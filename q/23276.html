<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::23276</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>nan</td><td>Scala 3</td><td>240510T114217Z</td><td><a href="https://codegolf.stackexchange.com/questions/23276/write-a-playfair-encryption-program/273051#273051">138 Aspe</a></td></tr>
<tr d-ix="1"><td>557</td><td>Rust</td><td>240510T131221Z</td><td><a href="https://codegolf.stackexchange.com/questions/23276/write-a-playfair-encryption-program/273053#273053">mousetai</a></td></tr>
<tr d-ix="2"><td>569</td><td>Python 3</td><td>140307T132931Z</td><td><a href="https://codegolf.stackexchange.com/questions/23276/write-a-playfair-encryption-program/23363#23363">Michael </a></td></tr>
<tr d-ix="3"><td>nan</td><td>Python</td><td>240510T120204Z</td><td><a href="https://codegolf.stackexchange.com/questions/23276/write-a-playfair-encryption-program/273052#273052">138 Aspe</a></td></tr>
<tr d-ix="4"><td>111</td><td>Pyth</td><td>170924T130412Z</td><td><a href="https://codegolf.stackexchange.com/questions/23276/write-a-playfair-encryption-program/143633#143633">EndingBe</a></td></tr>
<tr d-ix="5"><td>330</td><td>Ruby</td><td>140307T014848Z</td><td><a href="https://codegolf.stackexchange.com/questions/23276/write-a-playfair-encryption-program/23284#23284">Doorknob</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.scala-lang.org/" rel="nofollow noreferrer">Scala 3</a>, <del>1492</del> <del>766</del> <del>747</del> 740 bytes</h1>
<p>A port of <a href="https://codegolf.stackexchange.com/a/23284/110802">@Doorknob's Ruby answer</a> in Scala.</p>
<p>Saved 726+19+7=752 bytes thanks to @ceilingcat</p>
<hr />
<p>Golfed version. <a href="https://ato.pxeger.com/run?1=TVLbbhMxEJV4zFdYEW3GxJi2KBKKcKVSmhJIGyApLaAKuV5v4mazu7GnhXaVL-GlL_BP8MyHMHuh4iEbH_vMzDkz8_1nMDrRT-_uflxh_PjZ7wd_sotLa5Ati8jGDIGriiFdJicYDVPprY5GLrXAJXq3JJwn2ljoXHZEx3XoNjvJc-v3dbAydglaD1-kCyOLdCyfRy5gq8weA_b3vNc3n-vv_lz783Nh-uWB92GYoqAfVwXKW5efOpwP08h-kyZLEhI5cD5gYagQeOG4i5mnpxS1SwMYrnbBCS9dGTKO6YKv5czi2B8kFAFbYotuKiFLioC9RsuEbKWzc6p6rRO2UNQDGZFklxpsXWvPBgoW3S60917svzwYHL4avhkdHY_fvns_mZ58OD37-Knd-D7OEBb3ijgvzVc1WmXmqarOEvXFVaLRQk_0OJCTUvkA_KNelyRX1KCgbFrdIOBP-qSJF6ArqotByzRLD5Y53mxuapnogEoZrvvdzlmn3zXMkmFG0KxbOZnDJIXQflgAhQYZ3K3d2Hm-zUPNC1UYlyFxETUCdsTOv6nJmIQe6bzI1S7pgpmYcwU5bHGRV2UrubWFGKZiVuOViGo85y0q6ZVa8aLMB1PwZNl0t_lGj4sprAhFNeLrSg3xjVLRPR98_UzjJD6sGhQ1_P_SRk3Ccu5ruVzUc123CdXL3uz83a_XE9RmwcbX1sdJ9rU1nVtmNDJDu42M-pUxLK_8TY6C_jTtdySYTqOGkl0h0zMasqxT_gU" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre class="lang-scala prettyprint-override"><code>object m{def t()=scala.io.StdIn.readLine().trim.replace('j','i').toUpperCase.filter(_.isLetter).toList
def f(t:Array[Array[Char]],c:Char):(Int,Int)={t.zipWithIndex.collectFirst{case(r,i)if r.contains(c)=&gt;(i,r.indexOf(c))}.getOrElse((0,0))}
def main(A:Array[String])={val k=t().distinct
var F=(k++(&quot;ABCDEFGHIKLMNOPQRSTUVWXYZ&quot;.filterNot(k.contains))).toArray
val T=Array.tabulate(5,5)((r,c)=&gt;F(r*5+c))
val s=(List[Char]()/:t()){(a,c)=&gt;if(a.nonEmpty&amp;&amp;a.last==c)a:+'X':+c else a:+c}
println(s&quot;${(if(s.size%2&lt;1)s else s:+'X').sliding(2,2).toList.flatMap{p=&gt;val(g,h)=(p(0),p.last)
val(r,c)=f(T,g)
val(q,d)=f(T,h)
if(r==q){List(T(r)((c+1)%5),T(q)((d+1)%5))}else if(c==d){List(T((r+1)%5)(c),T((q+1)%5)(d))}else{List(T(r)(d),T(q)(c))}}.mkString}&quot;)}}
</code></pre>
<p>Ungolfed version. <a href="https://ato.pxeger.com/run?1=hVZdb9s2FH3Pr7gIuppaFHXxYGAIkAGd53RZnY_FydqtGAZGomw2FCWQdBI3yC_pS166_7T9mt1LSrLlxOiLE5GH51yeey_Jz__YlCv-_ePjl7nLd3_4b2u3vPooUgfHXGq43wJ49QoO5zp1stTgSnCGa5uXpgA3EyB1NXdgnZF6ithM5EsAc-LO7cPET0b7MJbWfRjOuPkLDjyz5z4XleKpgN7HHtxKN4Oe7MWQlvpGGEeC86oSJuVWxGBEUd4I0KXe5aqa8SvhIEVCnjphbAxcZ2ArJR3GhSuXU16MwklMkGMoF5NUlLjykhSGqJDkUiGc_Z1IOxYO_6VpihsJHraemjEVWhjuhPfiTPFFzqWBVFYzYeBaLMDxKyVqYxrwW7G4oGGGgBV7XhvDFx_Cr3dpadMNV8RGoxYHlw7jYJRkGJ_EmFoo2oTJQ9Zmwfbrn4Y_jw7f_HL0dnx8cnr22_nk4vL3d-__-HO73vJJ6VijkKD5Dgls1DKmZXEltcgawhYLOztrcuSY30ST4KERjUODu0HHFQibTvB7rhDEBjEMIsZMeUsloCI4-LGrTVPwLQxgx89HG_JSYZq5CaKFsJZPBaBhIHRqFhWh6pzUwOOAYYWdrhfssmq7-UDo03zg4NK0mjs7tlMENfgkL1U2FrljS2YWRXAPjKdp7IuW9u1pAGTuxxOs-VFRuQW8fAn0rbh1cHBQw3EE9neg975Hf2gMhLKiGacBz_fQBiduhD7rBEhKKyEnVn4S8A30SeW7qLMbz706ELQ9-RpxYpXM0E7Wj6H_lW7KJfZvWpYGF2A1WChz4Msuxqb2CV3vK1o2pFWWuSv1XCMFV_eBvjCv7Ei7GPAnajOKC5NPsnqHB9CRzsQd9oBSeAweSoM-39fJoFMIQnXijwdG5Bt-tE3DmgR6oMd4dCLp39M8zIcqeUimwp2aEdrJ3IxKW4tbOCkn83Q2UqIQ2o3uUuELltntYevEC59iXTqs6jmaVjvjXdne2BV19aOnTU_MLabmucOrtrZe0bTHRnt936y3S9S0UusywpIcG_2YV1jvFcm1hU5FydI9TFWf0sJoNpkJnsUe6As-6mLP_TGxN_QHxVoZ0EQX3g_w_iZ4P1ppOU_u-4uWRW0FeE8nvBCU0naMNk0sYRkeYD4oPKP2IuygQRSDn-zXk_3OZCP7ENoqqBPCq_ton6pjec4L_TSAOvCWPFDVAYQIVic9_VoAHbFz7AGup0qAveXVxg0Hos42g3DLXdd7cT1p3gq-QqnI6PZg3ExtU1sBQvVzqfEuX7sF8du_WRJZJhOXHWm803k2xiuC4fliZLF6RH8d3FxTb1av8vaI8U-KZ26T1YD8ZY5Cz93vm26Dp_dO1EYyqtv0Obm6IRuatf5sgolX1ZbEp3NHrzXibXk6ChX67hQdNaN2vubehxer2tvhjHkIr8b68fj4768Tx9NrOMW3W66wQS5QKuX4SMNw6kcZqXsebDnD8eWVhXdbgJQYH59iQSSB8n8" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre class="lang-scala prettyprint-override"><code>object Main {
  // Function to transform the input string
  def transform(text: String): List[Char] = {
    // Replace 'j' with 'i', convert to uppercase, remove non-alphabet characters, and split into characters
    text.replace('j', 'i').toUpperCase.filter(_.isLetter).toList
  }

  // Function to generate the Playfair cipher key table
  def generateKeyTable(key: String): Array[Array[Char]] = {
    val keyChars = transform(key).distinct
    val remainingChars = &quot;ABCDEFGHIKLMNOPQRSTUVWXYZ&quot;.filterNot(keyChars.contains)
    val combinedChars = (keyChars ++ remainingChars).toArray
    // Create the 5x5 key table
    Array.tabulate(5, 5)((row, col) =&gt; combinedChars(row * 5 + col))
  }

  // Function to prepare the message for encryption
  def prepareMessage(msg: String): List[List[Char]] = {
    val msgChars = transform(msg)
    val preparedMsg = msgChars.foldLeft(List[Char]()) { (acc, char) =&gt;
      if (acc.nonEmpty &amp;&amp; acc.last == char) acc :+ 'X' :+ char else acc :+ char
    }
    val evenPreparedMsg = if (preparedMsg.size % 2 == 0) preparedMsg else preparedMsg :+ 'X'
    evenPreparedMsg.sliding(2, 2).toList
  }

  // Function to find coordinates of a character in the key table
  def findCoords(tbl: Array[Array[Char]], char: Char): (Int, Int) = {
    tbl.zipWithIndex.collectFirst {
      case (row, rowIndex) if row.contains(char) =&gt; (rowIndex, row.indexOf(char))
    }.getOrElse(throw new NoSuchElementException(s&quot;Character $char not found in the table&quot;))
  }

  // Function to encrypt a message using the Playfair cipher
  def encryptMessage(tbl: Array[Array[Char]], msg: List[List[Char]]): String = {
    msg.flatMap { pair =&gt;
      val (c1, c2) = (pair.head, pair.last)
      val (c1Row, c1Col) = findCoords(tbl, c1)
      val (c2Row, c2Col) = findCoords(tbl, c2)
      if (c1Row == c2Row) {
        // Same row
        List(tbl(c1Row)((c1Col + 1) % 5), tbl(c2Row)((c2Col + 1) % 5))
      } else if (c1Col == c2Col) {
        // Same column
        List(tbl((c1Row + 1) % 5)(c1Col), tbl((c2Row + 1) % 5)(c2Col))
      } else {
        // Rectangle swap
        List(tbl(c1Row)(c2Col), tbl(c2Row)(c1Col))
      }
    }.mkString
  }

  def main(args: Array[String]): Unit = {
    val key = scala.io.StdIn.readLine().trim
    val msg = scala.io.StdIn.readLine().trim

    // Generate the key table and prepare the message
    val keyTable = generateKeyTable(key)
    val preparedMsg = prepareMessage(msg)

    // Encrypt the message
    val encryptedMsg = encryptMessage(keyTable, preparedMsg)

    // Output the encrypted message
    println(s&quot;Encrypted Message: $encryptedMsg&quot;)
  }
}
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.rust-lang.org" rel="nofollow noreferrer">Rust</a>, <strike>583</strike> <strike>578 bytes</strike> 557 bytes</h1>
<pre class="lang-rust prettyprint-override"><code>use std::io::*;fn f(mut k:Vec&lt;u8&gt;,t:Vec&lt;u8&gt;){let u=|a:Vec&lt;u8&gt;|a.into_iter().flat_map(|mut a|{a|=32;(a&gt;96&amp;&amp;a&lt;123).then(||a-(a==106)as u8)});k.extend(97..123);let mut o=vec![];for a in u(k){if!o.contains(&amp;a){o.push(a)}}let mut p=vec![];for c in u(t){if p.len()%2&gt;0&amp;&amp;p[p.len()-1]==c{p.push(120)}p.push(c)}if p.len()%2&gt;0{p.push(120)}for k in 0..p.len()/2{let[d,e]=[0,1].map(|z|o.iter().position(|&amp;a|a==p[k*2+z]).unwrap());stdout().write(&amp;if d%5==e%5{[(d+5)%25,(e+5)%25]}else if d/5==e/5{[d/5*5+(d+1)%5,e/5*5+(e+1)%5]}else{[d/5*5+e%5,e/5*5+d%5]}.map(|z|o[z]));}}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=VZNRbptAEIalvtWnGFsy2rXx2iYidUyw5DiNFEVOpdi1lCAUbWCpkW0WwRK3AU7Slzy09-g12tN0N-C0eWJm9puf4d_h-48kS8Xz889MBL3Rn3e9LGWQCn88Dvl43LGCCAK0ywRsxivmnWajiS4OEc63TEBmF_RQKSgJI8HvQ8EShEmwpeJ-R2NUKAVa5LSwjwwL0cnJsabR06FxhIlYswgVBe0hatvDwTGmKWQjXGJrQ9hXwSIfnXwgRLGWep-S4vYj85qOawU8AQphBBna4DwMmpx4PBI0jFKkUZxzEmfpGlFclofe-P9er-oVqhdispWj4LYxGWha7NRpb-jatpfHldLQGOCyjj1cvu16Ayn5jZIfEFIzfUM55vg6c21noA9d8mLOU8FJ7VjM01CEXBqi0UL6ETubjtF9cjHJon0iYYwteTs8ExLeJ7ILaXIGv23aNmubuYP8rilnMXXEqsAt2VZeqYL6CupLSEYdsyvRIW6bOqsy9pJV-AFhr8e-Onod15ETYassq635_ash12QnTUc4b7wP0EMrFdTb8EeWBFu-bxG5EtJ0hPWH1nLNwKMCvITFAtS2gFCl5FssdPmgccx8HWjk1whXq_NFijf_6WCrUTYa_T4sLuFmCrMp3JzDxRxWn-FyBqsFzD-pyt01TK_g4wzmdzC_gLMZ3F7X5GIFyxVcncFyDvPb6jsOf8Ff" rel="nofollow noreferrer">Attempt This Online!</a></p>
<h2>Formatted</h2>
<pre class="lang-rs prettyprint-override"><code>use std::io::*;
fn f(mut k: Vec&lt;u8&gt;, t: Vec&lt;u8&gt;) {
    let u = |a: Vec&lt;u8&gt;| {
        a.into_iter().flat_map(|mut a| {
            a |= 32;
            (a &gt; 96 &amp;&amp; a &lt; 123).then(|| a - (a == 106) as u8)
        })
    };
    k.extend(97..123);
    let mut o = vec![];
    for a in u(k) {
        if !o.contains(&amp;a) {
            o.push(a)
        }
    }
    let mut p = vec![];
    for c in u(t) {
        if p.len() % 2 &gt; 0 &amp;&amp; p[p.len() - 1] == c {
            p.push(120)
        }
        p.push(c)
    }
    if p.len() % 2 &gt; 0 {
        p.push(120)
    }
    for k in 0..p.len() / 2 {
        let [d, e] = [0, 1].map(|z| o.iter().position(|&amp;a| a == p[k * 2 + z]).unwrap());
        stdout().write(
            &amp;if d % 5 == e % 5 {
                [(d + 5) % 25, (e + 5) % 25]
            } else if d / 5 == e / 5 {
                [d / 5 * 5 + (d + 1) % 5, e / 5 * 5 + (e + 1) % 5]
            } else {
                [d / 5 * 5 + e % 5, e / 5 * 5 + d % 5]
            }
            .map(|z| o[z]),
        );
    }
}
</code></pre>
</div>
<div id="pu2" class="pu"><h1>Python 3, <s>709</s> <s>705</s> <s>685</s> <s>664</s> <s>662</s> <s>615</s> 569</h1>
<p>With @ceilingcat's improvements. Accepts input from stdin.</p>
<pre><code>import itertools as I,re,string
a=string.ascii_uppercase
d=lambda x:I.product(range(5),repeat=x)
t=lambda x:(input()+x).upper().replace('J','I')
s=''
for _ in t(a):
 if _ not in s and _ in a:s+=_
m=[s[i:i+5]for i in range(0,len(s),5)]
e={r[i]+r[j]:r[-~i%5]+r[-~j%5]for r in m for i,j in d(2)if i-j}
e.update({c[i]+c[j]:c[-~i%5]+c[-~j%5]for c in zip(*m)for i,j in d(2)if i-j})
e.update({m[q][r]+m[u][v]:m[q][v]+m[u][r]for q,r,u,v in d(4)if(q-u)*(r-v)})
print(''.join(e[a+(b if b else'X')]for a,b in re.findall(r'(.)(?:(?!\1)(.))?',''.join([_ for _ in t('')if _ in a]))))
</code></pre>
<p>Example:</p>
<pre><code>mfukar@oxygen[/tmp]&lt;&gt;$ python playfair.py
Stack Overflow
The cat crept into the crypt, crapped, and crept out again.
SIRACARDFMVUICVSMORDZNAKECMZMFBCYNRDFMSVTVKBTMMY
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, <del>1338</del> 525 bytes</h1>
<p>A port of <a href="https://codegolf.stackexchange.com/a/23284/110802">@Doorknob's Ruby answer</a> in Python.</p>
<p>Saved 813 bytes thanks to @ceilingcat</p>
<hr />
<p>Golfed version. <a href="https://tio.run/##ZVJNb5wwEL37V1iRImzBomSrvbD1od1@oW6ahqRtWsTBhSGYGGMZ03Qv@eubMWlOlZDm6b03M3429uC70bw6HvdCgyFeaDn8bmRW1rQdHa2pMvjZ2TOeTt4pi9WB1bIGFvVREqmIp7O14BhXLa1TNUltO8l4RWah1eRZo2qftm4c7uEwMRzEORkEVtKLM2IFiCgiD53SQPvXezbwjFAbi6Hsq20fi3NCcfCzIk1DkV@dV2LRM/RFtxFBw55Zfrp@IbQo2RyX3RKiwwQnb97u3r3/8PFT/nl/8eXy61VxffPt@4/bn79OsLmjZvQh6lzxss/6eFOFxj5QTpo7YGfJepNsMFQDLW1ZFw4ZLCoZgwnMPICTHpgOCl1mIj9mDvzsTPClyjTwF1vJcrPJDg2lXdat/18X8iRrXmUuUaJlNd8WSY5gx7cQC126qlw9qtNNFeuyCDhHjGudEAUFPQFdPPk/XQVNrfIXafXo0I90HHARcF4R65TxDPjxeO1lfU8v/4Br9fhAbjqgtfS0xrcPF@VH6gPlDtYnWCT@AU1Cw/s8W8bZU3knlUmfAA" rel="nofollow noreferrer">Try It Online!</a></p>
<pre class="lang-python prettyprint-override"><code>L=len
t=lambda:[c for c in input().strip().replace('j','i').upper()if c.isalpha()]
u=list(dict.fromkeys(t()))
m=t()
j=0
p=e=''
while j&lt;L(m):
 p+=m[j];j+=1
 if j&lt;L(m)and m[j-1]==m[j]:p+='X'
if L(p)%2:p+='X'
l=[(u+[h for h in&quot;ABCDEFGHIKLMNOPQRSTUVWXYZ&quot;if h not in u])[j:j+5]for j in range(0,25,5)]
def f(h):
 for i,o in enumerate(l):
  if h in o:return i,o.index(h)
for c,C in[p[j:j+2]for j in range(0,L(p),2)]:r,i=f(c);R,I=f(C);e+=l[r][-~i%5]+l[R][-~I%5]if r==R else l[r][I]+l[R][i]if i-I else l[-~r%5][i]+l[-~R%5][I]
print(e)
</code></pre>
<p>Ungolfed version. <a href="https://ato.pxeger.com/run?1=lVbBjts2EL3rK6ZZFJKxjpE1YKAI6kOabtKmbTbZTdu0hmHQ0thmIlMqSa3tS38kl720_9R-TWdIWpZkb7Ddi7nkzHszb2Yofvq73NlVoe7u_qrs4vFX_0Z_nsGLSqVWFgpsAVYLZRaFXoNdIUhVVhaM1VItowwXh-PE4tb2nkZAf2dwjWUuUoT4QwwbaVcQy7gPaaFuUVuGrcoSdSoM9kHjurhFUIV6LPJyJeZoIV0JLVKL2vRBqAxMmUtL7OR5OHJcTAtj9zPQnjUh1j4z9gaOJuk5S4220gomDAAUskMiTA8hF-7_gTQuiKQ3jaK2EktUqIVFJ8SbXOwWQhKILFeo4SPuwIp5jk6VvemMtmduO6FVUIdNxw3h-CTI9lwjEwjIpbFQLKBS8o8KGzm7eImfQRZFnhcbzGC-c3savROvayUT3KZ5lVG9IH4VeyKP6oJjZEPhMGGSydQOFrpY04lxce2VWwupCKI2Pxbx0bNvnn97-eLld9__8ONPr6_evL2-effzL7--_-33R3ttqcRcwyP6qSNJi_VcKsxqjqMoz7uBtFXjtEfbUaMUraq34CfyqTwfTV0GkmOiaiwxedKH4agPo-Pil9RbQnuSNRojluicUaV6V7KVK3wwmwWTZG2Woeq0alWdT0L8z7IM4vcxULk2iBQLlpQQV6zT6wE9m3mwiRdO0vKJW21WMqcZha8hR9Xg7voOBI2FythiIqe92obqJEnliwaAmz5vB-OxX7HJ9IB8Hzql1ICG8zFchIQvlalIS7ylZIloSfcDtbDIfJeSEhSIwpQ11LsoRMYRNWl68CUM4QvK_fNJ1mGcwc3hFilpdk2rQZq-rj2Gp9rjKArqmONuWUhSLS0KTRlRaxqeSnGoZnOID5cGO82ck0nsPO87-1BBDkQXm5nMtn1eMAKqau1uGbZuVHo_bRx2sWnXKSTbhBoQLW4TR9YU5HWhsJtX6HbKZT8DleGanbgRXUrBvh4Hl9ahL8Nxt6E5Wa4PZ0AHhwzSCxJlSIZ82tidURp9_k2LnE6Phbw4NGI6DNbDe62HrYnw8Nz83rUtKDWVWCPr2NpuZbbvREKfeLTpJAnR0ihxI48aU_h5_-Hef3ifP-Y-apfeOCR6Mmrar9bqYcRJ0KEmnHiKhwae-Mib_sOOP-YGu3FeY2pp9uhaMxtR_j-NjwgepGwrrTALcTz4UEiVtJx7PB0v6RNbGTfS_DLi1t1Ptrs5feNH_pvvbJLegN9PJb1KfNd3dx1q46lR3xIO8cSHKKpfGYR2z9Mj6nw7Tn2omPkyTHgTvjum3amumfqtC9jhXVWWdWG4GqYGLukZaTui-mdoeI3e_fPqxor0I1zRu3FBj53oHQGlgh6IRBSucsZ2CDS6mgua-TejNymIXSzp1TDwkP8B" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre class="lang-python prettyprint-override"><code># Function to transform the input string
def transform(text):
    # Replace 'j' with 'i', convert to uppercase, remove non-alphabet characters, and split into characters
    text = text.replace('j', 'i').upper()
    return [char for char in text if char.isalpha()]

# Function to generate the Playfair cipher key table
def generate_key_table(key):
    key = transform(key)
    # Create a list of unique characters in the key followed by the rest of the alphabet (excluding 'J')
    unique_key_chars = list(dict.fromkeys(key))
    remaining_chars = [char for char in &quot;ABCDEFGHIKLMNOPQRSTUVWXYZ&quot; if char not in unique_key_chars]
    combined_chars = unique_key_chars + remaining_chars
    # Create the 5x5 key table
    return [combined_chars[i:i+5] for i in range(0, 25, 5)]

# Function to prepare the message for encryption
def prepare_message(msg):
    msg = transform(msg)
    # Add 'X' between repeating characters
    prepared_msg = []
    i = 0
    while i &lt; len(msg):
        prepared_msg.append(msg[i])
        if i + 1 &lt; len(msg) and msg[i] == msg[i + 1]:
            prepared_msg.append('X')
        i += 1
    # Ensure even length by adding 'X' if necessary
    if len(prepared_msg) % 2 != 0:
        prepared_msg.append('X')
    # Split into pairs
    return [prepared_msg[i:i+2] for i in range(0, len(prepared_msg), 2)]

# Function to find coordinates of a character in the key table
def find_coords(tbl, char):
    for row_idx, row in enumerate(tbl):
        if char in row:
            return row_idx, row.index(char)
    return None

# Function to encrypt a message using the Playfair cipher
def encrypt_message(tbl, msg):
    encrypted_msg = []
    for pair in msg:
        c1, c2 = pair
        c1_row, c1_col = find_coords(tbl, c1)
        c2_row, c2_col = find_coords(tbl, c2)
        if c1_row == c2_row:
            # Same row
            encrypted_msg.append(tbl[c1_row][(c1_col + 1) % 5])
            encrypted_msg.append(tbl[c2_row][(c2_col + 1) % 5])
        elif c1_col == c2_col:
            # Same column
            encrypted_msg.append(tbl[(c1_row + 1) % 5][c1_col])
            encrypted_msg.append(tbl[(c2_row + 1) % 5][c2_col])
        else:
            # Rectangle swap
            encrypted_msg.append(tbl[c1_row][c2_col])
            encrypted_msg.append(tbl[c2_row][c1_col])
    return ''.join(encrypted_msg)

# Get user input for the key and message
key = input().strip()
msg = input().strip()

# Generate the key table and prepare the message
key_table = generate_key_table(key)
prepared_msg = prepare_message(msg)

# Encrypt the message
encrypted_msg = encrypt_message(key_table, prepared_msg)

# Output the encrypted message
print(encrypted_msg)
</code></pre>
</div>
<div id="pu4" class="pu"><h1>Pyth - 111</h1>

<p>Too late for competing, I just wanted to share. Here's 
<a href="https://pyth.herokuapp.com/?code=L%40G%3Arb0%5Cj%5CiJ%7By%2BwGKywWhZ%3DZh%2a2xlR%7BRcK2+1IhZ%3DKXZK%5Cx%3BM%40J%2BG%3F%21eH5%3F%21hH%3Fq4%25G5_4+1eHVcK2A%2CxJhNxJeN%3DZ-V.DH5.DG5pgGZpgH_RZ&amp;input=Stack+Overflow%0AThe+cat+crept+into+the+crypt%2C+crapped%2C+and+crept+out+again.&amp;debug=0" rel="nofollow noreferrer">the encoder</a>
and 
<a href="https://pyth.herokuapp.com/?code=L%40G%3Arb0%5Cj%5CiJ%7By%2BwGKywWhZ%3DZh%2a2xlR%7BRcK2+1IhZ%3DKXZK%5Cx%3BM%40J%2BG%3F%21eH_5%3F%21hH%3F%21%25G5+4_1eHVcK2A%2CxJhNxJeN%3DZ-V.DH5.DG5pgGZpgH_RZ&amp;input=Stack+Overflow%0Asiracardfmvuicvsmordznakecmzmfbcynrdfmsvtvkbtmmy&amp;debug=0" rel="nofollow noreferrer">decoder</a></p>

<pre><code>L@G:rb0\j\iJ{y+wGKywWhZ=Zh*2xlR{RcK2 1IhZ=KXZK\x;M@J+G?!eH5?!hH?q4%G5_4 1eHVcK2A,xJhNxJeN=Z-V.DH5.DG5pgGZpgH_RZ
</code></pre>

<p><strong>Explanation:</strong></p>

<pre><code>L    b                              L defines common method y(b); 2 calls helps us saving two bytes
    r 0                             lowercase r(b,0)
   :   \j\i                         : replaces all occurrences of "j" with "i"
 @G                                 strips all non-alphabetic characters; G = pyth built-in alphabet

    w                               first input argument
   + G                              appends the alphabet (G)
  y                                 calls y(b)
 {                                  { makes set (removes duplicated characters)
J                                   assigns result to 'J' (KEY VARIABLE)

Kyw                                 assigns output from y(second input argument) to 'K' (TEXT VARIABLE)

WhZ                         ;       While (Z+1 != 0) &lt;-&gt; While (Z != -1) &lt;-&gt; While mismatched items found
             cK2                    list of K pairs.                    e.g. 'ABCCDDE' -&gt; [AB, CC, DD, E]
         lR{R                       l length of { unique characters.    e.g. [2, 1, 1, 1]
        x       1                   1-length first index.               e.g. 1
     h*2                            *2+1 (Index in K)                   e.g. 3 'ABC CDDE'
   =Z                               Assigns to 'Z'
                  IhZ               if (Z != -1) &lt;-&gt; if (mismatched found)
                     =KXZK\x        X Inserts at Z index in K an 'x' and reassigns to 'K'  e.g. 'ABCXC...'

M                                   M defines function g(G, H) where G index H vector (INDEX CONVERSION)
     ?!eH                           if (same col)
         5                              then +5
         ?!hH                           else { if (same row)
             ?q4%G5                             then if (last col)
                   _4                               then -4
                      1                             else +1
                       eH                       else col
   +G                               index += increment
 @J                                 J[index]

VcK2                                V loops over cK2 list of K pairs
     ,xJhNxJeN                      x returns pair members index in J
    A                               A assigns G = xJhN, H = xJeN
                  .DH5              .D returns [row, col] = [i/5,i%5] of 5xn matrix from index of H
                      .DG5          idem. of G
                -V                  Subtracts vectors (RELATIVE POSITION)
              =Z                    Assigns to 'Z'
                          pgGZ          p prints g(G, Z) return value
                              pgH_RZ    p prints g(H, _RZ) return value, and _R changes signs of Z vector
</code></pre>

<p><strong>Sample Key/Message/Output:</strong></p>

<pre><code>Stack Overflow
Gottfried Leibniz is famous for his slogan Calculemus, which means Let us calculate. He envisioned a formal language to reduce reasoning to calculation.
lfaukvvnrbbomwpmupkoexvqkovfimaqohflcmkcdsqwbxqtlintinbehcbovttksbtybsavmormwuthrhrbkevfxebqbspdxtbfsvfrwyarfrctrhmpwkrssbtybsvurh
</code></pre>
</div>
<div id="pu5" class="pu"><h2>Ruby, <s>461</s> <s>411</s> <s>366</s> <s>359</s> <s>352</s> <s>346</s> 330 characters</h2>



<pre class="lang-ruby prettyprint-override"><code>k,m=$&lt;.map{|x|x.tr(?j,?i).upcase.tr('^A-Z','').chars}
t=[*((k&amp;k)|[*?A..?Z]-[?J]).each_slice(5)]
m=(m*'').gsub(/(.)\1/,'\1X\1').chars
c=-&gt;n{[t.index{|r|k=r.index n},k]}
$&gt;&lt;&lt;(m.size%2&lt;1?m:m+[?X]).each_slice(2).map{|p,q|a,b,d,e=*c[p],*c[q]
a==d ?[t[a][(b+1)%5],t[d][(e+1)%5]]:b==e ?[t[(a+1)%5][b],t[(d+1)%5][e]]:[t[a][e],t[d][b]]}*''
</code></pre>

<p>Thanks to @daniero for saving... err, a <em>lot</em> of bytes. \o/</p>

<p>Here's the ungolfed code:</p>

<pre class="lang-ruby prettyprint-override"><code>key = gets.chomp
msg = gets.chomp
transform = -&gt;str{
    str.gsub! 'j', 'i'
    str.upcase!
    str.gsub! /[^A-Z]/, ''
    str.split('')
}

# 1. Generate a key table
key = transform[key]
chars = key.uniq + ([*?A..?Z] - key - ['J'])
tbl = Array.new(5) {
    Array.new(5) {
        chars.shift
    }
}

# 2. Prepare the message
msg = transform[msg]
msg = msg.join('').gsub(/(.)\1/){ "#{$1}X#{$1}" }.split('')
msg = (msg.length % 2 == 0 ? msg : msg + ['X']).each_slice(2).to_a

# 3. Encryption
coords = -&gt;chr{
    i = -1
    [tbl.index{|row| i = row.index chr}, i]
}
msg.map! do |c1, c2|
    c1, c2 = coords[c1], coords[c2]
    if c1[0] == c2[0]
        # same row
        [tbl[c1[0]][(c1[1] + 1) % 5], tbl[c2[0]][(c2[1] + 1) % 5]]
    elsif c1[1] == c2[1]
        # same column
        [tbl[(c1[0] + 1) % 5][c1[1]], tbl[(c2[0] + 1) % 5][c2[1]]]
    else
        # neither
        [tbl[c1[0]][c2[1]], tbl[c2[0]][c1[1]]]
    end
end

# Output!
puts msg.join
</code></pre>

<p>Here's some sample outputs:</p>

<pre class="lang-ruby prettyprint-override"><code>llama@llama:...code/ruby/ppcg23276playfair$ printf 'Stack Overflow\nThe cat crept into the crypt, crapped, and crept out again.\n' | ./playfair.rb; printf 'This is a password!\nProgramming Puzzles and Code Golf is a Stack Exchange site.\n' | ./playfair.rb
SIRAVXRDFMVUUYVSBLRDZNYVECMZMFBCYNRDFMSVTVKBVBMY
WDDEDSXIXOQFBTUYVQFISQWGRPFBWMESATAHHGMBVEITQFFISHMI
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/23276/">23276</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




