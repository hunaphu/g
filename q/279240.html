<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::279240</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>129</td><td>Bash</td><td>250420T214212Z</td><td><a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8-for-supplementary-characters/279241#279241">Explorer</a></td></tr>
<tr d-ix="1"><td>083</td><td>Charcoal</td><td>250424T091905Z</td><td><a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8-for-supplementary-characters/279295#279295">Neil</a></td></tr>
<tr d-ix="2"><td>5854</td><td>x8664 machine code</td><td>250422T140443Z</td><td><a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8-for-supplementary-characters/279262#279262">m90</a></td></tr>
<tr d-ix="3"><td>139</td><td>Python 3.8</td><td>250422T155852Z</td><td><a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8-for-supplementary-characters/279265#279265">CrSb0001</a></td></tr>
<tr d-ix="4"><td>123</td><td>C gcc</td><td>250422T010335Z</td><td><a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8-for-supplementary-characters/279254#279254">l4m2</a></td></tr>
<tr d-ix="5"><td>nan</td><td>05AB1E</td><td>250422T095113Z</td><td><a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8-for-supplementary-characters/279258#279258">Kevin Cr</a></td></tr>
<tr d-ix="6"><td>143</td><td>C gcc</td><td>250421T075343Z</td><td><a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8-for-supplementary-characters/279243#279243">ceilingc</a></td></tr>
</table>
<div id="pu0" class="pu"><h2><a href="https://www.gnu.org/software/bash/" rel="nofollow noreferrer">Bash</a>, <s>131</s> 129 bytes</h2>
<pre class="lang-bash prettyprint-override"><code>u()(printf %X${1:9} $((v=0x${1:3:3}+128,(v&amp;7228)*3+v+985096)))
c()(printf ED%XEDB${1:5} $((v=0x${1:1:4},(v&amp;771|v/4&amp;7228)+40832)))
</code></pre>
<p><a href="https://tio.run/##VY9rS8MwGIW/51e8jM4l1mEunUurFaxbf8NAhGrXsYA0km2lYPvba3qJl@TLk5Nzzpu8v52OXXfBBH8aVZ4PMN95XywKW/AwrmJa9ycRidZnXN7g6mrNuSTXwq/8UK5oeEcIQflvfLuZ77abpE@t/nWwKGiH/Jo11W0w9vgBlYLbii5CH@p0jhcopSGVdo@QJukAyaQId/U8wZMzJxMw6cD1cKcI5wnkD9gBdsQCHbQBBaoEr3/HPew1AruK/Kghy8FTGcwelsvHGWQX@61eIdlgeYH6jwQx1J6CV2iaMVwYow3a67LovgE" rel="nofollow noreferrer" title="Bash – Try It Online">Try it online!</a></p>
<h2><a href="https://www.zsh.org/" rel="nofollow noreferrer">Zsh</a> (no <code>C_PRECEDENCES</code>), 122 bytes</h2>
<pre class="lang-sh prettyprint-override"><code>u()(printf %X${1:9} $[v=0x${1:3:3}+128,v&amp;7228*3+v+985096])
c()(printf ED%XEDB${1:5} $[v=0x${1:1:4},v&amp;771|v&gt;&gt;2&amp;7228+40832])
</code></pre>
<p><a href="https://tio.run/##TY7daoNAEIXvfYohmEZrA7prmtVWoep6WUp7EwhSwRiyUNzgH9Losxs1bpvZm2/OnDOzv8Wpr7IiLfm5BP/745P6NKDvPv3qK0VVzjnLyiMsd/LFsK0O5H3t6M3YYBt3moHIU/2wRYg8Yq3WLLLRredIlZL/KA2WOxp4Y2RznzdssxuzW6OtXRdNSzRTJxhFam9LP6wonZUU6pZOhneD0Asn8GYFi5E/w5swezMYRIDYg4SChcckfzAcGE6spCPPgQHLQL4440@6FzhwCYZKkxOHOAGZxbB4Xa/dBcQVyMqoqPFk2UNzJ4EDjcwggra9hdM857l04FnaXwE" rel="nofollow noreferrer" title="Zsh – Try It Online">Try it online!</a></p>
<p><em>This entry was submitted by the author of this challenge and serves as an example.</em></p>
<p>Numbers are processed in big endian. (It doesn't make sense to use little endian for this language.)</p>
<p><code>u</code> converts a CESU-8 sequence to UTF-8. The input, passed as argument <code>$1</code>, is formatted in 12 hex digits <em>without the <code>0x</code> prefix</em> (like <code>EDAFABEDB387</code>).</p>
<p><code>c</code> converts a UTF-8 sequence to CESU-8. The input, passed as argument <code>$1</code>, is formatted in 8 hex digits <em>without the <code>0x</code> prefix</em> (like <code>F48AB387</code>).</p>
<p>The Zsh version assumes the <strong><code>C_PRECEDENCES</code> option is off</strong> (<code>unsetopt C_PRECEDENCES</code>)  before calling the functions.</p>
<p>A slightly deobfuscated version:</p>
<pre class="lang-sh prettyprint-override"><code>cesu8_to_utf8 () (
    printf &quot;%X${1:9}&quot; \
        $((v = (0x${1:3:3}) + 0x80, \
            (v &amp; 0x1C3C) * 3 + v + 0xF0808))
)

utf8_to_cesu8 () (
    printf &quot;ED%XEDB${1:5}&quot; \
        $((v = (0x${1:1:4}), \
            ((v &amp; 0x303) | ((v / 4) &amp; 0x1C3C)) + 0x9F80))
)
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, <s>107</s> <s>103</s> 83 bytes</h1>
<pre><code>≔⍘⁺⍘↧θ¹⁶⎇÷Ｌθχ×³³Ｘ⁴¦¹⁶±×⁹Ｘ⁴χ⁴η↥⍘⍘⭆⎇÷Ｌθχ”C↘⁼Ｂ⁷HÀ-↙y&amp;↥””E⌈∨→ln‴=R⸿⊕À⊖G)&lt;℅”∨Σι§η⌕βι⁴¦¹⁶
</code></pre>
<p><a href="https://tio.run/##hU9Ra8IwEH7frwh9ukIGmhTn8KkyBMFtBd0PyNqYRGPaJbHqr4@JHaxvO8jlu/vu476rJbN1y3QIpXNKGFgyx7feKiOg0mc3rjfthds61vCTYzSdxbTj1jB7g7Xxb6pXDYcNN8LLYWKSJtSJO6AUoyrJoXgoI/HBBfMcBv51TE/yFBgV8cl88VTF7R6@uu53@8jSCA7fO@vgf1MZpXtB5OFItPOkv1yz1CN0SkizJ0IeHpgeNTFtl0XBp4Xt@QQqwtKvTcOvIDFaKdPAN0bqz2@6LV@EsCrm5ZLOX8Jzr@8" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. I/O is a hexadecimal string (big-endian). Auto-detects the conversion based on the length of the string. Explanation:</p>
<pre><code>≔⍘⁺⍘↧θ¹⁶⎇÷Ｌθχ×³³Ｘ⁴¦¹⁶±×⁹Ｘ⁴χ⁴η
</code></pre>
<p>Convert the input from hexadecimal, bias it by either adding <code>2³²+2³⁷</code> or subtracting <code>2²⁰+2²³</code>, then convert it to base <code>4</code>.</p>
<pre><code>↥⍘⍘⭆⎇÷Ｌθχ”C↘⁼Ｂ⁷HÀ-↙y&amp;↥””E⌈∨→ln‴=R⸿⊕À⊖G)&lt;℅”∨Σι§η⌕βι⁴¦¹⁶
</code></pre>
<p>Extract the appropriate base <code>4</code> digits into one of two compressed template strings, then convert the result from base <code>4</code> into base <code>16</code>.</p>
<p>Previous 103-byte answer:</p>
<pre><code>≔⪪⎇‹θ240”←″LＫ�⁺TRＩ⁴⁵””#⌈“«h⁸⎇¦↘4∕Ｕ▶³∨Ｇº▶ＤＢ&gt;” η≔⁰ζＦＥ⊟ηＸ²Ｉι≔⁺×ζι﹪Ｎιζ≧⁺Ｉ⊟ηζＦＥ⊟ηＸ²Ｉι«⊞υ⁺⁺¹²⁸Ｉ⊟η﹪ζι≧÷ιζ»Ｉ⮌υＳ
</code></pre>
<p><a href="https://tio.run/##lVHLasMwEDzHX7H4tAIHZFu4KT2V9hJoiknyA26i2gLHdvVwaUq/3V3JhtLeKqHVSrMzO0KnptKnvmqn6d4YVXd4GFpl8Sh1V@kPfJLG4FsCcSZ4zGhP0ww4zaLIIeWZAC4KLmKP8FvIPegTsQHBC8FhHYryoghs8LFhd9HSjCdwpdNrrwF31YBlP2BDJWX/LjVmCTxUxqJiNGChlK0zeFQXafCagKLiXX92bY/bbnD22V1eiMk8wmZx0p2pe1U3NvAX3bkb@4eHz2hVOtOgI9j7CCHNNr8FfzwFh4zUV39cbDv7qEZ1llQw9/@KSq06i0FoL0epjUQXyDMQ3newlNdIt9NEXxKl4iai/n5N67H9Bg" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. I/O is a list of decimal bytes. Auto-detects the conversion based on the first byte. Explanation: Similar to my previous 107-byte answer below but doesn't process the last byte since it's always the same.</p>
<pre><code>≔⪪⎇‹θ240”←″EＴ²G³|⌈⁼₂a≡””#⌈∨⊘↘yＬ×↔ＦＹ▶.πY⦃✂F¦‹$？ZI” η≔⁰ζＦＥ⊟ηＸ²Ｉι≔⁺×ζι﹪Ｎιζ≧⁺Ｉ⊟ηζＦＥ⊟ηＸ²Ｉι«⊞υ⁺⁺¹²⁸Ｉ⊟η﹪ζι≧÷ιζ»Ｉ⮌υ
</code></pre>
<p><a href="https://tio.run/##lVFbS8MwFH5ef8WhTyfQQXpZnPgk@jJwUub@QLfFNdC1NZeKE397PUkLom/mcpJwvhvkWFf62FXNON4bo84tvvSNsriXuq30Bz5JY/AtgTgreMzoTNMMeJhCiBzEapUL4IWgFfs2v4XcI/ylWHtYwWnBckLmxAo64GvN7qLZlidwpddrpwG3VY9l12NNkLJ7lxqzBB4qY1ExGjBTysYZ3KuLNHhNQBF4251c0@Gm7Z19dpcDMZnvsEmcdCfqTp1rG/iz7uTG/pHhM1qUztToqO1zhJJm69@CP5lCQkbqiz8pNq19VIM6SQJM/l9RqVVrMQjt5CC1keg8eRzpG6K0uInIye9xOTTf" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. I/O is a list of decimal bytes. Auto-detects the conversion based on the first byte. Explanation:</p>
<pre><code>≔⪪⎇‹θ240”←″EＴ²G³|⌈⁼₂a≡””#⌈∨⊘↘yＬ×↔ＦＹ▶.πY⦃✂F¦‹$？ZI” η
</code></pre>
<p>Select the operations to perform from two compressed strings based on the first byte. The uncompressed string data contains a) a list of 128-offset output byte offsets b) a string of output byte bit counts c) the offset between the two encodings d) a string of input byte bit counts.</p>
<pre><code>≔⁰ζ
</code></pre>
<p>Start with a zero code point.</p>
<pre><code>ＦＥ⊟ηＸ²Ｉι≔⁺×ζι﹪Ｎιζ
</code></pre>
<p>For each of the input bytes, extract the appropriate number of bits and update the running total. (For UTF, the final running total is the code point.)</p>
<pre><code>≧⁺Ｉ⊟ηζ
</code></pre>
<p>Offset the value to map between the encodings. (For CESU to UTF, this means that the value now has the right code point.)</p>
<pre><code>ＦＥ⊟ηＸ²Ｉι«⊞υ⁺⁺¹²⁸Ｉ⊟η﹪ζι≧÷ιζ»
</code></pre>
<p>For each output byte, extract the desired number of bits, and add on the desired offset.</p>
<pre><code>Ｉ⮌υ
</code></pre>
<p>The above loop extracts the bits in reverse order, so correct this for the final output.</p>
<p>I haven't looked at any of the other answers to see what I/O formats they use, so this may not be the best format.</p>
</div>
<div id="pu2" class="pu"><h1>x86-64 machine code, <del>58</del> 54 bytes</h1>
<pre><code>A8 F9 B8 3F 3F 3F 07 48 B9 3F 0F 00 3F BF ED 00 00 BE 80 B0 ED 80 BA 00 00 DF 1F 72 09 48 91 BE 80 80 80 F0 F7 DA C4 E2 C2 F5 F8 01 D7 C4 E2 C3 F5 C1 48 09 F0 C3
</code></pre>
<p><a href="https://tio.run/##fZRvb5swEMZf25/ixlQJ1qRym2pjYanUrOPd3uxVpaWqmO2AJ2IQhoYkylcfO5N/II0pkrnc/Z7jeGzg45jzponMCtwfjku5NJX/WmavVbn0p5Tc/NqUElj96FObsZUWwZIpOSWr7A1kVI8QYZ8mof0dkgVvk9@e5phijJ0L0ihb8BmWmM@OSdHSt@GTZTH5m4OhpOZJDIVtj@168hClfivXMrZyaqYkl3UJhUDgsESoiYTAMv6zDMmFzI8NW8J2zYpjxihKCllSqcWUeo4X0EobFWspIM10fFiULqFnkjsA1cP6npP/079lCqfXwsWYvleap5WQ8MWUQmU3yQO13CpS2vXojpKBRqXEnYqMND9fYAY7693n1ruDjxiH8/AUzy/5SYf5eokfO9r5Jb71O3Gn/10nP@nw9343xgnaGfbB4GPgDm2wusTtcmt8EBbABi@Xp6tfAqivrz1K0IuhLluU9O3foLeD@Brx/m5vWzwvsLp0nas0fYbxA3SvC@3gqCPYjmBt4T2hZ36hF/p7xBOlJfBMyCnYY0Z4pg0ei9MMPIkK@JAzvLn7z5LXm2mELKI5w04ig915OHb3DI6toivBHtaJSiW4Obyb2UNlb3xC3SsF9k03Xjt9DmNsZwF8H6pCo9l03zR/@DKNYtOMVx/vccGPxgzlMv0L" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<p>This uses big-endian integers.</p>
<p>Following the standard calling convention for Unix-like systems (from the System V AMD64 ABI), this takes a 64-bit integer in RDI and returns a 64-bit integer in RAX.</p>
<p>The CESU-8 to UTF-8 function starts at the beginning, and the UTF-8 to CESU-8 function starts after one byte.</p>
<p>In assembly:</p>
<pre><code>cesu8_to_utf8:
    .byte 0xA8  # This combines with the following instruction to form
                # 'test al, 0xF9', which sets CF to 0 among other things.
utf8_to_cesu8:
    stc         # Set CF to 1.
    mov eax, 0x073F3F3F     # Mask of variable bits in UTF-8.
    mov rcx, 0xEDBF3F000F3F # Mask of variable bits in CESU-8, and also
                            #  the first eight 1 bits and one 0 bit.
    mov esi, 0x80EDB080     # Fixed 1 bits in CESU-8 except the first eight.
                            # (With those removed, this fits in 32 bits.)
    mov edx, 0x1FDF0000     # Adjustment value to add to the codepoint
                            #  to add eight 1 bits and subtract 2¹⁶.
    jc s                    # Jump if CF=1 to skip some code.
    xchg rax, rcx       # Swap the masks.
    mov esi, 0xF0808080 # Fixed 1 bits in UTF-8.
    neg edx             # Negate the adjustment value in EDX.
s:  pext rdi, rdi, rax      # Extract the variable bits (maybe extra) from RDI.
    add edi, edx            # Add the adjustment value to the variable bits.
    pdep rax, rdi, rcx      # Distribute the bits using the other mask (into RAX).
    or rax, rsi             # Combine the result with the fixed 1 bits.
    ret                     # Return.
</code></pre>
</div>
<div id="pu3" class="pu"><h1>Python 3.8, <s>155</s> 139 bytes</h1>
<p><sup>-16 bytes thanks to <a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8/279265?noredirect=1#comment596738_279265">@ceilingcat</a></sup></p>
<p>Big endian input. Used with hexadecimal input/output.</p>
<p>The code for both big endian and little endian conversion are both golfed versions of the OP's code</p>
<pre class="lang-python prettyprint-override"><code>c=lambda s:hex((t:=(s&gt;&gt;12)-0xED9F80EDB)+(t&amp;29605888)*3|s&amp;3903|0xF0808080)
u=lambda s:hex(0xE9DD7EEDB080+(s&amp;3903)+(s+(s&amp;3158016)*3&gt;&gt;12&lt;&lt;22))
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m72soLIkIz9vwYKlpSVpuhY3u5NtcxJzk1ISFYqtMlIrNDRKrGw1iu3sDI00dQ0qXF0s3SwMXF2cNLU1StSMLM0MTC0sLDS1jGuK1YwtDYxrDCrcDCzAUJOrFNUkoG5LFxdzV6BuoLS2BkQH0KBiMNvQ1MLA0AxoFMguGxsjI01NqJPcCooy80o01A0qUlMSgVpTU5KApIK6dnFJkUayBqqwpqa2OlSqFCiVZmAJcQ3MNJhHAQ" rel="nofollow noreferrer">Attempt This Online!</a></p>
<hr />
<h3>Python 3.8, <s>168</s> 146 bytes (little endian input)</h3>
<p><sup>-22 bytes thanks to <a href="https://codegolf.stackexchange.com/questions/279240/conversion-between-cesu-8-and-utf-8/279265?noredirect=1#comment596739_279265">@ceilingcat</a></sup></p>
<pre class="lang-python prettyprint-override"><code>a,b=0x80B0ED809FED,16143&lt;&lt;16
c=lambda s:hex(((s:=s-a)&lt;&lt;4|s&gt;&gt;10&amp;3161863)|s&gt;&gt;16&amp;b|0x808080F0)
u=lambda s:hex(((s&amp;b)&lt;&lt;16|(s&amp;3847)&lt;&lt;10|s&gt;&gt;4&amp;197376)+a)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZY_BCoJAEIbvPkUn3UGDWVbWNdRDqO-xm4ZBmbgKBj5F1y5e6p16m9yyQ8TAMP_M_B8zt0dz6apzPU33vtuvxfMqPRXjIHCLWSowzLPUo5z6LIoot3bxUZ5UIVd6U5UDIURvYr2WEEX-qJOEos3mZcEZvCW31WhYJnIEq_-z2woMeJwrJvzACDRW36ZhwAIOroTlsrxpD3VHHANUWBYC5ZxXjqu7luzIbxvAdZZRTz4nhLhHgIX2_fcF" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, 123 bytes</h1>

<pre class="lang-c prettyprint-override"><code>long f(long n){long i=1&lt;&lt;20,j=0,p,q;for(;i|='x```'*2u,p=i++^'@@@'^n,j|='@UP@'*3u,q=j++^0xeda040124040,p&amp;&amp;q-n;);return p^q;}
</code></pre>
<p><a href="https://tio.run/##pdRBa4MwFADge39F6FjVNoVoBAup4LTm1MMugx2GWKwWxaUqFYSuv92ldoUyk0uDkLy8B/l4vGCyPCRJ35dHdgCZPmzMOA977prrtYVg4SJYwZpkx0Yn@Y@rdXEca3OrhZWbLxaR5nmeFjFY8JL38e5pc9zC2i14CXXpfodsZFo2X2E1m9VLRgzSpKe2YaCKanLpX/ZplrMUtCCb3OOExzk7ge9dznTjPKkafsp0MEXdK7@tLD/BNVrdgyH1xaaQn8LNG1qhcOPzdbuFoNVHSWBAkOjiyvUjz4HUp2NwSArBv8qTIBZ1iKUdYuUOAxEYSMFAFfRFM/SlM/RVZ2iKHo0pfTSm8qOxRKAlBS1lEItALAWxMmiLQFsK2sqgIwIdKegog6EIDKVgqAxSEUilIFUHfTr@tT0k/4OPlRt46X8B" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<p>-5 bytes ceilingcat</p>
<p>-1 byte Explorer09</p>
<p>big endian input. A brute force example</p>
<h1>x86asm, 55 bytes</h1>
<pre class="lang-c prettyprint-override"><code>00000000: b900 0010 0031 f681 c9c0 c0c0 f08d 91c0  .....1..........
00000010: bfbf ffff c148 b8c0 f0ff c0a0 ed00 0048  .....H.........H
00000020: 09c6 488d 86c0 bfed bf48 ffc6 39fa 7406  ..H......H..9.t.
00000030: 4839 f875 d292 c3                        H9.u...
</code></pre>
<p><a href="https://tio.run/##pZTPaoQwEMbv@xSDpaBgS/6psZ6qq6d9gB562VpdBNeWdhe2lD67zWTdIjW5bFAmX@ab@MuQYH23q@tx7N@GHbQ@DkEG28@977UPcP/ydWiAyigEol8a60GkITChNGWoCFUqZfPABFYLNET0Z9ApsCiaAk15CAmaUsyXTiYaMU55ctkCFqfoyWmhhnAxh@hyrbBi@paqjxKc4c6wkfhs66SQmERF9caxtzTygmy8eW3abmjgCO3qomulu@EA@203@MH36v1DzVofPHK6JZT1/ROgkhehU8@Dpxo4letHIkm5zlXcbEI4@oskBCHUvtnBJ7sOWOXVEqiTRuDkXAnkpg65tUPu3GFhAhZWYOEKzE1nmFvPMHc9Q2q6NNR6aajzpWEmILMCmTOQm4DcCuTOQGECCitQOAMTEzCxAhNnYGkCllZg6QysTMDKCqzcgXm1/LXNkv@Bc@cM/Bl/AQ" rel="nofollow noreferrer">Try it online!</a></p>
<pre class="lang-c prettyprint-override"><code>    use64
f:  
    mov ecx, 0x100000
    xor esi, esi
.a: or  ecx, 0xF0C0C0C0
    lea edx, [rcx-0x404040]
    inc ecx
    mov rax, 0xEDA0C0FFF0C0
    or  rsi, rax
    lea rax, [rsi-0x40124040]
    inc rsi
    cmp edx, edi
    jz .b
    cmp rax, rdi
    jnz .a
    xchg eax, edx
.b: ret
</code></pre>
<p>Same logic. Didn't expect asm still shorter when <code>pext</code> and <code>pdep</code> exist</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 74 (39+35) <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<p><em>UTF-8 to CESU-8 (39 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a>):</em></p>
<pre><code>bć¦¦¦šε¦¦}JŽMaS£ćC&lt;bš2ô€0˜•î¡€î±€•₅вb+C
</code></pre>
<p>I/O as a list of integers. (Could be -2 bytes if I/O as a list of binary-strings is allowed.)</p>
<p><a href="https://tio.run/##yy9OTMpM/e/xP@lI@6FlIHh04bmtILrW6@he38TgQ4uPtDvbJB1daHR4y6OmNQan5zxqWHR43aGFQA6Q2gikgAKPmlovbErSdv6f8T9ayc1ESUfJwhFIOBmDWOZKsQA" rel="nofollow noreferrer">Try it online</a> (with header/footer to convert from/to hexadecimal).</p>
<p><em>CESU-8 to UTF-8 (35 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a>):</em></p>
<pre><code>bεŽ3
Nè.$}JŽIuS£ćC&gt;bšJŽE&quot;S£Tìć7bìšC
</code></pre>
<p>I/O as a list of integers. (Could be -2 bytes if I/O as a list of binary-strings is allowed.)</p>
<p>Try it online (with header/footer to convert from/to hexadecimal).</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>b              # Convert the (implicit) list of integers to a list of binary-strings
 ć             # Extract the head
  ¦¦¦          # Remove the first three 1s of this binary-string
     š         # Prepend it back to the head
 ε             # Map over each binary-string:
  ¦¦           #  Remove the first &quot;10&quot; of the binary-string
 }J            # After the map: join everything together
   ŽMa         # Push compressed integer 5646
      S        # Convert it to a list of digits: [5,6,4,6]
       £       # Split the string into parts of those sizes
        ć      # Extract the head
         C     # Convert from a binary-string to an integer
          &lt;    # Decrease it by 1
           b   # Convert it from an integer back to a binary-string
            š  # Prepend it back to the list
2ô             # Split the list of four into two pairs
  €0           # Place a 0 before each pair in the list:
               #  [0,[wwww,uuuuzz],0,[yyyy,xxxxxx]]
    ˜          # Flatten it
     •î¡€î±€•  # Push compressed integer 256212984493808
      ₅в       # Convert it to base-255 as list: [237,160,128,237,176,128]
        b      # Convert each to binary:
               #  [11101101,10100000,10000000,11101101,10110000,10000000]
         +     # Add the values in the two lists together
C              # Convert all values from binary-strings to integers
               # (after which the result is output implicitly)
</code></pre>
<hr />
<pre class="lang-python prettyprint-override"><code>b              # Convert the (implicit) list of integers to a list of binary-strings
 ε             # Map over each binary-string:
  Ž3\n         #  Push compressed integer 842
      Nè       #  Get the digit at the modular map-index
        .$     #  Remove that many leading bits from the binary-string
 }J            # After the map: join everything together
   ŽIu         # Push compressed integer 4646
      S        # Convert it to a list of digits: [4,6,4,6]
       £       # Split the string into parts of those sizes
        ćC&gt;bš  # Similar as before, but increase by 1 instead
JŽE&quot;S£        &quot;# Join and split it into parts of sizes [3,6,6,6]
      Tì       # Prepend &quot;10&quot; before each
        ć      # Extract head
         7bì   # Prepend &quot;111&quot; (binary of 7)
            š  # Prepend it back to the list
C              # Convert all values from binary-strings to integers
               # (after which the result is output implicitly)
</code></pre>
<p><a href="https://codegolf.stackexchange.com/a/166851/52210">See this 05AB1E tip of mine (sections <em>How to compress large integers?</em> and <em>How to compress integer lists?</em>)</a> to understand why <code>ŽMa</code> is <code>5646</code>; <code>•î¡€î±€•</code> is <code>256212984493808</code>; <code>•î¡€î±€•₅в</code> is <code>[237,160,128,237,176,128]</code>; <code>Ž3\n</code> is <code>842</code>; <code>ŽIu</code> is <code>4646</code>; and <code>ŽE&quot;</code> is <code>3666</code>.</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, big endian input, 143 bytes</h1>

<pre class="lang-c prettyprint-override"><code>#define x 4096-0xED9F80EDB
#define c(s)(((s+(s&amp;'00\0')*3&gt;&gt;12)&lt;&lt;22)+0xE9DD7EEDB080+(s&amp;3903))
#define u(s)(s/x+(s/x&amp;29605888)*3|s&amp;3903|'x@@@'*2L)
</code></pre>
<p><a href="https://tio.run/##pdRBa4MwFADge39F6FhNqmXPxNXISnFqcvIH7NDLcO0QOhlzA2Hdb3eJbqPM5NIgRH0vyZdHQqrVc1X1/dXT/lA3e9ShCJL1CjpRJJKDKLLZb6rCLcEYtz5uFx7ADjyyZNttSMlmQynx1ZikKGKhxgAH3YslwAj5m@BDT9DedL5uFjRZwy3nXE1yGruevC5NU29JS9LXzTt6eawbTD5nr2/q74DRHLprCOnx@ID0Fx9fQ2DXzAOkF30Pw6JVW5aBEidBRAJViTmjn7tLOJnJKTcEjdxP5iKOmapj1uqYY3W5icutXO7GZaa9y6x7l7ntXWg6KqH1qISOR4WaOGrlqCPHTByzcsyRi0xcZOUiRy42cbGVix05YeKElROOnDRx0spJVy6T00vsLPifO8@M3Ff/DQ" rel="nofollow noreferrer">Try it online!</a></p>
<h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, little endian input, <s>148</s> 147 bytes</h1>

<pre class="lang-c prettyprint-override"><code>long x=0x80B0ED809FED;
#define u(s)((s-x&lt;&lt;4|s-x&gt;&gt;10)&amp;'0?\7'|s-x&gt;&gt;16&amp;16143&lt;&lt;16|'@@@x'*2)
#define c(s)((s&lt;&lt;6&amp;16143L&lt;&lt;22|s&amp;3847)*1024+(s&gt;&gt;4&amp;197376)+x)
</code></pre>
<p><a href="https://tio.run/##pdTdaoMwFADg@z5F6Jia1kL@MJZmzqY1Vz7ALnozXFsE58bcQJh7dmdXWedMLkoQjDkn5DsxIdnimGVtW7yUR1DfoTpEEiXbEC1Vsl1Nbp72h7zcgw@vgp5XLWohWNM1UYQRdFx0v@Nu3w8cHGBGhcBB48ZxXLszAn8nyM4TCNEPS4UgpKkcGjIOZxgRNveqKGIOXnLKAzivYZuX7@D5MS89@Dl5fet6Bw9MUX2LMCmKB3D6Cs/NT2BXTn1wWcC6e6ep35U@CgLodwXpM6dndQUnlVQjbhj8y/3PXMv15VLd6qhxddSS2@i4jZHb2HFSt3fSuHfS9meiNdYdFWw8KtiSIzqOGDliyVEdR40cteSYjmNGjllyXMdxI8ctuUTHJUYuseSUjlNGTtlcYlINuGFwfIldMmfuq/0G" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<p>Both are golfed versions of the reference implementation.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/279240/">279240</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




