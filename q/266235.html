<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::266235</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>063</td><td>Jelly</td><td>231027T182810Z</td><td><a href="https://codegolf.stackexchange.com/questions/266235/hermite-interpolation/266271#266271">Nick Ken</a></td></tr>
<tr d-ix="1"><td>149</td><td>R</td><td>231028T193459Z</td><td><a href="https://codegolf.stackexchange.com/questions/266235/hermite-interpolation/266289#266289">Nick Ken</a></td></tr>
<tr d-ix="2"><td>052</td><td>PARI/GP</td><td>231028T075924Z</td><td><a href="https://codegolf.stackexchange.com/questions/266235/hermite-interpolation/266280#266280">alephalp</a></td></tr>
<tr d-ix="3"><td>094</td><td>Charcoal</td><td>231027T115004Z</td><td><a href="https://codegolf.stackexchange.com/questions/266235/hermite-interpolation/266252#266252">Neil</a></td></tr>
<tr d-ix="4"><td>604</td><td>Python3</td><td>231027T035407Z</td><td><a href="https://codegolf.stackexchange.com/questions/266235/hermite-interpolation/266250#266250">Ajax1234</a></td></tr>
<tr d-ix="5"><td>076</td><td>Mathematica</td><td>231026T152603Z</td><td><a href="https://codegolf.stackexchange.com/questions/266235/hermite-interpolation/266242#266242">138 Aspe</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>71</s> 63 bytes</h1>
<pre><code>IÃ·á¸¢á¹›á¹ªá¸¢?@&quot;Z}
FJá¸¶á¹š1á»‹+&quot;,Æ²:L_/Å¼á¹ªÂ©á»‹&quot;Â¥É—Ã·&quot;Jâ€™!ÆŠ$Å»Ã§\á¸¢â‚¬á¸ŠÃ—&quot;Â®á¸¢1;$Å»_Ã—É—\á¹–Â¤Fâ‚¬S
</code></pre>
<p><a href="https://tio.run/##VVFLS8NAEL73V9TQm7NkZ3fzsqCeCoo3QbAPevIi/QMehOKlUG8ejPVxEUUU8VDEJlQ8JLTQn7H5I3HSpk1L2JnZ@R47Q87POp2LND2IRzp41uGDDj@o2Ns36pel2qEOfnR4j3p8vW3AdLhz1DYnv0SJ3qllRK8zPx4Zh0l3sDXtVybj@K1J4uTqUwf92DeiL7phlYB27M/8pg5vo5cawcepDv@qSfexzHbLSfepGvcmNzq8q5R0OMB63Cvp8bcOhiQ/mfZJEPconKapYRiNBgIH3oI8tzKPBrZKGSCoXTQVMAcErGESVI4JYGKJkYKKDEUEKZeWgCYR5jHz3DCBhgV2TpTAUIFASnztOZDEUlDwmCQnjw5zKGSXFRlt4grugaUyb1SOBCHEalgFng0O0e1iYj7fFfNcbM0QHBrFBcGBucCL4RcaAS5Y8/csB5CTt7RctVqab3y4ruQbOV8@20dwx6TRHJRZYijkvEDuLhqeZ6rcjv7gPw" rel="nofollow noreferrer" title="Jelly â€“ Try It Online">Try it online!</a></p>
<p>A pair of monadic links that takes a list of lists and returns a list of polynomial coefficients.</p>
<p>The argument holding the input is transposed and then rotated both vertically by 1 such that the 0th column appears at the end. This is done to best fit with Jellyâ€™s 1-indexing and the fact that zero refers to the last column. The output starts with the zeroth coefficient and works upwards.</p>
<p>Updated to a more efficient algorithm, but still based on the one on the Wikipedia page.</p>
<h2>Explanation</h2>
<pre><code>IÃ·á¸¢á¹›á¹ªá¸¢?@&quot;Z}                                          # â€â¡Helper link: takes the current list of values for the divided difference algorithm on the left, and a list of the x differences and potential relevant derivatives on the right and returns the next column for the divided difference algorithm
I                                                    # â€â¢Increments
 Ã·                                                   # â€â£Divided by the right argument
  á¸¢                                                  # â€â¤Head (effectively gives the differences divided by the x differences)
       @&quot;Z}                                          # â€â¢â¡Take each pair of x differences and possible relevant derivatives as the left argument and the relevant divided difference as the right and do the following for each:
     á¸¢?                                              # â€â¢â¢- If the x-difference was non-zero:
   á¹›                                                 # â€â¢â£- Then the divided difference
    á¹ª                                                # â€â¢â¤- Else the relevant derivative
    

FJá¸¶á¹š1á»‹+&quot;,Æ²:L_/Å¼á¹ªÂ©á»‹&quot;Â¥É—Ã·&quot;Jâ€™!ÆŠ$Å»Ã§\á¸¢â‚¬á¸ŠÃ—&quot;Â®á¸¢1;$Å»_Ã—É—\á¹–Â¤Fâ‚¬S  # â€â£â¡Main link: takes a matrix as described above and returns a list of coefficients
F                                                    # â€â£â¢Flatten
 J                                                   # â€â£â£Sequence along flattened matrix from 1 to length
  á¸¶                                                  # â€â£â¤For each of these, sequence from 0 to value minus 1
   á¹š                                                 # â€â¤â¡Reverse
         Æ²                                           # â€â¤â¢Following as a monad (argument z):
    1á»‹                                               # â€â¤â£- First list within z
      +&quot;                                             # â€â¤â¤- Add zipped to z (so each member of first list in z increases by zero, each member of second list of z increases by 1, etc.)
        ,                                            # â€â¢â¡â¡- Pair with z
          :L                                         # â€â¢â¡â¢Integer divide by length of matrix (m)
                    É—                                # â€â¢â¡â£Following as a dyad (see below for right argument details, referred to as y)
            _/                                       # â€â¢â¡â¤- Reduce by subtraction (gives x differences)
              Å¼                                      # â€â¢â¢â¡- Zip with
                   Â¥                                 # â€â¢â¢â¢- Following as a dyad:
               á¹ªÂ©                                    # â€â¢â¢â£  - Tail (effectively z from above but after the integer divide bit), also copying this for later
                 á»‹&quot;                                  # â€â¢â¢â¤  - Index zipped into right argument
                           $                         # â€â¢â£â¡y, which will be the result of the following applied as a monad to the original argument (the matrix)
                     Ã·&quot;   ÆŠ                          # â€â¢â£â¢- Divide zipped by the result of the following applied as a monad to the original matrix:
                       J                             # â€â¢â£â£  - Sequence along original matrix rows
                        â€™                            # â€â¢â£â¤  - Decrease by 1
                         !                           # â€â¢â¤â¡  - Factorial
                            Å»                        # â€â¢â¤â¢Prepend zero
                             Ã§\                      # â€â¢â¤â£Reduce using the helper link, collecting all intermediate values
                               á¸¢â‚¬                    # â€â¢â¤â¤Head of each
                                 á¸Š                   # â€â£â¡â¡Remove the original zero
                                  Ã—&quot;Â®          Â¤     # â€â£â¡â¢Multiply zipped by the result of applying the following to the register value stored earlier
                                     á¸¢               # â€â£â¡â£- Head
                                      1;$            # â€â£â¡â¤- Prepend 1 ($ used to prevent the Â¤ only tracking back to the 1)
                                            É—\       # â€â£â¢â¡- Reduce using the following, collecting up intermediate values
                                         Å»           # â€â£â¢â¢  - Prepend zero
                                          _Ã—         # â€â£â¢â£  - Subtract the result of multiplying the previous list by the incoming x value
                                              á¹–      # â€â£â¢â¤- Remove the last list member
                                                Fâ‚¬   # â€â£â£â¡Flatten each (deals with the 1 introduced above that is not a list)
                                                  S  # â€â£â£â¢Sum
ğŸ’
</code></pre>
<p>Created with the help of <a href="https://vyxal.github.io/Luminespire" rel="nofollow noreferrer">Luminespire</a>.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>, 149 bytes</h1>
<pre class="lang-r prettyprint-override"><code>\(y,n,m,o=m*n-1,z=y,v={},`^`=c){for(i in 0:o){v=v^0+(z=ifelse(x&lt;-i:o%/%n-(j=0:(o-i)%/%n),diff(z)/x,y[i+1,j+1]/factorial(i)))[1]*T;T=0^T-T^0*i%/%n};v}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZVJdjpswEJb62FMg1JXsZFxsQwJky_YGfcobP9psFiqvCETApvlpjtGnvqSVeogepT1Nx8CGZCtkz3i-H88If_9RnX5mwa_nJmPen28R2UEBKyiD1ahgAvbBDjbB4Qj3yX2wpIesrIgyVGHwWUkPm2CT8DHZBypL8zol2w9Mzcob66Zg5CngM1IyRfWRwqPKMrKn1hZ2oRoLeBqL2MoWy6as1CInilIaing0v50HPJmzecJHSiuPt5tj19zfN7_NMBTAgcfQx9hgdwbq3mpAYnkoOsBckHCB2eD0mAQmXzBUYKJRIcC2XyxBWEhod-15ZQLhBKY90QYmHJACA7-4DmxkOTDwmI1OPi7m4qYPZ7KYIldyHyaO9haOa4OU8tysA_4UXKRPh455O6vo4zA1_jIXW_FAcmAe8KH5TiPBg0l738QFwdHbnnjOeWh-9YlLJb-K_fB6HsldC1tzha0DE9JuE8G9ruD7ltPbmcbXO4NEZEs_188PxDTCJCrikQmGiWtLKaGaUTdVvc5VQ8yoMNtKmndIq63T5tNildZke6HpEG2aRFFI3o9oFMXvtPPyQRWPJIoENV_zuy46_kctaPn_cfPFep3vWkW6wce6XlT42JsACa_xTDdVVOUXzDFZljnRrO4Fn05d_Ac" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>A function taking the matrix, n and m as arguments and returning a vector of coefficients, starting from the zeroth.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://pari.math.u-bordeaux.fr" rel="nofollow noreferrer">PARI/GP</a>, 52 bytes</h1>
<pre><code>f(a,m)=a/matrix(#a,,k,i,derivn(x^k--,i--%m)%(x-i\m))
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=XZBRasMwDIbZW48RUgo2_GaxbDfZQ3cRzy2GrcN0KSakJTtLX_oydqbtNHOapjRDIPRJ_y-ETt_RN2HzHs_nr0O7FdWP3jKPmq_8Y-3bJnRs7oEdAl7fmnDcs269EwJBiEXNF6wT4aXmfPD-Psx8jB-fzGfiOYtN2LepzHvIs7TWSgdvyXGOzForUaS4ZAfl-p4EDUg3VNAjDnIFmZK6tyQNDJb_bENrVMklqHiC0RpSlwpENFl8u2V6T4-ECibZTQlZkIYylZ4q7qIfuOtDxqf-AQ" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Takes input as a flatten list and <span class="math-container">\$m\$</span>. Outputs a list of coefficients in ascending order.</p>
<p>Using the fact that Hermite interpolation is a linear map. We can construct a <span class="math-container">\$mn\times mn\$</span> matrix, whose entries are the <span class="math-container">\$i\$</span>th derivative of <span class="math-container">\$x^k\$</span> evaluated at <span class="math-container">\$x=j\$</span>, where <span class="math-container">\$0\leq i&lt; m\$</span>, <span class="math-container">\$0\leq j&lt; n\$</span>, and <span class="math-container">\$0\leq k&lt; mn\$</span>. Then we can multiply the flattened input by the inverse of this matrix.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, <s>99</s> 94 bytes</h1>
<pre><code>ï¼¦ï¼¬Î¸ï¼¦âŒŠÎ¸âŠÏ…Î¹â‰”ï¼¥Ï…Â¬ÎºÎ·â‰”Ã—â°Î·Î¶ï¼¦ï¼¬Ï…Â«â‰”ï¼¥Ï…â‡â¼ÎºÂ§Ï…âºÎ»Î¹âˆ•Â§Â§Î¸ÎºÎ¹âˆ¨Î â€¦Â·Â¹Î¹Â¹âˆ•â»Â§ÎµâŠ•Î»Â§ÎµÎ»â»Â§Ï…âºÎ»Î¹ÎºÎµï¼µï¼­Î¶âºÎºÃ—Â§Îµâ°Â§Î·Î»ï¼µï¼­Î·âºÂ§Î·âŠ–Î»Ã—Â±Â§Ï…Î¹ÎºÂ»ï¼©Î¶
</code></pre>
<p><a href="https://tio.run/##XZDLbsIwEEXX5Cu8HEuuRPrasELQBVKhUcUuysJKpomVxGn8QG2qfntqByiGjS3fmXvmjvOKq7zjzTh@dIrAK8rSVNBTSqb3VkjR2nYSEqsrsIwIuoiWWotSwpZ/emXXGagpZaS6lPaiRQ1zrzEyOD3kW4f7iWbXlD0qydU3vPSWNxpqRpZmIwv88sWksRoaP9zPWYuDKBDO9fPdM1JT38PIm4JEdYXNDWxk7szigO9clgjxBGEkDkBuTYc/Y5AR51HYojRYQOMbg9r0vnZcB/Qpppjo1p657VZd23JZwHBqc6sdvyegzoMh1TSE3rirkzvoWuNNzCN2hyU3GKb7T7WIfqNECWlgxbWBwSnjmKZpzO4zlj6wR3c@secsy8a7Q/MH" rel="nofollow noreferrer" title="Charcoal â€“ Try It Online">Try it online!</a> Link is to verbose version of code. Outputs the polynomial coefficients in ascending order of degree. Explanation:</p>
<pre><code>ï¼¦ï¼¬Î¸ï¼¦âŒŠÎ¸âŠÏ…Î¹
</code></pre>
<p>Create a list of x-coordinates <code>xáµ¢</code> where each coordinate is repeated by the number of times equal to the number of differentials provided.</p>
<pre><code>â‰”ï¼¥Ï…Â¬ÎºÎ·
</code></pre>
<p>Create a unit polynomial.</p>
<pre><code>â‰”Ã—â°Î·Î¶
</code></pre>
<p>Create a zero polynomial, which will be the running total.</p>
<pre><code>ï¼¦ï¼¬Ï…Â«
</code></pre>
<p>Loop over each row of the divided difference table.</p>
<pre><code>â‰”ï¼¥Ï…â‡â¼ÎºÂ§Ï…âºÎ»Î¹âˆ•Â§Â§Î¸ÎºÎ¹âˆ¨Î â€¦Â·Â¹Î¹Â¹âˆ•â»Â§ÎµâŠ•Î»Â§ÎµÎ»â»Â§Ï…âºÎ»Î¹ÎºÎµ
</code></pre>
<p>Calculate the row. For each cell, if the x-coordinates of the triangle that generates this cell are all equal then divide the appropriate derivative of that coordinate by the factorial of the row number, otherwise divide the difference of the two cells from the previous row by the difference of the x-coordinates. (Some additional bogus entries are also calculated but none of them affect the final result.)</p>
<pre><code>ï¼µï¼­Î¶âºÎºÃ—Â§Îµâ°Â§Î·Î»
</code></pre>
<p>Multiply the (originally unit) polynomial by the first entry in the row and add it to the running total.</p>
<pre><code>ï¼µï¼­Î·âºÂ§Î·âŠ–Î»Ã—Â±Â§Ï…Î¹Îº
</code></pre>
<p>Multiply the (originally unit) polynomial by <code>x-xáµ¢</code>. (This generates a bogus result on the last pass but since it won't be used this is irrelevant.)</p>
<pre><code>Â»ï¼©Î¶
</code></pre>
<p>Output the final total polynomial.</p>
<p>97 bytes for a version that accepts a list of x-coordinates as an additional argument, rather than assuming that they're 0-indexed:</p>
<pre><code>ï¼¦Î·ï¼¦âŒŠÎ¸âŠÏ…Î¹â‰”ï¼¥Ï…Â¬ÎºÎ·â‰”Ã—â°Î·Î¶ï¼¦ï¼¬Ï…Â«â‰”ï¼¥Ï…â‡â¼ÎºÂ§Ï…âºÎ»Î¹âˆ•Â§Â§Î¸Ã·Î»ï¼¬âŒŠÎ¸Î¹âˆ¨Î â€¦Â·Â¹Î¹Â¹âˆ•â»Â§ÎµâŠ•Î»Â§ÎµÎ»â»Â§Ï…âºÎ»Î¹ÎºÎµï¼µï¼­Î¶âºÎºÃ—Â§Îµâ°Â§Î·Î»ï¼µï¼­Î·âºÂ§Î·âŠ–Î»Ã—Â±Â§Ï…Î¹ÎºÂ»ï¼©Î¶
</code></pre>
<p><a href="https://tio.run/##XZDBbsIwDIbP9ClydKQgtUibJnFCsAPSYNXEreIQtV4b0aYjSdHGtGfvnFK2wMnJb/v/bOeVNHkr675/bw2DirMhbpRWTdfAkXOWdraCTjDF59HCWlVq2MgPr2xbBwfOBav@UzvVoIXYa4KdSR/8XlCXjlzI7jua3Lrs0GhpvuD52MnawkGwhVvrAj99Mq07C7WHe85KnVSBcM1f41GwtXZjkopHWrAE9w6CvRpITVt0uYO1zslanfBN6hIhGRCCJQGG@gl@haCH5AYb1A4LqH1hkBv@tx234wtGp/IB6SgT2n3ZNo3UBZzHMlr8crzANQ4g1QDhd93V2B1UrfBuzIvtFkvpMJzub6p59BOlRmkHS2kdnEnp@yzLZmL6JB4e9yJLRCxiijMxCPSaeinZ7/vpqf4F" rel="nofollow noreferrer" title="Charcoal â€“ Try It Online">Try it online!</a> Link is to verbose version of code.</p>
</div>
<div id="pu4" class="pu"><h1>Python3, 604 bytes:</h1>
<pre class="lang-py prettyprint-override"><code>import math
E=enumerate
def M(p,*P):
 for i in P:
  D={}
  for a,b in i.items():
   for A,B in p.items():D[a+A]=D.get(a+A,0)+b*B
  p=D
 return p
def O(p,*P):
 for i in P:
  for j,k in i.items():p[j]=p.get(j,0)+k
 return p
def f(A):
 z,l,d=zip(*[(i,a[0],a[1:])for i,a in E(A)for _ in a])
 L=[[(a,[i])for i,a in E(l)]]
 c=1
 while len(U:=L[-1])&gt;1:L+=[[(d[min(U[i][1])][c-1]/math.factorial(c)if 0==(D:=z[max(U[i+1][1]+U[i][1])]-z[min(U[i+1][1]+U[i][1])])else(U[i+1][0]-U[i][0])/D,U[i][1]+U[i+1][1])for i in range(len(U)-1)]];c+=1
 return O(*[M({0:a[0][0]},*[{1:1,0:-z[j]}for j in range(i)])for i,a in E(L)])
</code></pre>
<p><a href="https://tio.run/##fVFNb@IwEL3nV/hok4HaCWnZrLwSVXqjai97sqzKBaeYJiFKU@0uiN9Oxyll2yysZMX2vI8Zv9R/2uW6iid1s9@7sl43LSlNuwxupK1eS9uY1gYLm5NbWsPgnqUBydcNccRV5B4vJJPbHW6@aODRl93ItbZ8oZ77Dkzh2gP1EciUCadaZqMn21I8Amfh4@Aa@bXMAtLY9rVBftf47kxjf1vB89eOtVppWXe2K2/63DPL6dQ7baCAhdy4mg4UdWAU1/gRqWZdDzDe9Qa5/vrgL0azgMykUtSAcj1ewbQOyFyKgPxausKSwlb0Zypnaig0@yHSWeiVC1U6rKNcYVmrOaIXPuxRbubtunGmoHPmcsKlpFkqN6o0vz0/FF4RHpXDzYdTH2G2eLEfANfDDuCaXWRw4IRHFTvm2ZjqydJuaDYU@Jjv89A/5hDdHaZ0S7c89Tnh2sFAbUUqgKc4yUrvul/x18ixXj4zLOzrxlUtzalSAgjHpYGoCMgESHLZnZMrIIJHYyBxMhlrzVjwWcQBJYe9j0WInKvH0PdCJogOEQLi@KwKVAKX/6IQIzKGU5jAl6iIf4Nk7OVifBVDFEWnBuDdyOKwnxr@nRPBBJLOFvPp4vlPOvzLjpz9Gw" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu5" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Mathematica</a>, 76 bytes</h1>
<p>Mathematica has built-in <a href="https://reference.wolfram.com/language/ref/InterpolatingPolynomial.html" rel="nofollow noreferrer"><code>InterpolatingPolynomial</code></a> to construct an interpolating polynomial that reproduces function values and derivatives.</p>
<p><a href="https://tio.run/##JYxBC8IgGEDv/YrBoNMXTttqFIMuHRYEu4uENFfC/JThwRB/uy26PR6PZ6R/KyO9fsqcp4t5nLoevVqcnVeJr8HOH7RGy5nfpetxVEGN/GY18lgyzqkQO5qgpGILRkAQhFyDkzjmdbroUHRFjBQqqBJEBi00hx80R6AVq2HftHVK583E/7koCBkWjT5/AQ" rel="nofollow noreferrer">Try it online!</a></p>
<pre><code>f@m_:=InterpolatingPolynomial[MapIndexed[Join[{#2[[1]]-1},#1]&amp;,m],x]//Expand
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/266235/">266235</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




