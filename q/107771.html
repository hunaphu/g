<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::107771</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>559</td><td>Python3</td><td>250908T192328Z</td><td><a href="https://codegolf.stackexchange.com/questions/107771/split-a-grid-into-a-grid/283588#283588">Ajax1234</a></td></tr>
<tr d-ix="1"><td>020</td><td>Jelly</td><td>170125T053641Z</td><td><a href="https://codegolf.stackexchange.com/questions/107771/split-a-grid-into-a-grid/108025#108025">Dennis</a></td></tr>
<tr d-ix="2"><td>116</td><td>Haskell</td><td>170123T190643Z</td><td><a href="https://codegolf.stackexchange.com/questions/107771/split-a-grid-into-a-grid/107816#107816">Roman Cz</a></td></tr>
<tr d-ix="3"><td>022</td><td>Jelly</td><td>170124T001753Z</td><td><a href="https://codegolf.stackexchange.com/questions/107771/split-a-grid-into-a-grid/107830#107830">Dennis</a></td></tr>
<tr d-ix="4"><td>023</td><td>Pyth</td><td>170123T121954Z</td><td><a href="https://codegolf.stackexchange.com/questions/107771/split-a-grid-into-a-grid/107786#107786">PurkkaKo</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 559 bytes</h1>
<pre class="lang-py prettyprint-override"><code>P=lambda a,V,l:[[[i.pop(0)for _ in range(t)]for t in a]for i in V[:l]]
W=lambda a,B,l,F=0:all(sum(map(sum,j))==1 if F else sum(map(sum,j))&lt;=1 for j in zip(*P(a,[[*i]for i in B],l)))
def f(b):
 q,s=[[1]],[]
 for a in q:
  if sum(a)==len(b[0]):
   Q=[[1]]
   for A in Q:
    X=[*b];C=[[X.pop(0)for _ in range(y)]for y in A]
    if sum(A)==len(b):
     if all(W(a,B,len(B),1)for B in C):return 1
     continue
    if all(W(a,B,len(B))for B in C):Q+=[A[:-1]+[A[-1]+1],A+[1]]
   continue
  if W(a,b,1):q+=(o:=[p for p in[a[:-1]+[a[-1]+1],a+[1]]if p not in s]);s+=o
</code></pre>
<p><a href="https://tio.run/##fVVda9swFH2ef4Xoi6VGLRJ7Ge48SAp9HC2UrqCJIjfK5qLaruUOOvLfsyv5S7aTPUSW78c59x5dK9VH87ssPn@p6sPhNjXqNdsqpOgDNYkQIr@sygozsitr9ITyAtWq@KVxQ6SzNM6i/DZ32weRGCmjHyPMhhp6k7JEGYPt@yt@VZV70hdC0pSjfIdukDZWo5nzKzgd7IuD/ZtX@PwWKyrEeT6ybSQ1hJBoq3dohzOSROiN2lQILiUVMvIAykW@gctxORIFxEYXOBNMuhSE7toUt3UZa5dx5z3oMRXnmby6hojH40p8tEp8OMvaY/RE656oZfF2J8MP7GUBz4ZQ7vE2LvuaJLVu3usC8Tb@uSyavHjX0YnkSerdKhVrkVxwuYKne3BJ16u@sQALkBxKBtzJ2yrFZZKKyndeAZZQHYjqQZQHgawKFaU/cSvJlV2l5cFylKKzs7OIsT1jHBa@5xEsjHnLnrWe9qXztGHMvXDn4c4DIJe1rox61jjexzSOSeQPtimfslLVW2xBxk@dQDAHblbyooFZkcOc7HLT6Bp/LwtNkb20lckbHP8sYkJkFNmuVn/Y6OIbuq9BDyEYhSYFp2xi5VPrjYIh9eY2HNZFAmvt3Trzdd4xex7RE4bPOcbITDvMYywj24DRl@8K6Ivg7W4oLGgpDB955@FLft5Zw4iWiJ@I5mNPQ@fHsAe8sLcuiw0IPQ@dxPfV80nzHePINB4xp8vy@aL5UOYRamyAz8U6pm@fegqaLUphx1Q@2vVsyGl4mjxgCvVZ@qcDwo/ofZppKdkoI5/EBd9H8DttC@sPvouJfssPNyxiGKKpbQaylHlW1tBYgDcXcsoxiuVuo@Hf7D@XF1x8iqIM7i936@k/ylCU9xEODWIgxFpdNygrS4N38DdHUJq2bxncpVUNtyWO77VtLKpc7DYmh38" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 20 bytes</h1>

<pre><code>ŒṖS€€ỊȦ$ÐfZ€µ⁺€Ȧ€€FS
</code></pre>

<p>This is still a brute-force solution, but it's quite a bit faster than my other answer – which cannot cope with the last two test cases on TIO – and handles all test cases in ~4 seconds.</p>

<p><a href="https://tio.run/nexus/jelly#dVO7DcIwEK3JHJQufEvAAOmI3LIHNEhUiIIRUtFSAB0RUtYgixhH/tw725GSOPd79@7Ztt/r73lrp@PdPb/3eezXw2W/c8bnMR1ebh17H9y0dji5dWtt16y6joxR86oVGdWR0sGmwvYZ7os@7wlfzvR@ruBYxMVV1nE9x2asiEf@L/VARsEKffM8jdMFG2Mem4o84skTb4mXMJB7yNepNmIrkR@5kpgx9KpxFlypmBH1YwzmTLkmQr9Ys4SpCw66pmV1TuzB@0TQA7Uo43LPqaJtrUepD2tGIg/OLbzLPmQOt0NoBrcHu6czIn1ZdalpxidNBHi5drKHacwf" rel="nofollow noreferrer" title="Jelly – TIO Nexus">Try it online!</a></p>

<h3>How it works</h3>

<pre><code>ŒṖS€€ỊȦ$ÐfZ€µ⁺€Ȧ€€FS  Main link. Argument: M (matrix, array of rows)

ŒṖ                    Compute all partitions, i.e., all groupings of M's rows.
  S€€                 Map sum over all individual groupings, collapsing the grouped
                      rows into a single row.
        Ðf            Filter; keep only those partially collapsed matrices for
                      which the link to the left returns a truthy value.
       $                Group the two links to the left into a monadic chain.
     Ị                    Insignificant; map 0 and 1 to 1, greater integers to 0.
      Ȧ                   All; return 1 iff the matrix contains no zeroes.
          Z€          Zip/transpose all kept matrices,
            µ         Combine all links to the left into a monadic chain.
             ⁺€       Duplicate the chain and map it over the individual results
                      from the first call. We now have all possible combinations
                      of row and column groupings (represented by the corresponding
                      matrices of collapsed rows and columns) that do not have a
                      2 anywhere. However, they still may contain zeroes.
               Ȧ€€    Map the all atom over the matrices, returning 1 only for
                      matrices that consist entirely of ones.
                  FS  Flatten and sum, counting the number of valid divisions.
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, 116 bytes</h1>



<pre class="lang-hs prettyprint-override"><code>import Data.List
m(a:b)=[a:e|e&lt;-m b]++[zipWith(+)a d:e|d:e&lt;-m b];m e=[e]
d=(any$any$all$all(==1)).map(m.transpose).m
</code></pre>

<p><a href="https://tio.run/nexus/haskell#dVM9b8QgDN3zKxg6JDoa4fVaOnXs3gExcEqkIh25KGFp1f@eki@wSToQwDbv@dnOZF3/GDx7N97UH3b0hSvN9VZJZa7tb/v67NhNXy7qx/af1n@Vl8qwJnjCWn0vjrVStbpoZGm676dl3e/zKqWEqqqd6UtX@8F0Y/8Y22CYnLGd7Afb@TmONUop0JorJTiEDbhYbmEPJx6sqz18OWwe2CLxviLMUXv8dotnEZFhu2HPwrx6UBREbhHZMFb0ZEyQ4yMOccZ/cgfEkHQBYth1wqkfZ4QzxHh7pSG9SdXObMCJumP@uGMoFuPlmVIOrdlbwVgYo3UsTgcilRa3XZAkqXRBogR@vyeUFebYCiprH7tYJjpYZKDgMIZYQUL4r3VUAx6gHDUxAYmjbYFM49EGpM1AbPEX0cX0Bw" rel="nofollow noreferrer" title="Haskell – TIO Nexus">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 22 bytes</h1>

<pre><code>ŒṖḅ1S€€=1Ȧ€
SŒṖ⁸ṁþÇ€FS
</code></pre>

<p><a href="https://tio.run/nexus/jelly#dVExDsMgDJybtzBwD@jaPoAR8ZhUqrp36BM69QHJ0iWq1G8kH6EkGGwClRDG9vl8Nv5zn8fHPFxhlssrnCO@z2A6syWWfpjHfnpPtxA7Gb/Zs/e2O1gL59RqtYJTFkqTj8qPiHDLWIzQzcgY5wrOJV5pyzqu59zKlfgQX7mHVEQe9d3jtJyOfJmL3Khw4Mmz7pIvc0jthNe5NnGrAp@0opiRerU0F1pRzSj3xxysGfudFPtLNf84daVBt3bZnFP24H@C6CF3UefLP0djt6FH534" rel="nofollow noreferrer" title="Jelly – TIO Nexus">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1>Pyth, <s>30</s> <s>29</s> <s>26</s> <s>24</s> 23 bytes</h1>
<pre><code>sm.Asmmq1ssbCkds./MC./M
</code></pre>
<p><a href="https://pyth.herokuapp.com/?code=sm.Asmmq1ssCbCkds.%2FMC.%2FM&amp;input=%5B%5B1%2C0%2C0%5D%2C%5B0%2C0%2C1%5D%2C%5B0%2C1%2C1%5D%5D&amp;debug=0" rel="nofollow noreferrer">Try it online.</a></p>
<p>I'm sure this will get shorter. This is <strong>O(2<sup><em>mn</em></sup>)</strong>, where <em>m</em> and <em>n</em> are the width and height of the array, but completes the last two test cases in 45 seconds on my laptop on battery (i5-5200U with limited performance).</p>
<p>Outputs the number of solutions.</p>
<h3>Explanation</h3>
<p>Five-dimensional arrays are really fun to work with.<sub><sup>&lt;/sarcasm&gt;</sup></sub> You are not supposed to understand how this works even with the explanation.</p>
<pre><code>                    ./M    Find all partitions of each row. Now we have a list of rows,
                           each containing the ways to split the row, each containing
                           the parts of the split (3D).
                   C       Transpose. Now we have a list of ways to split the columns,
                           each containing the rows, each containing the parts of the
                           row (3D).
                ./M        Find all partitions of each row list. Now we have a list of
                           ways to split the columns, each containing the ways to split
                           the rows, each containing the bunch of rows, each containing 
                           the rows in the bunch, each containing the parts of the row
                           (6D).
               s           Combine the ways to split rows &amp; columns into one array (5D).
 m            d            Do the following for each way to split rows &amp; columns (4D):
     m       k                 Do the following for each bunch of rows (3D):
            C                      Transpose the array. We now have a list of column
                                   groups, each containing the row parts (3D).
      m    b                       Do the following for each column group (2D):
          s                            Combine the row parts in the column group. We now
                                       have the list of cells in this row/column group
                                       (1D).
         s                             Sum the cells.
       q1                              Check if the sum is one.
                                   We now have the list of booleans that tell if each
                                   row/column group is valid (1D).
                               We now have the 2D list of booleans that tell if each
                               row/column group in each bunch of rows is valid. (2D)
    s                          Combine the 2D list of booleans to 1D.
  .A                           Check if all values are truthy; if the split is valid.
                           We now have the validity of each split.
s                          Sum the list to get the number of valid solutions.
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/107771/">107771</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




