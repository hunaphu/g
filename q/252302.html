<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::252302</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>202</td><td>APLNARS</td><td>250301T001142Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/278438#278438">Rosario</a></td></tr>
<tr d-ix="1"><td>029</td><td>MATLAB</td><td>221004T173949Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252577#252577">John Bof</a></td></tr>
<tr d-ix="2"><td>035</td><td>Wolfram Language Mathematica</td><td>221004T031545Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252545#252545">att</a></td></tr>
<tr d-ix="3"><td>020</td><td>J</td><td>221004T021128Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252544#252544">Bubbler</a></td></tr>
<tr d-ix="4"><td>032</td><td>J</td><td>221004T012107Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252541#252541">south</a></td></tr>
<tr d-ix="5"><td>099</td><td>Python 3</td><td>221001T015835Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252399#252399">DialFros</a></td></tr>
<tr d-ix="6"><td>811</td><td>Jelly</td><td>220928T195827Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252318#252318">Jonathan</a></td></tr>
<tr d-ix="7"><td>004</td><td>Vyxal P</td><td>220929T193656Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252357#252357">pacman25</a></td></tr>
<tr d-ix="8"><td>012</td><td>MATL</td><td>220928T175808Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252311#252311">Luis Men</a></td></tr>
<tr d-ix="9"><td>133</td><td>Python</td><td>220928T202246Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252321#252321">97.100.9</a></td></tr>
<tr d-ix="10"><td>050</td><td>Wolfram Language Mathematica</td><td>220929T165820Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252349#252349">infinite</a></td></tr>
<tr d-ix="11"><td>nan</td><td></td><td>220929T144716Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252339#252339">Parcly T</a></td></tr>
<tr d-ix="12"><td>041</td><td>R</td><td>220928T155244Z</td><td><a href="https://codegolf.stackexchange.com/questions/252302/find-the-real-solutions-of-a-cubic/252305#252305">Dominic </a></td></tr>
</table>
<div id="pu0" class="pu"><h1>APL(NARS), 202 chars</h1>
<pre><code>r←{1e¯8&lt;∣11○⍵:3√⍵⋄⍵≥0:3√⍵⋄-3√-⍵}
f←{(a b c)←1↓⍵÷↑⍵⋄p←¯3÷⍨b-3÷⍨a*2⋄q←¯2÷⍨c+(27÷⍨2×a*3)-a×b÷3⋄(b c)←r¨q(+,-)√(q*2)-p*3⋄(-a÷3)++/¨(⊂b c),{⍵×e×1 e←2÷⍨¯1+0J1×√3}¨(c b)(b c)}
m←{{(∼⍵=∅)/⍵}{1e¯8&gt;∣11○⍵:9○⍵⋄∅}¨f⍵}
</code></pre>
<p>Above function <code>f</code> calculate the one array of 3 roots of the equation of argument <code>A B C D</code> that means</p>
<pre><code>Ax^3+Bx^2+Cx+D=0
</code></pre>
<p><code>m</code> return only the real ones of that array and <code>r</code> make root3 of all Complex numbers in the way
formula in function <code>f</code> works ok. In these functions I consider one number <code>x</code> ugual to 0 if <code>abs(x)&lt;1e¯8</code>.</p>
<p>If we have the equation</p>
<pre><code>Ax^3+Bx^2+Cx+D=0
</code></pre>
<p>Because A!=0 we can divide for A and obtain</p>
<pre><code>x^3+(B/A)x^2+(C/A)x+(D/A)=0
</code></pre>
<p>and so call (a b c) (B/A, C/A, D/A) we can rewrite the equation as</p>
<pre><code>x^3+a x^2+b x+c=0    
</code></pre>
<p>If we have this change of variables x=y-(a/3) we can rewrite above equation as</p>
<pre><code>y^3+y(b-(a^2)/3)+c-(ab)/3+(2/27)a^3=0
</code></pre>
<p>and from this is know a way of calculate solutions using radicals (from wikipedia)
it will find y01 y02 y03 solution of above equation, and using the translation</p>
<pre><code>x0i=y0i-(a/3)
</code></pre>
<p>we can find the roots of the equation x^3+a x^2+b x+c=0.  This is an old and difficult
problem in the history of mathematic connected with the theory of immaginary numbers.</p>
<p>Test:</p>
<pre><code>  f 1 3 0 ¯1
0.5320888862J0 ¯0.6527036447J1.110223025E¯16 ¯2.879385242J¯5.551115123E¯17 
  m 1 3 0 ¯1
0.5320888862 ¯0.6527036447 ¯2.879385242 
  m 1 0 ¯1 ¯1
1.324717957 
  m 1 1 1 1
¯1 
  m 1 0 ¯3 ¯2
2 ¯1 ¯1 
</code></pre>
</div>
<div id="pu1" class="pu"><h1>MATLAB, 29 bytes</h1>
<pre><code>syms a b c d;roots([a b c d])
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 35 bytes</h1>
<pre><code>#^0NSolve[x#+#2&amp;~Fold~!##,x,Reals]&amp;
</code></pre>
<p><a href="https://tio.run/##y00syUjNTSzJTE78n2b7XznOwC84P6csNbpCWVvZSK3OLT8npU5RWVmnQicoNTGnOFbtf2BpZmqJQ0BRZl5JtHKdW1F@rktmemZJcV2Frl2ag4NyrFpdcHJiXl01V7WhjrGOgY6uYa0OV7UBEtsQyAKzuWr/AwA" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
<p>Input <code>[a, b, c, d]</code>. If <span class="math-container">\$a=0\$</span>, returns a list of as many <code>{Indeterminate}</code>s as there would be solutions.</p>
<p>When given non-equation expressions, <code>NSolve</code> <a href="https://mathematica.stackexchange.com/a/163273">finds their roots</a>.</p>
<pre><code>          x#+#2&amp;~Fold~!##           convert to a polynomial in x
   NSolve[               ,x,Reals]  get real solutions
#^0                                 invalidate solutions if a=0
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.jsoftware.com" rel="nofollow noreferrer">J</a>, 20 bytes</h1>
<pre><code>1(#~]=+)@{::[:p.]*{:
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70wa8FOJT31NAVbKwV1BR0FAwUrINbVU3AO8nFbWlqSpmuxxVBDuS7WVlvTodrKKtqqQC9Wq9oKInXTQpMrNTkjXyFNTc9OwUbJUCFWwQQIVRTiDYHGGCsYwhgGMKgDljaE6F-wAEIDAA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Takes <code>d c b a</code>, and returns the array of real roots, or an empty array if <code>a</code> is 0.</p>
<pre class="lang-none prettyprint-override"><code>1(#~]=+)@{::[:p.]*{:
                ]*{:    multiply the entire polynomial with `a`
                        which doesn't change the roots if `a` is nonzero
                        but gives 0 0 0 0 otherwise, which has zero roots according to `p.`
            [:p.    convert to multipler-roots form
1        {::        extract the roots
 (     )@      filter real roots:
  #~]=+        filter the list by &quot;complex conjugate equals self&quot;
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://www.jsoftware.com" rel="nofollow noreferrer">J</a>, 32 bytes</h1>
<pre><code>[:{:^:([:-.*./@(=+)){:@:&gt;@p.^:{:
</code></pre>
<p>I am pretty bad at conditionals in J, but after some finagling, this was the best I could come up with. Expects coefficients as <code>d,c,b,a</code></p>
<p><a href="https://ato.pxeger.com/run?1=m70wa8FOJT31NAVbKwV1BR0FAwUrINbVU3AO8nFbWlqSpmtxUyHaqtoqzkoj2kpXT0tP30HDVltTs9rKwcrOoUAvDigHVWeoyZWanJGvkKamZ6dgo2SoEKtgrGCioKIQbwg001jBEMYwAFoEEjeEaFywAEIDAA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre><code>[:{:^:([:-.*./@(=+)){:@:&gt;@p.^:{:
                    {:@:&gt;@p.^:{:  : u^:v executes u if v is true, else return x
                              {:  : is last item 0?
                    {:@:&gt;@p.      : if non-zero
                          p.      : converts coefficient form to multiplier-roots form
                        &gt;         : unbox the results
                    {:            : take the roots, not the multiplier
  {:^:([:-.*./@(=+))              : The check for only one real
      ([:-.*./@(=+))              : u(v(x)) where u is -. and v is *./@(=+)
               (=+)               : each x equal to its complex conjugate?
           *./                    : AND reduce result
         -.                       : negate result
  {:                              : if roots are not all reals, take the last value

extra:
u@v -&gt; apply u monadically to v(x) for every application of v
u@:v -&gt; apply u to the entire result of v(x)
[:u v -&gt; strictly u(v(x))
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 99 bytes</h1>
<pre><code>import numpy
f=lambda a,b,c,d:[float(i)for i in numpy.roots([a,b,c,d])if round(float(i))!=0if a!=0]
</code></pre>
<p><a href="https://tio.run/##Tcq7CsMwDIXhPU/hbhaoxW22Qp4kZFBqTAWxZVxlyNM77o2WMxz4@fKmd0l9rRyzFDVpjXnrwrBQnD0Zwhlv6K9jWITUMgQphg2nNzwVEX3Y8cMm4GCKrMnbr4fD4FqkdlPNhZPaYM/4GkD3Kz06PP4n18jlieoO" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 8? 11 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>ṛ/ȧÆr,N+AƲƇ
</code></pre>
<p>A monadic Link that accepts a list of the coefficients (<code>[d,c,b,a]</code>) and yields a list of the (one or three) real roots, unless <code>a</code> is zero in which case it yields an empty list.</p>
<p><strong><a href="https://tio.run/##ASYA2f9qZWxsef//4bmbL8inw4ZyLE7Ei0HGssaH////Wy0xLDAsMywxXQ" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> Or see the <a href="https://tio.run/##y0rNyan8///hztn6J5YfbivS8TvS7Xhs07H2/4fbj056uHOGZuT//9HRuoY6BjrGOoaxXDrRhjpgCGJa6JjoGEGYBjogCFcA5ICYYH2GIHYsAA" rel="nofollow noreferrer" title="Jelly – Try It Online">test-suite</a>.</p>
<p>...<span class="math-container">\$8\$</span> bytes if we can handle <code>a</code> being zero (in which case it works for all polynomials):</p>
<pre><code>Ær,NċAƲƇ
</code></pre>
<p><a href="https://tio.run/##y0rNyan8//9wW5GO35Fux2ObjrX///8/WtdQx0DHWMcwFgA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<h3>How?</h3>
<p>The heavy lifting is done by a built-in...</p>
<pre><code>ṛ/ȧÆr,N+AƲƇ - Link: coefficients, P = [d,b,c,a]
 /          - reduce (P) by:
ṛ           -   right
               -&gt; a
   Ær       - polynomial roots (of P)
  ȧ         - logical AND
               -&gt; [d,c,b,a] or 0
          Ƈ - keep those for which (with 0, keep those of range(0)=[]):
         Ʋ  -   last four links as a monad - f(x):
      N     -     negate (x)
     ,      -     (P) paired with (that)
        A   -     absolute value (of x)
       ċ    -     count occurrences (of that in the pair)
                    -&gt; Truthy (1 or 2*) if x is real, falsey (0) if not
                                  * when x=0
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal" rel="nofollow noreferrer">Vyxal</a> <code>P</code>, 4 bytes</h1>
<pre><code>hß∆P
</code></pre>
<p><a href="https://vyxapedia.hyper-neutrino.xyz/tio#WyIiLCJow5/iiIZQIiwiIiwiUCIsIlswLDMsLTMsLTFdIl0=" rel="nofollow noreferrer">Try It Online!</a></p>
<p>Good old built-ins. This may not work on some interpreters until the SymPy ACE vulnerabilities are fixed. Input as a list <code>[a,b,c,d]</code>.</p>
<p>Edit: Changed output to the input if leading coefficient is 0.</p>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, 12 bytes</h1>
<pre><code>1)?G&amp;ZQ&amp;Zj~)
</code></pre>
<p><a href="https://tio.run/##y00syfn/31DT3l0tKlAtKqtO8///aEMFYwUDBV3DWAA" rel="nofollow noreferrer">Try it online!</a></p>
<h3>How it works</h3>
<pre><code>       % Implicit input
1)     % Get the first element
?      % If non-zero
  G    %   Push input again
  &amp;ZQ  %   Implicit input. Roots of polynomial. Gives a numeric vector
  &amp;Zj  %   Push real and imaginary parts
  ~    %   Negate. Gives &quot;true&quot; if imaginary part is zero, or &quot;false&quot; otherwise
  )    %   Keep only real parts corresponding to &quot;true&quot;.
       % Implicit end
       % Implicit display
</code></pre>
</div>
<div id="pu9" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, <s>143</s> <s>134</s> 133 bytes</h1>
<pre class="lang-python prettyprint-override"><code>f=lambda a,b,c,d,R=[-1,1j,1]:[R:=[(z:=R[2])-(((a*z+b)*z+c)*z+d)/(z-R[0])/(z-R[1])]+R for i in&quot; &quot;*99]and[x for x in R[:3]if x.imag==0]
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=bY-xCsIwGIR3nyJ0SuofbezSBvISWUOGtCEasWkpFWp3n8Kli76Tb2OtFRc5OI4PDu5uj-bSHeowjvdz52j2vDpxMlVhDTJQQAkWpFCUATsC01xJLhQeuJBqpwnFGJt4WBdksvJtlmzxQKVK9BKYJnotkatb5JEPEYriPNcmWNXPsJ8gkoqn2jvUb3xl9kIkehmTNa0PHXaYQQoJUEbI6ofoHzaLkE__e-oF" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>This is the first solution that doesn't use a builtin, and it suffers greatly for it. Instead, I'm using the <a href="https://en.wikipedia.org/wiki/Durand%E2%80%93Kerner_method" rel="nofollow noreferrer">Durant-Kerner method</a> to find all approximations, then filtering for whether they're complex.</p>
<hr />
<p>-9 bytes from @Steffan for various small changes.</p>
</div>
<div id="pu10" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 50 bytes</h1>
<p><a href="https://tio.run/##y00syUjNTSzJTE78/z89Ojs@Vt86OzraJDZW0dbAyjY4P6csNboiLigxLz012kBHwThWL9vW1kCnQicoNTGnONb6f0BRZl5JdHp0ta6hjoGOsY5hbay@vl8sF7q4AUT8PwA" rel="nofollow noreferrer">Try it online!</a></p>
<pre><code>g[k_]/;k[[4]]!=0:=Solve[x^Range[0,3].k==0,x,Reals]
</code></pre>
<p>Input is the number of coefficients in reverse order <code>{d, c, b, a}</code>. This defines a function <code>g</code> only if the <code>4th</code> argument is unequal 0. Otherwise this function remains undefined and returns the function call as output. Uses the built-in <code>Solve</code> function over the <code>Reals</code> domain.</p>
</div>
<div id="pu11" class="pu"><p>Both functions below take a polynomial in <code>x</code>.</p>
<h1><a href="https://pari.math.u-bordeaux.fr" rel="nofollow noreferrer">PARI/GP</a>, 27 bytes</h1>
<pre><code>p-&gt;if(#p&gt;3,polrootsreal(p))
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m728ILEoMz69YMGiNNulpSVpuha7C3TtMtM0lAvsjHUK8nOK8vNLiotSE3M0CjQ1ISpu2hYUZeaVaKRpVMQZaxtrVcQZ6RpqanIhiwLFtCu0UUWNdCtA6iCGLFgAoQE" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Returns <code>0</code> for quadratics and below.</p>
<h1><a href="https://pari.math.u-bordeaux.fr" rel="nofollow noreferrer">PARI/GP</a>, 101 bytes</h1>
<pre><code>p-&gt;k=[Pi,I,2];for(q=1,99,k-=[subst(p,x,k[i])/vecprod([k[i]-z|z&lt;-k[^i]])|i&lt;-[1..3]]);[r|r&lt;-k,!imag(r)]
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m728ILEoMz69YMGiNNulpSVpuhY3Uwt07bJtowMydTx1jGKt0_KLNAptDXUsLXWydW2ji0uTiks0CnQqdLKjM2M19ctSkwuK8lM0okFc3aqaKhvd7Oi4zNhYzZpMG91oQz09YyDbOrqopggoo6OYmZuYrlGkGQu1zLagKDOvRCNNoyLOWNtYqyLOSNdQU5MLWRQopl2hjSpqpFsBUgcxZMECCA0A" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Yet another implementation of the Durand–Kerner method.</p>
</div>
<div id="pu12" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, <s>42</s> 41 bytes</h1>

<pre class="lang-r prettyprint-override"><code>function(c,a=polyroot(c))a[!Im(a)]/!!c[4]
</code></pre>
<p><a href="https://tio.run/##PcoxCoAwDADA3V90SyCiRSehD/ANIrRGC4I2UhXq66uT63ExW2WNvwNfqwRIOLlz6boPIcodZkika8TCm/wnJmcO2Z4ocgEjukH1OzgcK6V4aMfsgaHUVFNDGjG/" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<p>Input is vector of <code>d</code>,<code>c</code>,<code>b</code>,<code>a</code>.  Outputs <code>Inf</code> if the cubic coefficient (<code>a</code>) is zero.</p>
<p>Using <code>a[!Im(a)]</code> to select only real solutions is very susceptible to floating-point rounding errors; the TIO header rounds values less than 0.0000000001 to zero to prevent this.  <a href="https://tio.run/##K/qfZvs/rTQvuSQzP08jWSfRtiA/p7IoP79EI1lTMzFa0TNXI1EzztIyVl9RMTnaJPZ/mkayhq6hjoGOsY6hpuZ/AA" rel="nofollow noreferrer">Including rounding in the code</a> costs <s>5</s> 3 more bytes.</p>
<hr />
<h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 111 bytes</h1>

<pre class="lang-r prettyprint-override"><code>function(e,z=1i^(1:3)){for(i in 1:99)z=z-e%*%rbind(z^3,z^2,z,1)/(z-(x=c(z,z))[2:4])/(z-x[3:5]);if(e)z[!Im(z)]}&#9;
</code></pre>
<p><a href="https://tio.run/##HchBCsIwEADAs7@oh8KubNBt9NBIHuAbQnIwNrAHUwgKZcW3R3CO03rxvbxrfslaYSH1LAnYWcRPWRvIIHVgN8@oXs0yHsZ2l/oATZY0TaTEeAQ1sPkMSooYJneO/9uCdZeIVymwoIb97QmK8bvrBTIwWTqRYcT@Aw" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<p>Non-builtin <a href="https://en.wikipedia.org/wiki/Durand%E2%80%93Kerner_method" rel="nofollow noreferrer">Durant-Kerner</a> strategy copied from <a href="https://codegolf.stackexchange.com/a/252321/95126">97.100.97.109's answer</a> (upvote that!).
Using this approach to find all the roots in parallel works very nicely with <a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>'s vectorized operations.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/252302/">252302</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




