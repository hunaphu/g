<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::80586</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>004</td><td>Thunno 2</td><td>230726T110613Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/263352#263352">The Thon</a></td></tr>
<tr d-ix="1"><td>005</td><td>Vyxal r</td><td>210728T032914Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/231915#231915">emanresu</a></td></tr>
<tr d-ix="2"><td>051</td><td>R</td><td>180207T195445Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/155170#155170">rturnbul</a></td></tr>
<tr d-ix="3"><td>nan</td><td>Perl 5</td><td>180123T223427Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/153963#153963">Xcali</a></td></tr>
<tr d-ix="4"><td>008</td><td>Pyt</td><td>180206T184616Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/155017#155017">mudkip20</a></td></tr>
<tr d-ix="5"><td>006</td><td>Japt</td><td>180123T172653Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/153949#153949">Shaggy</a></td></tr>
<tr d-ix="6"><td>016</td><td>K4</td><td>180123T194842Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/153958#153958">mkst</a></td></tr>
<tr d-ix="7"><td>059</td><td>AWK</td><td>180123T161123Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/153943#153943">Robert B</a></td></tr>
<tr d-ix="8"><td>048</td><td>PHP</td><td>170126T182816Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/108282#108282">Titus</a></td></tr>
<tr d-ix="9"><td>050</td><td>Haskell</td><td>160526T011748Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80685#80685">Michael </a></td></tr>
<tr d-ix="10"><td>087</td><td>C#</td><td>160601T180650Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/81088#81088">raive</a></td></tr>
<tr d-ix="11"><td>063</td><td>Clojure</td><td>160526T162832Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80719#80719">mark</a></td></tr>
<tr d-ix="12"><td>015</td><td>J</td><td>160527T091625Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80772#80772">Zgarb</a></td></tr>
<tr d-ix="13"><td>027</td><td>Julia</td><td>160525T041307Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80600#80600">Dennis</a></td></tr>
<tr d-ix="14"><td>014</td><td>Dyalog APL</td><td>160525T232019Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80678#80678">Ad&#225;</a></td></tr>
<tr d-ix="15"><td>072</td><td>Swift</td><td>160526T123741Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80695#80695">John McD</a></td></tr>
<tr d-ix="16"><td>090</td><td>Java</td><td>160525T090241Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80620#80620">Shaun Wi</a></td></tr>
<tr d-ix="17"><td>022</td><td>J</td><td>160526T033840Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80687#80687">ljeabmre</a></td></tr>
<tr d-ix="18"><td>008</td><td>Jelly</td><td>160525T231104Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80677#80677">Ad&#225;</a></td></tr>
<tr d-ix="19"><td>010</td><td>Jolf</td><td>160525T182430Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80668#80668">Conor O&</a></td></tr>
<tr d-ix="20"><td>032</td><td>Perl 6</td><td>160525T163405Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80661#80661">Brad Gil</a></td></tr>
<tr d-ix="21"><td>011</td><td>CJam</td><td>160525T073222Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80612#80612">Luis Men</a></td></tr>
<tr d-ix="22"><td>054</td><td>Perl 5.10</td><td>160525T113509Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80638#80638">Paul Pic</a></td></tr>
<tr d-ix="23"><td>064</td><td>PowerShell v2+</td><td>160525T125804Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80648#80648">AdmBorkB</a></td></tr>
<tr d-ix="24"><td>008</td><td>Pyke</td><td>160525T125322Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80647#80647">Blue</a></td></tr>
<tr d-ix="25"><td>026</td><td>Vitsy</td><td>160525T110301Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80635#80635">Addison </a></td></tr>
<tr d-ix="26"><td>006</td><td>Pyth</td><td>160525T020051Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80587#80587">Maltysen</a></td></tr>
<tr d-ix="27"><td>028</td><td>Mathematica</td><td>160525T103158Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80630#80630">Martin E</a></td></tr>
<tr d-ix="28"><td>010</td><td>Jelly</td><td>160525T093328Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80623#80623">jimmy230</a></td></tr>
<tr d-ix="29"><td>007</td><td>05AB1E</td><td>160525T083726Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80619#80619">Emigna</a></td></tr>
<tr d-ix="30"><td>007</td><td>Actually</td><td>160525T053119Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80605#80605">user4594</a></td></tr>
<tr d-ix="31"><td>015</td><td>J</td><td>160525T035055Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80599#80599">Leaky Nu</a></td></tr>
<tr d-ix="32"><td>032</td><td>JavaScript ES7</td><td>160525T080250Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80617#80617">Neil</a></td></tr>
<tr d-ix="33"><td>071</td><td>Hoon</td><td>160525T050841Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80603#80603">RenderSe</a></td></tr>
<tr d-ix="34"><td>009</td><td>MATL</td><td>160525T045821Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80602#80602">beaker</a></td></tr>
<tr d-ix="35"><td>009</td><td>MATL</td><td>160525T033555Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80597#80597">Suever</a></td></tr>
<tr d-ix="36"><td>006</td><td>Jelly</td><td>160525T032711Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80596#80596">Leaky Nu</a></td></tr>
<tr d-ix="37"><td>034</td><td>Ruby</td><td>160525T024107Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80591#80591">Value In</a></td></tr>
<tr d-ix="38"><td>028</td><td>Julia</td><td>160525T032638Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80595#80595">Sp3000</a></td></tr>
<tr d-ix="39"><td>043</td><td>Python 3</td><td>160525T031509Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80594#80594">Sp3000</a></td></tr>
<tr d-ix="40"><td>055</td><td>JavaScript ES5</td><td>160525T030626Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80593#80593">Downgoat</a></td></tr>
<tr d-ix="41"><td>029</td><td>Octave</td><td>160525T024053Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80590#80590">beaker</a></td></tr>
<tr d-ix="42"><td>046</td><td>Python 3</td><td>160525T022120Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80588#80588">Keatinge</a></td></tr>
<tr d-ix="43"><td>023</td><td>Minkolang 0.15</td><td>160525T025129Z</td><td><a href="https://codegolf.stackexchange.com/questions/80586/mean-bits-an-average-challenge/80592#80592">El&#39;e</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/Thunno/Thunno2" rel="nofollow noreferrer">Thunno 2</a>, 4 <a href="https://github.com/Thunno/Thunno2/blob/main/docs/codepage.md" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>Lḃḷm
</code></pre>
<p><a href="https://Not-Thonnu.github.io/run#aGVhZGVyPSZjb2RlPUwlRTElQjglODMlRTElQjglQjdtJmZvb3Rlcj0maW5wdXQ9NSZmbGFncz0=" rel="nofollow noreferrer">Try it online!</a></p>
<h4>Explanation</h4>
<pre class="lang-python prettyprint-override"><code>Lḃḷm  # Implicit input
L     # Push [0..input)
 ḃ    # Convert each to binary
  ḷ   # And get the length of each one
   m  # Take the average of the result
      # Implicit output
</code></pre>
</div>
<div id="pu1" class="pu"><h1 id="vyxal-r-5-bytes-3v49"><a href="https://github.com/Vyxal/Vyxal" rel="nofollow noreferrer">Vyxal</a> <code>r</code>, 5 bytes</h1>
<pre><code>ʁbfL/
</code></pre>
<p><a href="https://lyxal.pythonanywhere.com?flags=r&amp;code=%CA%81bfL%2F&amp;inputs=6&amp;header=&amp;footer=" rel="nofollow noreferrer">Try it Online!</a></p>
<pre><code>ʁ     # 0...a
 b    # Turn each into base 2
  f   # Flatten
   L  # Get the length
    / # Divide by the input
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 51 bytes</h1>

<p>Takes input from stdin. Uses the OEIS formula and then divides by <code>n</code>.</p>



<pre class="lang-r prettyprint-override"><code>(2+ceiling(log2(n&lt;-scan()))*n-2^ceiling(log2(n)))/n
</code></pre>

<p><a href="https://tio.run/##K/r/X8NIOzk1MyczL10jJz/dSCPPRrc4OTFPQ1NTUytP1ygOVRIoqp/335DLiMuYy4TLlMuMy5zrPwA" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a>, <s>44</s> 43 + 2 (<code>-pa</code>) = 45 bytes</h1>

<p><em>-1 thanks to @DomHastings</em></p>



<pre class="lang-perl prettyprint-override"><code>$\+=(length sprintf'%b',$_)/"@F"while$_--}{
</code></pre>

<p><a href="https://tio.run/##K0gtyjH9/18lRttWIyc1L70kQ6G4oCgzryRNXTVJXUclXlNfycFNqTwjMydVJV5Xt7b6/3/zf/kFJZn5ecX/dQsSAQ" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/mudkip201/pyt" rel="nofollow noreferrer">Pyt</a>, 8 <a href="https://github.com/mudkip201/pyt/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>

<pre><code>⁻řļ⌊⁺Á1µ
</code></pre>

<p>Explanation:</p>

<pre><code>                Implicit input (N)
⁻               Decrement by 1 (N-1)
 ř              Push [1,2,...,N-1]
  ļ             element-wise log base 2 of [1,2,...,N-1]
   ⌊⁺           element-wise floor and increment
     Á          Push contents of array onto stack
      1         Push 1
       µ        Get mean of stack
                Implicit output
</code></pre>

<p><a href="https://tio.run/##ARoA5f9weXT//@KBu8WZxLzijIrigbrDgTHCtf//Nw" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/ETHproductions/japt/" rel="nofollow noreferrer">Japt</a>, 6 bytes</h1>
<pre><code>o¤xÊ/U
</code></pre>
<p><a href="https://ethproductions.github.io/japt/?v=1.4.5&amp;code=b6R4yi9V&amp;input=OA==" rel="nofollow noreferrer">Try it</a></p>
<hr />
<h2>Explanation</h2>
<pre><code>           :Implicit input of integer U
o          :Range [0,U)
 ¤         :Convert each to a base-2 string
   Ê       :Get length of each
  x        :Reduce by addition
    /U     :Divide by U
           :Implicit output of result
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="http://kx.com/download/" rel="nofollow noreferrer">K4</a>, 16 bytes</h1>

<p><strong>Solution:</strong></p>

<pre><code>(1+#,/2\:'!x)%x:
</code></pre>

<p><strong>Example:</strong></p>

<pre><code>(1+#,/2\:'!x)%x:5
1.8
(1+#,/2\:'!x)%x:6
2f
(1+#,/2\:'!x)%x:7
2.142857
</code></pre>

<p><strong>Explanation:</strong></p>

<p>Convert each number to binary, sum up the bits, add <code>1</code> for <code>0</code>, divide by input.</p>

<pre><code>(1+#,/2\:'!x)%x: / the solution
              x: / store input as x
(           )%   / divide left by right
          !x     / range 0..x-1
      2\:'       / convert each (') to bits (2\:)
    ,/           / flatten result
   #             / count length of list
 1+              / add one (as 0 contains 0 bits!)
</code></pre>

<p><strong>Extra:</strong></p>

<p>Precision is determined by the <code>P</code> system setting. Default is <code>7</code>, max is <code>17</code></p>

<pre><code>\P 7
(1+#,/2\:'!x)%x:7
2.142857

\P 12
(1+#,/2\:'!x)%x:7
2.14285714286

\P 17
(1+#,/2\:'!x)%x:7
2.1428571428571428
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://www.gnu.org/software/gawk/manual/gawk.html" rel="nofollow noreferrer">AWK</a>, 59 bytes</h1>

<pre><code>{for(s=1;++n&lt;$0;s+=int(log(n*2)/log(2)));printf"%.8g",s/$0}
</code></pre>

<p>Since <code>AWK</code> only does base-10 logs, I had to convert to base-2 and I chose to multiply the argument by 2 rather than add 1 to the result.  It's the same byte-count, but I like it. :) </p>

<p><a href="https://tio.run/##SyzP/v@/Oi2/SKPY1tBaWzvPRsXAuljbNjOvRCMnP10jT8tIUx/EMNLU1LQuKAKKpymp6lmkK@kU66sY1P7/bw4A" rel="nofollow noreferrer" title="AWK – Try It Online">Try it online!</a></p>
</div>
<div id="pu8" class="pu"><h1>PHP, 48 bytes</h1>
<p>a direct port of <a href="https://codegolf.stackexchange.com/a/80594#80594">Sp3000´s answer</a></p>
<pre class="lang-php prettyprint-override"><code>&lt;?=(2-2**$x=strlen(decbin($n=$argv[1]))-2)/$n+$x
</code></pre>
</div>
<div id="pu9" class="pu"><h1>Haskell, 50 bytes</h1>

<pre><code>r x|x&lt;1=0|1&lt;2=1+r(x/2)
f n=(sum(r&lt;$&gt;[0..n-1])+1)/n
</code></pre>
</div>
<div id="pu10" class="pu"><h1>C#, 87 bytes</h1>

<pre><code>double f(int n){return Enumerable.Range(0,n).Average(i=&gt;Convert.ToString(i,2).Length);}
</code></pre>

<p>I wrote a C# answer because I didn't see one. This is my first post to one of these, so please let me know if I'm doing anything wrong.</p>
</div>
<div id="pu11" class="pu"><h2>Clojure, <s>71</s> <s>64</s> 63 bytes</h2>

<p>It looks like ratios are ok according to <a href="http://meta.codegolf.stackexchange.com/questions/9263/which-number-formats-are-acceptable-in-output">Which number formats are acceptable in output?</a></p>

<p><code>(fn[n](/(inc(apply +(map #(.bitLength(bigint %))(range n))))n))</code></p>

<ul>
<li>n=1 => 1</li>
<li>n=7 => 15/7</li>
</ul>

<p>ungolfed (and slightly rewritten for ease of explanation)</p>

<pre><code>(fn [n]
 (->
  (->>
   (range n)                      ;;Get numbers from 0 to N
   (map #(.bitLength (bigint %))) ;;Cast numbers to BigInt so bitLength can be used
   (apply +)                      ;;Sum the results of the mapping
   (inc))                         ;;Increment by 1 since bitLength of 0 is 0
  (/ n)))                         ;;Divide the sum by N
</code></pre>

<h3>old answer that used (float):</h3>

<p><code>(fn[n](float(/(inc(apply +(map #(..(bigint %)bitLength)(range n))))n)))</code></p>

<p>output is like:</p>

<ul>
<li>n=1 => 1.0</li>
<li>n=7 => 2.142857</li>
</ul>
</div>
<div id="pu12" class="pu"><h2>J, 15 bytes</h2>

<pre><code>%~[:+/#@#:"0@i.
</code></pre>

<p>This is a monadic verb, used as follows:</p>

<pre><code>   f =: %~[:+/#@#:"0@i.
   f 7
2.14286
</code></pre>

<p><a href="http://tryj.tk/" rel="nofollow">Try it here!</a></p>

<h2>Explanation</h2>

<p>I implemented the challenge spec pretty literally.
There are other approaches, but all turned out to be longer.</p>

<pre><code>%~[:+/#@#:"0@i.  Input is y
             i.  Range from 0 to y-1.
          "0@    For each number in this range:
      #@           Compute the length of
        #:         its base-2 representation.
  [:+/           Take the sum of the lengths, and
%~               divide by y.
</code></pre>
</div>
<div id="pu13" class="pu"><h1>Julia, 27 bytes</h1>



<pre class="lang-julia prettyprint-override"><code>n-&gt;endof(prod(bin,0:n-1))/n
</code></pre>

<p><a href="http://julia.tryitonline.net/#code=Zj1uLT5lbmRvZihwcm9kKGJpbiwwOm4tMSkpL24KCmZvciBuIGluIDE6NwogICAgcHJpbnRsbihuLCAiID0-ICIsIGYobikpCmVuZA&amp;input=" rel="nofollow">Try it online!</a></p>

<h3>How it works</h3>

<p>Since <code>*</code> is string concatenation in Julia, <code>prod</code> can be used to concatenate an array of strings. It optionally takes a function as first argument that it maps over the second one before taking the actual "product", so <code>prod(bin,0:n-1)</code> is the string of the binary representation of all integers in the desired range. Taking the length with <code>endof</code> and dividing by <strong>n</strong> yields the mean.</p>
</div>
<div id="pu14" class="pu"><h1><a href="http://goo.gl/9KrKoM" rel="nofollow">Dyalog APL</a>, 14 bytes</h1>

<pre><code>(+/1⌈(⌈2⍟⍳))÷⊢

range ← ⍳
log   ← ⍟
log2  ← 2 log range
ceil  ← ⌈
bits  ← ceil log2
max   ← ⌈
fix0  ← 1 max bits
sum   ← +/
total ← sum fix0
self  ← ⊢
div   ← ÷
mean  ← sum div self
</code></pre>
</div>
<div id="pu15" class="pu"><h1>Swift, 72 bytes</h1>

<pre><code>func f(n:Double)-&gt;Double{return n&lt;1 ?1:f(n-1)+1+floor(log2(n))}
f(N-1)/N
</code></pre>
</div>
<div id="pu16" class="pu"><h1>Java, <s>135</s> <s>95</s> 90 bytes</h1>

<pre><code>float a(int n){int i=0,t=0;for(;i&lt;n;)t+=Integer.toString(i++,2).length();return t/(n+0f);}
</code></pre>
</div>
<div id="pu17" class="pu"><h1>J, 22 bytes</h1>

<p><code>[:(+/%#)[:([:##:)"0 i.</code>
Usage:</p>

<pre><code>    bin =: [:(+/%#)[:([:##:)"0 i.
    bin 7
2.14286
</code></pre>
</div>
<div id="pu18" class="pu"><h1>Jelly, 8 bytes</h1>

<p>Not shorter, but interesting algorithm, and my first Jelly submission:</p>

<pre><code>Rl2Ċ»1S÷

R         1 to n
 l2       log2
   Ċ      ceiling
    »1    max of 1 and...
      S   sum
       ÷  divided by n
</code></pre>
</div>
<div id="pu19" class="pu"><h1>Jolf, 10 bytes</h1>

<pre><code>/uΜr0xdlBH
</code></pre>

<p><a href="http://conorobrien-foxx.github.io/Jolf/#code=L3XOnHIweGRsQkg&amp;input=NQ" rel="nofollow">Try it here!</a></p>

<h2>Explanation</h2>

<pre><code>/uΜr0xdlBH
  Μr0x      map range 0..x
      dlBH  over lengths of binary elements
/u          divide sum of this
            by implicit input (x)
</code></pre>
</div>
<div id="pu20" class="pu"><h1><a href="http://perl6.org" rel="nofollow">Perl 6</a>, <s> 34 </s> 32 bytes</h1>



<p><s></p>

<pre class="lang-perl6 prettyprint-override"><code>{$_ R/[+] map *.base(2).chars,^$_}
</code></pre>

<p></s></p>

<pre class="lang-perl6 prettyprint-override"><code>{$_ R/[+] map {(.msb||0)+1},^$_}
</code></pre>

<h3>Explanation:</h3>

<pre class="lang-perl6 prettyprint-override"><code>{ 
  $_  # the input
  R/  # divides ( ｢$a R/ $b｣ is the same as ｢$b / $a｣ )
  [+] # the sum of:
  map
    {
      (
       .msb # the most significant digit (0 based)
       || 0 # which returns Nil for ｢0.msb｣ so use 0 instead
            # should be ｢(.msb//0)｣ but the highlighting gets it wrong
            # it still works because it has the same end result 
      ) 
      + 1   # make it 1 based
    },
    ^$_ # ｢0 ..^ $_｣ all the numbers up to the input, excluding the input
}
</code></pre>

<h3>Test:</h3>

<pre class="lang-perl6 prettyprint-override"><code>use v6.c;

# give it a name
my &amp;mean-bits = {$_ R/[+] map {(.msb||0)+1},^$_}

for 1..7 {
  say .&amp;mean-bits
}

say '';

say mean-bits(7).perl;
say mean-bits(7).base-repeating(10);
</code></pre>

<pre class="lang-none prettyprint-override"><code>1
1
1.333333
1.5
1.8
2
2.142857

&lt;15/7&gt;
(2. 142857)
</code></pre>
</div>
<div id="pu21" class="pu"><h1>CJam, <s>13</s> <s>12</s> 11 bytes</h1>
<p><em>One byte saved thanks to @Sp3000, and another thanks to @jimmy23013</em></p>
<pre><code>rd_,2fbs,\/
</code></pre>
<p><a href="http://cjam.tryitonline.net/#code=cmRfLDJmYnMsXC8&amp;input=Nw" rel="nofollow noreferrer"><strong>Try it online!</strong></a></p>
<h3>Explanation</h3>
<p>Straightforward. Applies the definition.</p>
<pre><code>rd      e# read input and convert to double 
_       e# duplicate 
,       e# range from 0 to input minus 1
2fb     e# convert each element of the array to binary 
s       e# convert to string. This flattens the array
,       e# length of array 
\       e# swap 
/       e# divide 
</code></pre>
</div>
<div id="pu22" class="pu"><h2>Perl 5.10, 54 bytes</h2>
<pre><code>for(1..&lt;&gt;){$u+=length sprintf&quot;%b&quot;,$_;$n++}$u/=$n;say$u
</code></pre>
<p>Pretty much straightforward. <code>sprintf&quot;%b&quot;</code> is a neat way to output a number in binary in Perl without using additional libraries.</p>
<p><a href="https://ideone.com/P8XRsE" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu23" class="pu"><h2>PowerShell v2+, 64 bytes</h2>

<pre><code>param($n)0..($n-1)|%{$o+=[convert]::ToString($_,2).Length};$o/$n
</code></pre>

<p>Very straightforward implementation of the spec. Loops from <code>0</code> to <code>$n-1</code> with <code>|%{...}</code>. Each iteration, we <code>[convert]</code> our input number <code>$_</code> to a string base<code>2</code> and take its <code>length</code>. We accumulate that in <code>$o</code>. After the loops, we simply divide <code>$o/$n</code>, leaving that on the pipeline, and output is implicit.</p>

<p>As long as this is, it's actually shorter than the formula that Sp &amp; others are using, since <code>[math]::Ceiling()</code> and <code>[math]::Log()</code> are ridiculously wordy. Base conversion in PowerShell is yucky.</p>
</div>
<div id="pu24" class="pu"><h2>Pyke, 8 bytes</h2>
<pre><code>Qmb2slQ/
</code></pre>
<p><a href="http://pyke.catbus.co.uk/?code=Qmb2slQ%2F&amp;input=6" rel="nofollow noreferrer">Try it here!</a></p>
</div>
<div id="pu25" class="pu"><h1>Vitsy, 26 bytes</h1>
<p>This is a first attempt, I'll golf this down more and add an explanation later.</p>
<pre><code>0vVV1HV1-\[2L_1+v+v]v1+V/N</code></pre>
<p><a href="http://vitsy.tryitonline.net/#code=MHZWVjFIVjEtXFsyTF8xK3Yrdl12MStWL04&amp;input=&amp;args=Nw" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu26" class="pu"><h1>Pyth, 6 bytes</h1>
<pre><code>.Oml.B
</code></pre>
<p><a href="http://pyth.herokuapp.com/?code=.Oml.B&amp;test_suite=1&amp;test_suite_input=1%0A2%0A3%0A4%0A5%0A6%0A7&amp;debug=0" rel="noreferrer">Try it online here</a>.</p>
<pre><code>.Oml.BdUQ              Filling in implict vars

.O                     Average of list
 m   UQ                Map over [0..input)
  l                    Length of
   .B                  Binary string representation of int
    d                  Lambda var
</code></pre>
</div>
<div id="pu27" class="pu"><h2>Mathematica, 28 bytes</h2>

<pre><code>(Tr@⌈Log2@Range@#⌉+1)/#&amp;
</code></pre>

<p>or</p>

<pre><code>Tr@⌈Log2@Range@#⌉/#+1/#&amp;
</code></pre>

<p>In either case, it's an unnamed function which takes <code>N</code> as an input and returns an exact (rational) result for the mean.</p>
</div>
<div id="pu28" class="pu"><h1>Jelly, 10 bytes</h1>
<pre><code>BL©2*2_÷+®
</code></pre>
<p>From Sp3000's suggestion.</p>
<p><a href="http://jelly.tryitonline.net/#code=QkzCqTIqMl_DtyvCrg&amp;input=&amp;args=Nw" rel="nofollow noreferrer">Try it here.</a></p>
<h1>Jelly, 11 bytes</h1>
<pre><code>æḟ2’Ḥ÷_BL$N
</code></pre>
<p>Not very short but I need some tips.</p>
<p><a href="http://jelly.tryitonline.net/#code=w6bhuJ8y4oCZ4bikw7dfQkwkTg&amp;input=&amp;args=Nw" rel="nofollow noreferrer">Try it here.</a></p>
<p>Using the same formula as in <a href="https://codegolf.stackexchange.com/a/80594/25180">Sp3000's answer</a>. (It's not very hard to get it yourself, by differentiating geometric progression.)</p>
</div>
<div id="pu29" class="pu"><h2>05AB1E, <s>9</s> 7 bytes</h2>
<p><strong>Code:</strong></p>
<pre><code>L&lt;bJg¹/
</code></pre>
<p><strong>Explanation:</strong></p>
<pre><code>L&lt;         # range from 0..input-1
  b        # convert numbers to binary
   J       # join list of binary numbers into a string
    g      # get length of string (number of bits)
     ¹/    # divide by input
</code></pre>
<p><a href="http://05ab1e.tryitonline.net/#code=TDxiSmfCuS8&amp;input=Nw" rel="nofollow noreferrer">Try it online</a></p>
<p>Edit: saved 2 bytes thanks to @Adnan</p>
</div>
<div id="pu30" class="pu"><h2>Actually, 7 bytes:</h2>
<pre><code>;r♂├Σl/
</code></pre>
<p><a href="http://actually.tryitonline.net/#code=O3LimYLilJzOo2wv&amp;input=NQ" rel="nofollow noreferrer">Try it online!</a></p>
<p>Explanation:</p>
<pre><code>;r♂├Σl/
;        duplicate input
 r       push range(0, n) ([0, n-1])
  ♂├     map binary representation
    Σ    sum (concatenate strings)
     l/  divide length of string (total # of bits) by n
</code></pre>
<p>If it weren't for a bug that I just discovered, this solution would work for 6 bytes:</p>
<pre><code>r♂├♂læ
</code></pre>
<p><code>æ</code> is the builtin mean command.</p>
</div>
<div id="pu31" class="pu"><h1>J, <s>21</s> <s>17</s> 15 bytes</h1>
<p>From 17 bytes to 15 bytes thanks to @Dennis.</p>
<pre><code>+/@:%~#@#:&quot;0@i.
</code></pre>
<p>Can anyone help me golf this?...</p>
<h3>Ungolfed version</h3>
<pre><code>range        =: i.
length       =: #
binary       =: #:
sum          =: +/
divide       =: %
itself       =: ~
of           =: @
ofall        =: @:
binarylength =: length of binary &quot;0
average      =: sum ofall divide itself
f            =: average binarylength of range
</code></pre>
</div>
<div id="pu32" class="pu"><h2>JavaScript (ES7), <s>38</s> 32 bytes</h2>

<pre><code>n=&gt;(l=-~Math.log2(n))-(2**l-2)/n
</code></pre>

<p>Using @sp3000's formula (previous version was a recursive solution). ES6 version for 34 bytes:</p>

<pre><code>n=&gt;(l=-~Math.log2(n))-((1&lt;&lt;l)-2)/n
</code></pre>

<p>Explanation of formula: Consider the case of N=55. If we write the binary numbers (vertically to save space), we get:</p>

<pre><code>                                11111111111111111111111
                111111111111111100000000000000001111111
        11111111000000001111111100000000111111110000000
    111100001111000011110000111100001111000011110000111
  11001100110011001100110011001100110011001100110011001
0101010101010101010101010101010101010101010101010101010
</code></pre>

<p>The size of this rectangle is <i>nl</i> so the average is just <i>l</i> but we need to exclude the blanks. Each row of blanks is twice as long as the previous so the total is 2 + 4 + 8 + 16 + 32 = 64 - 2 = 2<sup>l</sup> - 2.</p>
</div>
<div id="pu33" class="pu"><h2><a href="https://github.com/urbit/urbit" rel="nofollow noreferrer">Hoon</a>, 71 bytes</h2>
<pre><code>|=
r/@
(^div (sun (roll (turn (gulf 0 (dec r)) xeb) add)) (sun r)):.^rq
</code></pre>
<p>...I'm pretty sure this is actually the first time I've used Hoon's floating point cores. It's actually an implementation written in Hoon that jets out to SoftFloat, since the only data types in Hoon are atoms and cells.</p>
<p>Create a function that takes an atom, <code>r</code>. Create a list from [0..(r - 1)], map over the list taking the binary logarithm of the number, then fold over that list with <code>++add</code>. Convert both the output of the fold and <code>r</code> to <code>@rq</code> (quad-precision floating point numbers) with <code>++sun:rq</code>, and then divide one by the other.</p>
<p>The oddest thing in this snippet is the <code>:.^rq</code> at the end. <code>a:b</code> in Hoon means &quot;evaluate a in the context of b&quot;. <code>++rq</code> is the core that contains the entire quad-precision implementation, like a library. So running <code>(sun 5):rq</code> is the same thing as doing <code>(sun:rq 5)</code>.</p>
<p>Luckily, cores in Hoon are like nesting dolls; when you evaluate the arm <code>++rq</code> to get the core, it adds the entire stdlib to it as well, so you get to keep roll and turn and gulf and all that fun stuff instead of being stuck with <em>only</em> the arms defined in <code>++rq</code>. Unluckily, rq redefines <code>++add</code> to be floating-point add instead, along with not having <code>r</code> in its context. <code>.</code> (the entire current context) does, however.</p>
<p>When evaluating an expression in a context, the compiler looks for the limb depth-first. In our case of <code>a:[. rq]</code> it would look in the entire current context for <code>a</code> before moving on to looking in <code>rq</code>. So <code>add</code> will look up the function that works on atoms instead of floating-point numbers...but so will <code>div</code>. Hoon also has a feature where using <code>^name</code> will ignore the first found reference, and look for the second.</p>
<p>From there, it's simply using the syntatic sugar of <code>a^b</code> being equal to <code>[a b]</code> to evaluate our snippet with both our current context and the quad-precision float library, ignoring the atomic div in favor of <code>++div:rq</code>.</p>
<pre><code>&gt; %.  7
  |=
  r/@
  (^div (sun (roll (turn (gulf 0 (dec r)) xeb) add)) (sun r)):.^rq
.~~~2.1428571428571428571428571428571428
</code></pre>
</div>
<div id="pu34" class="pu"><h1>MATL, 9 bytes</h1>
<pre><code>:qBYszQG/
</code></pre>
<p><a href="http://matl.tryitonline.net/#code=OnFCWXN6UUcv&amp;input=Nw" rel="noreferrer">Try it online!</a></p>
<p><strong>Explanation</strong></p>
<pre><code>:qBYszQG/
:               % take vector [1..n]
 q              % decrement by 1 to get [0..n-1]
  B             % convert from decimal to binary
   Ys           % cumulative sum (fills in 0's after first 1)
     z          % number of nonzero elements
      Q         % increment by 1 to account for zero
       G        % paste original input (n)
        /       % divide for the mean
</code></pre>
</div>
<div id="pu35" class="pu"><h1>MATL, 9 bytes</h1>
<pre><code>q:ZlksG/Q
</code></pre>
<p><a href="http://matl.tryitonline.net/#code=cTpabGtzRy9R&amp;input=Ng" rel="nofollow noreferrer"><strong>Try it Online!</strong></a></p>
<p><a href="http://matl.tryitonline.net/#code=YGl0cTpabGtzdy9RRFRd&amp;input=MQoyCjMKNAo1CjYKNw" rel="nofollow noreferrer">Modified version with all test cases</a></p>
<p><strong>Explanation</strong></p>
<pre><code>    % Implicitly grab input (N)
q:  % Create array from 1:N-1
Zl  % Compute log2 for each element of the array
k   % Round down to the nearest integer
s   % Sum all values in the array
G   % Explicitly grab input again
/   % Divide by the input
Q   % Add 1 to account for 0 in [0, ... N - 1]
    % Implicitly display the result
</code></pre>
</div>
<div id="pu36" class="pu"><h1>Jelly, 6 bytes</h1>
<pre><code>R’BFL÷
</code></pre>
<p><a href="http://jelly.tryitonline.net/#code=UuKAmUJGTMO3&amp;input=&amp;args=Nw" rel="noreferrer">Try it online!</a></p>
<pre><code>R’BFL÷  Main monadic chain. Argument: n

R       yield [1, 2, ..., n]
 ’      decrement; yield [0, 1, ..., n-1]
  B     convert to binary; yield [[0], [1], [1,0], [1,1], ...]
   F    flatten list; yield [0, 1, 1, 0, 1, 1, ...]
    L   length of list
     ÷  divide [by n]
</code></pre>
</div>
<div id="pu37" class="pu"><h1>Ruby, <s>44</s> 34 bytes</h1>
<p>Now starring the formula used by @Sp3000</p>
<pre><code>-&gt;x{(2.0-2**b=x.to_s(2).size)/x+b}
</code></pre>
<p>Old version:</p>
<pre><code>-&gt;x{r=0.0;x.times{|i|r+=i.to_s(2).size};r/x}
</code></pre>
</div>
<div id="pu38" class="pu"><h2>Julia, 28 bytes</h2>

<pre><code>n-&gt;mean(ceil(log2([2;2:n])))
</code></pre>

<p>Since <code>bin</code> doesn't automatically map over arrays, we're using <code>ceil(log2(n))</code> to get the number of bits in <code>n-1</code>. This works out nicely because Julia's <code>a:b</code> notation is inclusive on both ends, so <code>2:n</code> is a range from 2 to <code>n</code>, but we're really calculating the number of bits for numbers in the range <code>1:n-1</code>. Unfortunately though, we need to tack on an extra <code>2</code> to account for 0.</p>

<p><a href="http://julia.tryitonline.net/#code=Zj1uLT5tZWFuKGNlaWwobG9nMihbMjsyOm5dKSkpCnByaW50bG4oZigxMjM0NTYpKQ&amp;input=">Try it online!</a></p>
</div>
<div id="pu39" class="pu"><h1>Python 3, 43 bytes</h1>



<pre class="lang-py prettyprint-override"><code>def f(n):x=len(bin(n))-2;return(2-2**x)/n+x
</code></pre>

<p>Makes use of the formula on the <a href="http://oeis.org/A083652">OEIS page</a>. Surprisingly, a named function is somehow cheaper here because of the assignment to <code>x</code>.</p>

<p>Alternative approach for 46 bytes:</p>

<pre class="lang-py prettyprint-override"><code>lambda n:-~sum(map(int.bit_length,range(n)))/n
</code></pre>

<p>Unfortunately, the <code>-~</code> is necessary since <code>(0).bit_length()</code> is <code>0</code>, but even then it'd be a byte too long.</p>
</div>
<div id="pu40" class="pu"><h1>JavaScript ES5, 55 bytes</h1>

<pre><code>n=&gt;eval(`for(o=0,p=n;n--;o+=n.toString(2).length/p);o`)
</code></pre>

<h2>Explanation</h2>

<pre><code>n =&gt;   // anonymous function w/ arg `n`
  for( // loop
      o=0,  // initalize bit counter to zero
      p=n   // copy the input
    ;n-- // will decrease input every iteration, will decrease until it's zero
    ;o+=    // add to the bitcounter
        n.toString(2)  // the binary representation of the current itearations's
                     .length // length
        /p   // divided by input copy (to avergage)
   );o       // return o variable  
</code></pre>
</div>
<div id="pu41" class="pu"><h1>Octave, 29 bytes</h1>
<pre><code>@(n)1+sum(fix(log2(1:n-1)))/n
</code></pre>
<p><strong>Explanation</strong></p>
<pre><code>              log2(1:n-1)       % log2 of numbers in range [1..n-1]
                                % why no 0? because log2(0) = -Inf  :/
          fix(           )      % floor (more or less, for positive numbers)
      sum(                )     % sum... wait, didn't we miss a +1 somewhere?
                                % and what about that missing 0?
                           /n   % divide by n for the mean
    1+                          % and add (1/n) for each of the n bit lengths 
                                % (including 0!)
</code></pre>
<p>Sample run on <a href="http://ideone.com/3i9BsB" rel="noreferrer">ideone</a>.</p>
</div>
<div id="pu42" class="pu"><h1>Python 3, 46 Bytes</h1>
<pre><code>lambda x:sum(len(bin(i))-2for i in range(x))/x
</code></pre>
<p>Call it like</p>
<pre><code>f = lambda x: sum(len(bin(i))-2for i in range(x))/x
print(f(6))
# 2.0
</code></pre>
<p><em>I had to revert the map revision because it failed for input of 5</em></p>
</div>
<div id="pu43" class="pu"><h2><a href="https://github.com/elendiastarman/Minkolang" rel="nofollow noreferrer">Minkolang 0.15</a>, 23 bytes</h2>
<pre><code>n$z1z[i1+2l$M$Y+]kz$:N.
</code></pre>
<p><a href="http://play.starmaninnovations.com/minkolang/?code=n%24z1z%5Bi1%2B2l%24M%24Y%2B%5Dz%24%3AN%2E&amp;input=6" rel="nofollow noreferrer">Try it here!</a></p>
<h3>Explanation</h3>
<pre><code>n$z                       Take number from input and store it in register (n)
   1                      Push 1 onto the stack
    z[                    For loop that repeats n times
      i1+                 Loop counter + 1
         2l$M             log_2
             $Y           Ceiling
               +          Add top two elements of stack
                ]         Close for loop
                 z$:      Float divide by n
                    N.    Output as number and stop.
</code></pre>
<p>Pretty straightfoward implementation.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/80586/">80586</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




