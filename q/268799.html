<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::268799</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>016</td><td>APLDyalog Unicode</td><td>231227T210326Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268809#268809">Tbw</a></td></tr>
<tr d-ix="1"><td>036</td><td>Python</td><td>231227T152034Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268805#268805">bsoelch</a></td></tr>
<tr d-ix="2"><td>6463</td><td>Scala 3</td><td>231228T062106Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268817#268817">138 Aspe</a></td></tr>
<tr d-ix="3"><td>002</td><td>05AB1E</td><td>231227T142325Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268802#268802">Command </a></td></tr>
<tr d-ix="4"><td>010</td><td>Haskell + hgl</td><td>231227T173046Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268807#268807">Wheat Wi</a></td></tr>
<tr d-ix="5"><td>035</td><td>Charcoal</td><td>231227T142337Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268803#268803">Neil</a></td></tr>
<tr d-ix="6"><td>032</td><td>R</td><td>231227T203159Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268808#268808">pajonk</a></td></tr>
<tr d-ix="7"><td>039</td><td>C gcc</td><td>231227T142423Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268804#268804">Noodle9</a></td></tr>
<tr d-ix="8"><td>027</td><td>JavaScript Node.js</td><td>231227T141933Z</td><td><a href="https://codegolf.stackexchange.com/questions/268799/output-an-infinitely-proportional-sequence/268801#268801">l4m2</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://dyalog.com" rel="nofollow noreferrer">APL(Dyalog Unicode)</a>, <sup><s></s></sup>16 bytes <sup><a href="https://github.com/abrudz/SBCS" rel="nofollow noreferrer">SBCS</a></sup></h1>
<pre><code>{⍵≠⌊⍵:0⋄1+∇⍵*.5}
</code></pre>
<p><a href="https://razetime.github.io/APLgolf/?h=AwA&amp;c=q37Uu/VR54JHPV1AhpXBo@4WQ@1HHe1AjpaeaS0A&amp;f=K0ktLil@1DbBUPtR72YTS64SEF8nWs80Nu3QCjAHAA&amp;i=AwA&amp;r=tryapl&amp;l=apl-dyalog-extended&amp;m=train&amp;n=f" rel="nofollow noreferrer">Try it on APLgolf!</a></p>
<p>-1 byte thanks to att.</p>
<p>A tacit function which takes an integer <span class="math-container">\$n\geq 2\$</span> on the right and outputs the <span class="math-container">\$n\$</span>th term in the sequence in the question.</p>
<pre><code>{⍵≠⌊⍵:0⋄1+∇⍵*.5}­⁡​‎‎⁪⁡⁪⁠⁪⁤⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁢⁪‏‏​⁡⁠⁡‌⁢​‎‎⁪⁡⁪⁠⁪⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁪‏‏​⁡⁠⁡‌⁣​‎‎⁪⁡⁪⁠⁪⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁣⁪‏‏​⁡⁠⁡‌⁤​‎‎⁪⁡⁪⁠⁪⁢⁤⁪‏‏​⁡⁠⁡‌⁢⁡​‎‎⁪⁡⁪⁠⁪⁣⁡⁪‏‏​⁡⁠⁡‌⁢⁢​‎‎⁪⁡⁪⁠⁪⁤⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁣⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁤⁪‏‏​⁡⁠⁡‌⁢⁣​‎‎⁪⁡⁪⁠⁪⁣⁤⁪‏‏​⁡⁠⁡‌⁢⁤​‎⁪⁪⁠‎⁪⁡⁪⁠⁪⁣⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁣⁪‏‏​⁡⁠⁡‌­
   ⌊⍵             ⍝ floor ‎⁡input
 ⍵≠               ⍝ ‎⁢not input
 ⍵≠⌊⍵:            ⍝ ‎⁣If input is non-integer:
      0           ⍝ ‎⁤    return 0
       ⋄          ⍝ ‎⁢⁡Else:
           ⍵*.5   ⍝ ‎⁢⁢sqrt input
          ∇       ⍝ ‎⁢⁣apply this dfn 
        1+        ⍝ ‎⁢⁤add 1
💎
</code></pre>
<p>Created with the help of <a href="https://vyxal.github.io/Luminespire" rel="nofollow noreferrer">Luminespire</a>.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, 36 bytes</h1>
<p><em>-6 bytes thanks to l4m2, Command Master and xnor</em></p>
<pre class="lang-python prettyprint-override"><code>f=lambda n:-n&amp;n&lt;n or-~f(len(bin(n)))
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m72soLIkIz9vwYKlpSVpuhY3VdJscxJzk1ISFfKsdPPU8mzyFPKLdOvSNHJS8zSSMvM08jQ1NaFqlQqKMvNKNKLTNDI10_KLFDIVMvMUihLz0lM1DHWMTM01Y6EqYaYDAA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p><strong><a href="https://ato.pxeger.com/run?1=m72soLIkIz9vwYKlpSVpuhY31dNscxJzk1ISFfKs8tTydA0T81IUDPOLdOvSNHJS8zSSMvM08jQ1NaHKlQqKMvNKNKLTNDI10_KLFDIVMvMUihLz0lM1DHWMTM01Y6EqYRYAAA" rel="nofollow noreferrer">39 bytes</a> if using <code>True</code> as <code>1</code> is not allowed:</strong></p>
<pre class="lang-python prettyprint-override"><code>f=lambda n:n&amp;n-1and 1or-~f(len(bin(n)))
</code></pre>
<p>Similar to example but with logarithm base 2 instead of square root.</p>
<p><em>I known that <code>len(bin(n))</code> is not exactly the logarithm, but it does not make a difference for the purpose of this challenge</em></p>
<hr />
<h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, 36 bytes</h1>
<p><em>suggested by Wheat Wizard</em></p>
<pre class="lang-python prettyprint-override"><code>lambda n:len(min(bin(n).split(&quot;1&quot;)))
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m72soLIkIz9vweI025ilpSVpuhY3VXISc5NSEhXyrHJS8zRyM_M0koA4T1OvuCAns0RDyVBJU1MTqla5oCgzr0QjOk0jUzMtv0ghUyEzT6EoMS89VcNQx9DAyFgzFqp0wQIIDQA" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.scala-lang.org/" rel="nofollow noreferrer">Scala 3</a>, <del>64</del> 63 bytes</h1>
<p>A port of <a href="https://codegolf.stackexchange.com/a/268808/110802">@pajonk's R answer</a> in Scala.</p>
<p>Saved 1 byte(s) thanks to the comment of @pajonk</p>
<hr />
<pre class="lang-scala prettyprint-override"><code>def f(n:Double):Int={val i=math.sqrt(n);if(i%1&gt;0)1 else f(i)+1}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=NY9BTsMwEEX3PcWoEpItlLSGDUqVoCI2SHSFWFUVclKnNXLGwZ5Ao6onYdMNbLgD9-ht6oSwmvme_7-eP799IY28_lmOI7Qf0uF4dZrZ_FUVBAupEfYjgLUqoQqCSbfxCcydk-3yiZzGzYon8IyaIO2d8NVQGd2cbrtIyTC5t01uFE8ekNL9uzSg00rSNvZvjhjymS6ZvhDZlAtQxquQ0fxSHIaa39AIkwnM69q0QNtwb7AgbRHI9hqbKlfOQ-lsBVfdq5gKkLiGOuBR73HKN4Z8hwcdwqADMvtP8LiSNUNIM0CIsg49JjvA87AuZN3n-1aDbOgIl0ftKfbW0V3Ldmm2i18E58F7GA2_OB7_5hk" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E" rel="noreferrer">05AB1E</a>, 2 bytes</h1>
<pre><code>Óθ
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m73MwDQxyTB1wQZDAwNXPzt7JQVdOwUlez-7paUlaboWSw5PPrdjSXFScvFCHYjIggUQGgA" rel="noreferrer">Attempt This Online!</a></p>
<p>Returns the exponent of the largest prime factor of <span class="math-container">\$n\$</span>.</p>
<h2>Proof of correctness</h2>
<p>Let's look at the ratio between the number of values which return <span class="math-container">\$k\$</span> and the number which return <span class="math-container">\$k + 1\$</span>. For each number which gives <span class="math-container">\$k+1\$</span>, with greater prime factor <span class="math-container">\$p_m\$</span>, we can create <span class="math-container">\$m-1\$</span> new numbers, by dividing by <span class="math-container">\$p_m\$</span> and multiplying by <span class="math-container">\$p_i\$</span> for <span class="math-container">\$i &lt; m\$</span>. However, some numbers are generated multiple times, but it's bounded by their number of distinct prime divisors. If we look at numbers up to <span class="math-container">\$n\$</span>, that's bounded by <span class="math-container">\$O(\frac{\log(n)}{\log\log(n)})\$</span>. Therefore we have <span class="math-container">\$\sum_{p_m} \frac{(m-1)\log\log(n)}{\log(n)} \Psi(\frac n{p_m^{k+1}}, p_m-1) \leq \sum_{p_m} \Psi(\frac n{p_m^k}, p_m-1)\$</span>. We want to show that for every <span class="math-container">\$N\$</span>, for large enough <span class="math-container">\$n\$</span>, we have <span class="math-container">\$ N \sum_{p_m} \Psi(\frac n{p_m^{k+1}}, p_m-1) \leq \sum_{p_m} \frac{(m-1)\log\log(n)}{\log(n)} \Psi(\frac n{p_m^{k+1}}, p_m-1)\$</span>. We'll split it at <span class="math-container">\$m = 2N \log(n)\$</span>. From theorem 1.4 in <a href="http://www.numdam.org/item/JTNB_1993__5_2_411_0.pdf" rel="noreferrer">Integers without large prime factors</a>, we have <span class="math-container">\$\Psi(n, p_m) = n^{O_N(\frac 1{\log\log n})}\$</span>. The inequality is trivial for <span class="math-container">\$m &gt; 2N \log(n)\$</span>, and because <span class="math-container">\$\sum_{p_m} \Psi(\frac n{p_m^{k+1}}, p_m-1) = \Omega(\frac{n^{k+1}}{\log(n)})\$</span> grows faster than <span class="math-container">\$n^{O_N(\frac 1{\log\log n})}\$</span> the fact that we used <span class="math-container">\$2N\$</span> balances the terms we split out.</p>
<h1><a href="https://github.com/Adriandmen/05AB1E" rel="noreferrer">05AB1E</a>, 2 bytes, thanks to @GregMartin</h1>
<pre><code>Ó¿
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m73MwDQxyTB1wQZDAwNXPzt7JQVdOwUlez-7paUlaboWSw5PPrR_SXFScvFCHYjIggUQGgA" rel="noreferrer">Attempt This Online!</a></p>
<p>Returns the gcd of the prime exponents, which is the largest <span class="math-container">\$k\$</span> such that <span class="math-container">\$n\$</span> is a <span class="math-container">\$k\$</span>-th power.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://www.haskell.org" rel="nofollow noreferrer">Haskell</a> + <a href="https://gitlab.com/wheatwizard/haskell-golfing-library" rel="nofollow noreferrer">hgl</a>, 10 bytes</h1>
<pre><code>nM l&lt;gr&lt;bi
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m708I7E4OzUnZ8FN3czcgvyiEoXC0sSczLTM1BSFgKLUnNKUVC6oRABXmpWVZ16Jrh2QWFpakqZrsSbNNs9XIccmvcgmKRMitDU3MTPPNjdeoaBIJc0m2lBPz9DAIBYit2ABhAYA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<h2>Explanation</h2>
<ul>
<li><code>bi</code> convert the input to binary</li>
<li><code>gr</code> group equal elements</li>
<li><code>nM l</code> length of the shortest group</li>
</ul>
<p>This finds the shortest run of equal elements in the binary expansion of the input.</p>
<h2>Proof</h2>
<p>I will provide a proof that the proportion of 1s approaches 1. That is <span class="math-container">\$P(f(x)=1)=1\$</span> This argument can be repurposed to show that for any number the proportion relative to numbers greater than or equal to it approaches 1. That is <span class="math-container">\$P(f(x)=n\mid f(x)\geq n)=1\$</span>.</p>
<p>Let's consider the two least significant bits of a number <span class="math-container">\$x\$</span>. If they are <code>10</code> or <code>01</code> then <span class="math-container">\$f(x)=1\$</span>.</p>
<p>The two other options <code>11</code> and <code>00</code> may be any value. This means that at least half of all numbers give 1.</p>
<p>Now in the general case, let us treat the case where the least significant <span class="math-container">\$2n\$</span> bits do not rule out values other than 1. Considering the least significant <span class="math-container">\$2n+2\$</span> bits. A fourth of all cases of begin with <code>010</code> or <code>101</code> and thus <span class="math-container">\$f(x)=1\$</span>. So 3/4 of all cases have the <em>possibility</em> of being something other than 1.</p>
<p>We can use recursion to then derive the following formula:</p>
<p><span class="math-container">\$
P(f(x)\neq 1) \leq \frac{1}{2}\left(\frac34\right)^n
\$</span></p>
<p>We can take the limit:</p>
<p><span class="math-container">\$
\displaystyle P(f(x)\neq 1)\leq\frac{1}{2}\lim_{n\rightarrow\infty} \left(\frac{3}{4}\right)^n=0
\$</span></p>
<p>So the probability of getting a 1 converges to 1.</p>
<h2>Reflection</h2>
<p>There are a couple of things that would be nice here.</p>
<ul>
<li>There is <code>sss</code> which gives the shortest continuous substring satisfying a predicate, and <code>sSn</code> which gives the <em>maximal</em> substrings satisfying a predicate. Here it would have been useful to have a function which gives the shortest maximal substring satisfying a predicate.</li>
<li>It might be nice to have a version of <code>gr</code> which just gives the lengths of the groups. It's not uncommon to care only about group lengths and not their contents.</li>
</ul>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 35 bytes</h1>
<pre><code>Ｎθ⊞υ¹Ｗ›θΣυ«≧⁻Συθ⊞υ×⌈υＬυ»Ｉ⊕ΣＥυ›θΣ✂υκ
</code></pre>
<p><a href="https://tio.run/##Xc7NCsIwDAfws32KHlOYsJ13Eg8ycDKcL1BrWIttnf1QQXz2usp2MaeQf/glQnInblyn1NgxhkM0Z3RwZzXpopcQC1pN/VMqjRR2DnnIcUH7aCAyxuibrFo@brxXgz2qQQZolY1@2ShotlYLdlIGPbT8pcwc79EOQf6smnxI55QNsOU@QGOFQ4M24AUyNp3JxN8TvVYC8/zK5qpTqsqyTOuH/gI" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Outputs the <code>n</code>th term. Explanation:</p>
<pre><code>Ｎθ
</code></pre>
<p>Input <code>n</code>.</p>
<pre><code>⊞υ¹
</code></pre>
<p>Start with <code>1</code> <code>1</code> as the first term of the sequence.</p>
<pre><code>Ｗ›θΣυ«
</code></pre>
<p>While more terms are needed, ...</p>
<pre><code>≧⁻Συθ
</code></pre>
<p>... account for previous terms, and...</p>
<pre><code>⊞υ×⌈υＬυ
</code></pre>
<p>generate a new set of terms.</p>
<pre><code>»Ｉ⊕ΣＥυ›θΣ✂υκ
</code></pre>
<p>Calculate the resulting term.</p>
<p>The result is the following sequence:</p>
<pre><code>1
1 2
1 1 2 3
1 1 1 1 1 1 2 2 3 4
1 (24 times) 2 2 2 2 2 2 3 3 4 5
1 (120 times) 2 (24 times) 3 3 3 3 3 3 4 4 5 6
1 (720 times) 2 (120 times) ...
</code></pre>
<p>Within each group, the number of times <code>m-1</code> appears more than <code>m</code> is more than the number of times <code>m-1</code> appeared more than <code>n</code> in the previous group.</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>, 32 bytes</h1>
<pre class="lang-r prettyprint-override"><code>f=\(n,i=n^.5)`if`(i%%1,1,f(i)+1)
</code></pre>
<p>Uses the sequence from the question (2-indexed).</p>
<p><a href="https://ato.pxeger.com/run?1=m72waMGiNNulpSVpuhY3FdJsYzTydDJt8-L0TDUTMtMSNDJVVQ11DHXSNDI1tQ01oerU0jSMTM00uYpTS_wSc1OLNYoTCwpyKjWMrAwNgGo1dcAMqOoFCyA0AA" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu7" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, 39 bytes</h1>

<pre class="lang-c prettyprint-override"><code>i;f(n){i=sqrt(n);n=i*i-n||1/n?:f(i)+1;}
</code></pre>
<p><a href="https://tio.run/##bVDbTsMwDH3fV1iVJiVto9FNPEAoPCC@gvahSpMRsWUjiURF118nuFeYRORY9rF95GPB9kKEoLkihrY6dx/WY8RNrmPNzOWSbczTvSKaJhnvgjYejpU2hEK7Anw9IJuzFF7WryXk0GYpjLadg3/T0XYdH2jEW2Vj9FK8S4s80DNFRfOyLZq7Z/y3UQp/8100TaqTBdJvoU0tGxy74VP4AE5/yZMi8350MwHxgnBIkqF71jNr8sg00iSQ8auSw5Iinl6jEtHlEMNk@dtwttiiSLSugT0C@rUrDCryKbh0kY0UObhyIu5WXfgW6lDtXWCfgR2OPw" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
</div>
<div id="pu8" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 27 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>S=n=&gt;++n**.5%1?1:S(n**.5)+1
</code></pre>
<p><a href="https://tio.run/##HchRCoAgDADQ0wSbq2Af/STaITxBlMYiXFh0faP@Hm@fn/laipx3l3WNtQaXnSfKxvRDwxOPAX4jcU1aQBxbSyQoCQIIesZF86VH7A/dQNovsb4" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/268799/">268799</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




