<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::282109</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>202</td><td>JavaScript ES6</td><td>250603T233420Z</td><td><a href="https://codegolf.stackexchange.com/questions/282109/solve-tango-puzzle/282114#282114">Arnauld</a></td></tr>
<tr d-ix="1"><td>599</td><td>Python3</td><td>250603T223415Z</td><td><a href="https://codegolf.stackexchange.com/questions/282109/solve-tango-puzzle/282112#282112">Ajax1234</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>JavaScript (ES6), 202 bytes</h1>
<p>Expects <code>(m)([e,x])</code>, where <strong>m</strong> is a matrix of characters and the lists of coordinates <strong>e</strong> and <strong>x</strong> are filled with 4-tuples <code>[y,x,Y,X]</code>.</p>
<p>Prints all solutions as matrices of characters (only one solution in practice, given the constraints of the challenge).</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;g=A=&gt;m.some((r,y)=&gt;r.some((c,x)=&gt;c&lt;g?r[g(A,r[x]=&quot;M&quot;),g(A,r[x]=&quot;S&quot;),x]=c:A.some((b,i)=&gt;!b.every(([V,H,Y,X])=&gt;Y-y|X-x|m[V][H]==c^i))|/(\w)((\D*\1){3}|,\1,\1)/.test(r+0+m.map(r=&gt;r[x]))))||console.log(m)
</code></pre>
<p><a href="https://tio.run/##fVJNb9swDL3nV3g5SSuj6sO6DHOGADv0opOAooWiAqnnBhnqunCCLsG8356JZpLGQVHDsB@fTPI90r8Xb4t12a5eN5OX5le1fyr2dTFdFrNiWot1U1eMtbDjxbQ9RCVsU1R@X/5ow5LNoA3bWIzdmMN75FOU3uW32SHpEVYp6cujqN6qdsdYuIUbuIe7mNj7ya67m2y7OtzGcBOLonxYcd5ds/kfztj859e54n/Nvw7mKt38Wmyq9Ya1V/KqFvXilbVJW@rK09V1ZfOybp4r8dwsWc33TyyMsiwIIcbCee/EOMKRcOkh3BnhPyT8Zco5IbxzPhUdRc5CFoICBZkGFSELBrEBHTFIJxpPNAYKDGQKcsQasSZsEOdgCOeIez7HSjlWyiIfnVvkozOHrtd7IdcPDCVmMAORUpy/@GIwg34m/t2hJh/mpD2JJocGT8zxRB@8f6pYiAvFHxBe@AHhUPPnKUQcFUucnqKdKJCoXpJGixotTVvihCVNu8eKXPXZkvYm0a@knUjcz2GHfdVTh563hC12s9RNYjdJ3Sx2sNQtH2JLNS32OmGFWJ/@BYvq0mT3/wE" rel="nofollow noreferrer" title="JavaScript (Node.js) â€“ Try It Online">Try it online!</a></p>
<h3>Method and performance</h3>
<p>This makes all possible guesses on empty cells but stops as soon as an inconsistency is detected, so it's still pretty fast (a few milliseconds for the test cases).</p>
<p>It's worth noting that there are only 11,222 valid grids<sup>(1)</sup>. Without any clue given in the input, this code can generate all of them in <a href="https://tio.run/##tY7BasMwEETv/grXp916rST01lTupYdc6kshJMgqKKpiXKwoyCa1qfrtriiBfkGGheENDLOf6qJ67dvzUJzch5mPfLa8bLjipWW9swbA04S89FfSNEbST9lr9uxFA4q8GCWPiPRPb5Gi60d1rR2ojbW7AzMX4ycAsaUN7WknY7ovprArxmDFVoqN5Fy/t4hhAfUXAtQv9/UKvx9@AtWreLhgg@kH8Pkyt8yqM/j4XVzFqBDyvJo7M6RVytPlOjmCSNJUMMYy9qdM0i2CRCIIiYl2p951hnWugQrX8y8" rel="nofollow noreferrer">~30 seconds on TIO</a>.</p>
<p><em><sub>(1) as confirmed <a href="https://github.com/zmxv/tangocount" rel="nofollow noreferrer">here</a></sub></em></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>m =&gt;                            // outer function taking m[]
g = A =&gt;                        // inner recursive function taking A[]
m.some((r, y) =&gt;                // for each row r[] at index y in m[]:
  r.some((c ,x) =&gt;              //   for each character c at index x in r[]:
    c &lt; g ?                     //     if this cell is still empty (c is &quot;.&quot;):
      r[                        //
        g(A, r[x] = &quot;M&quot;),       //       1st recursive call with a moon inserted
        g(A, r[x] = &quot;S&quot;),       //       2nd recursive call with a sun inserted
        x                       //       then restore r[x] ...
      ] = c                     //       ... to &quot;.&quot;
    :                           //     else (c is &quot;M&quot; or &quot;S&quot;):
      A.some((b, i) =&gt;          //       for each list b[] at index i in A[]:
        !b.every(               //         for each 4-tuple ...
          ([V, H, Y, X]) =&gt;     //         ... [V, H, Y, X] in b[]:
          Y - y | X - x |       //           tests whether (X, Y) matches (x, y)
          m[V][H] == c          //           and m[V][H] either does or doesn't
          ^ i                   //           match c, according to i
        )                       //         end of every()
      ) |                       //       end of some()
      /(\w)((\D*\1){3}|,\1,\1)/ //       look for 4 identical symbols anywhere
      .test(                    //       or 3 consecutive identical symbols in:
        r +                     //         either the current row
        0 +                     //         (use 0 as a separator)
        m.map(r =&gt; r[x])        //         or the current column
      )                         //       end of test()
  )                             //   end of inner some()
)                               // end of outer some()
|| console.log(m)               // if falsy, print the matrix
</code></pre>
</div>
<div id="pu1" class="pu"><h1>Python3, 599 bytes</h1>
<pre class="lang-py prettyprint-override"><code>C=lambda x:[]if[]==x else[x[:2]]+C(x[2:])
E=enumerate
def f(a,b,c):
 A,B=dict(C(a)+[(k,j)for j,k in C(a)]),dict(C(b)+[(k,j)for j,k in C(b)])
 q,S=[(c,[(x,y)for x,r in E(c)for y,v in E(r)if'.'==v])],[]
 for c,l in q:
  if[]==l:return c
  (x,y),*l=l
  for t in'SM':
   e=eval(str(c));e[x][y]=t
   if all(all(m*3 not in''.join(k)for k in e+[*zip(*e)])for m in'SM')and all('.'in j or j.count('M')==j.count('S')for j in e+[*zip(*e)])and e not in S:
    F=0
    if(x,y)in A:X,Y=A[(x,y)];F=e[X][Y]in['.',t]
    elif(x,y)in B:X,Y=B[(x,y)];F=e[X][Y]=='.' or e[X][Y]!=t
    else:F=1
    if F:q+=[(e,l)];S+=[e]
</code></pre>
<p><a href="https://tio.run/##jVJNb9swDD3Pv0LrxVKiGf4KMLjQoS2am3fRpYUmDI4jb04dO7XdItmfz6gPz@naw1wULyQfyUeKh9P4q2uTr4f@fL5jTbHfbAt0zISsKyEZOyLVDEocRRZLubzDRxFnknj3TLUve9UXo/K2qkIVLuiGliTz0A29Zdu6HPEdLshS4Ce6I1XXox19QnWLtFcS6hibDxkbYHjomXImcEkFPtKTIRxprwn3uDTmib5asyd15Qc@Y6@SSCqkh3S4pI0OP4MmZIdpsl6NL32LSnCZqnTRsAYMzR@B7fPc13ykmHotGjyMPTQj17ABKU6SjTpWV6hoGqz/94sEtZ3J9INdV7f4yUgzg6ilWPyuD3ihYB7t3bsOpGi3pgSIBt4O6eGDsntpR@xDmLG/Fvftat7V0yWU64240YzWLDRYV2Y4CNxkD/SR3dgVyus1U@JBikdZtwJ601EavmrmjFuTcfsugzFI0EKd/dnuwpxHtmaRa4zW2fMSnk3RBrI5/FTyPEQMXV1deUHOeR54eQBf7vEL4NbJvYDnOQ88zfaGGNm83HAMhUMCIFQJwJlzY0EVU4u7vMTlBeabgcMfiNCZ/8RMnj7ksfux6Yp@iwe45U/uXIRY1NLcSK23XdXNqHr8rWsVRUMwHJoaXup76xMibZWfavygjKbYI9kXB@wOhg6EeN6hr@G157QKCxzRiFCEYwvJBLE@cQjGNmggoomF1DoTC6nNMFZqIbHOdILIgi46jx4R@Jwm/4u/SEPyocJ4EpFcgO6nFSY2mEzBeJY/d4r/s1NohUYThLamg5Ut7SC0I72FyGhyZUIrJrTSQrsLB9EE4ZuGzrm6gHiC8KKvU5FOkL63VhMkb6zIQnzxLisje95WYrZ1/gM" rel="nofollow noreferrer">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/282109/">282109</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




