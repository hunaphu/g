<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::200650</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>193</td><td>Nim</td><td>250728T111931Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/282837#282837">janAkali</a></td></tr>
<tr d-ix="1"><td>236</td><td>C GCC</td><td>230224T171848Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/258210#258210">Peter</a></td></tr>
<tr d-ix="2"><td>227</td><td>C# Visual C# Interactive Compiler</td><td>200312T140920Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200918#200918">Jirka Pi</a></td></tr>
<tr d-ix="3"><td>083</td><td>Ruby</td><td>200306T100047Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200653#200653">G B</a></td></tr>
<tr d-ix="4"><td>176</td><td>Python 3.8</td><td>200306T114359Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200659#200659">Noodle9</a></td></tr>
<tr d-ix="5"><td>027</td><td>Japt</td><td>200306T233950Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200681#200681">Shaggy</a></td></tr>
<tr d-ix="6"><td>057</td><td>Charcoal</td><td>200306T224739Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200680#200680">Neil</a></td></tr>
<tr d-ix="7"><td>021</td><td>Jelly</td><td>200306T195528Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200677#200677">Nick Ken</a></td></tr>
<tr d-ix="8"><td>189</td><td>R</td><td>200306T181809Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200672#200672">John</a></td></tr>
<tr d-ix="9"><td>023</td><td>Husk</td><td>200306T203934Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200679#200679">Leo</a></td></tr>
<tr d-ix="10"><td>204</td><td>Red</td><td>200306T135134Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200662#200662">Galen Iv</a></td></tr>
<tr d-ix="11"><td>093</td><td>Perl 5 p MListUtil=product</td><td>200306T184533Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200674#200674">Xcali</a></td></tr>
<tr d-ix="12"><td>026</td><td>Jelly</td><td>200306T181953Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200673#200673">Jonathan</a></td></tr>
<tr d-ix="13"><td>080</td><td>JavaScript ES6</td><td>200306T095334Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200652#200652">Arnauld</a></td></tr>
<tr d-ix="14"><td>206</td><td>SNOBOL4 CSNOBOL4</td><td>200306T161811Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200667#200667">Giuseppe</a></td></tr>
<tr d-ix="15"><td>155</td><td>Python 3</td><td>200306T131425Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200660#200660">ovs</a></td></tr>
<tr d-ix="16"><td>026</td><td>05AB1E</td><td>200306T101317Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200654#200654">Expired </a></td></tr>
<tr d-ix="17"><td>173</td><td>Wolfram Language Mathematica</td><td>200306T104849Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200657#200657">ZaMoC</a></td></tr>
<tr d-ix="18"><td>020</td><td>05AB1E</td><td>200306T094150Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200651#200651">Kevin Cr</a></td></tr>
<tr d-ix="19"><td>070</td><td>Retina</td><td>200306T112642Z</td><td><a href="https://codegolf.stackexchange.com/questions/200650/bad-factorial-joke/200658#200658">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="http://nim-lang.org/" rel="nofollow noreferrer">Nim</a>, 193 bytes</h1>
<pre><code>include math,prelude
proc(a=&quot;&quot;):auto=join a.split(' ').mapIt (var b,c=it[0..^2];[it,try:($b.parseInt.fac)except:(for i in 2..b.len:c&amp;=b[0..^i];c),&quot;&quot;][int(it[^1]&lt;'&quot;')+int it in [&quot;1!&quot;,&quot;2!&quot;]]),&quot; &quot;
</code></pre>
<p><a href="https://wandbox.org/permlink/5L9GkmD3eFuj8vj2" rel="nofollow noreferrer">Try it in wandbox!</a></p>
<p>Ungolfed:</p>
<pre class="lang-none prettyprint-override"><code>proc facJoke(input = &quot;&quot;): auto =
  join(
    input.split(' ').mapIt (
      var word, acc = it[0..^2] # substring (^2 == it.len-2)
      [
        it,   # 1st element - unchanged word
        (
          try:
            $word.parseInt.fac
          except:
            for i in 2..word.len:
              acc &amp;= word[0..^i]
            acc
        ),    # 2nd element - either fac(n) or transformed word if fails to parse integer
        &quot;&quot;    # 3rd element - empty string
      ][ int(it[^1] &lt; '&quot;') + int(it in [&quot;1!&quot;,&quot;2!&quot;]) ] # indexing array with sum of two bools
                                                      # [a-zA-Z] &gt; '&quot;' &gt; '?'
                                                      # string in [array of strings]
                                                      # int(true) + int(true) == 2
    ),
  &quot; &quot;) # second argument of join
</code></pre>
</div>
<div id="pu1" class="pu"><h1>C (GCC), 236 bytes</h1>
<pre class="lang-c prettyprint-override"><code>i,j;char*a,*b,*c,*d;f(char*s){a=strchr(s,33);for(b=a;b&gt;s&amp;!isspace(b[-1]);--b);for(d=s;d-b;)putchar(*d++);*a=0;if(*b&amp;64)for(c=a;*b;*--c=0)printf(&quot;%s&quot;,b);else{for(i=j=1;j-atoi(b);)i*=++j;printf(&quot;%d&quot;,i);}printf(&quot;%s&quot;,a+1);j&gt;0&amp;j&lt;3&amp;&amp;puts(b);}
</code></pre>
<p><a href="https://tio.run/##Tc5NTsMwEAXgdXMKJxKR7dhVnAKbwV1zAHalC/8k1CEkVSbAourZg0Ohqhe2NP7e0zj55tw8B9GCO5iRG8Gt4E5wDw39nSA7GY3T6A4jRbHZMGiGkVptwG4xTwPi0bia2p1UewZS2gvwGsFLC@z4OS09lPuiYMCNLiE0lNv88Z4t0MUmboFL6XTJjmPop4Zmd5iJ2FR3WJ8WFXSrFbTSTEOg8YMFrouihav3mQgMzrd5UygG7bbM26dNnsc9cEme5yjIhwk9/RqCZ8kpWS0LEtztiSbZc911Q0peapzIer1@7TNIVg1FFp9/qS70IY23qsqrUbeouiCVkoDkPfSeDA35rsPol96YIH8nBqsYPM8/" rel="nofollow noreferrer">Try It Online!</a></p>
<p>Explanation:</p>
<pre class="lang-c prettyprint-override"><code>i,j;
char*a,*b,*c,*d;

f(char*s)
{
    // a is the first '!' in s
    a=strchr(s,33);
    // b is the first character after the first whitespace before a, or s if there is no whitespace there
    for(b=a;b&gt;s&amp;!isspace(b[-1]);--b);
    // Print each character from s to b
    for(d=s;d-b;)putchar(*d++);
    // Null-terminate s at a
    *a=0;
    // If b is alphabetic
    if(*b&amp;64)
        // While there's anything left of b, print b and shorten it by adding an earlier null terminator
        for(c=a;*b;*--c=0)
            printf(&quot;%s&quot;,b);
    else {
        // If b is not alphabetic, it's assumed to be a number.
        // i is the product of all j-s between 1, and b as a number
        for(i=j=1;j-atoi(b);)i*=++j;
        printf(&quot;%d&quot;,i);
    }
    // Print everything after the exclamation mark
    printf(&quot;%s&quot;,a+1);
    // Print the number twice if it's 1 or 2
    j&gt;0&amp;j&lt;3&amp;&amp;puts(b);
}
</code></pre>
<p><a href="https://codegolf.stackexchange.com/users/52904/ceilingcat">ceilingcat</a>'s 226 byte version:</p>
<pre class="lang-c prettyprint-override"><code>i,j;char*a,*b,*c,*d;f(char*s){for(b=a=index(s,33);b&gt;s&amp;!isspace(b[-1]);--b);for(d=s;*a=d-b;)putchar(*d++);if(*b&amp;64)for(c=a;*b;*--c=0)printf(b);else{for(i=j=1;j-atoi(b);)i*=++j;printf(&quot;%d&quot;,i);}printf(&quot;%s&quot;,a+1);j&gt;0&amp;j&lt;3&amp;&amp;puts(b);}
</code></pre>
<p><a href="https://tio.run/##TZDLTsMwEEXX7Vc4kYg8jl3VLbAZ3DUfwK504VfAoSRVHB5S1W8PdgsVXszInnPvHdmKF2unKfAW7asemObMcGY5c9jQ80uEY9MP1CitQuf8N418vQY0m1gVIcaDtp6arZA7QCEMYIadisi0csIgHD7G7EOZq2vA0FBmqvtbyJhVGplBJoRVSzgMoRsbmiz8PvpzaFCtktgKPfYhDyAwVdct/qLljSt5ADxd77HkupaA7WZZtQ/rqkrpMStPUyLIuw4d/eyDg/lxPstrkbjdEUXKR7/f9wV58nEki8XiuStxPmtohNT@SHlB74pU5Wp5ZeR/aHWBZEFCJG/px0jfkC8fBpd9k4L8niRcJeFp@gE" rel="nofollow noreferrer">Try It Online</a></p>
</div>
<div id="pu2" class="pu"><h1><a href="http://www.mono-project.com/docs/about-mono/releases/5.0.0/#csc" rel="nofollow noreferrer">C# (Visual C# Interactive Compiler)</a>, 227 bytes</h1>



<pre class="lang-cs prettyprint-override"><code>s=&gt;{var w=s.Split("!")[0].Split(" ").Last();if(!int.TryParse(w,out int n))for(;(w=w.Substring(1)).Length!=0;)s=s.Replace("!",w+"!");else{for(int i=n;--i&gt;0;n=n*i);s=s.Replace(w+"!",""+(n&lt;1?1:n&gt;4?n:0));}return s.Replace("!","");}
</code></pre>

<p><a href="https://tio.run/##bVLBbtswDL3nK2ifpDUJ4rbAgLpObwMKBMOwFOih6EFRmFibQgUSHSML8u0ZXcfDBuwkkI@Pj3yUTROb3OVLQ/YxcXS0HUP/zmFTXVI1Px1MhLZK0@XeO1Z5luu32fsQQa6nC5NY6dJtVOaIpy/x@M3EhKodh4ZBUkBab0JUpWqrdrpsVr2CKrSQkbZcZ9Ws1ElEvuPeG4udzLi96cRK9AlPHb3r5CoqJxM3n5VU0Seny79JH4Rxnt8oeiyeigea3z/Rw0zr8hyRm0jwr0Au3c@XctRtyFABYfv2fspfEXxIDFwj7AzbGu6AA8yEMQLIQzSwCt6ka7x1B6lDuL/Gz9AaYlzDbQYDdttDC2RoEqwa59dgIFFod4auPJE1UaQNI6zQmiYhONk4wV4MhuLzn/6B/BFqI60D4X@yxZAjG3HtVh4zeO4hwgNGSIgEho5cyxnAu5@d0nWK2rBAYHbmVwfasEbYBr8BWxvv5VooxshQbth/GcQlOgKjTGlNwgF4qTH1OxnLjZCP8KPpNhnm@xrEKsdZ53TsK4u7/FyO5NpobK26w8gf2n98I2AtpNfoGBeOUG1UD8l5L78B" rel="nofollow noreferrer" title="C# (Visual C# Interactive Compiler) – Try It Online">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, <s>88 85</s> 83 bytes</h1>



<pre class="lang-ruby prettyprint-override"><code>-&gt;s{s.sub(/\S+!/){|z|z&lt;?1?1:z&gt;?9?z.chars.map{z=z.chop}*'':eval([6,*4..z.to_i]*?*)}}
</code></pre>

<p><a href="https://tio.run/##ZcjNDoIgAADge0@BXlQqjHJtuZSH6GiuQcNy08Eg3QJ5dvq5cvw@NbG37yq/rbXVSE8sza@XdZRndjGLORNMcGlqciIG3Z9UaTRSaU31k5AOJknJZzqkzXEDC4QMeolb30ICM@e8BF0TC0UBEwPVUdyu/vPoZw5GDopgcDD7YA7B7L7jPw" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8</a>, <sup><s>222</s> <span class="math-container">\$\cdots\$</span> <s>178</s></sup> 176 bytes</h1>
<p>Saved 2 bytes thanks to <a href="https://codegolf.stackexchange.com/users/52210/kevin-cruijssen">Kevin Cruijssen</a>!!!<br />
Added <s>2</s> 3 bytes to fix bugs.<br />
Saved 5 bytes thanks to <a href="https://codegolf.stackexchange.com/users/64121/ovs">ovs</a>!!!</p>

<pre class="lang-python prettyprint-override"><code>lambda j:(g:=re.match(r&quot;(.*)\b(\w+)!(.*)&quot;,j).group)(1)+(str(math.perm(int(f)))*-~(f in'1 2')if(f:=g(2))[0]&lt;':'else''.join(f[:i]for i in range(len(f),0,-1)))+g(3)
import math,re
</code></pre>
<p><a href="https://tio.run/##lVPBbtswDL3nKxhfLLVuYCdpmxrzLgMGBNhtBXZIepAd2lbmSIYkt8iC7tcz2mqyDW2B7SCK4iOfRIps967WarZozbHM1sdG7PKNgG3KqjQzONkJV9TMBGxywdc5Wz9d8nGvB9GWTyqju5azhF8y6wwj33rSotkxqRwrOecXVz9ZCVKFCUxDLktWplnFppyv4ocPYRpiYzEMJ1stFStXqXwotQFJAWCEqpA1SHYexdFVQmyXFZvxkdy12jjoL4sMHk12uDcdpl2w7qa3ySyI4LMg2hfD/FPwPHJonYUM2IgF3xAabR24GmFIDmbgNMRjCnwPTAIeUag2AnLdCDv4nk@9oJXr3LtV8pGiEeaD2@k0nXt0CU9COdzAdAxnrHf8DUz/AIaYL@igs5B3stmAAKv0006ogf5tyG@D7AUtq6znohSFoTSFwwikA2mhFZRycnuqwJvw7Pr6ZnE7ny7iu5s4jk@5aNXsoRb0Wq1w7NP4y6aVfu2bvPJMXkq8VIXBjcwbHMPSQwof0YBFVCAUNatUFTTyO9LrBpZzxFk7KS@73wbZC1pLtfwXdl@vWjiCQOzEjx4s9Aah0k0JRS0aatAKqV2oTNK3xX/4S3/DV029pvbQdykUwqInem3uBa1CFD7wvkbrv0sUriPyPWy7/it9fd@DZ3d3yc3C/yEf9RPnIuxnbhiTdARgs5I5TkprhkkOg4N7DuDqIwQHS8rBrGyW4cNzyI@/AA" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>Replaces <code>1!</code> with <code>11</code> and <code>2!</code> with <code>22</code>.</p>
<h3>Ungolfed:</h3>
<pre class="lang-python prettyprint-override"><code>import math,re
def f(j):
 m=re.match(r&quot;(.*)\b(\w+)!(.*)&quot; ,j)
 f=m.group(2)
 if f in ('1','2'):f=''
 if re.match(r&quot;\d+&quot;,f):
     f=str(math.factorial(int(f)))
 else:
     f=''.join(f[:i] for i in range(len(f),0,-1))
 return m.group(1)+f+m.group(3)
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/ETHproductions/japt" rel="nofollow noreferrer">Japt</a>, 27 <a href="https://en.wikipedia.org/wiki/ISO/IEC_8859-1" rel="nofollow noreferrer">bytes</a></h1>
<p>Well, this is just god-awful but I've spent far too long on it to <em>not</em> post it. Kids, let this be a warning against trying to golf without your full faculties about you!</p>
<pre><code>r&quot;(%w+)!&quot;Ï&lt;3?°Y:Yn ÊªYå+ Ôq
</code></pre>
<p><a href="https://petershaggynoble.github.io/Japt-Interpreter/?v=1.4.6&amp;code=ciIoJXcrKSEizzwzP7BZOlluIMqqWeUrINRx&amp;input=WyJhYmNkISIsIldlIGxvc3QgdGhlIG1hdGNoIDMgdG8gMCEiLCJvcmEgYm9sYXMhIiwiZ2l2ZSBtZSA0ISIsIkkgd2FudGVkIDIhIGdpdmUgbWUgMiIsIkxldCB1cyBidWlsZCBhIHNub3dtYW4hIiwiV2UgYXJlIGxhdGUgSXQgaXMgcGFzdCAxNyEiLCJJIG9ubHkgaGF2ZSBvbmUhIiwiSSBvbmx5IGhhdmUgMSEiLCJJbmNyZWRpYmxlISBJIGhhdmUgbmV2ZXIgc2VlbiBhbnl0aGluZyBsaWtlIGl0IiwiV2hhdCBhbiBhbWF6aW5nIGNvZGUgZ29sZiBjaGFsbGVuZ2UgdGhpcyBpcyEiLCJTbyBtYW55IHRlc3QgY2FzZXMhIiwiVGhlc2UgYXJlIGFjdHVhbGx5IGp1c3QgMTEhIiwidGVzdCEgMyIsICIwISIsInRlc3QiXQotbVI" rel="nofollow noreferrer">Try it</a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 57 bytes</h1>

<pre><code>≔⌕θ!η≔⊟⌕Ａ⁺ …θη ζ…θζ≔✂θζη¹ε≡ε2¹1¹0¦1¿ΣεＩΠ…·¹Ｉε⭆ε…ε⁻Ｌεκ✂θ⊕η
</code></pre>

<p><a href="https://tio.run/##bVBLasMwEN37FBOtxuBC3GWyCoZCIQETn0CVJ5aoLCeWlNCUnt0df0hbqDaD3m94o7TsVSftMOy8N43DF@NqvGQgViLNQKfbZCHK7jyRO2uxtNGjAJFB8aEsFZq5y6hmC8PjuLOz7I0L@EdyT38SK2sUTSBbM8jZRcz6mwlKA1IKn4mSnkA8iw3MYTkLZiz/B1s/MKYZrekkow0bMCfAKracmS6CQvqAZd/VUQV8dYobmSsdpWsIc@410qzmtwWyHD7bqsCjOcgz0u/y/DkYx0fZk2uCZmcG75M5@VrO8GjLy3pqyQWqUY@SYdhTgOjhLRpbgwTvulsr3SoZnq72Gw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>

<pre><code>≔⌕θ!η
</code></pre>

<p>Find the position of the <code>!</code>.</p>

<pre><code>≔⊟⌕Ａ⁺ …θη ζ
</code></pre>

<p>Find the position of the start of the word ending in <code>!</code>.</p>

<pre><code>…θζ
</code></pre>

<p>Print the prefix of the input before the word.</p>

<pre><code>≔✂θζη¹ε≡ε
</code></pre>

<p>Extract the word and switch on it.</p>

<pre><code>2¹1¹0¦1
</code></pre>

<p>If it's <code>2</code> or <code>1</code> then output a <code>-</code>, otherwise if it's a <code>0</code> then outputs <code>1</code>, otherwise...</p>

<pre><code>¿ΣεＩΠ…·¹Ｉε
</code></pre>

<p>... if it's an integer then output its factorial, otherwise...</p>

<pre><code>⭆ε…ε⁻Ｌεκ
</code></pre>

<p>... output its prefixes in reverse order. (These are inclusive prefixes, so they include the word itself but not the empty string.)</p>

<pre><code>✂θ⊕η
</code></pre>

<p>Print the suffix of the input after the <code>!</code>.</p>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>22</s> 21 bytes</h1>

<pre><code>;”ḟV$¹ƤṖṚƊfØD$?ċ¡€”!K
</code></pre>

<p><a href="https://tio.run/##VY8xSwNBEIX7@xVvIa1gomAR0MYmaKcYLOfuxruNm1253Us4K7EJaC8iigiWVmKRYJdI/sflj8Q5goXlfPPmzXsDNqZar7urm5d6@nrWms@W7/XsoZ49Le8uFo@HrYOf@/nb6vZDBOqo0T1jax8ydevp52LSiurvr8VEBOfrdZ9hnA8IOWNIIcmxg@CwrSJXEGJnyKso0yPZMnZV1MOYbOAUHYU/3ImOOaD0iEttUhC8deMhWRWJOxXygQIj5oRKz9AB2uOK5Gl7rzF01lTISbyc5f@gLaNNCk51bFiht6GWR1zAM1uQrUKubQajLxvrqJ9TEAoa0nXDE5cyMmcukORkDNuMpasE0NLrxElnWyGwhEnIs7DTnP0mNSWhlJMKg7LJ2la/" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<p>A full program taking a list of words and printing a string. For the 1 and 2 cases the 1 and 2 are dropped from the output. Saved a byte now that a list of words is permitted input. </p>

<h2>Explanation</h2>

<pre><code>Ḳ                      | Split at spaces
                ċ¡€”!  | For each word, if it contains a ! then do the following:
           fØD$?       | - If any characters are left after restricting to digits:
     $                 | - Then:
 ;”ḟ                   |   - Append ḟ (which will filter out 1 and 2 at the next step because x! == x)
    V                  |   - Evaluate (i.e. calculate the factorial and then filter out the input number) 
          Ɗ            | - Else:
      ¹Ƥ               |   - Prefixes
        Ṗ              |   - Remove last
         Ṛ             |   - Reverse
                     K | Finally, join with spaces
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, <s>205</s> <s>201</s> <s>194</s> 189 bytes</h1>



<pre class="lang-r prettyprint-override"><code>s=scan(,'');l=grepl('\\w!',s);w=s[l];n=nchar;k=function(m,x)substr(x,1,n(x)-m);w=k(1,w);b=as.numeric(w);o=`if`(is.na(b),Reduce(paste0,sapply(0:n(w)-1,k,w)),gamma(b+1));s[l]=o;if(o!=w)cat(s)
</code></pre>

<p><a href="https://tio.run/##FY5LbsMwDESvYq9MokwRbyvoBl112xQIrcipYH0MUYLc07vKcgbvDSafp2gxHIGmCZXXz2x3D9Pt1saJBFXT8u1/VNTR/HJWm15rNMWlCIEOlLpIyXDQTBEOvISXsMFMDdWiWd5jDTY7Az0nfXfrHVwvGRakL/uoxsLOUuyVhPfd/8H1I3b2MtPWJ5CeHEKH32ZE9fqhk3IrpFE3NFxA8Py0ZagyLNX5x8CDxNQCx/H8Bw" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
</div>
<div id="pu9" class="pu"><h1><a href="https://github.com/barbuz/Husk" rel="nofollow noreferrer">Husk</a>, 23 bytes</h1>

<pre><code>wm??öΣ↔ḣhȯs§Y→ΠiV√I€'!w
</code></pre>

<p><a href="https://tio.run/##VY8xTsNAEEV7n@JvRUsCEmVqS3QgIsqxPXiXrHeRdx3LdKSIqBEVFVIKGiS6iDo0VLkDvogZK6KgnDeaN//rJiyGql897LZDW81mX9v9pl8//3xu9PdH2L1d9@un/au56h9f0n71fqTaYRjmDOtDRNSMimKucYLocawSXxMybymopDRL2TJOVZKiJRe5wFThD0@Tc45oArLG2AKE4HxbkVOJ2KmWDxQZGefUBIaJMAF3JE8nZ6PQO9tBk7i84/9gIqPLay5MZlkhPVDHS64RmB3IdVEbV8KaxahO5pqiUFBF9yPPfcEovb1BrsladiVLVwlgpNeFl86uQ2QJk1NgYZeawyE15bGRkw63zZh1on4B" rel="nofollow noreferrer" title="Husk – Try It Online">Try it online!</a></p>

<p>Maps 1 to 2 and 2 to 3.</p>

<p>On my phone, so writing an explanation is not too easy, but I'll try.</p>

<p>Code with parentheses for "clarity":</p>

<pre><code>wm(?(?(Σ↔ḣh)(s§Y→Πi)(V√))(I)(€'!))w
</code></pre>

<p>The main part of the code is built by conditionals, they may be a bit easier to read once you know that in Husk <code>?abc</code> means <code>if c then a else b</code>. Also, most of the time <code>fg</code> is the composition of functions <code>f</code> and <code>g</code>, so we are actually applying <code>g</code> before <code>f</code> (to oversimplify it, you should read the code backwards)</p>

<p>A pseudocode for this could be:</p>

<pre><code>Split input into words, map the following function to each word and then join them again.
  If word contains '!':
    if any character of the word is a letter:
      get the head of the word (drop final '!')
      get the list of prefixes (heads)
      reverse it
      join prefixes in a single word
    else:
      convert word to integer
      get the maximum between:
        successor
        factorial
      convert it back to string
  else apply Identity function (do nothing)
</code></pre>
</div>
<div id="pu10" class="pu"><h1><a href="http://www.red-lang.org" rel="nofollow noreferrer">Red</a>, <s>242</s> <s>225</s> 204 bytes</h1>

<pre><code>func[s][c: charset[#"0"-#"z"]parse s[any[change[copy t any c"!"](
case[find"12"t[0]t &lt;"A"[t: to 1 t p: 1 while[t &gt; 1][p: p * t
t: t - 1]p]t &gt;":"[p: copy t until[take/last p append t p p =""]t]])| skip]]s]
</code></pre>

<p><a href="https://tio.run/##RVBNT8MwDL33V7x5F0CaWAenCiZxROIESByiHLLWXcu6JGpcpiH@e3G1DRJFkd6H/eyeq/GVK2OzuhjrwZcmWVMWKBvXJxYzpyUt5vRNNk4AknH@aJT1WzZliEcIFEFJM7JXWekSm7r1FeUrErO0ggd6IiMFJCBXcSz0OzRtx0awRm6NIhE3kGwSYaFQVNuaCpqoc4/BS9sZcTu@7VzSMnAxsq@minofiaxYe/2DtGujtcmOdejZlQ0STAY99MHoglqlYeydKHU3hVrO6MSH3mETtPoF2LZfqmTcX4BnHJwXrrCa4UKuztwLa8iEzdB2FRySD4e98//O4LsjGqem4PkCvwVNotsT1lzT7v56vzes23a9vlIG16n5c1BRnqvCniaKfevF6Jx7HZIWa0KNZDM7/gI" rel="nofollow noreferrer" title="Red – Try It Online">Try it online!</a></p>
</div>
<div id="pu11" class="pu"><h1><a href="https://www.perl.org/" rel="noreferrer">Perl 5</a> <code>-p -MList::Util=product</code>, 93 bytes</h1>



<pre class="lang-perl prettyprint-override"><code>s/(\d+)!/$1?$1&gt;2?product 1..$1:'':1/e;s%(\w+)!%join'',map{substr$1,0,$_}reverse 1..length$1%e
</code></pre>

<p><a href="https://tio.run/##dY8xT8MwEIX3/IqL5ChFJE0dyhJEOyPBiFgqIbs@EiPXtuxLOyD@OiapgE4M93Tv3veG8xjMbUqxWezU9VXeML5lfNNufXBq3BPw5ZLxriw73uBdLBa700QV707bsqwOwn/EUUYKjFerir1@BjxiiDjXDNqeBsYLTOkFwbhIQAPCQdB@gBsgB6sc6g38E/LMBQHSGRHP2J@bZRrpZNbr49RBWJ@JX9euswc4CUuooM0v55kZrcI3bVF9OU/a2ZjqJ6l7bWlaHnWkrnsmbe5//k@1N98" rel="noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>
</div>
<div id="pu12" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 26 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>

<pre><code>ḲṖVN!Ƒ¡!ƲṖƤṚ$&lt;”AẠ$?¹ċ?€”!K
</code></pre>

<p>A full program accepting a string which prints the result.</p>

<p><strong><a href="https://tio.run/##y0rNyan8///hjk0Pd04L81M8NvHQQsVjIM6xJQ93zlKxedQw1/HhrgUq9od2Hum2f9S0Biig6P3//39PhfLEvJLUFAUjRYX0zLJUhdxUBSMA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong></p>

<p>Kind of a tough one for Jelly.</p>

<h3>How?</h3>

<pre><code>ḲṖVN!Ƒ¡!ƲṖƤṚ$&lt;”AẠ$?¹ċ?€”!K - Link: list of characters, s
Ḳ                          - split at space characters -&gt; words
                       ”!  - literal '!' character
                      €    - for each word:
                     ?     -   if...
                    ċ      -   ...condition: count (i.e. contains?)
                  ?        -   ...then: if...
                 $         -            ...condition: last two links as a monad:
             &lt;             -              less than:
              ”A           -                literal 'A' character
                Ạ          -              all?
        Ʋ                  -            ...then: last four links as a monad:
 Ṗ                         -              pop (remove the '!')
  V                        -              evaluate as Jelly code (get an integer)
      ¡                    -              repeat...
     Ƒ                     -              ...number of times: is invariant under?:
    !                      -                factorial
   N                       -              ...action: negate (i.e. 1;2;X -&gt; -1;-2;X)
       !                   -              factorial (-1! = -2! = inf)
            $              -            ...else: last two links as a monad:
          Ƥ                -              for prefixes:
         Ṗ                 -                pop (remove the `!` from each prefix)
           Ṛ               -              reverse
                   ¹       -   ...else: no-op
                         K - join with spaces
                           - implicit, smashing print
</code></pre>
</div>
<div id="pu13" class="pu"><h1>JavaScript (ES6), <s>&nbsp;86 85&nbsp;</s> 80 bytes</h1>

<p>Replaces <code>1!</code> and <code>2!</code> with <code>0</code> ... ¯\_(ツ)_/¯</p>



<pre class="lang-javascript prettyprint-override"><code>s=&gt;s.replace(/\w+!/,g=s=&gt;(s=s.slice(0,-1))?1/s?'1006'[s]||s*g(s-1+'#'):s+g(s):s)
</code></pre>

<p><a href="https://tio.run/##jVNNj9pADD23v8LZHkjKVwIsC5XonpF6a6Uetj04E5PMdphB8QREtf@ddaCwbNitiGQ78bxnx87LI66RValXvmtdRrvFbMezr9wraWVQUdj/tWkH/U4@k2zIM@6x0ZKOO90kiu6TPt@3kjgetx7499MTf85D7ibt1qdW9IXb8iAh2iln2RnqGZeHi/DGlQipM8jBTRR92F/9PpyytRNLXfqxQcz1mmBJMHpFPGYHoyZ@Dhu0njIYBC@oI1WYlc1ooS1lTeI38lAxpJU2GSCwdZsl2mNXYb4NOIS9r50YW27W/kmAJYFBTx3QHjTDCtlDcndW/z3Q8PZ2PLkbDSbxdBzH8eXAzpotFCizOkvB2ayNI2fd/8hJcM2a5laVlOnUUCD190RLayqBiSyg3fpC2xyM/kMyRF2xfpET6XR3vPkXD2Hvayc2t/MrGlxsukAvIMAl/q1hSvQNuTMLUAUaQzYnkAIs2z2MWy/@eo5u9vvuQESwBU/ypRQy8fkWL09rJ6ZQNSv9KIgPCkDlK@m7hceq1khyppH3QMPpNBlPLsUhmjJOzn0hPwJ6VcAQvIP4tezegiS7Zw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>

<h3>How?</h3>

<p>Because the callback function of <code>replace()</code> is recursive, it's better to feed it with a single variable <span class="math-container">\$s\$</span> to keep the recursive calls short. That's why the <code>!</code> is captured along with the word preceding it.</p>

<p>The same <code>slice(0,-1)</code> is used to remove the <code>!</code> on the first iteration and to build the prefixes in case of a string. In order to make the factorial computation compatible with that method, we just have to pad the recursive argument with a random character which is immediately removed by the next iteration.</p>

<p>To deal with the weird edge cases <span class="math-container">\$1!\$</span> and <span class="math-container">\$2!\$</span>, we use the small lookup string <code>'1006'</code> to stop the recursion whenever the value is less than or equal to <span class="math-container">\$3\$</span>. This way, we have <span class="math-container">\$0!=1\$</span>, <span class="math-container">\$3!=6\$</span> and <span class="math-container">\$n! = 6\cdot\prod_{k=4}^{n}k\$</span> for <span class="math-container">\$n&gt;3\$</span>, but <span class="math-container">\$1!=2!=0\$</span> (sic).</p>

<h3>Commented</h3>

<p><em>NB: alternate slash symbols used in the regular expression to prevent the syntax highlighting from being broken</em></p>

<pre class="lang-javascript prettyprint-override"><code>s =&gt;                        // s = input string
  s.replace(                // find in s
    ⁄\w+!⁄,                 // a word followed by a '!'
    g = s =&gt;                // g is a recursive function computing the replacement
      (s = s.slice(0, -1))  //   remove the last character from s
                            //   (for the 1st iteration, it removes the '!')
      ?                     //   if the resulting string is not empty:
        1 / s ?             //     if this is a numeric value:
          '1006'[s]         //       0 -&gt; 1, 1 -&gt; 0, 2 -&gt; 0, 3 -&gt; 6
          || s *            //       for all other values, multiply s by
             g(s - 1 + '#') //       the result of a recursive call with s - 1,
                            //       padded with a '#' for the next slice()
        :                   //     else (s is a string):
          s +               //       append s
          g(s)              //       append the result of a recursive call
      :                     //   else (s is empty):
        s                   //     stop recursion
  )                         // end of replace()
</code></pre>
</div>
<div id="pu14" class="pu"><h1><a href="http://www.snobol4.org/csnobol4/" rel="nofollow noreferrer">SNOBOL4 (CSNOBOL4)</a>, 206 bytes</h1>

<pre><code>&#9;D =84 ** 9
&#9;INPUT ARB . L SPAN(&amp;UCASE &amp;LCASE D) . W '!' REM . R
&#9;W SPAN(D) &#9;:F(S)
&#9;N =W + 1&#9;LT(W,3)&#9;:S(O)
&#9;N =W
F&#9;W =W - 1&#9;GT(W,1)&#9;:F(O)
&#9;N =N * W&#9;:(F)
S&#9;N =N W
&#9;W ARB . W RPOS(1)&#9;:S(S)
O&#9;OUTPUT =L N R
END
</code></pre>

<p><a href="https://tio.run/##LY65DoMwEETr9VcMDdjkkBAUCRIFZxSJ2MgGuU8dhSL/L7Ic1R5vZ2d@3/k9f7JloQbFLUMc4y7oqYdpRGkrXNHDDaWW4VSXrkXYb6VRTDyiIIJtX9xbQX4/ZER5J50SpFF4nJBQP0p/ThXlTppjLzoWML4wfqw4UavswBoxPOWyU8Lts18N9kQedjBOJts/9jFkpnENXPTQnKTVzbKUFdIAdfMH" rel="nofollow noreferrer" title="SNOBOL4 (CSNOBOL4) – Try It Online">Try it online!</a></p>

<p><code>84 ** 9 = 208215748530929664</code> which has all the digits from 0-9.</p>

<pre><code>&#9;D =84 ** 9&#9;&#9;&#9;&#9;&#9;&#9;;* D contains every decimal digit.
&#9;INPUT ARB . L SPAN(&amp;UCASE &amp;LCASE D) . W '!' REM . R
&#9;;* split the input into an ARBitrary Left part, the Word followed by a '!' and the REMainder to the Right part.
&#9;W SPAN(D) &#9;:F(S)&#9;&#9;&#9;&#9;&#9;;* if W has digits, goto S
&#9;N =W + 1&#9;LT(W,3)&#9;:S(O)&#9;&#9;&#9;&#9;;* if W &lt; 3, then N = W + 1 and goto O
&#9;N =W&#9;&#9;&#9;&#9;&#9;&#9;&#9;;* set N = W
F&#9;W =W - 1&#9;GT(W,1)&#9;:F(O)&#9;&#9;&#9;&#9;;* decrement W, and goto O if W == 0
&#9;N =N * W&#9;:(F)&#9;&#9;&#9;&#9;&#9;;* N = N * W, goto F
S&#9;N =N W&#9;&#9;&#9;&#9;&#9;&#9;&#9;;* W is a string, so set N = N W
&#9;W ARB . W RPOS(1)&#9;:S(S)&#9;&#9;&#9;&#9;;* set W to W excluding its final character and if W had any characters, goto S
O&#9;OUTPUT =L N R&#9;&#9;&#9;&#9;&#9;&#9;;* output Left, the New middle, and the Right string.
END
</code></pre>
</div>
<div id="pu15" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <s>157</s> 155 bytes</h1>

<p>Thanks to <a href="https://codegolf.stackexchange.com/users/9481/noodle9">Noodle9</a> for -2 bytes.</p>



<pre class="lang-python prettyprint-override"><code>(*s,w),b=map(str.split,input().split('!'))
w*=1+(w in'1 2')
if'A'&gt;w:
 i=int(w);w=1
 while i:w*=i;i-=1
else:
 d=w[:-1]
 while d:w+=d;d=d[:-1]
print(*s,w,*b)
</code></pre>

<p><a href="https://tio.run/##VZFBa9wwEIXv@hXPe7G9cUq9KRR2caGHFAKFHhrIofQwtidrNVrJSHJU989vRzU59CTm0@jNe5p5jZOzd9fBjYwOu93uWu1Dk@qm7y40VyH6d2E2Ojbazkus6q2qyqKsa5X2XXtTJWhbtjiUtdLP5efyUzoq6E7bWKX6lLpWIU3aMPRRHuiTvhXEJrC0jV36cbxtf761jMd0042nsRs3PPsskx01@76@ij@lts5Hv2QBRL/mA@DfPFQ5R61yMfAccf/ty733zm8dvWd6uT4xjAsRcWJcKA4T7hAd3hfKeULvDIVCnfWr3DI@FOoBiWzkEYcCb/igvnLEEtAv2owgBOvShWyhRJ28TKDIDXSEDphJprUfs5KzZsVEIuIs/w9aKe3gedS94QIPG7X8yh6B2YKs7ErbM4x@kb@M6mmiKBR0oT@Z/9vh2ZlnDBMZw/bMElIMaAn03UlYuyKymBkosLDHicNml4a4yJMVv5bstS3@Ag" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
</div>
<div id="pu16" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E" rel="nofollow noreferrer">05AB1E</a>, <s>26</s> <s>22</s> 26 bytes</h1>

<pre><code>ð¡εD'!¢i¨D.ïiÐ!Ês!*ëηRJ]ðý
</code></pre>

<p><a href="https://tio.run/##yy9OTMpM/f//8IZDC89tdVFXPLQo89AKF73D6zMPT1A83FWsqHV49bntQV6xhzcc3vv/f0lqcYmiAogEAA" rel="nofollow noreferrer" title="05AB1E – Try It Online">Try it online!</a></p>
</div>
<div id="pu17" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 173 bytes</h1>

<pre><code>StringRiffle[""&lt;&gt;If[Last@#=="!",If[NumberQ[n=ToExpression[""&lt;&gt;#]],If[n&gt;0&amp;&amp;n&lt;3&amp;&amp;First@#!="0","",ToString@n],Rest@NestList[Most,#,Length@#-1]],#]&amp;/@Characters/@StringSplit@#]&amp;
</code></pre>

<p><a href="https://tio.run/##bY09a8MwEIb3/gr7BJpU4jRrFASlhYIb2iSb0KCEsyywpSBdS/@9qjRDFy8H73Pvx2xpxNmSv9jiZDlS8sEd/DBMqAG2u7dB9zaTYlJCC6LK/dd8xvSpgzzFl59rwpx9DH9mZszNEXYd52G74fzVp1u2ldCBABCneB9QwYgD1te@nt5n0u8xk2Cix@BoVOxxXauY4Sv1PNpkL4Qpr9Q9fLxOvpYaXj6qpEY5DTHZ5hwnm1swD//Y@W9sZmy6Zbxexk/LeFNxKb8" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>

<p><em>-2 bytes from @Kevin Cruijssen</em></p>
</div>
<div id="pu18" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="noreferrer">05AB1E</a>, <s>23</s> <s>22</s> <s>26</s> <s>25</s> 20 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="noreferrer">bytes</a></h1>
<pre><code>ð¡εD'!åi¨ÐaiηRJë2Lså+!]ðý
</code></pre>
<p>+4 bytes for two bug-fixes (+1 in case the input is without spaces; +3 for <code>0!</code>)<br />
-5 bytes thanks to <em>@Grimmy</em>.</p>
<p>Outputs <code>2</code>/<code>3</code> for <code>1!</code>/<code>2!</code> respectively.</p>
<p><a href="https://tio.run/##ATwAw/9vc2FiaWX//8OwwqHOtUQnIcOlacKoRCFzPs63UkpNXcOww73//0kgd2FudGVkIDAhIGdpdmUgbWUgMiE" rel="noreferrer">Try it online</a> or <a href="https://tio.run/##XY89TsNAFISvMt6GxkL5QaIjTRojaABBgVI82w/vwmYXedeJzAE4ADegQKJMg6ho4j6H4CJm11Eayvnez8xYR7niftXOBH5f3yBm7Vz03Wb7vvuaHyXdh9p@zhN3tvu@Or9cdJvupxfHt2l/L@4Y2joPLxlL8oXEFN5ilIhU2JqQW00uikqtwgbjJIoMazKeS0wSHAaTwC/Yo3HIG6VLEJyx6yWZeBF8qA5e5BmZh3J4pmA7Pt2/s0a3kBQ@WcP/0XgApqi5VLnmBNmeG15xDcdsQKb1UpkKWj0xlI@OknzgoCW9xElhS0Zl9QMKSVqzqTi0DkHU0O/ahv6mhecQqyDHA72R7PbJqfBNOGvx2MTcQ6a4m2AqUojRQYvFHw" rel="noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>ð¡                  # Split the (implicit) input-string on spaces
                    # (NOTE: `#` cannot be used here if the input doesn't contain spaces)
  ε                 # Map each part to:
   D                #  Duplicate it
    '!åi           '#  If it contains a &quot;!&quot;:
        ¨           #   Remove the last character (the &quot;!&quot;)
         D          #   Duplicate it
          !         #   Take the factorial of it (strings remain the same)
           s        #   Swap to get the duplicate value again
            &gt;       #   Increase it by 1 (strings remain the same)
             η      #   Get the prefixes of this string/integer
              R     #   Reverse it
               J    #   And join them together to a single string
                M   #   And then push the largest value on the stack
                    #   (which is either the factorial-integer;
                    #    or the integer+1 if it was 0, 1, or 2;
                    #    otherwise it's the longest string, which is the joined prefixes)
  ]                 # Close both the map and if-statement
   ðý               # And join everything with space delimiter again
                    # (after which the result is output implicitly)
</code></pre>
</div>
<div id="pu19" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language" rel="nofollow noreferrer">Retina</a>, 70 bytes</h1>

<pre><code>' %/!$/&amp;/^[012]!$/(`..
$.(*__
/\D./(^`.
$`
.+
*
_
$.&gt;`$*
~`^
^.$*¶$$.(
</code></pre>

<p><a href="https://tio.run/##jVFLbttADN3PKWhAaQy31cdxHHuTVYFCQHcNkEVaW5TEWNOOOYVmlMBZ5Fg9QC/mcKTGRZIGyIKPnMdHiiJb8pox2x@NPxf7YzhKRlHyLlldpdn0u4TjIo5VFI8n67VKvn2Kk/GqEKJQ8Xs1UWtJnRfRRN0XK7WKo8mf35GI93vbIpTWoBvBx3M4vAKIlbZUG31DsCWY9YrH13SmcrhF9lTDdPSPDpqOa7rWTLX6Qh46B2WnTQ0Iju3tFrlv9P/U4HoMIObYqUsCbAkMevoA2oN28Audh@ysb/Va@uT0dL44m00X6XKepqkMbNnsoEGZ1TL1tc84y/aJLBs9/aGcq5ZqXRqpzgcJ0w214IgYkHe@0bwBo39SmCR84FBxiB6Dv35wPQYQyzl/Q3d12aAXFnCLd4GvbE2wseYaqgaNId4QSIWThQx7erteq68W5B478CSbrNDR0OMlHUCswkpdNOSGW2DlO2m5gx9duNOwxtfSJ8tlNl@k6QM" rel="nofollow noreferrer" title="Retina – Try It Online">Try it online!</a> Link includes test cases. Explanation:</p>

<pre><code>' %
</code></pre>

<p>Split the input into words.</p>

<pre><code>/!$/&amp;
</code></pre>

<p>Only process words that end in <code>!</code>.</p>

<pre><code>/^[012]!$/(`
</code></pre>

<p>If this is <code>0!</code>, <code>1!</code> or <code>2!</code>...</p>

<pre><code>..
$.(*__
</code></pre>

<p>... then return the incremented digit. (Approach shamelessly stolen from @Arnauld.)</p>

<pre><code>/\D./(
</code></pre>

<p>If the word contains a non-digit (excluding the trailing <code>!</code>)...</p>

<pre><code>^`.
$`
</code></pre>

<p>... then replace it with all of its prefixes in reverse order. (Note that these are exclusive prefixes so that the empty prefix is included but the string including the <code>!</code> is excluded.)</p>

<pre><code>.+
*
_
$.&gt;`$*
~`^
^.$*$n$$.(
</code></pre>

<p>Otherwise compute the factorial.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/200650/">200650</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




