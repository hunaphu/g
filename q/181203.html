<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::181203</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>198</td><td>Python3</td><td>241017T142113Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/276177#276177">Ajax1234</a></td></tr>
<tr d-ix="1"><td>039</td><td>Jelly</td><td>190312T084526Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/181367#181367">Nick Ken</a></td></tr>
<tr d-ix="2"><td>050</td><td>CJam</td><td>190312T143922Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/181391#181391">Peter Ta</a></td></tr>
<tr d-ix="3"><td>120</td><td>Java 8</td><td>190311T152620Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/181314#181314">Kevin Cr</a></td></tr>
<tr d-ix="4"><td>080</td><td>Haskell</td><td>190309T114235Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/181220#181220">nimi</a></td></tr>
<tr d-ix="5"><td>044</td><td>Jelly</td><td>190309T231214Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/181233#181233">Nick Ken</a></td></tr>
<tr d-ix="6"><td>028</td><td>Jelly</td><td>190309T174154Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/181224#181224">Jonathan</a></td></tr>
<tr d-ix="7"><td>067</td><td>JavaScript ES6</td><td>190309T082341Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/181211#181211">Arnauld</a></td></tr>
<tr d-ix="8"><td>087</td><td>Python 2</td><td>190309T041258Z</td><td><a href="https://codegolf.stackexchange.com/questions/181203/cycles-on-the-torus/181205#181205">xnor</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 198 bytes</h1>
<pre class="lang-py prettyprint-override"><code>def f(n,m):
 q,c=[(0,0,[(0,0)])],0
 for x,y,p in q:
  if p[1:]and(x,y)==p[0]:c+=1;continue
  if(J:=(x,(y+1)%m))not in p[1:]:q+=[(*J,p+[J])]
  if(K:=((x+1)%n,y))not in p[1:]:q+=[(*K,p+[K])]
 return c
</code></pre>
<p><a href="https://tio.run/##bY0xDoMwDEV3TuGlUlw8EGCoUuUCcATEUAFRGWpCFCQ4PQ10KFRdLD39/77t4p8DZzfr1rXtDBjB9EIVwUiNrkRCCe0Xa6wpicAMDmZayELPMIYe9AZsJVX94FaEBLW2VVKrJtby3gzse566vSYKpUNDLLHEywuRB7@N7LIa4/DtWpCNqyK8@ghlEMS81TkM/xPKTSh3wXV@cgzNal3PXhghSSJGX0oPlP5QdqDsRCnlp@xI@UbrGw" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>54</s> 39 bytes</h1>

<pre><code>ḣ2æ.2ị³¤+4
‘Ç;¥¦%³Ç=4ƊÑÇị$?
çⱮØ½S
’Ñ0xÇ
</code></pre>

<p><a href="https://tio.run/##AVAAr/9qZWxsef//4bijMsOmLjLhu4vCs8KkKzQK4oCYw4c7wqXCpiXCs8OHPTTGisORw4fhu4skPwrDp@KxrsOYwr1TCuKAmcORMHjDh////zQsNA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<p>I’ve posted this as a separate answer to my other Jelly one because it’s a completely different method. This is closer in principle to @Arnauld’s answer. It uses a recursive function that works through every possible path until it reaches a point it’s already got to, and then returns the result of a check whether it’s back to the start. I suspect a few more bytes could be shaved off. Now changed to using slice operator. It works well for up to 5x5. The recursion depth should be at most m x n.</p>
</div>
<div id="pu2" class="pu"><h2>CJam (50 chars)</h2>

<pre><code>q~]:M:!a{9Yb2/\f{_W=@.+M.%a+_)a#g"WAR"=~}}:R~e_We=
</code></pre>

<p><a href="http://cjam.aditsu.net/#code=q~%5D%3AM%3A!a%7B9Yb2%2F%5Cf%7B_W%3D%40.%2BM.%25a%2B_)a%23g%22WAR%22%3D~%7D%7D%3AR~e_We%3D&amp;input=3%205" rel="nofollow noreferrer">Online demo</a>. This is a program which takes two inputs from stdin.</p>

<p>Finally we have an answer to the question</p>

<blockquote>
  <p>War, huh, what is it good for?</p>
</blockquote>

<hr>

<h3>Dissection</h3>

<pre><code>q~]:M        e# Parse input, collect in array, store in M (for moduli)
:!a          e# Zero and wrap in array for starting position (0, 0)
{            e# Define recursive block R
  9Yb2/      e#   Push [[1 0][0 1]], an array of movements
  \f{        e#   For each of those movements, with the current path,
    _W=@.+   e#     Add the movement to the last position in the path
    M.%      e#     Apply the wrapping
    a+       e#     Add to one copy of the path
    _)a#     e#     And find its index in another copy
    g"WAR"=~ e#     Switch on the sign of the index:
             e#       If the sign is -1, position not found, make a recursive call
             e#       If the sign is 0, found at start, push -1 to the stack
             e#       If the sign is 1, we have a self-intersection. We push 10 to
             e#       the stack for no other reason than to make the bad joke above
  }
}:R
~            e# Execute R
e_We=        e# Count the -1s which we pushed as sentinels
</code></pre>
</div>
<div id="pu3" class="pu"><h1>Java 8, 120 bytes</h1>

<pre class="lang-java prettyprint-override"><code>n-&gt;m-&gt;g(n,m,0,0);int g(int n,int m,int k,int l){return(l&gt;&gt;k)%2&gt;0?k&lt;1?1:0:g(n,m,(k+m)%(m*n),l|=1&lt;&lt;k)+g(n,m,k-~k%m-k%m,l);}
</code></pre>
<p>Port of <a href="https://codegolf.stackexchange.com/a/181211/52210"><em>@Arnauld</em>'s JavaScript answer</a>, and also only works for inputs where <span class="math-container">\$n*m&lt;32\$</span>.</p>
<p><a href="https://tio.run/##jZKxboMwFEX3fIWFFMkuxgKSdAjE2Sp16JSx6uASghzbLwhMqihNx35AP7E/QoEwOJk6@Ppdnyc/Xct7cRTBfqvaTIu6Ri9CwnmC0L47Zo2Vmu0ayKw8AHsai/QZbF7kFf1f01hwjnZo1ULATcALDNTQkIYkkWBRgXsF2qsZVA2qybnKbVMB1pwrMo15uFZptI6W4fJ6BVa@IVNsHoBQ/bmK0lQR/4pU8KWmJugW1SS5tMmki1U271pmqLbCdtvxILfIdInxxlYSitc3JEifHiGb1xZHNCKJa2PXxrc0vqcz185u6eyezl07v7Uxfbybu3D9YsSXPqCbbKDOy47RNqfa5oYdGsvKLrXVgMH3qOcb30O/3z/I8yH/GH4CJmzHRFnqEwYyFoaM0y7tHw" rel="nofollow noreferrer">Try it online.</a></p>
</div>
<div id="pu4" class="pu"><h2>Haskell, <s>88</s> 80 bytes</h2>

<pre><code>n#m|let(x!y)a|elem(x,y)a=0^(x+y)|b&lt;-(x,y):a=(mod(x+1)n!y)b+(x!mod(y+1)m)b=0!0$[]
</code></pre>

<p><a href="https://tio.run/##bctBC8IgGMbxe5/iHdtBWYE6T5GfJAqUCY183agdFPzuZh2128OP//PQ76d1LmffY3J2J6GLVCfrLJJwLFOxOwljpMlcTj85a0VwnQty6ktsxvL5QiyA1CjWseF6y6gXDwrm9QCwvRa/wwCkp8CBNyIqEX9kqmRqRIBsmlokyPwB" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>

<p>Simple brute force: try all up/right combinations, dropping those which intersect (we keep all positions we've visited in list <code>a</code>) and counting those which eventually hit positition <code>(0,0)</code> again.</p>

<p>The base case of the recursion is when we visit a position a second time (<code>elem(x,y)a</code>). The result is <code>0^0</code> = <code>1</code> when the position is <code>(0,0)</code> and counts towards the numbers of loops or <code>0</code> (<code>0^x</code>, with <code>x</code> non-zero) otherwise and doesn't increase the number of loops.</p>

<p>Edit: -8 bytes thanks to @xnor. </p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 44 bytes</h1>

<pre><code>×ƝṪ2*Ḥ_2Rḃ€2ċⱮØ½%³¬ẠƲƇịØ.Ṛ,Ø.¤ZÄZ%€ʋ€³ŒQẠ$€S
</code></pre>

<p><a href="https://tio.run/##y0rNyan8///w9GNzH@5cZaT1cMeSeKOghzuaHzWtMTrS/WjjusMzDu1VPbT50JqHuxYc23Ss/eHu7sMz9B7unKUDpA4tiTrcEqUKVHyqG0gc2nx0UiBQnQqQHfz//38THRMA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<p>Works for 4,4, but has complexity <span class="math-container">\$O({2^m}^n)\$</span> so won’t scale that well. </p>

<p>This works by finding all possible routes of up to <span class="math-container">\$mn\$</span> length, filtering out those that don’t end at 0,0, and then excluding those that pass the same point twice. </p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 28 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>ạƝ§=1Ȧ
²‘p/’ŒPÇƇḢÐṂ%⁸QƑƇṪÐṂL
</code></pre>
<p>A monadic Link accepting a list, <code>[m,n]</code>, which yields the count.</p>
<p><strong><a href="https://tio.run/##y0rNyan8///hroXH5h5abmt4YhnXoU2PGmYU6D9qmHl0UsDh9mPtD3csOjzh4c4m1UeNOwKPTQQK7FwFFvD5//@/oY4hAA" rel="nofollow noreferrer" title="Jelly – Try It Online">TIO-jt1qe1v9</a></strong> ...although there is little point, it's way too inefficient.<br />
(I can't even run <code>[2,3]</code> locally with 16GB ram)!</p>
<h3>How?</h3>
<p>Brute force - creates coordinates of a tiled version big enough then filters the power-set of these points to those paths with neighbours only increasing by one in a single direction, then filters to those starting at a minimal coordinate (i.e. the origin) and, at the same time, removes this start coordinate from each. Then uses modulo arithmetic to wrap back to a torus and filters out any containing duplicate coordinates (i.e. those containing intersections) and, finally, filters to those with minimal ending coordinates (i.e. ending back at the origin) and yields the result's length.</p>
<pre><code>ạƝ§=1Ȧ - Link 1: all neighbours differ by 1 in exactly one direction
 Ɲ     - for neighbours:
ạ      -   absolute difference
  §    - sum each
   =1  - equal to one (vectorises)
     Ȧ - any and all? (falsey if empty or contains a falsey value when flattened)

²‘p/’ŒPÇƇḢÐṂ%⁸QƑƇṪÐṂL - Main Link: list of integers, [m,n]
²                     - square (vectorises) -&gt; [m*m, n*n]
 ‘                    - increment (vectorises) -&gt; [m*m+1, n*n+1]
   /                  - reduce with:
  p                   -   Cartesian product
    ’                 - decrement (vectorises) -&gt; all the coordinates of an m*m by n*n grid
                      -                           including [0, 0] and [m*m, n*n] 
     ŒP               - power-set -&gt; all paths going either up OR right at each step, but not
                      -              necessarily by only 1, and
                      -              necessarily both up and right (e.g. [...[1,3],[5,7],[6,2],...])
        Ƈ             - filter keep those for which:
       Ç              -   call last Link (1) as a monad
                      -              ...now all remaining paths do only go in steps
                      -              of one up or one right
          ÐṂ          - filter keep those minimal under:
         Ḣ            -   head - removes the 1st coordinate from each and yields them for the filter
                      -          ...so only those which started at [0,0] but without it
            %⁸        - modulo by the left argument ([m,n]) (vectorises)
                Ƈ     - filter keep those for which:
               Ƒ      -   is invariant when:
              Q       -     de-duplicated
                      -          ...so no repetitions of torus coordinates (and we already removed
                      -          the first [0,0] which must be present exactly twice)
                  ÐṂ  - filter keep those minimal under:
                 Ṫ    -   tail
                      -          ...so only those which ended at [0,0] 
                    L - length
</code></pre>
</div>
<div id="pu7" class="pu"><h1>JavaScript (ES6), 67 bytes</h1>
<p>This shorter version is derived from a Python 3.8 alternate version found by <a href="https://codegolf.stackexchange.com/users/20260/xnor">@xnor</a>. However, this works only for <span class="math-container">\$m\times n&lt;32\$</span> in JS.</p>
<p>Takes input as <code>(m)(n)</code>.</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;n=&gt;(g=(k,l)=&gt;l&gt;&gt;k&amp;1?!k:g((k+m)%(m*n),l|=1&lt;&lt;k)+g(k-~k%m-k%m,l))``
</code></pre>
<p><a href="https://tio.run/##bczNCoJAFAXgfU9hC@Pe1GRGswhnehXFdKg7P5HRKnr1STBcaHDO6uOcW/2q@@ZxvT8T6y6t74Q3QlohQQmgWKOQWkrasPOaTgqAIoMhmK3FWL8FK0vCSAElHwpNMnRYYFX5xtne6XannYIOGA7BIE0DvloI/y98knwp2SiHmWST8D93@UgsW65@VBQzyifi@6P/Ag" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>To have it work for any input, we could use BigInts for <strong>73 bytes</strong>:</p>
<pre class="lang-javascript prettyprint-override"><code>m=&gt;n=&gt;(g=(k,l=k)=&gt;l&amp;(b=1n&lt;&lt;k)?!k:g((k+m)%(m*n),l|=b)+g(k-~k%m-k%m,l))(0n)
</code></pre>
<p><a href="https://tio.run/##dczNCoJAGIXhfVdhC@P7UlNnbJRw7FrUVGr@IqNVdOuTgYGYLd7VwzmX8lH29e18vQfanBrbcqt4oXkBHQfhSy6QF3IDFY91ngs8rsWhAxCeQhfUVqMvn7xCrwMRvISrgiFfIkKk0dZG90Y2O2k6aCHW@AmdMHTI6tfIHyMTSxaMjpbOjE6MLJ0mI8Z0YflFxmaYTJDss5myQdmoWZrRyL4B" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<hr />
<h1>JavaScript (ES6), <s> 76 73 </s> 72 bytes</h1>
<p>Takes input as <code>(m)(n)</code>.</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;n=&gt;(g=(x,y)=&gt;g[x+=y*m]?!x:g(-~x%m,y,g[x]=1)+g(x%m,-~y%n)+--g[x])(0,0)
</code></pre>
<p><a href="https://tio.run/##bcxBDoIwEAXQvafABcmMtAIF0ZgUD2JYEIQGA60RY9oNV68QDAsg@Zv5L/Of@Tfvinf9@lCpHqWtuG15KnkKgoMmBnkq7trj5tBmt72@CqC9dltiyFBnPERPwHjT3rgSPUrHGiEgAdpCyU415bFRAioIcQg6vu@w3UrYtrBZ4rVEk5wXEs3CNubiicJo/fWnJFlQPBM7XewP" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>m =&gt; n =&gt; (         // m = width; n = height
  g = (             // g is a recursive function taking:
        x, y        //   the current coordinates (x, y) on the torus
      ) =&gt;          //
    g[              // the surrounding object of g is also used for storage
      x += y * m    // turn x into a key for the current coordinates
    ] ?             // if this cell was already visited:
      !x            //   return 1 if we're back to (0, 0), or 0 otherwise
    :               // else:
      g(            //   first recursive call:
        -~x % m,    //     move to the right
        y,          //     leave y unchanged
        g[x] = 1    //     mark the current cell as visited by setting the flag g[x]
      ) +           //   add the result of
      g(            //   a second recursive call:
        x % m,      //     restore x in [0...m-1]
        -~y % n     //     move up
      ) +           //
      --g[x]        //   clear the flag on the current cell
)(0, 0)             // initial call to g with (x, y) = (0, 0)
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="https://docs.python.org/2/" rel="noreferrer">Python 2</a>, 87 bytes</h1>



<pre class="lang-python prettyprint-override"><code>f=lambda m,n,z=0,l=[]:z==0if z in l else sum(f(m,n,(z+d)%m%(n*1j),l+[z])for d in(1,1j))
</code></pre>

<p><a href="https://tio.run/##VcqxDoMgFIXhvU9xFxOod1B0asKTGAcbJNLA1agdel@e4gSO3zn/9juXlVSMVvspvM0EAQlZN@j1ML5Y68ZZYHAEHmZ/zHB8g7DiqgTXRlahEvRsPxJ9PfAo7bqDSbloMY0ybrujE@xF@chQGeqOLqMrobAvnwJ9QvwD" rel="noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>

<p>The interesting thing here is using a complex number <code>z</code> to store the coordinate of the current position. We can move up by adding <code>1</code> and move right by adding <code>1j</code>. To my surprise, modulo works on complex numbers in a way that lets us handle the wrapping for each dimension separately: doing <code>%m</code> acts on the real part, and <code>%(n*1j)</code> acts on the imaginary part.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/181203/">181203</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




