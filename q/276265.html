<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::276265</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>040</td><td>Prolog SWI</td><td>241027T154756Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276351#276351">Unrelate</a></td></tr>
<tr d-ix="1"><td>469</td><td>Scala 3</td><td>241027T133358Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276349#276349">138 Aspe</a></td></tr>
<tr d-ix="2"><td>108</td><td>OCaml</td><td>241027T083208Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276346#276346">Merlin04</a></td></tr>
<tr d-ix="3"><td>182</td><td>Python3</td><td>241024T185358Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276311#276311">Ajax1234</a></td></tr>
<tr d-ix="4"><td>085</td><td>Python 3</td><td>241024T231629Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276319#276319">apilat</a></td></tr>
<tr d-ix="5"><td>038</td><td>oK</td><td>241024T175055Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276310#276310">zgrep</a></td></tr>
<tr d-ix="6"><td>051</td><td>JavaScript Node.js</td><td>241023T065738Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276267#276267">l4m2</a></td></tr>
<tr d-ix="7"><td>040</td><td>Charcoal</td><td>241023T234253Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276295#276295">Neil</a></td></tr>
<tr d-ix="8"><td>199</td><td>Retina 0.8.2</td><td>241023T065105Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276266#276266">Neil</a></td></tr>
<tr d-ix="9"><td>052</td><td>JavaScript Node.js</td><td>241023T070624Z</td><td><a href="https://codegolf.stackexchange.com/questions/276265/check-subtype-relation-in-a-simple-type-system/276268#276268">tsh</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="http://www.swi-prolog.org" rel="nofollow noreferrer">Prolog (SWI)</a>, 40 bytes</h1>
<pre><code>_+t.
A*B+C*D:-A+C,B+D.
A/B+C/D:-C+A,B+D.
</code></pre>
<p><a href="https://tio.run/##bY4xCoAwDEV3T5HRJtbsLlLrPRxFEBQtePwaGysibj/vv5Cs2zIvo92PKcaBQl047Mhj31hHvuqoF8JCWIgnl0hsLQQgEDslhjIAQjDCNIERqHV59VLhlUil5LyXOWvaPuPtKMsb@CH5OP@Y38dMuhxP" rel="nofollow noreferrer" title="Prolog (SWI) – Try It Online">Try it online!</a></p>
<p>Can't get much more to the point than this! Represents <span class="math-container">\$\top\$</span> as the atom <code>t</code>, <span class="math-container">\$S \times T\$</span> as the term <code>S * T</code>, and <span class="math-container">\$S \rightarrow T\$</span> as the term <code>S / T</code>; outputs through success or failure.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.scala-lang.org/" rel="nofollow noreferrer">Scala 3</a>, 469 bytes</h1>
<p>Golfed version. <a href="https://ato.pxeger.com/run?1=nVI9b9swEEU75lccMhgkwjiSsgRCaSAturVAgKCTYRi0TMVyKMqg6NSE4l-SJUuyFP05WfJrQlJSLfijKarheLr3-Hh8x4fnMmGCnf8aHp_K4idT8nj0u5jMeaLhO8skVE9LnZ5evH54mfIUUsTiS2nIxEUcfy4KwZmkiJEJzplOZtURQMJKjgJboYMJpUFbGZPAVsJPUVtYxd-yUg_HI2LazBIsCpClaNXPyq_5Qpv7e9OmOGWi5J7BbVL5DOCOCUiok0DIRx8CEmHis5CcY0xCTDpoZLvpohHGGzU0JwJT28KMsylZ9TXLRBe-JbmFTQ2bbRiWVJyc5E0h6fOVPaas_J0V0e0d3acpnfd6Nt72eqqfFooJUS06BEtRpkrREi1QYNt0a4gxXncYiTfeycOYDrxFG7jN6nXdeO-I4SA6WjfT_TgDcPPN7cgRUzdlDJdKMTO81iqTNyMcww-ZaaBQe352Bl8KeceVhiujZ4UEyUvNpyDcVUEXcO2elecurIIWEqV2IhA0Nm-KzTTAgs04oOY1_9FW3WN7RcLNjoa5V_DP_3ud7KRuz9-wbcFdxuETd9s9RN5x459OCQ87HP6Pw3u6CN4VXLcP7vGxXt8A" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre class="lang-scala prettyprint-override"><code>def f(a:Any,b:Any):Boolean=(a,b)match{
  case(0,b)=&gt;b==0
  case(_,0)=&gt;1&lt;2
  case(x:List[_],y:List[_])=&gt;
    if(x.isEmpty||y.isEmpty)false
    else{
      val c=List((List(List(0,2),List(1,3)),1),(List(List(2,0),List(1,3)),2))
      val(j,l)=(x.head,x.tail)
      val(k,m)=(y.head,y.tail)
      val u=l++m
      c.exists{case(r,t)=&gt;
        t==j&amp;&amp;t==k&amp;&amp;r.forall{p=&gt;
          try{f(u(p(0)),u(p(1)))}
          catch{case _=&gt;false}
        }
      }
    }
  case _=&gt;1&gt;2
}
</code></pre>
<p>Ungolfed version. <a href="https://ato.pxeger.com/run?1=nVbNjtMwED4i9SnmtEq0oZt2L6hSkXZhxSIBQlp6WlWVkzpbQ-JUtls16vZJuOwFHopn4cDYzp_TlEX04Nrzzc_n8cwo33_KmKTk8unpx0YlL1_9evE7j77SWMFHwjjsBwAXF3BL0zUVoIo1hSQXEFGlqrMkCVUFEL6ENdFiDhlR8YrxBzQ2Kp-oVHT5gUkFU7jixQCBJU0g8cikBQYQtY_-BK7zPKWEo5UmAuAR1PGt_1Jk-F0TSSHGRZYyvQcvNNrT1xDBdAqhgy0CCA2mxIaWSOPQXF7QeCMk21rX5uIp8nJjEE11Anq9X8wxoHPWEUp1AJaU6kMmb7I1Ju3x0epXAh9jqg1mMCGppLVhvUFmb2nCODLK-ZIplnMJkmUsJfgaOXwu1CrnsKVIO-e12ZakLYOSnGdWs7znao7U8c-fY661zKuNMetGYBbM6NgPrMYogEsfDyM_6Fce6xR3lMd-rev33u8dVZAwgaVCU5pRrqQpLUEzfBKsKecJ7NU8ckvJMgDyhbAUM15leWWlZq805FpF1iqqraKWVdRj1ab5Js8i_Q4Nr4quE2SGfg0tOD-3kfq9rWj8rfVENdaIhnSnLw77su5EAMqpLuw1XeUmF3B2Zk9Rddq39FohSZpi12K6IU_64uufGGLla8W9UXVjmrii6Pivrr_D62sbL_R78aLCR_34RjuYebsTaGHQ4hhNvM0uQLyLHDB57dHR_ExSFxO42cV0rXOgR4PbhaWLwalTsz90HxnzjWMPcrXCqWlC2T6XTgjLwQ2sXR2qealLzSPiAVv4SghS3N8pgaU3x0k540zVY9LUJ8cpoKqJwM1Utb2jB8WdHvpGd40eVMq9RPd26PsdYd3ITR9bvfI87sgN1utk1FiE7mBwHNbn55gcbbXN37Cuw2ON0xGP6Z5SPsrGP0UZnc7w6H8y3MMifNbhYXCwHwHlt0D1TfAH" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre class="lang-scala prettyprint-override"><code>object Main {
  // Helper type for better type safety and pattern matching
  type NestedList = Any

  def f(a: NestedList, b: NestedList): Boolean = {
    (a, b) match {
      // Base cases
      case (0, b) =&gt; b == 0
      case (_, 0) =&gt; true
      
      // Main recursive case for lists
      case (aList: List[_], bList: List[_]) =&gt;
        if (aList.isEmpty || bList.isEmpty) return false
        
        // Define conditions similar to Python version
        val conditions: List[(List[List[Int]], Int)] = List(
          (List(List(0, 2), List(1, 3)), 1),
          (List(List(2, 0), List(1, 3)), 2)
        )
        
        // Get first elements and remaining lists
        val (aHead, aTail) = (aList.head, aList.tail)
        val (bHead, bTail) = (bList.head, bList.tail)
        
        // Combine remaining elements
        val U = aTail ++ bTail
        
        // Check conditions
        conditions.exists { case (r, t) =&gt;
          t == aHead &amp;&amp; t == bHead &amp;&amp; {
            // Check all pairs of conditions
            r.forall { pair =&gt;
              try {
                val x = pair(0)
                val y = pair(1)
                val ux = U(x)
                val uy = U(y)
                f(ux, uy)
              } catch {
                case _: Exception =&gt; false
              }
            }
          }
        }
        
      // Any other case returns false
      case _ =&gt; false
    }
  }

  def main(args: Array[String]): Unit = {
    // Convert Python nested lists to Scala
    println(f(0, 0))
    println(f(List(2, 0, List(1, 0, 0)), List(2, List(1, 0, 0), 0)))
    println(f(List(1, List(2, 0, 0), List(1, 0, 0)), List(1, 0, 0)))
    println(f(List(2, 0, List(2, 0, List(2, 0, 0))), List(2, 0, List(2, 0, 0))))
    println(f(0, List(2, 0, 0)))
    println(f(List(2, 0, 0), List(1, 0, 0)))
    println(f(List(2, List(1, 0, 0), 0), List(2, 0, 0)))
    println(f(List(1, 0, List(1, 0, 0)), List(1, List(1, 0, 0), 0)))
    println(f(List(1, List(2, List(1, 0, 0), 0), 0), List(1, List(1, 0, 0), 0)))
  }
}
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="http://www.ocaml.org/" rel="nofollow noreferrer">OCaml</a>, 108 bytes</h1>

<pre class="lang-ml prettyprint-override"><code>type t=T|D of bool*t*t
let rec h=function D(g,a,b),D(j,c,d)-&gt;g=j&amp;&amp;h(if g then c,a else a,c)&amp;&amp;h(b,d)|_,b-&gt;b=T
</code></pre>
<p><a href="https://tio.run/##fVDLboMwELzzFSMfIhs5/YAiOHHs0bc@EBDziChEsIkUiX@nttM8oDQXyzszO7O7XZ5@N9NE54MGhWqM0RXIuq7xySev0YRe56jC4tjmVHctYl7KVGZCxnwvc7kT26gM95tNxesCJajSLXKZQjeDRipzYanM6MZEZtsoC9UUBN7NeaC@bsukKxJCiGuKB4xQ2EZgqjswV9pgDBIkHM4Zvmbdg6kfZmBOdRmDwQcTCz2Zmgl2HeZOpX05gKcSmTAjPbaktuWDlsmZ9XirB3qpSffgZgucbDz4CWOEyj73BntdOwx7xdLLRbueg4Eo0e2uqVst8O5xH9QfqTrDFx5XEkoEHo@5AbUppLlPkZpl3V8JYYELNycc6Tp/0QcLJVZtZsAydO1rZOIZF9htrOttmblgnqGeDvF3u1W3u@j/BVcP9Tn9AA" rel="nofollow noreferrer" title="OCaml – Try It Online">Try it online!</a> (includes test cases)</p>
<p>Input to the function <code>h</code> is a tuple of two values of type <code>t</code>:</p>
<ul>
<li><span class="math-container">\$\mathbf{Top}\$</span> is <code>T</code></li>
<li><span class="math-container">\$S \times T\$</span> is <code>D(false, S, T)</code></li>
<li><span class="math-container">\$S \to T\$</span> is <code>D(true, S, T)</code>.</li>
</ul>
</div>
<div id="pu3" class="pu"><h1>Python3, 182 bytes</h1>
<pre class="lang-py prettyprint-override"><code>def f(a,b):
 if a==0:return b==0
 if b==0:return 1
 for r,T in[([[0,2],[1,3]],1),([[2,0],[1,3]],2)]:
  U=a[1:]+b[1:]
  if T==a[0]and T==b[0]and all(f(U[X],U[Y])for X,Y in r):return 1
</code></pre>
<p><a href="https://tio.run/##fU9BCoMwELz7ij0auoeNvRTBX1RQQg4JNlQoqQR76OvtRq1abAthmZlMZjbds7/e/fHUhWFoLg5catCKPIHWgSkKysOlfwQPlvEo2o0oE3D3AAHP0HqVKkWYaVQSj1qjFMhKhrQomdAcDGVhlMz1wcbJnEPPBWukjW8itDM0t1vq0lJVGktVaxG7Kqy5C4JYdhi60PqejYQkRPJmsTkWs8rVwHQmfLY2iaNz2vJtntAubRnsmjJXvjHTfLVPoF/h625f38rPv8h/f9lE0d48vAA" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 85 bytes</h1>

<pre class="lang-none prettyprint-override"><code>f=lambda s,t:t==0if t==0 or s==0else(t[0]==s[0])&amp;f(s[2],t[2])&amp;f(*[s[1],t[1]][::s[0]])
</code></pre>
<p><a href="https://tio.run/##fVDLDoIwELzzFXsy1NQE9NakX9L0gEqjCbaE3YtfX1sQEIpc9jEzu9Nt@6aHsxfvjWyq1/VeAXISJGXxNBATuA4w5LrBOidVaCkxRHYwOaqz5hRCbI4KVRnbUmslRNRo5sm1IKHIbp1DDNXkASRAlbyvdGZswp0mMqsQ647A5GFbQFzLZsjYAe0NZgHjEJgV@KXm4YEfVwySdNEaSc3XuZexf/g4b91000Kw5Pdfl2g3T941@Jn4d/v2P/oP" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>Uses <code>0</code> for Top, <code>[1,S,T]</code> for <span class="math-container">\$S \times T\$</span>, <code>[-1,S,T]</code> for <span class="math-container">\$S \to T\$</span>.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/JohnEarnest/ok/" rel="nofollow noreferrer">oK</a>, 38 bytes</h1>
<pre><code>{$[*x&amp;x=y;&amp;/o.'(.*x;_)@'1_+(x;y);*~y]}
</code></pre>
<p><a href="https://tio.run/##dY/RCoIwFIbvfYpzEbpZ6Yq6qEPQe4iF1AahuXBGk6hXX0tUVArGdvjOf/7zL53L1BixfU4iX7t6V6EbysAjBwx8jUe696ZEY0XRf1fxy4RQFncOXCfXW8YVyBzEpVAlFPIxA5Fkin@Z4ieZnx1CQEQMEFjsANiaLJYrZEg2a3szSm2rRi2wp1Va0qgtHgw09chy8Fhl592HMVAH2lAdHjqxf0t6IX9N191x0P7HgFLzAQ" rel="nofollow noreferrer" title="K (oK) – Try It Online">Try it online!</a></p>
<p>The input is encoded as follows, whether or not it's reasonable depends on how charitable you're feeling:</p>
<ul>
<li><span class="math-container">\$\textbf{Top}\$</span> is <code>0</code></li>
<li><span class="math-container">\$X \times Y\$</span> is <code>(95;X;Y)</code></li>
<li><span class="math-container">\$X \to Y\$</span> is <code>(124;X;Y)</code></li>
</ul>
<p>Output is <code>1</code> for true and <code>0</code> for false.</p>
<p>Translation:</p>
<pre><code>{                                    } /function(x, y):
      x=y                              /  ans = (x == y)    // element-wise
    x&amp;                                 /  ans = min(x, ans) // element-wise
   *                                   /  ans = first(ans)
 $[      ;                      ;   ]  /  if ans:
                           (x;y)       /    ans = [x, y]
                          +            /    ans = transpose(ans)
                        1_             /    ans = drop_first(ans)
                .*x                    /    f1 = eval(first(x))
                                       /    // eval interprets int as char:
                                       /    //    95 → &quot;_&quot; → floor
                                       /    //   124 → &quot;|&quot; → reverse
                    _                  /    f2 = floor
               (   ; )@'               /    ans = map(apply, zip([f1, f2], ans))
            o                          /    o = this function
             .'                        /    ans = map(uncurry, zip([o, o, …], ans))
          &amp;/                           /    return fold(min, ans)
                                       /  else:
                                 *~y   /    return first(not y)
</code></pre>
<p>Explanation:</p>
<ul>
<li><code>*x&amp;x=y</code> is true when <span class="math-container">\$X = Y \not= \textbf{Top}\$</span>
<ul>
<li>This lets us recurse only when <span class="math-container">\$X \in \{A \to B, A \times B\}\$</span> and <span class="math-container">\$Y \in \{C \to D, C \times D\}\$</span>.</li>
<li><code>1_+(x;y)</code> gives us the array <span class="math-container">\$[[A, C], [B, D]]\$</span></li>
<li><code>(f;g)@'</code> zip-maps, giving <span class="math-container">\$[f([A, C]), g([B, D])]\$</span></li>
<li><code>_</code> floor acts as an identity function</li>
<li>If <span class="math-container">\$X = \cdot \to \cdot\$</span>:
<ul>
<li><code>.*x</code> is reverse, so the array is <span class="math-container">\$[[C, A],[B, D]]\$</span></li>
</ul>
</li>
<li>Otherwise:
<ul>
<li><code>.*x</code> is floor, so the array is <span class="math-container">\$[[A, C], [B, D]]\$</span></li>
</ul>
</li>
<li>Given <span class="math-container">\$[[w,z],[B,D]]\$</span>, <code>o.'</code> recurses to check both <span class="math-container">\$w &lt;: z\$</span> and <span class="math-container">\$B &lt;: D\$</span>.</li>
<li><code>&amp;/</code> returns true iff both are true.</li>
</ul>
</li>
<li>Otherwise <span class="math-container">\$\textbf{Top} \in \{X, Y\}\$</span>:
<ul>
<li>Return <code>*~y</code>, which is true iff <span class="math-container">\$Y = \textbf{Top}\$</span>.</li>
</ul>
</li>
</ul>
<hr />
<p>A similar 38-byte solution:</p>
<pre><code>{$[*x&amp;x=y;&amp;/o.'(^;.*x;_)@'+(x;y);*~y]}
</code></pre>
<p>And if the input is a two-element array, as opposed to two arguments:</p>
<pre><code>{$[**x&amp;*=/x;&amp;/o'(.**x;_)@'1_+x;**~|x]}
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 51 bytes</h1>

<pre class="lang-none prettyprint-override"><code>f=(x,y)=&gt;y?x&amp;&amp;f(x.b,y.b)&amp;f(x.a,y.a)+f(y.A,x.A):x&gt;=x
</code></pre>
<p><a href="https://tio.run/##bVDRjoMgEHz3K3hq4A4p9NEGjN9hyBU9NHchtdG2WdL02z2KRq@9I5vJ7DA72ey3uZqh7r9O5/TYfdpxbCQG6olUPofNpsHAKupZRSI1gRry3mDPCgqsIBkoCeM@aSVIBTmUXEsp8pvJWgyl0IRWke00uWe34j@V75NDwhFHqULn/mKTckc5LUUArjUK3cxDrR5Boy2oq3MiLzkLBEtMW9vFydEsPZTGuGEe5k@hy8evff7Oiaflxcvyk@nAentyprZ4i9kbQRFStW0pwh90On/dHYfOWea6FoeDt9hejcNACJ2pJ483/gA" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p><code>{A:_,b:_}</code> as arrow, <code>{a:_,b:_}</code> as mult,</p>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 40 bytes</h1>
<pre><code>¹⊞υＡＦυＦ…§ι¹¦¹¿κ¿⁻κ§§ι⁰¦⁰⎚Ｆ²⊞υＥ⎇∧λ⊖κ⮌ιι⊟μ
</code></pre>
<p><a href="https://tio.run/##VU6xCoMwEN37FTfeQQrVtZPYxUGQ0i10CHrFYIwSjdSvT2OlpR3evXfH492rW@XqQZkQKqftjAmdD5WfWvQCCjv6GSleHoMD9ARvztfacN4OI2ZzYRt@ohaQ0AYC/QDsdiq19RN2Aj62H/uJNhDkhpVDOgObiff4lOBToFQj3thZ5VbMbINGwIVrxz3bmZv4J6ZceWE3MeqoN1SxV0@xdAhSykTIVMjTfUMcyVf/L/dwXMwL" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Takes input as a list of the two types and uses <code>[0]</code> for Top and outputs a Charcoal boolean, i.e. <code>1</code> for subtype, nothing if not. Explanation:</p>
<pre><code>¹
</code></pre>
<p>Assume that the first input element is a subtype of the second.</p>
<pre><code>⊞υＡＦυ
</code></pre>
<p>Start by considering the two input types.</p>
<pre><code>Ｆ…§ι¹¦¹
</code></pre>
<p>Get the kind of the second type.</p>
<pre><code>¿κ
</code></pre>
<p>If the second type is not Top, then...</p>
<pre><code>¿⁻κ§§ι⁰¦⁰⎚
</code></pre>
<p>... if the two types are different then they are not subtypes, otherwise...</p>
<pre><code>Ｆ²⊞υＥ⎇∧λ⊖κ⮌ιι⊟μ
</code></pre>
<p>... take the two pairs of inner types, reverse the first pair if necessary, and save both pairs for further processing.</p>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language/a950ad7d925ec9316e3e2fb2cf5d49fd15d23e3d" rel="nofollow noreferrer">Retina 0.8.2</a>, <s>219</s> 199 bytes</h1>
<pre><code>^({(({)|(?&lt;-3&gt;})|\w)+)p((({)|(?&lt;-6&gt;})|\w)+},)({(({)|(?&lt;-9&gt;})|\w)+)p(?(9)^)
$7x$4$1x
^{((({)|(?&lt;-3&gt;})|\w)+)x((({)|(?&lt;-6&gt;})|\w)+)},{((({)|(?&lt;-9&gt;})|\w)+)x((({)|(?&lt;-12&gt;})|\w)+)}$
$1,$7¶$4,$10
+%)A`,T$
^$
</code></pre>
<p><a href="https://tio.run/##bY1BCsIwEEX3c44RZmgEo8VSkBTvMEspdeHCjRQRDKS5lgfwYjFGUysUhvmfP48/19PtfDmGBVFnoA8tOSLHAzW75cZ4Hg53LrinMdzm0CuesPWEbajmlgEriyVqC62jmU4708leTdh6jtXrH4yAWmH1fGCpUK@gWPC@U4LQYgiiBJwYJ1Z8rE1qxEN0UWzO3/LhTDqk7GtBVDKQdmZz03izfz/ivAA" rel="nofollow noreferrer" title="Retina 0.8.2 – Try It Online">Try it online!</a> Link includes test cases. Explanation:</p>
<pre><code>^({(({)|(?&lt;-3&gt;})|\w)+)p((({)|(?&lt;-6&gt;})|\w)+},)({(({)|(?&lt;-9&gt;})|\w)+)p(?(9)^)
$7x$4$1x
</code></pre>
<p>Match <code>{S'pT},{SpT'}</code> and turn it into <code>{SxT},{S'xT'}</code>.</p>
<pre><code>^{((({)|(?&lt;-3&gt;})|\w)+)x((({)|(?&lt;-6&gt;})|\w)+)},{((({)|(?&lt;-9&gt;})|\w)+)x((({)|(?&lt;-12&gt;})|\w)+)}$
$1,$7¶$4,$10
</code></pre>
<p>Match <code>{SxT},{S'xT'}</code> and split it into <code>S,S'</code> and <code>T,T'</code>.</p>
<pre><code>+%)A`,T$
</code></pre>
<p>Delete any conditions where the RHS is <code>T</code> and repeatedly process any remaining conditions.</p>
<pre><code>^$
</code></pre>
<p>Check that there are no left-over conditions.</p>
<p>The input format is as follows:</p>
<ul>
<li>A condition <code>S &lt;: T</code> to be tested takes the form <code>S,T</code> where <code>S</code> and <code>T</code> are types.</li>
<li>A type can be of the form <code>T</code> (representing Top), <code>{SpT}</code> (representing <code>S -&gt; T</code> or <code>{SxT}</code> (representing <code>S * T</code>).</li>
<li>The test harness allows for multiple conditions each on their own line.</li>
<li>As a convenience, the test harness also allows <code>&gt;</code> in place of <code>p</code>.</li>
</ul>
</div>
<div id="pu9" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 52 bytes</h1>

<pre class="lang-none prettyprint-override"><code>f=([a,b,c],[x,y,z])=&gt;~x?a-x||f(c,z)|f(a?y:b,a?b:y):0
</code></pre>
<p><a href="https://tio.run/##fVLLbsIwELznK/aGrTrB5ggKnPoVUVQc16FUKY5sg4DS/nq6MXlAi3qxPTszu6tdv8uDdMpuax/vzKtumjIlmWQFUznLjuzEzjlNl9/HlYyPl0tJFDtTvOTqNC@YXBXzE53zppbWaUjBQLqEzwhgWwJBkAKnYLXf2x1kscgXPZXxvGXFyHIGIQtyIqcjmOU02Hqd@Ff3FXntvJJOO2xnHUUcOMRL8HavI/RyhoX7e4jPEHdBZGf9@04jWJBhdFQ@zDMcKAnZRjgoOXShNlLKynXm@@YG4qafvz5x17z41fxVFK2TD@nVG5kmT9MNRVAT2@@q0h5w5VAweGGgcDFgE1dXW08mMKG3w78OWx9kRSQdhh9w0eLwUmERdNxEUhr7LLE66cqY9k@F2srsnKl0UpkNwV@FLGYxtPUvmh8" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>Use <code>[-1]</code> for <span class="math-container">\$\mathbf{Top}\$</span>, <code>[0,S,T]</code> for <span class="math-container">\$S\times T\$</span>, <code>[1,S,T]</code> for <span class="math-container">\$S\to T\$</span>.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/276265/">276265</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




