<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::276637</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>086</td><td>Ruby</td><td>241113T153619Z</td><td><a href="https://codegolf.stackexchange.com/questions/276637/perfect-ruler-search/276660#276660">G B</a></td></tr>
<tr d-ix="1"><td>140</td><td>JavaScript ES7</td><td>241113T012919Z</td><td><a href="https://codegolf.stackexchange.com/questions/276637/perfect-ruler-search/276652#276652">Arnauld</a></td></tr>
<tr d-ix="2"><td>016</td><td>Jelly</td><td>241112T191154Z</td><td><a href="https://codegolf.stackexchange.com/questions/276637/perfect-ruler-search/276649#276649">Jonathan</a></td></tr>
<tr d-ix="3"><td>026</td><td>Pyth</td><td>241112T164159Z</td><td><a href="https://codegolf.stackexchange.com/questions/276637/perfect-ruler-search/276643#276643">CursorCo</a></td></tr>
<tr d-ix="4"><td>039</td><td>K ngn/k</td><td>241112T162934Z</td><td><a href="https://codegolf.stackexchange.com/questions/276637/perfect-ruler-search/276642#276642">att</a></td></tr>
<tr d-ix="5"><td>033</td><td>05AB1E</td><td>241112T155233Z</td><td><a href="https://codegolf.stackexchange.com/questions/276637/perfect-ruler-search/276641#276641">Kevin Cr</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, 86 bytes</h1>

<pre class="lang-none prettyprint-override"><code>-&gt;n{(1..2&lt;&lt;n).select{|x|(1..n).all?{|y|x&amp;x&lt;&lt;y&gt;0}}.group_by{|x|x.digits(2).sum}.min[1]}
</code></pre>
<p><a href="https://tio.run/##FYtLCoAgFAD3naJV2KJHCbWyOkhI9Ecwk0pQ1LNbrgaGmVvNJuxtKDphUQWACRE5PBvfltc67aL7xcR5b51xOtOEmK70Ho77UnKcTaw0rOxg74Pw/6rTw8nEUFEfZLoPNU0iGho@" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
<p>First check which numbers are complete rulers, by means of arithmetic shift and bitwise <code>and</code>, then group by number of marks  (popcount) and take the minimum.</p>
</div>
<div id="pu1" class="pu"><h1>JavaScript (ES7), 140 bytes</h1>
<p>Returns the rulers as a single string made of binary digits and newlines.</p>

<pre class="lang-none prettyprint-override"><code>f=(n,N)=&gt;(g=q=&gt;++q&gt;&gt;n+1?&quot;&quot;:((h=j=&gt;~j?q&gt;&gt;j&amp;1**h(j-1)&amp;&amp;a.push(a.map(x=&gt;h|=1&lt;&lt;j+~x)&amp;&amp;j)&lt;N:a=[])(n)+h&gt;&gt;n?q.toString(2)+`
`:&quot;&quot;)+g(q))``||f(n,-~N)
</code></pre>
<p><a href="https://tio.run/##XY7NasMwEITveQphitnN1qbq0fHKb@BLj6UgkdpWhCP5LyEQx6/u6tzTN8zAxzhzN/N5ugxL5sNvs@8tg3@vkRV0PLIiGpXyJKskKQAsO1abq2LnUnk8WnCZxDQ1@XCbLZj8agZ4sLIry7J0tD3i6LCsC8PfPwgeyUZdNeZL@Fqmi@/gE0kfdJEkSB2MiFqvaxsvZFuNexsm6JtFeMFCniLKyI8YiFA8D0Kcg59D3@R96EB7fnv6l8bTvyHqMJav/Q8" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>Slower but not limited by the size of the call stack: <a href="https://tio.run/##XY7NasMwEITvfYqtCI4UYRcVeom8yhv40mNbiEjtKMLd9V9CIE1e3ZWvPc0wH8NM9Bc/HoZTN@XE3/Xc4Ezo6otv5brhQVbIKIR9ZltprZakR1OWpI3N894qGTCie8Rd71zMzGYTZMyNyrLqxRfdeQzSFz@@k1d04XdpRv24JhzV1uPHl5KkdHCOdqyxLyZ@n4YTHeWr0gLEltdqXjbbegICBGOTlEnfkkl/4PYEcGAaua2Llo9yT7i60X2v7D/QpCHQID5JJHaf/wA" rel="nofollow noreferrer">142 bytes</a></p>
<h3>Commented</h3>
<pre class="lang-none prettyprint-override"><code>f = (                   // outer recursive function taking:
  n,                    //   n = input
  N                     //   N = exclusive upper bound for the number of
) =&gt;                    //       marks in the ruler (initially undefined)
( g = q =&gt;              // inner recursive function taking q
  ++q &gt;&gt; n + 1 ?        // increment q; if q has more than n + 1 bits:
    &quot;&quot;                  //   stop
  :                     // else:
    (                   //
      ( h = j =&gt;        //   h is a recursive function taking j
                        //   NB: h is reused as a bitmask to test the ruler
        ~j ?            //   if j is not equal to -1:
          q &gt;&gt; j &amp;      //     test the j-th bit of q
          1 ** h(j - 1) //     do a recursive call to h with j-1
          &amp;&amp; a.push(    //     if the j-th bit is set, push j in a[] and
            a.map(x =&gt;  //     for each value x in a[] (before the push):
              h |= 1 &lt;&lt; //       update h by setting the bit at index j-x-1
                j + ~x  //       for a valid ruler, h will end up with all
            ) &amp;&amp; j      //       bits from 0 to n-1 set to 1
          ) &lt; N         //     test whether a[] has less than N elements
        :               //   else (end of recursion):
          a = []        //     initialize a[] to an empty array
      )(n) +            //   invoke h with n -&gt; returns 1 if a.length &lt; N
      h &gt;&gt; n ?          //   add this to h; if the n-th bit is set:
        q.toString(2)   //     success -&gt; append the ruler as the binary
        + `\n`          //     representation of q followed by a newline
      :                 //   else:
        &quot;&quot;              //     append nothing
    ) + g(q)            //   append the result of a recursive call
)``                     // initial call to g with q zero'ish
|| f(n, -~N)            // if no ruler was found, try again with N+1
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 16 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>‘ŒPŒcIQLƲÐṀLÐṂṬṚ
</code></pre>
<p>A monadic Link that accepts the ruler length, <span class="math-container">\$N\$</span>, and yields all perfect rulers of length <span class="math-container">\$N\$</span> as lists of binary marks ordered numerically.</p>
<p><strong><a href="https://tio.run/##y0rNyan8//9Rw4yjkwKOTkr2DPQ5tunwhIc7G3xAZNPDnWse7pz1//9/MwA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> Or see the <a href="https://tio.run/##AUAAv/9qZWxsef//4oCYxZJQxZJjSVFMxrLDkOG5gEzDkOG5guG5rOG5mv/Dh1bFkuG5mOKBuCxq4oG@OsK2KVn//zEy" rel="nofollow noreferrer" title="Jelly – Try It Online">test-suite</a>.</p>
<h4>How?</h4>
<p>If we can assert that a ruler has implicit marks of <span class="math-container">\$0\$</span> and <span class="math-container">\$N\$</span>, which I believe is part of the definition of a <a href="https://en.wikipedia.org/wiki/Sparse_ruler" rel="nofollow noreferrer">sparse ruler</a>, then we know that <span class="math-container">\$N\$</span> is always in the <em>set of all distances a ruler can measure</em> and hence <span class="math-container">\$k \ge N\$</span>. At the same time, we cannot hope to measure any distance greater than <span class="math-container">\$N\$</span> (as that is the length of our ruler!), so <span class="math-container">\$k=N\$</span>. Furthermore, no ruler of length less than <span class="math-container">\$N\$</span> can make as many measurements (they can't measure <span class="math-container">\$N\$</span>).</p>
<p>Thus I believe we can just look for those rulers of length up to <span class="math-container">\$N\$</span> with maximal measuring capability (i.e. the set <span class="math-container">\$\{1,2,\cdots,N\}\$</span>) and then filter these rulers down to those with the fewest marks. (Please correct me if I've made a false assertion!)</p>
<pre><code>‘ŒPŒcIQLƲÐṀLÐṂṬṚ - Link: non-negative integer, N
‘                - increment {N} -&gt; N+1
 ŒP              - powerset {[1..N+1]}
                   -&gt; [[],[1],[2],...,[N+1],[1,2],[1,3],...,[1..N+1]]
                      i.e. all rulers of length &lt;=N where the 0-mark is represented
                           by a value of 1 or higher while no value may exceed N+1
                           (e.g. [1,3,8] &amp; [2,4,9] both represent [0,2,7] when N&gt;=8)
                           Note that there is, therefore, exactly one representation
                           present of every sparse-ruler of length N
         ÐṀ      - keep those maximal under:
        Ʋ        -   last four links as a monad:
   Œc            -     unordered pairs
     I           -     forward deltas
      Q          -     deduplicate
       L         -     length
            ÐṂ   - keep those minimal under:
           L     -   length
              Ṭ  - untruth (convert to their binary representations)
               Ṛ - reverse (equivalent to sorting by binary representation)
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/isaacg1/pyth" rel="nofollow noreferrer">Pyth</a>, 26 bytes</h1>
<pre><code>.mSbf.Amsm}`11%hd&gt;TkQQ^`Th
</code></pre>
<p><a href="https://tio.run/##K6gsyfj/Xy83OClNzzG3OLc2wdBQNSPFLiQ7MDAuIQQoZwYA" rel="nofollow noreferrer" title="Pyth – Try It Online">Try it online!</a></p>
<p>Alternatively <a href="https://tio.run/##K6gsyfj/P0svNzgpTc8xtzi3NsHQUDUjxS4kOzAwLiEEKGkGAA" rel="nofollow noreferrer">+1 byte to seperate by newlines</a>.</p>
<h3>Explanation</h3>
<pre><code>.mSbf.Amsm}`11%hd&gt;TkQQ^`ThQ    # implicitly add Q
                               # implicitly assign Q = eval(input())
                       `T      # string &quot;10&quot;
                      ^  hQ    # Q+1 times repeated cartesian product (this generates all binary strings of lenght Q+1)
    f                          # filter list on lambda T
       m             Q         #   map range(Q) over lambda d
         m          Q          #     map range(Q) over lambda k
          }`11                 #       check whether &quot;11&quot; is in
              %hd              #       the string made from taking every (d+1)-th character of
                 &gt;Tk           #       T[k:]
        s                      #     sum (check if at least one boolean is true) the following
     .A                        #   check if all items in list are truthy
.m                             # filter for elements which minimize lambda b
  Sb                           #   sort the characters in b
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://codeberg.org/ngn/k" rel="nofollow noreferrer">K (ngn/k)</a>, <s>44</s> <s>43</s> 39 bytes</h1>
<pre><code>*&lt;==!/+/'\{'[#x^/-/:/2#,&amp;:]_+!x:'2}@!1+
</code></pre>
<p><a href="https://ngn.codeberg.page/k#eJxLs9KysbVV1NfWV4+pVo9WrojT19W30jdS1lGzio3XVqywUjeqdVA01ObiSlMwBGIjIDYGYhMgNgViMyA2B2ILAHZtD/Q=" rel="nofollow noreferrer">Try it online!</a></p>
<pre><code>                                    !1+ range 0..n
          {                       }@    complete rulers:
                            +!x:'2        n+1-d range (0...)..(1...)
           '[             ]_              keep where
                 -/:/2#,&amp;:                  distances
             #x^/                           superset of range 0..n
   =!/+/'\                              group by #marks
*&lt;=                                     min
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 33 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>&gt;EÝN.Æεœ.Δ.ÆíÆêILQ}}®KZdiIÝδå{që\
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/f/fzvXwXD@9w23nth6drHduCpB1eC0Qr/L0CaytPbTOOyol0/Pw3HNbDi@tLjy8Oub/f9P/urp5@bo5iVWVAA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/W/u6mevpPCobZKCkr2fS@h/O9eIw3P99A63ndt6dLLeuSlA1uG1QLwqwiewtvbQOu@olEyginNbDi@tPt12eHXMf6Do@gt7D23R@f9fVzcvXzcnsaoSAA" rel="nofollow noreferrer">verify <span class="math-container">\$n\$</span> in the range 1-7</a>.</p>
<p>If binary-strings are mandatory, a <code>J</code> can be added after the <code>{</code> for +1 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">byte</a>:<br />
<a href="https://tio.run/##yy9OTMpM/f/fzvXwXD@9w23nth6drHduCpB1eC0Qr/L0CaytPbTOOyol0/Pw3HNbDi@t9io8vDrm/3/T/7q6efm6OYlVlQA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/W/u6mevpPCobZKCkr2fS@h/O9eIw3P99A63ndt6dLLeuSlA1uG1QLwqwiewtvbQOu@olEyginNbDi@t9jrddnh1zH@g8PoLew9t0fn/X1c3L183J7GqEgA" rel="nofollow noreferrer">verify <span class="math-container">\$n\$</span> in the range 1-7</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-none prettyprint-override"><code>&gt;                  # Increase the (implicit) input by 1
                   # (for edge-cases n=1 and n=2 that have larger output-rulers)
 E                 # Loop `N` in the range [1,input+1]:
  Ý                #  Push a list in the range [0,(implicit) input]
   N.Æ             #  Pop and push a list of all `N`-sized combinations
      ε            #  Map over each inner list:
       œ           #   Get all permutations of this list
        .Δ         #   Get the first that's truthy for:
                   #   (or -1 if none are truthy)
          .Æ       #    Pop the list and get all combination-pairs
            í      #    Reverse each inner pair
             Æ     #    And then reduce each pair by subtracting
                   #    (these are all sizes this ruler can measure)
              ê    #    Uniquify and sort it
               IL  #    Push a list in the range [1,input]
                 Q #    Check that the two lists are the same
         }         #   Close the find_first
      }            #  Close the map
       ®K          #  Remove all -1s
         Zdi       #  If valid rulers have been found:
            IÝ     #   Push a list in the range [0,input] again
              δ    #   Apply double-vectorized:
               å   #    Check for each value in [0,input] if it's in the ruler
                   #   (we now have a list of binary-lists)
                {  #   Sort this list of binary-lists
                 q #   Stop the program
                   #   (after which the list of binary-lists is output implicitly)
           ë       #  Else:
            \      #   Discard the empty list (so we can use the implicit input
                   #   for the next iteration again)
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/276637/">276637</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




