<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::283848</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>168</td><td>JavaScript ES6</td><td>250926T053125Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283859#283859">Arnauld</a></td></tr>
<tr d-ix="1"><td>464</td><td>Wolfram Language Mathematica</td><td>250927T105700Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283881#283881">138 Aspe</a></td></tr>
<tr d-ix="2"><td>108</td><td>Python</td><td>250926T115538Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283863#283863">Albert.L</a></td></tr>
<tr d-ix="3"><td>079</td><td>Ruby n rdate</td><td>250926T080812Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283862#283862">Dingus</a></td></tr>
<tr d-ix="4"><td>nan</td><td>Python</td><td>250925T120444Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283849#283849">ojdo</a></td></tr>
<tr d-ix="5"><td>133</td><td>R</td><td>250926T073346Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283861#283861">pajonk</a></td></tr>
<tr d-ix="6"><td>139</td><td>Perl 5 mListUtil MTimeLocal plF</td><td>250925T155924Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283852#283852">Xcali</a></td></tr>
<tr d-ix="7"><td>068</td><td>05AB1E</td><td>250925T152027Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283851#283851">Kevin Cr</a></td></tr>
<tr d-ix="8"><td>167</td><td>Excel ms365</td><td>250925T140051Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283850#283850">JvdV</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>JavaScript (ES6), 168 bytes</h1>
<p>Returns a Boolean value.</p>

<pre class="lang-javascript prettyprint-override"><code>S=&gt;S.replace(/^.{6}(....)(..)(..)...(\d|X)$|/,(_,y,m,d,c)=&gt;(new Date(y+=`-${m}-`+d).toJSON(g=s=&gt;s&lt;17?g(s+1,t=S[s]*2+t*13%11):1/c?c:10)+g).match(y)&amp;&amp;g(t=0)==(34-t)%11)&gt;g
</code></pre>
<p><a href="https://tio.run/##hdBdT9swFAbge37FEWLMJoljxy3FaC5a4QaksYtOUyX2gee4SbbERrELi4Df3qUCpE5dhyVb78WrR8fnp7pVXrfVTUisy81yLpdTOZ6S1tzUShuUfiP3h4@I9Aej59tn9CV/mOG9hzRG3@MubuI81liOkTV3cKaCQV0kr5O9@@YxuY5yTIK7mH68RIX0cuzfsdFJgXzE4iCnV/7rQRaFA8bfMIaPWapP9DGjOCowaVTQJerw/n6BgqRYSsQHScCr5rhYame9qw2pXYHmaJcxyuiQCUHpKlE@2sUYIE3hs6qrfGdLfSBYxvt6NvurTuBTaUCXRv/yiwYYhcrD81Zy@NHBjOy8NoB4Ec/t7ZN5@uL1mIDK@mBUDm4Oo62YYHyFDYYb2AdnQwmMQ@6Mt28DmN@VD9vHEvSQ/1u6WFgDztYdlMoDp5Crzv8PWq0s40/SOsREvzLVKh1M69f/x442uYy/n/SPGLKjyeS0TxtzXTqb2EVj2kqvuWT5Bw" rel="nofollow noreferrer" title="JavaScript (Node.js) â€“ Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<p><strong>Regular expression</strong></p>
<pre class="lang-javascript prettyprint-override"><code>// a regular expression that matches either the relevant parts of an ID
// that is sufficiently well-formed, or the empty string
const REGEX = /^.{6}(....)(..)(..)...(\d|X)$|/
</code></pre>
<p><strong>Helper function</strong></p>
<pre class="lang-javascript prettyprint-override"><code>g = s =&gt;          // g is a recursive function taking a counter s
s &lt; 17 ?          // if s is less than 17:
  g(              //   do a recursive call:
    s + 1,        //     increment s
    t =           //     update t:
      S[s] * 2 +  //       multiply the s-th character by 2
      t * 13 % 11 //       add t * 13, reduced modulo 11
  )               //   end of recursive call
:                 // else:
  1 / c ?         //   if c is numeric:
    c             //     return c
  :               //   else (c is 'X'):
    10            //     return 10
</code></pre>
<p><strong>Main function</strong></p>
<pre class="lang-javascript prettyprint-override"><code>S =&gt;                    // S = input string
S.replace(              // replace in S
  REGEX,                // if S has the correct length and ends with either
                        // a digit or 'X': capture the date parts and the
                        // checksum; otherwise: match the empty string
  (_, y, m, d, c) =&gt;    // y = year, m = month, d = day, c = checksum
  (                     // (they may be all undefined)
    new Date(           // create a date from ...
      y += `-${m}-` + d // ... (y, m, d) arranged in YYYY-MM-DD format
    ).toJSON()          // and convert it to ISO 8601 format
    + g                 // coerce to a string (in case it's null)
  ).match(y) &amp;&amp;         // does it match the original YYYY-MM-DD string?
  g(t = 0) ==           // invoke g with t = s = 0
  (34 - t) % 11         // is the checksum correct?
) &gt; g                   // is the final result 'true'? (greater than 's')
                        // it may also be 'false' or 'null&lt;some_garbage&gt;'
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 464 bytes</h1>
<p>464 bytes, it can be golfed more.</p>
<hr />
<p>Golfed version. <a href="https://tio.run/##lVZtT9tIEP6eXzH4pB6gBcUJbyYyApIiUZU7XtIe0mKdNvYG@@qsU@8aEYX8djrrdzuAehIKifeZZ2aemdnxjCmfz5gKXPb6OqXyX@fYvoq8JOR0OSELMiMeeSKMCOKScEUup/ROxYF4/MrFo/JP5YZtHpFbrpJYnF6wUHJnMLEzyJj94FSS5SEx91bOYGGPo8/P85hLGUTitIaZkKVJNGT2EWSfHCDE@whySI4Q8mTfJAFXp0Ofuz/oiCn@9@Q/7qrTZZrOajCOE07yYDGhjadWAqyZgHmYwbKHV0y5/g1lZBQ8Bmros5i5ise7u06LRdgXcTRLURLhZt8ZuFpaau70BDFNZxA2/ezgo3/8wPVpaNvGvUHcE4s0nIYtpw5piIFmLqkl57xubsOYSwUuk1zC9lZH4a9h@sOGZQdgaZhm1@zum5bV7epv3f6hQcD4zsLAM1akAdmzzF4fIb37ErILY5@Dq5WWyQzMLgQSYj4Pmcs9mCzgfrfNUjqyNMuleMp4hgUHElgQCKk48yCawuEagWX2NcHefoPgKhLKB7MPXsSl@FMBfw6kWndvdQ/669ZfEsEhEuECfCah3wWPLeRbxlqCXr9lbVqoQV4UWQ/ePKo4ev2zc/yw9s2j8/MhfmtQ/BWJHZHMeBy4NS607qwGnQ4W8iIRrsIyg4ogTvBfo7C3iRgXtaUOHNuQT7H2HXjjSJ8S8Lh042CueQgKNMex4N4tl0mIh@gyYWHxS/PfKaYSmSaAf9fYiooa6EpgT2LFAsElh8sRpDmwLDo0k8eGMygNsha@5XPO0NrGrI@6TnqOf6NIR/hejCts06JlByku/UA1RhzlmWEAZRbYdjpwmCAWtRd1Hq2QNmxmjORZbJhmrOQNbaiTz4DT9IvJ17PNeevKIeuUFtm0rNMmh2CaFW/OpA4156j0Rga8b9qx2q36GNdnd3e6hS7OLr@2w0yVzxWRhYd6Ob5EgciUh1yEa@bdBo@@olUgBPYcdAAvYJAca0zpg4Feq3IZD4YDOycVZBxlhLQeb8qzWdYKGUpYM1EN3II/KrpaUdInjkOqVJdFd5CyT@QKT1AOJxubYTSbYyDwhNOkK7bJfyYBVpCjPjhJUYw3qmAhXC@UH4ktrdX3rL48b/DLUc6B2zELuT1fGownpLwI04lp7UoqHdiw8UYgkC0Kmt/S@STkJGVT5lsBcKtBukAzyo10udH2cqPLTqZ9tQ9ojaeMEDctIBmq/Jv4fQIH/weP0eISdhCNIUO6jSBP9J3E13ZrM39cvwTWl@3bXOUmSutDTdiB3nZtD79BjYsZP8yCYbMJwaWsRw/XMXz6VNGfgLUFLy81gzdjR@t27I7m6XwgZWaWei3cbRXN/PmZzeYhh0SyR65bNb@SbQQXZ9/SM3yi74T8fK2jcYjXF78eZFuPZj55U/rW24FT0U5rNNXLwQc0tTeId2iqt4PficZKaQqeB6F1KNbTWRimLz@y0KK5IgevvwA" rel="nofollow noreferrer">Try it online!</a></p>
<pre class="lang-mathematica prettyprint-override"><code>f[s_]:=Module[{b,y,m,d,v,a,n,c,l},If[StringLength@s!=18,Return@False];b=StringTake[s,{7,14}];y=ToExpression@StringTake[b,{1,4}];m=ToExpression@StringTake[b,{5,6}];d=ToExpression@StringTake[b,{7,8}];v=Quiet@Check[DateObject@{y,m,d};True,False];If[!v,Return@False];a=StringTake[s,17];If[!StringMatchQ[a,DigitCharacter..],Return@False];n=FromDigits[a,13];c=Mod[1-2n,11];l=StringTake[s,-1];Which[l==&quot;X&quot;,c&gt;9,StringMatchQ[l,DigitCharacter],ToExpression@l==c,True,False]]
</code></pre>
<p>Ungolfed version. <a href="https://tio.run/##nVf/T9tGFP89f8WrJ3WADMoRaEhRKtFQJqqWUcg2JNeaDvuIvTp25jszEPC3s3d3Pvv8JR0dAuPY733e93efLKmI2JKKOKDPzxtbMIvilHEGZ/goS2kCp8fwO03ikIoshziFz7UCbG0OBuVLViqeHntxeCnyOF38qf/58HYKn7OwSJg3AHjAP4DrOBfRMaqhjAv3jOJ1maUiciGk9/IimEJ2QcnfxDkXZDyLaM5diMOzYnnNUCegSVAkKBzOIhZ848WyVKCBKGhiHko9F9jdigWWKBooGEo/uXjBXxU@voL4RoYdUY4qCJTcAzmAADHwA8u5jBvg9MbTAX5i6UJEVdg@vJqivAsXTBR56p3QhDPfP6xsfLgTEkjnQEUKqyyX6YaNVcZjecdhvE32Wvl24Z8oDiIoOONAtq8pZyGKhOwOzW5qr@zEwhS0S3P6jVX@ufAwdoHsPVkunWNaWacMcJNnS9tNrgC0ISmMBubZh7tVzjhHpz3LWrPAD8QFNKgsKvyXa@678KbUlC69WA9jPHiy024aFTCfdlAqmqrf0MCXImbCU12k2kHfAkjsX6//whbyHtqp0smUP/O8YG55r0qv7n28Gl@wcV5Z/b2uTX5hQrc9kLHdfDc4h0HZwVX/y@ZRgdiDsq7@ZGyZqTq@zxbNGdAkgTBexKLu@1caCVsziL54zdk8lqIzA7Gz46@PcJaltywXIDLsYsEWLMfWlg0mOxvICDaW0oJ8kuUIK9cRTRZ4L6Jl2e9mFWCsJ9ityjpvuURGtlGzMaokvoUNAtuwC1uQKqxNLGwIhGgL3RUDap95Smmr3kWEtKonG03vIatgJjOwkVDMd/W5jKe7t9ZVcZv0NXdlSKH9IfeFt2YhwnQKzpWjmxUxriBncrBYiqWucG7lkgQy1IC96XgHEw2iLo3e6FvDzQ7xK/sXbIHAuSwCy@OgFQr0r@/2QugaLCdzjfa07wipg6mnGR08TW/ViugpZumiGXh/gFYHqDJnssZULmwUEfhppj5M1Tn44BAyJMN9MpkMh/JuOBo7Ljiqmo46lmqRvQnZHaHI7lUlsgPzyCo5FinmsogJDfBkuL6Hq502SmVoIlHKiHagqiUCTHAauWA0hOwGxh2ACRlJgL39BsBntdVxZsOM8fRngfmOueianwzfjLraH4uUQZbiQSsP3dFQrlTepyxTsDtqaZOJvbMs58lBjbE7OnqPl8k@OXj/foZ3DYizLN2u@85gofbgSRfypEgDtWVxWeUF/msU9qJI56a2XpvwxOE8k2/xoGA8yOOVxKnZyAXjRYIvdeeaTxL/UlBRcMNOznGshOegqVRuREPUkKjc6uFX3qEaf@uontcKehwv2IpR1J5i1AfDagkfZ3o59Pv4hG1qWvawngnMxjHD9CzRgSoKbDvpOGhSgp5YOO0B1jFWew3DzAX/4jWyU86A37SLwdvRlrh25hC1j5Hq6Fpo1dGnirmiXLpeYtb5R0Q88tq@T1v1cs6PLi9lS50cnX5qu60qUWaIGwt2eT5mcWpohn5yTsOLeBEJr3YEKRQepg48gmMIhtON9avjSIJsyul8dXzYflerzDNtwLP9V7gbVS0RoRJrBi4FN@GnGs4qmiY6vrU9H0z3uFUf8SfNhMr9OMuWK8mFkQdwRYDZ30WMFcYzSE5adeyf34soS9UZ2Qm5xPD4mi8coeGEZlGqiWrTd/593h72UWre5NKSGWnyqHmjTRj1abKGuoZtnlx@iflv@ZIdv1i@ZMXyS49/qE83KANdE3iH7jXjRy75cs4X9BEoi7b1QCN3azCrpghyoJLFwOvXNTwSkk14fLQUen1H7Q4bkTiD76RSqymrxtymaeYPd3S5ShiSWLpQ3yvKlT1FYfPuN/UOn8gdUb7vG@IuMZCDPJWjWU5eV6uPTfgvM1OTix8wYzES/wejmfyfaCbKjLHzNZV5NcfhEX5LkRuPm9w2j@TD5@d/AQ" rel="nofollow noreferrer">Try it online!</a></p>
<pre class="lang-mathematica prettyprint-override"><code>(* Chinese National ID Validator in Mathematica *)

ValidateChineseID[idString_String] := Module[
  {
    birthDateStr, year, month, day, dateValid, 
    first17Chars, idNumber, calculatedChecksum, 
    actualChecksumChar, expectedChecksumValue
  },
  
  (* Check if ID has exactly 18 characters *)
  If[StringLength[idString] != 18, Return[False]];
  
  (* Extract birth date portion (positions 7-14 in Mathematica, which uses 1-based indexing) *)
  birthDateStr = StringTake[idString, {7, 14}];
  
  (* Parse year, month, day from birth date string *)
  year = ToExpression[StringTake[birthDateStr, {1, 4}]];
  month = ToExpression[StringTake[birthDateStr, {5, 6}]];
  day = ToExpression[StringTake[birthDateStr, {7, 8}]];
  
  (* Validate the birth date *)
  dateValid = Quiet[
    Check[
      DateObject[{year, month, day}];
      True,
      False
    ]
  ];
  
  If[!dateValid, Return[False]];
  
  (* Get first 17 characters for checksum calculation *)
  first17Chars = StringTake[idString, 17];
  
  (* Check if first 17 characters are all digits *)
  If[!StringMatchQ[first17Chars, DigitCharacter..], Return[False]];
  
  (* Convert to integer using base 13 (matching original algorithm) *)
  idNumber = FromDigits[first17Chars, 13];
  
  (* Calculate checksum: (1 - 2 * number) mod 11 *)
  calculatedChecksum = Mod[1 - 2*idNumber, 11];
  
  (* Get the actual checksum character (last character) *)
  actualChecksumChar = StringTake[idString, -1];
  
  (* Validate checksum *)
  Which[
    actualChecksumChar == &quot;X&quot;,
    (* X represents checksum value 10 *)
    calculatedChecksum &gt; 9,
    
    StringMatchQ[actualChecksumChar, DigitCharacter],
    (* Regular numeric checksum *)
    expectedChecksumValue = ToExpression[actualChecksumChar];
    expectedChecksumValue == calculatedChecksum,
    
    True,
    (* Invalid checksum character *)
    False
  ]
];

(* Test cases *)
testCases = {
  {&quot;110105199001010037&quot;, &quot;Valid&quot;},
  {&quot;11010519491231002X&quot;, &quot;Valid. The checksum 10 is replaced by X.&quot;},
  {&quot;110105199001010039&quot;, &quot;Invalid. Checksum is 9 instead of 7&quot;},
  {&quot;110105199913010045&quot;, &quot;Invalid. Month 13 doesn't exist.&quot;},
  {&quot;110105199906310045&quot;, &quot;Invalid. June only has 30 days.&quot;},
  {&quot;1101051999012312345&quot;, &quot;Invalid. 19 characters instead of 18.&quot;},
  {&quot;123AB1239518BBC123&quot;, &quot;Invalid. Non-numeric characters.&quot;}
};

(* Function to run test cases *)
RunTestCases[] := Module[
  {idToTest, description, expectedResult, actualResult, testStatus},
  
  Print[&quot;Running Chinese ID validation tests:&quot;];
  Print[StringRepeat[&quot;=&quot;, 80]];
  
  Do[
    {idToTest, description} = testCase;
    
    (* Determine expected result based on description *)
    expectedResult = StringStartsQ[description, &quot;Valid&quot;];
    
    (* Run validation *)
    actualResult = ValidateChineseID[idToTest];
    
    (* Check if test passed *)
    testStatus = If[expectedResult == actualResult, &quot;PASS&quot;, &quot;FAIL&quot;];
    
    (* Print results *)
    Print[StringJoin[
      StringPadRight[testStatus, 4], &quot; | &quot;,
      &quot;ValidateChineseID[\&quot;&quot;, idToTest, &quot;\&quot;] -&gt; &quot;,
      ToString[actualResult], &quot; (expected &quot;, ToString[expectedResult], &quot;) # &quot;,
      description
    ]],
    
    {testCase, testCases}
  ];
];

(* Compact version (equivalent to original Python) *)
ValidateChineseIDCompact[s_String] := Module[
  {dateStr, checksum},
  If[StringLength[s] != 18, Return[False]];
  
  dateStr = StringTake[s, {7, 14}];
  If[!Quiet[Check[DateObject[{
    ToExpression[StringTake[dateStr, {1, 4}]], 
    ToExpression[StringTake[dateStr, {5, 6}]], 
    ToExpression[StringTake[dateStr, {7, 8}]]
  }]; True, False]], Return[False]];
  
  If[!StringMatchQ[StringTake[s, 17], DigitCharacter..], Return[False]];
  
  checksum = Mod[1 - 2*FromDigits[StringTake[s, 17], 13], 11];
  
  (StringTake[s, -1] == &quot;X&quot; &amp;&amp; checksum &gt; 9) || 
  (StringMatchQ[StringTake[s, -1], DigitCharacter] &amp;&amp; 
   ToExpression[StringTake[s, -1]] == checksum)
];

(* Example usage *)
Print[&quot;=== Example Usage ===&quot;];
Print[&quot;ValidateChineseID[\&quot;110105199001010037\&quot;] = &quot;, 
      ValidateChineseID[&quot;110105199001010037&quot;]];
Print[&quot;ValidateChineseID[\&quot;11010519491231002X\&quot;] = &quot;, 
      ValidateChineseID[&quot;11010519491231002X&quot;]];
Print[&quot;ValidateChineseID[\&quot;110105199001010039\&quot;] = &quot;, 
      ValidateChineseID[&quot;110105199001010039&quot;]];

Print[&quot;\n=== Running All Tests ===&quot;];
RunTestCases[];
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, 108 bytes</h1>
<pre class="lang-python prettyprint-override"><code>import time
def f(s):int(str(int(f&quot;{s}Y&quot;[:~(ord(s[17:])==88)])),13)%11!=1&lt;'';time.strptime(s[6:14],&quot;%Y%m%d&quot;)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZZPfbtMwGMUl7pqn-BZUOZbSKm7atckIUjtp0hAgpE1oU9uLkDjUInEi2xmrqvEi3IwLeCd4Gj633daBLxz_Ob9jOz7-_qtZm1Ut7-9_tqboTX6XompqZcCIijs5L6DwNI2FNJ42yrPfwt3ou2t3Hn_zapV7es7G8ZImyWRCl5T6LKRdxo4S9oqQE-vSR7CxDZQex2y49N3udbfq5i7drfnnxQ-TaUjAdd2Fw1jAghGLoiCwrSAcQ-djWor8cWYYsUGIM4Or_UwfLlccshXPvui2AhaA0KB4U6YZz-HTGq76_9tG0DmXNzv89AFFLgIhteFpDnUB4ycuYqHlhqMD7l0tzQpYCHnNtSQG-K3Q5mCxKDgO_4XetJJDLcs1rFINYQB5utbPGHu8QfgMYhGeL1VpZrjShztkE0QH4XSGVTRik9nsFFsH5Pta9mRbcSWyA4u-gz_bKWoFJkM7rHVfN6UwHllIQmMHsIgCZI1RyHZdWzI8sZAt3w5oHyr9GS-uShsbD3vTovERePQyxAdG6VbObxvUXqqWW2ck5_FoCUkCZHuLBHipOZylWG_1Rq1jm74TxXVisb1LxhsT27EnaaNsMp1Oh3yYXlwQ679dLcEY6J0vOZuevyU-agq38AhmmNCF6b2GDUqOVDy6g6-pNLBBcNeFl7DBXd65Tmef1IdX8hc" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Signals by exit code. Returns nothing for valid and raises an exception for invalid.</p>
<p>Test harness borrowed from @ojdo.</p>
<h3>How?</h3>
<p>One can check that the full 18-digit base-13-number is 1 mod 11 exactly if the last digit is the correct checksum and not equal to 'X'. If it is 'X' then the remaining 17 digits are 1 mod 11 in base 13.</p>
<p>Technicalities:</p>
<p><code>ord(s[17:])==88</code> instead of <code>s[17]==&quot;X&quot;</code> guarantees that the length of s is exactly 18.
The purpose of the <code>int</code>-<code>str</code> round trip is to rule out characters 'A','B','C' which in base 13 could slip through.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a> <code>-n -rdate</code>, 79 bytes</h1>

<pre class="lang-ruby prettyprint-override"><code>Date.parse~/^(\d{6}(\d{8})\d{3})(\d|X)$/==$3.ord%48%30-(1-2*$1.to_i(13))%11&amp;&amp;$2
</code></pre>
<p><a href="https://tio.run/##FY27DsIwDAB/JqlipKR2zaMduvERDAhUlA5dmioNA4Lw6Zh0Od1NF5@Pl8h5SKNbhriO3/pmrv59zBvbDIWcocTnAqrue8UuRK/3rWa0hmyzU@RSuE@GGEATVZVqRIiQ8EBdh7gZ8ukXljSFeRU7i42@DP8" rel="nofollow noreferrer" title="Ruby â€“ Try It Online">Try it online!</a> Full program that takes input from STDIN and outputs via exit code: <code>0</code> for a valid ID number, <code>1</code> otherwise.</p>
<p><a href="https://tio.run/##ZZCxDoIwEIZ3noIBCDUBej1AOmAi@hAMRgPSGBYgBQaj@OjWdjCaMNyX/77c3XByru@qFre2U8dqEuFQyVG8orN/ah7pYpgtRBMXoptnSZwozx0Me9m4ceYiDXwI2MaBcOovrQ9IiAvgeQ5Tgz3JWVhSjNdZ2PnOFtagS3SNAqBAE@CcUpMobq2vijkw1IqV1mqK/xQHNCpO/hRNcaXMMYbGMdwXGjyBrCgOOq032bsfprbvRhV0KpCNfsgH" rel="nofollow noreferrer" title="Ruby â€“ Try It Online">Verify all test cases</a>. Instead to trying to capture exit codes, the wrapper here prints <code>true</code> for valid ID numbers and the various exceptions thrown for invalid ID numbers.</p>
<h3>Explanation</h3>
<pre class="lang-ruby prettyprint-override"><code>~/^(\d{6}(\d{8})\d{3})(\d|X)$/
</code></pre>
<p>Check whether the input string (read implicitly thanks to the <code>-n</code> flag) exactly consists of 17 digits followed by another digit or <code>X</code>. If it does, this expression returns <code>0</code> (being the index within the input string where the regex matches) and the following substrings are extracted:</p>
<p><code>$1</code>: the ID number without the checksum character</p>
<p><code>$2</code>: an 8-character representation of the date (not yet validated)</p>
<p><code>$3</code>: the checksum character</p>
<p>If the input string is not in the correct format, an exception will be thrown when the code subsequently attempts to manipulate the checksum character.</p>
<pre class="lang-ruby prettyprint-override"><code>$3.ord%48%30-(1-2*$1.to_i(13))%11
</code></pre>
<p>Convert the checksum character to an integer between <code>0</code> and <code>10</code> inclusive (<code>$3.ord%48%30</code>), calculate the checksum (<code>(1-2*$1.to_i(13))%11</code>), then subtract the two values. For a valid ID number, the result will be <code>0</code>.</p>
<pre class="lang-ruby prettyprint-override"><code>~/.../==$3...%11
</code></pre>
<p>This equality is <code>true</code> only if the ID number is valid, in which case both sides of the expression will be equal to <code>0</code> (as noted above). An incorrect checksum character causes the equality test to fail and an exception will be thrown when we subsequently attempt to parse <code>false</code> as a date.</p>
<pre class="lang-ruby prettyprint-override"><code>Date.parse...$2
</code></pre>
<p>Check whether the 8-character string extracted before is a valid date.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, <del>178</del> <del>177</del> <del>173</del> 169 bytes</h1>
<p>Returns <code>True</code> for Valid, but one of <code>False</code>,<code>0</code> for Invalid. Heavy lifting is done by the standard library. Checksum copy &amp; pasted directly from the challenge text.</p>
<pre class="lang-python prettyprint-override"><code>from datetime import*
def f(s):
 if len(s)!=18:s=''
 try:date.fromisoformat(s[6:14])
 except:return 0
 c=(1-2*int(s[:17],13))%11
 return'X'==s[17]and c&gt;9or int(s[17])==c
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZZNRa9swEMdhb_GnuGYM2SUxVpw0scGFpFDo2MagZQSSPGiyvJjZspHkLiHkk-ylLxvsI22fZid77dJNYHHS_X-nk-789Xu9N9tKPjx8a0w2nP38kamqhJQZYfJSQF7WlTLnTioyyFztxQ7kGRRCon2W0FmsE0IcMGofW8a3dK6rrFIlM65eXcR0vPEcEDsuahMrYRolIXCAJy4djs5zaVUxnW4GNPS8V5Q60InIkiSJXqGHyRT4ZVQp6NS45SUJ7xL-9WJnuIYE-v3-2qE0oMGERlEQWCsIp9D7wIo8ffKMIzoK0TNa_vH4cLcVwLeCf9ZNCTSAXGMKdcG4SOHjHpb-_2Ej6N3I-w6_ekSRizBFbQRLocpg-peLaGi58eSEe1tJswUaQloJLYnBN8q1OTksCi7Cf6HXjRRQyWIPW6YhDLBSe_2Msdcbhc8gGuH9mGLcCKVPM6QzREfhfIFTNKGzxeIKrRPyXSWHsimFyvlJCN_Bx3awxmA4hsNZ-7oucuOStSS2R3Bgm8jKoK9b2sHxxrlsRLuhB1DqT1i4ktWuNsrHL68HCDzFMmQA1PNaudjVqL1TjbCRkVzFkw0kCZC2igREoQVcM5xbfa1sszi9Hnk_v70lFmpDJG0bd2pyPb95QwYoyvqZSw76SLy1GV7CwWrOVDw5whcmDRwQ7ZbwEg54-LHv9LyuAR__nN8" rel="nofollow noreferrer">Attempt This Online!</a></p>
<ul>
<li>-1 <code>import*</code> @Rhaixer</li>
<li>-4 <code>..c&gt;9or</code> @KevinCruijssen</li>
<li>-4 <code>s=''</code> safes one return @Albert.Lang</li>
</ul>
</div>
<div id="pu5" class="pu"><h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>, 133 bytes</h1>
<pre class="lang-r prettyprint-override"><code>\(x)nchar(x)==18&amp;c(0:9,'X')[13-sum(strtoi(head(d&lt;-el(strsplit(x,&quot;&quot;)),-1))*2^(17:1))%%11]==tail(d,1)&amp;&amp;as.Date(substr(x,7,14),&quot;%Y%m%d&quot;)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=bZHPSsNAEMbxqE8xVNLsSlJ2sq3tijlYvSjoSaTiH1iTLQmmG8lupH0AL76Clyr4UPo0bghKq152hv34ffMN8_JaLd-m8Xttp-Ho4-mazKlOMlm5Gsc46iaE7YnAn_j0Cnlo6hkxtrJlTjIlU5Luh6pofsxDkVsyDzodSoMQKd2JbgkO91zneYg3cWxlXpA0QNrtStM7klYRU9851FHDAPs06HiX3sxLO7QN87nxPCU-IkM2QCEYazrGhz7d3ryQRZ5urch9gRF3cjT5kXtwnilIMpXcu9iADHIDlXooZKJSuFvApLf13wDROBzrx9bj8Jt3sIBcG-v2hnIKwzVYIG_g_mANPi21zQA5pKUy2reg5rmx62MF2-V_yZNaKyh1sYBMGuAMUrkwv8Fm5Yj_IlFAcz-ZWFWZ1cA4avmIH4zdIwY4Go8PXbeGn5U61PVMVXmy4tNrT7JctvUL" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Returns falsy as <code>FALSE</code> or <code>NA</code>.</p>
<p>Uses the checking formula from Wikipedia link.</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a> <code>-mList::Util -MTime::Local -plF</code>, 139 bytes</h1>

<pre class="lang-perl prettyprint-override"><code>$e=17;$_=/^\d{17}[X0-9]$/*/.{6}(....)(..)(..)/*eval{1+timegm 0,0,0,$3,$2-1,$1}&amp;&amp;(10*&quot;@F&quot;=~/X$/+pop@F)==(12-(sum map{$_*(2**$e--)}@F)%11)%11
</code></pre>
<p><a href="https://tio.run/##ZY9bS8MwFIDf9yvGiCPNmiYnWVdTCcwKfZpvCgUvo2iRQmqDrb6U@tONCSgKO4dz@84Fjm3eTOocajRkF@io2eP98wTZfFdxqh4QIyyZdjNOvET4xxhpPmozwWZsu@alW/I4KJIxEhRiBPN6jYGT1b5c6U9WIbaxvd2XkdYYBMXDe7fsajuhI8GCENRQGs2@fQYQzDkADjwFpTgPGZfZ4hdtFQjpkagWJ1PqDymQAW3Tf4jv5AkKx4QMTMjLwjuVwnlRXPnsq7dj278Ojl6niV/w8ca/m@eH/qk2vjq0w5jnt2NrtP/IUWvKbw" rel="nofollow noreferrer" title="Perl 5 â€“ Try It Online">Try it online!</a></p>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, <s>70</s> 68 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>2Ã´4LÃŒÃ¨`UVÂ«Ñ‚â€°0KÎ¸4Ã–T*â€¢Î©Ã¢Ð½â€¢+RÂºSâ‚‚+YD13â€¹Ã—&lt;Ã¨X@Ã—Â¨Â©13Ã¶Â·(&gt;11%Â®DdÃ—g17QÃ—T'X:IÎ¸Q
</code></pre>
<p>Outputs a 05AB1E truthy/falsey result (only <code>1</code> is truthy in 05AB1E).<br />
Or to be more precise: outputs <code>1</code> for truthy and <code>0</code> or a list of thirteen <code>0</code>s as falsey.</p>
<p><a href="https://tio.run/##AYAAf/9vc2FiaWX//zLDtDRMw4zDqGBVVsKr0YLigLAwS864NMOWVCrigKLOqcOi0L3igKIrUsK6U@KCgitZRDEz4oC5w5c8w6hYQMOXwqjCqTEzw7bCtyg@MTElwq5EZMOXZzE3UcOXVCdYOknOuFH//zExMDEwNTE5NDkxMjMxMDAyWA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfeXhCYcn/Dc6vMXE53DP4RUJoWGHVl9setSwwcD73A6Tw9NCtB41LDq38vCiC3uBDO2gQ7uCHzU1aUe6GBo/ath5eLrN4RURDoenH1pxaKWh8eFth7Zr2Bkaqh5a55JyeHq6oXng4ekh6hFWled2BP7X@R@tZGhoYGhgamhpaWAAYhkYmyvpwAVNLA2NjIGCRhFIgnCVlsiClobGIEETUxRBAzNjLIIgQ42MIaJGxo5OQMLS1NDCyckZyFKKBQA" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>2Ã´                   # Split the (implicit) input-string into pairs
  4L                 # Push list [1,2,3,4]
    ÃŒ                # Add 2 to each: [3,4,5,6]
     Ã¨               # Get the pairs at those 0-based indices
      `              # Pop and push all four pairs to the stack
       UV            # Pop the top two, and store them in variables `X` and `Y`
Â«                    # Merge the remaining two together
 Ñ‚â€°0KÎ¸4Ã–             # Check that it's a leap year:
 Ñ‚â€°                  #  Divmod-100
   0K                #  Remove a potential 0
     Î¸               #  Pop and keep the last value
      4Ã–             #  Check that it's divisible by 4
        T*           # Multiply this check by 10
          â€¢Î©Ã¢Ð½â€¢      # Push compressed integer 5454525
            +        # Add the 10 or 0 to it
             R       # Reverse it
              Âº      # Mirror it
               S     # Convert it to a list of digits
                â‚‚+   # Add 26 to each:
                     #  [31,28 or 29,31,30,31,30,31,31,30,31,30,31,28 or 29,31]
         Y           # Push month `Y`
          D          # Duplicate it
           13â€¹       # Check that it's smaller than 13
              Ã—      # Repeat `Y` that many times (becomes &quot;&quot; if month &gt;= 13)
               &lt;     # Decrease it by 1 (no-op on &quot;&quot;)
                Ã¨    # Use it to index into the list (no-op for &quot;&quot;)
                 X@  # Check for each if it's &gt;= day `X`
                     # (if the month was &gt;=13, we now have a list of fourteen 1s)
                   Ã— # Repeat the (implicit) input that many times
                     # (resulting in the input if the date was valid;
                     #  an empty string if the day was invalid;
                     #  or a list of 14 times the input if the month was invalid)
Â¨                    # Remove the last character (or item)
 Â©                   # Store this in variable `Â®` (without popping)
  13Ã¶                # Convert from base-13 to a base-10 integer
     Â·               # Double it
      (              # Negate it
       &gt;             # Increase it by 1
        11%          # Modulo-11
 Â®D                  # Push two copies of `Â®` again
   dÃ—                # If it doesn't consist of just digits: make it &quot;&quot;
   g17QÃ—             # If it's length is NOT 17: make the checksum &quot;&quot;
   T'X:             '# Replace 10 with &quot;X&quot;
       IÎ¸Q           # Check that it equals the last character of the input
                     # (after which the result is output implicitly)
</code></pre>
<p><a href="https://codegolf.stackexchange.com/a/166851/52210">See this 05AB1E tip of mine (section <em>How to compress large integers?</em>)</a> to understand why <code>â€¢Î©Ã¢Ð½â€¢</code> is <code>5454525</code>.</p>
<p>The leap year check was taken from <a href="https://codegolf.stackexchange.com/a/177019/52210">this 05AB1E answer of mine</a> (minor note: the top 6 bytes solution of that answer would need a <code>D</code>uplicate before it, since we use the input twice, but the <code>Ñ‚â€°0KÎ¸4Ã–</code> above could alternatively have been <code>DÑ‚Ã–oooÃ–</code> for the same byte-count: <a href="https://tio.run/##AX4Agf9vc2FiaWX//zLDtDRMw4zDqGBVVsKrRNGCw5Zvb2/DllQq4oCizqnDotC94oCiK1LCulPigoIrWUQxM@KAucOXPMOoWEDDl8KowqkxM8O2wrcoPjExJcKuRGTDl2cxN1HDl1QnWDpJzrhR//8xMTAxMDUxOTQ5MTIzMTAwMlg" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfeXhCYcn/Dc6vMXE53DP4RUJoWGHVrtcbDo8LT8///C0EK1HDYvOrTy86MJeIEM76NCu4EdNTdqRLobGjxp2Hp5uc3hFhMPh6YdWHFppaHx426HtGnaGhqqH1rmkHJ6ebmgeeHh6iHqEVeW5HYH/df5HKxkaGhgamBpaWhoYgFgGxuZKOnBBE0tDI2OgoFEEkiBcpSWyoKWhMUjQxBRF0MDMGIsgyFAjY4iokbGjE5CwNDW0cHJyBrKUYgE" rel="nofollow noreferrer">verify all test cases</a>.</p>
</div>
<div id="pu8" class="pu"><h1>Excel ms365, 167 bytes</h1>
<pre><code>=LET(i,ROW(1:17),x,MOD,y,MID,s,A1,IFERROR(--AND(DATE(y(s,7,4),y(s,11,2),y(s,13,2)),TEXT(x(1-2*x(SUM(y(s,i,1)*x(2^(17-i),11)),11),11),&quot;[=10]X;0&quot;)=RIGHT(s),LEN(s)=18),))
</code></pre>
<p>Expects input in <code>A1</code> and will output a <code>1</code> for valid or <code>0</code> for invalid.</p>
<p><a href="https://i.sstatic.net/AJjlXxk8.png" rel="nofollow noreferrer"><img src="https://i.sstatic.net/AJjlXxk8.png" alt="enter image description here" /></a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/283848/">283848</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




