<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::283848</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>nan</td><td>Python</td><td>250925T120444Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283849#283849">ojdo</a></td></tr>
<tr d-ix="1"><td>133</td><td>R</td><td>250926T073346Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283861#283861">pajonk</a></td></tr>
<tr d-ix="2"><td>168</td><td>JavaScript ES6</td><td>250926T053125Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283859#283859">Arnauld</a></td></tr>
<tr d-ix="3"><td>139</td><td>Perl 5 mListUtil MTimeLocal plF</td><td>250925T155924Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283852#283852">Xcali</a></td></tr>
<tr d-ix="4"><td>068</td><td>05AB1E</td><td>250925T152027Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283851#283851">Kevin Cr</a></td></tr>
<tr d-ix="5"><td>167</td><td>Excel ms365</td><td>250925T140051Z</td><td><a href="https://codegolf.stackexchange.com/questions/283848/verify-a-chinese-id-number/283850#283850">JvdV</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, <del>178</del> <del>177</del> <del>173</del> 169 bytes</h1>
<p>Returns <code>True</code> for Valid, but one of <code>False</code>,<code>0</code> for Invalid. Heavy lifting is done by the standard library. Checksum copy &amp; pasted directly from the challenge text.</p>
<pre class="lang-python prettyprint-override"><code>from datetime import*
def f(s):
 if len(s)!=18:s=''
 try:date.fromisoformat(s[6:14])
 except:return 0
 c=(1-2*int(s[:17],13))%11
 return'X'==s[17]and c&gt;9or int(s[17])==c
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZZNRa9swEMdhb_GnuGYM2SUxVpw0scGFpFDo2MagZQSSPGiyvJjZspHkLiHkk-ylLxvsI22fZid77dJNYHHS_X-nk-789Xu9N9tKPjx8a0w2nP38kamqhJQZYfJSQF7WlTLnTioyyFztxQ7kGRRCon2W0FmsE0IcMGofW8a3dK6rrFIlM65eXcR0vPEcEDsuahMrYRolIXCAJy4djs5zaVUxnW4GNPS8V5Q60InIkiSJXqGHyRT4ZVQp6NS45SUJ7xL-9WJnuIYE-v3-2qE0oMGERlEQWCsIp9D7wIo8ffKMIzoK0TNa_vH4cLcVwLeCf9ZNCTSAXGMKdcG4SOHjHpb-_2Ej6N3I-w6_ekSRizBFbQRLocpg-peLaGi58eSEe1tJswUaQloJLYnBN8q1OTksCi7Cf6HXjRRQyWIPW6YhDLBSe_2Msdcbhc8gGuH9mGLcCKVPM6QzREfhfIFTNKGzxeIKrRPyXSWHsimFyvlJCN_Bx3awxmA4hsNZ-7oucuOStSS2R3Bgm8jKoK9b2sHxxrlsRLuhB1DqT1i4ktWuNsrHL68HCDzFMmQA1PNaudjVqL1TjbCRkVzFkw0kCZC2igREoQVcM5xbfa1sszi9Hnk_v70lFmpDJG0bd2pyPb95QwYoyvqZSw76SLy1GV7CwWrOVDw5whcmDRwQ7ZbwEg54-LHv9LyuAR__nN8" rel="nofollow noreferrer">Attempt This Online!</a></p>
<ul>
<li>-1 <code>import*</code> @Rhaixer</li>
<li>-4 <code>..c&gt;9or</code> @KevinCruijssen</li>
<li>-4 <code>s=''</code> safes one return @Albert.Lang</li>
</ul>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>, 133 bytes</h1>
<pre class="lang-r prettyprint-override"><code>\(x)nchar(x)==18&amp;c(0:9,'X')[13-sum(strtoi(head(d&lt;-el(strsplit(x,&quot;&quot;)),-1))*2^(17:1))%%11]==tail(d,1)&amp;&amp;as.Date(substr(x,7,14),&quot;%Y%m%d&quot;)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=bZHPSsNAEMbxqE8xVNLsSlJ2sq3tijlYvSjoSaTiH1iTLQmmG8lupH0AL76Clyr4UPo0bghKq152hv34ffMN8_JaLd-m8Xttp-Ho4-mazKlOMlm5Gsc46iaE7YnAn_j0Cnlo6hkxtrJlTjIlU5Luh6pofsxDkVsyDzodSoMQKd2JbgkO91zneYg3cWxlXpA0QNrtStM7klYRU9851FHDAPs06HiX3sxLO7QN87nxPCU-IkM2QCEYazrGhz7d3ryQRZ5urch9gRF3cjT5kXtwnilIMpXcu9iADHIDlXooZKJSuFvApLf13wDROBzrx9bj8Jt3sIBcG-v2hnIKwzVYIG_g_mANPi21zQA5pKUy2reg5rmx62MF2-V_yZNaKyh1sYBMGuAMUrkwv8Fm5Yj_IlFAcz-ZWFWZ1cA4avmIH4zdIwY4Go8PXbeGn5U61PVMVXmy4tNrT7JctvUL" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Returns falsy as <code>FALSE</code> or <code>NA</code>.</p>
<p>Uses the checking formula from Wikipedia link.</p>
</div>
<div id="pu2" class="pu"><h1>JavaScript (ES6), 168 bytes</h1>
<p>Returns a Boolean value.</p>

<pre class="lang-javascript prettyprint-override"><code>S=&gt;S.replace(/^.{6}(....)(..)(..)...(\d|X)$|/,(_,y,m,d,c)=&gt;(new Date(y+=`-${m}-`+d).toJSON(g=s=&gt;s&lt;17?g(s+1,t=S[s]*2+t*13%11):1/c?c:10)+g).match(y)&amp;&amp;g(t=0)==(34-t)%11)&gt;g
</code></pre>
<p><a href="https://tio.run/##hdBdT9swFAbge37FEWLMJoljxy3FaC5a4QaksYtOUyX2gee4SbbERrELi4Df3qUCpE5dhyVb78WrR8fnp7pVXrfVTUisy81yLpdTOZ6S1tzUShuUfiP3h4@I9Aej59tn9CV/mOG9hzRG3@MubuI81liOkTV3cKaCQV0kr5O9@@YxuY5yTIK7mH68RIX0cuzfsdFJgXzE4iCnV/7rQRaFA8bfMIaPWapP9DGjOCowaVTQJerw/n6BgqRYSsQHScCr5rhYame9qw2pXYHmaJcxyuiQCUHpKlE@2sUYIE3hs6qrfGdLfSBYxvt6NvurTuBTaUCXRv/yiwYYhcrD81Zy@NHBjOy8NoB4Ec/t7ZN5@uL1mIDK@mBUDm4Oo62YYHyFDYYb2AdnQwmMQ@6Mt28DmN@VD9vHEvSQ/1u6WFgDztYdlMoDp5Crzv8PWq0s40/SOsREvzLVKh1M69f/x442uYy/n/SPGLKjyeS0TxtzXTqb2EVj2kqvuWT5Bw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>S =&gt;                                // S = input string
S.replace(                          // replace in S
  /^.{6}(....)(..)(..)...(\d|X)$|/, // if the string has the correct length and ends with
                                    // either a digit or 'X', we capture the year, month,
                                    // day and checksum; otherwise we match the empty string
  (_, y, m, d, c) =&gt;                // y = year, m = month, d = day, c = checksum
  (                                 // (they may be all undefined)
    new Date(                       // create a date
      y += `-${m}-` + d             // in YYYY-MM-DD format
    ).toJSON(                       // and convert it to ISO format
      g = s =&gt;                      // g is a recursive function taking a counter s:
      s &lt; 17 ?                      //   if s is less than 17:
        g(                          //     do a recursive call:
          s + 1,                    //       increment s
          t =                       //       update t:
            S[s] * 2 +              //         multiply the s-th character by 2
            t * 13 % 11             //         add t * 13, reduced modulo 11
        )                           //     end of recursive call
      :                             //   else:
        1 / c ?                     //     if c is numeric:
          c                         //       return c
        :                           //     else (c is 'X'):
          10                        //       return 10
    ) + g                           // coerce to a string (in case it's null)
  ).match(y) &amp;&amp;                     // test whether it matches the original YYYY-MM-DD string
  g(t = 0) ==                       // invoke g with t = s = 0
  (34 - t) % 11                     // test whether the checksum is correct
) &gt; g                               // test whether we get the string 'true' (greater than 's')
                                    // it may also be 'false' or starting with 'null'
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a> <code>-mList::Util -MTime::Local -plF</code>, 139 bytes</h1>

<pre class="lang-perl prettyprint-override"><code>$e=17;$_=/^\d{17}[X0-9]$/*/.{6}(....)(..)(..)/*eval{1+timegm 0,0,0,$3,$2-1,$1}&amp;&amp;(10*&quot;@F&quot;=~/X$/+pop@F)==(12-(sum map{$_*(2**$e--)}@F)%11)%11
</code></pre>
<p><a href="https://tio.run/##ZY9bS8MwFIDf9yvGiCPNmiYnWVdTCcwKfZpvCgUvo2iRQmqDrb6U@tONCSgKO4dz@84Fjm3eTOocajRkF@io2eP98wTZfFdxqh4QIyyZdjNOvET4xxhpPmozwWZsu@alW/I4KJIxEhRiBPN6jYGT1b5c6U9WIbaxvd2XkdYYBMXDe7fsajuhI8GCENRQGs2@fQYQzDkADjwFpTgPGZfZ4hdtFQjpkagWJ1PqDymQAW3Tf4jv5AkKx4QMTMjLwjuVwnlRXPnsq7dj278Ojl6niV/w8ca/m@eH/qk2vjq0w5jnt2NrtP/IUWvKbw" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, <s>70</s> 68 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>2ô4LÌè`UV«т‰0Kθ4ÖT*•Ωâн•+RºS₂+YD13‹×&lt;èX@×¨©13ö·(&gt;11%®Dd×g17Q×T'X:IθQ
</code></pre>
<p>Outputs a 05AB1E truthy/falsey result (only <code>1</code> is truthy in 05AB1E).<br />
Or to be more precise: outputs <code>1</code> for truthy and <code>0</code> or a list of thirteen <code>0</code>s as falsey.</p>
<p><a href="https://tio.run/##AYAAf/9vc2FiaWX//zLDtDRMw4zDqGBVVsKr0YLigLAwS864NMOWVCrigKLOqcOi0L3igKIrUsK6U@KCgitZRDEz4oC5w5c8w6hYQMOXwqjCqTEzw7bCtyg@MTElwq5EZMOXZzE3UcOXVCdYOknOuFH//zExMDEwNTE5NDkxMjMxMDAyWA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfeXhCYcn/Dc6vMXE53DP4RUJoWGHVl9setSwwcD73A6Tw9NCtB41LDq38vCiC3uBDO2gQ7uCHzU1aUe6GBo/ath5eLrN4RURDoenH1pxaKWh8eFth7Zr2Bkaqh5a55JyeHq6oXng4ekh6hFWled2BP7X@R@tZGhoYGhgamhpaWAAYhkYmyvpwAVNLA2NjIGCRhFIgnCVlsiClobGIEETUxRBAzNjLIIgQ42MIaJGxo5OQMLS1NDCyckZyFKKBQA" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>2ô                   # Split the (implicit) input-string into pairs
  4L                 # Push list [1,2,3,4]
    Ì                # Add 2 to each: [3,4,5,6]
     è               # Get the pairs at those 0-based indices
      `              # Pop and push all four pairs to the stack
       UV            # Pop the top two, and store them in variables `X` and `Y`
«                    # Merge the remaining two together
 т‰0Kθ4Ö             # Check that it's a leap year:
 т‰                  #  Divmod-100
   0K                #  Remove a potential 0
     θ               #  Pop and keep the last value
      4Ö             #  Check that it's divisible by 4
        T*           # Multiply this check by 10
          •Ωâн•      # Push compressed integer 5454525
            +        # Add the 10 or 0 to it
             R       # Reverse it
              º      # Mirror it
               S     # Convert it to a list of digits
                ₂+   # Add 26 to each:
                     #  [31,28 or 29,31,30,31,30,31,31,30,31,30,31,28 or 29,31]
         Y           # Push month `Y`
          D          # Duplicate it
           13‹       # Check that it's smaller than 13
              ×      # Repeat `Y` that many times (becomes &quot;&quot; if month &gt;= 13)
               &lt;     # Decrease it by 1 (no-op on &quot;&quot;)
                è    # Use it to index into the list (no-op for &quot;&quot;)
                 X@  # Check for each if it's &gt;= day `X`
                     # (if the month was &gt;=13, we now have a list of fourteen 1s)
                   × # Repeat the (implicit) input that many times
                     # (resulting in the input if the date was valid;
                     #  an empty string if the day was invalid;
                     #  or a list of 14 times the input if the month was invalid)
¨                    # Remove the last character (or item)
 ©                   # Store this in variable `®` (without popping)
  13ö                # Convert from base-13 to a base-10 integer
     ·               # Double it
      (              # Negate it
       &gt;             # Increase it by 1
        11%          # Modulo-11
 ®D                  # Push two copies of `®` again
   d×                # If it doesn't consist of just digits: make it &quot;&quot;
   g17Q×             # If it's length is NOT 17: make the checksum &quot;&quot;
   T'X:             '# Replace 10 with &quot;X&quot;
       IθQ           # Check that it equals the last character of the input
                     # (after which the result is output implicitly)
</code></pre>
<p><a href="https://codegolf.stackexchange.com/a/166851/52210">See this 05AB1E tip of mine (section <em>How to compress large integers?</em>)</a> to understand why <code>•Ωâн•</code> is <code>5454525</code>.</p>
<p>The leap year check was taken from <a href="https://codegolf.stackexchange.com/a/177019/52210">this 05AB1E answer of mine</a> (minor note: the top 6 bytes solution of that answer would need a <code>D</code>uplicate before it, since we use the input twice, but the <code>т‰0Kθ4Ö</code> above could alternatively have been <code>DтÖoooÖ</code> for the same byte-count: <a href="https://tio.run/##AX4Agf9vc2FiaWX//zLDtDRMw4zDqGBVVsKrRNGCw5Zvb2/DllQq4oCizqnDotC94oCiK1LCulPigoIrWUQxM@KAucOXPMOoWEDDl8KowqkxM8O2wrcoPjExJcKuRGTDl2cxN1HDl1QnWDpJzrhR//8xMTAxMDUxOTQ5MTIzMTAwMlg" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfeXhCYcn/Dc6vMXE53DP4RUJoWGHVrtcbDo8LT8///C0EK1HDYvOrTy86MJeIEM76NCu4EdNTdqRLobGjxp2Hp5uc3hFhMPh6YdWHFppaHx426HtGnaGhqqH1rmkHJ6ebmgeeHh6iHqEVeW5HYH/df5HKxkaGhgamBpaWhoYgFgGxuZKOnBBE0tDI2OgoFEEkiBcpSWyoKWhMUjQxBRF0MDMGIsgyFAjY4iokbGjE5CwNDW0cHJyBrKUYgE" rel="nofollow noreferrer">verify all test cases</a>.</p>
</div>
<div id="pu5" class="pu"><h1>Excel ms365, 167 bytes</h1>
<pre><code>=LET(i,ROW(1:17),x,MOD,y,MID,s,A1,IFERROR(--AND(DATE(y(s,7,4),y(s,11,2),y(s,13,2)),TEXT(x(1-2*x(SUM(y(s,i,1)*x(2^(17-i),11)),11),11),&quot;[=10]X;0&quot;)=RIGHT(s),LEN(s)=18),))
</code></pre>
<p>Expects input in <code>A1</code> and will output a <code>1</code> for valid or <code>0</code> for invalid.</p>
<p><a href="https://i.sstatic.net/AJjlXxk8.png" rel="nofollow noreferrer"><img src="https://i.sstatic.net/AJjlXxk8.png" alt="enter image description here" /></a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/283848/">283848</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




