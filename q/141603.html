<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::141603</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>021</td><td>APLNARS</td><td>250912T191224Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/283665#283665">Rosario</a></td></tr>
<tr d-ix="1"><td>030</td><td>TIBASIC TI84 Plus CE Python</td><td>250912T160838Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/283657#283657">madeforl</a></td></tr>
<tr d-ix="2"><td>068</td><td>JavaScript ES6</td><td>170906T105806Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141849#141849">Shaggy</a></td></tr>
<tr d-ix="3"><td>042</td><td>Haskell</td><td>171007T185403Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/144619#144619">SEJPM</a></td></tr>
<tr d-ix="4"><td>068</td><td>JavaScript ES6</td><td>170905T090457Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141645#141645">Neil</a></td></tr>
<tr d-ix="5"><td>036</td><td>Pari/GP</td><td>170906T121421Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141862#141862">alephalp</a></td></tr>
<tr d-ix="6"><td>121</td><td>Axiom</td><td>170906T053525Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141817#141817">user5898</a></td></tr>
<tr d-ix="7"><td>082</td><td>R</td><td>170905T024304Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141627#141627">Giuseppe</a></td></tr>
<tr d-ix="8"><td>007</td><td>Jelly</td><td>170904T194430Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141608#141608">Leaky Nu</a></td></tr>
<tr d-ix="9"><td>011</td><td>Japt</td><td>170905T095313Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141647#141647">Shaggy</a></td></tr>
<tr d-ix="10"><td>008</td><td>05AB1E</td><td>170905T081252Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141635#141635">Emigna</a></td></tr>
<tr d-ix="11"><td>033</td><td>J</td><td>170905T014852Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141624#141624">Jonah</a></td></tr>
<tr d-ix="12"><td>062</td><td>Python 2</td><td>170905T012332Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141623#141623">Dennis</a></td></tr>
<tr d-ix="13"><td>011</td><td>Pyth</td><td>170904T211215Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141614#141614">Mr. Xcod</a></td></tr>
<tr d-ix="14"><td>091</td><td>Mathematica</td><td>170904T193101Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141606#141606">ZaMoC</a></td></tr>
<tr d-ix="15"><td>011</td><td>Husk</td><td>170904T194330Z</td><td><a href="https://codegolf.stackexchange.com/questions/141603/compute-the-wilson-numbers/141607#141607">H.PWiz</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>APL(NARS), 21 chars</h1>
<pre><code>{⌊⍵÷⍨1+×/k/⍨1=⍵∨k←⍳⍵}
</code></pre>
<p>Even if do not follow the precise definition in the question it seems it would be ok until 1000 at last if used rational &quot;x&quot; numbers for bignums.</p>
<p>test:</p>
<pre><code>  g←{⌊⍵÷⍨1+×/k/⍨1=⍵∨k←⍳⍵}
  {⍵,g¨⍵}¨⍳8
1 2  2 1  3 1  4 1  5 5  6 1  7 103  8 13 
  {⍵,g¨⍵}¨9..14
9 249  10 19  11 329891  12 32  13 36846277  14 1379 
  {⍵,g¨⍵}¨15..20
15 59793  16 126689  17 1230752346353  18 4727  19 336967037143579  20 436486 
  {⍵,g¨⍵}¨21..25
21 2252263619  22 56815333  23 4.886959686E19  24 1549256  25 1.654529071E18 
  {⍵,g¨⍵}¨21..25x
21 2252263619  22 56815333  23 48869596859895986087  24 1549256  25 1654529071288638505 
  f←{e←¯1*1∊⍵∣×⍨¯2↓1↓k←⍳⍵⋄⍵÷⍨e+×/k/⍨1=⍵∨k}
  kkk/⍨{(g ⍵)≠f ⍵}¨kkk←⍳1000x
</code></pre>
</div>
<div id="pu1" class="pu"><h1>TI-BASIC (TI-84 Plus CE Python), 30 bytes</h1>
<pre><code>Input N
1+prod(seq(K^(1=gcd(K,N)),K,1,N
int(Ans/N
</code></pre>
<p>translation of <a href="https://codegolf.stackexchange.com/a/141607/121035">H.Pwiz's answer in Husk</a></p>
</div>
<div id="pu2" class="pu"><h1>JavaScript (ES6), <s>83</s> <s>81</s> <s>80</s> <s>78</s> <s>76</s> 68 bytes</h1>
<p>My first pass at this was a few bytes longer than Neil's solution, which is why I originally ditched it in favour of the array reduction solution below. I've since golfed it down to tie with Neil.</p>
<pre class="lang-js prettyprint-override"><code>n=&gt;(g=s=&gt;--x?g(s*(h=(y,z)=&gt;z?h(z,y%z):--y?1:x)(n,x)):++s)(1,x=n)/n|0
</code></pre>
<hr />
<h3>Try it</h3>
<p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>o.innerText=(f=
n=&gt;(g=s=&gt;--x?g(s*(h=(y,z)=&gt;z?h(z,y%z):--y?1:x)(n,x)):++s)(1,x=n)/n|0
)(i.value=8);oninput=_=&gt;o.innerText=f(+i.value)</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;input id=i type=number&gt;&lt;pre id=o&gt;</code></pre>
</div>
</div>
</p>
<hr />
<h1>Non-recursive, 76 bytes</h1>
<p>I wanted to give a non-recursive solution a try to see how it would turn out - not as bad as I expected.</p>
<pre class="lang-js prettyprint-override"><code>n=&gt;-~[...Array(x=n)].reduce(s=&gt;s*(g=(y,z)=&gt;z?g(z,y%z):y&lt;2?x:1)(--x,n),1)/n|0
</code></pre>
<hr />
<h2>Try it</h2>
<p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>o.innerText=(f=
n=&gt;-~[...Array(x=n)].reduce(s=&gt;s*(g=(y,z)=&gt;z?g(z,y%z):y&lt;2?x:1)(--x,n),1)/n|0
)(i.value=8);oninput=_=&gt;o.innerText=f(+i.value)</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;input id=i type=number&gt;&lt;pre id=o&gt;</code></pre>
</div>
</div>
</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, 42 bytes</h1>



<pre class="lang-hs prettyprint-override"><code>f n=div(product[x|x&lt;-[1..n],gcd x n&lt;2]+1)n
</code></pre>

<p><a href="https://tio.run/##LYyxCoMwFEX3fsUbHAytgkIXiYNDh84dxSGYqKHmRV5exUL/PW3Fu1w43HMnFZ5mnqN1iyeGxzuwcfkNV0senUFOR8MNjUHEAbDWdk0X8vrVc7t9Npm1RZ5jdxl7DRugLLtzITA6ZbEG7U@wR/18kBkcVwddyCInA6RklIYEpn/t06qCO7KIsbx@AQ" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>

<p>Uses the integer division trick as all the other answers.<br>
Uses 1-based indices.</p>

<p><strong>Explanation</strong></p>

<pre class="lang-hs prettyprint-override"><code>f n=                                       -- function
    div                                  n -- integer division of next arg by n
       (product                            -- multiply all entries in the following list
               [x|                         -- return all x with ...
                  x&lt;-[1..n],               -- ... 1 &lt;= x &lt;= n and ...
                            gcd x n&lt;2]     -- ... gcd(x,n)==1
                                      +1)  -- fix e=1
</code></pre>
</div>
<div id="pu4" class="pu"><h2>JavaScript (ES6), <s>72</s> <s>70</s> 68 bytes</h2>

<p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>f=(n,p=1,i=n,a=n,b=i)=&gt;i?f(n,b|a-1?p:p*i,i-=!b,b||n,b?a%b:i):-~p/n|0</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;input type=number min=1 oninput=o.textContent=f(+this.value)&gt;&lt;pre id=o&gt;</code></pre>
</div>
</div>
</p>

<p>Integer division strikes again. Edit: Saved 2 bytes thanks to @Shaggy. Saved a further 2 bytes by making it much more recursive, so it may fail for smaller values than it used to.</p>
</div>
<div id="pu5" class="pu"><h1><a href="http://pari.math.u-bordeaux.fr/" rel="nofollow noreferrer">Pari/GP</a>, 36 bytes</h1>

<pre><code>n-&gt;(prod(i=1,n,i^(gcd(i,n)==1))+1)\n
</code></pre>

<p><a href="https://tio.run/##DYoxCoAwDAC/EpwSTIcIjvElIojSkiUNwf/XLgd3XNxppcWooDC8HBjZXzQVdrYL2zOFnVSFaBU6fdSe6PMWhm1niDT/ZligHBMVnYjGDw" rel="nofollow noreferrer" title="Pari/GP – Try It Online">Try it online!</a></p>
</div>
<div id="pu6" class="pu"><h1>Axiom, 121 bytes</h1>

<pre><code>f(n)==(e:=p:=1;for i in 1..n repeat(if gcd(i,n)=1 then p:=p*i;e=1 and i&gt;1 and i&lt;n-1 and(i*i)rem n=1=&gt;(e:=-1));(p+e)quo n)
</code></pre>

<p>add some type, ungolf that and result</p>

<pre><code>w(n:PI):PI==
   e:INT:=p:=1
   for i in 1..n repeat
       if gcd(i,n)=1 then p:=p*i
       e=1 and i&gt;1 and i&lt;n-1 and (i*i)rem n=1=&gt;(e:=-1)
   (p+e)quo n

(5) -&gt; [[i,f(i)] for i in 1..25]
   (5)
   [[1,2], [2,1], [3,1], [4,1], [5,5], [6,1], [7,103], [8,13], [9,249],
    [10,19], [11,329891], [12,32], [13,36846277], [14,1379], [15,59793],
    [16,126689], [17,1230752346353], [18,4727], [19,336967037143579],
    [20,436486], [21,2252263619], [22,56815333], [23,48869596859895986087],
    [24,1549256], [25,1654529071288638505]]
                                                  Type: List List Integer

(8) -&gt; f 101
   (8)
  9240219350885559671455370183788782226803561214295210046395342959922534652795_
   041149400144948134308741213237417903685520618929228803649900990099009900990_
   09901
                                                    Type: PositiveInteger
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 82 bytes</h1>



<pre class="lang-r prettyprint-override"><code>function(n)(prod((1:n)[g(n,1:n)&lt;2])+1)%/%n
g=function(a,b)ifelse(o&lt;-a%%b,g(b,o),b)
</code></pre>

<p>Uses integer division rather than figuring out <code>e</code> like many answers here, although I did work out that <code>e=2*any((1:n)^2%%n==1%%n)-1</code> including the edge case of <code>n=1</code> which I thought was pretty neat.</p>

<p>Uses <a href="https://codegolf.stackexchange.com/a/95328/67312">rturnbull's vectorized GCD function</a>.</p>

<p><a href="https://tio.run/##PYxBCoAgEADv/UPYpY2wY@hLooNWiiCraB16vdWl2zAMU5rTzV28nSExMEIuaQeQM@PigekDNa3YSxSj4M7rPzZkMbgj1gOSGowQljxYSvj6Vk3O8X4/ciKH7QE" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>8</s> 7 bytes</h1>

<p>1 byte thanks to Dennis.</p>

<pre><code>gRỊTP‘:
</code></pre>

<p><a href="https://tio.run/##y0rNyan8/z896OHurpCARw0zrP4bmR5uf9S05j8A" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<p>You don't really have to compute <code>e</code> since you need to divide anyway.</p>
</div>
<div id="pu9" class="pu"><h1><a href="https://github.com/ETHproductions/japt/" rel="nofollow noreferrer">Japt</a>, 11 bytes</h1>
<pre><code>õ fjU ×Ä zU
</code></pre>
<p><a href="https://ethproductions.github.io/japt/?v=1.4.5&amp;code=9SBmalUg18QgelU=&amp;input=OA==" rel="nofollow noreferrer">Try it</a></p>
<hr />
<h2>Explanation</h2>
<p>Implicit input of integer <code>U</code>.</p>
<pre><code>õ
</code></pre>
<p>Generate an array of integers from 1 to <code>U</code>.</p>
<pre><code>fjU
</code></pre>
<p>Filter (<code>f</code>) co-primes of <code>U</code>.</p>
<pre><code>×
</code></pre>
<p>Reduce by multiplication.</p>
<pre><code>Ä
</code></pre>
<p>Add 1.</p>
<pre><code>zU
</code></pre>
<p>Divide by <code>U</code>, floor the result and implicitly output.</p>
</div>
<div id="pu10" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E" rel="nofollow noreferrer">05AB1E</a>, 8 bytes</h1>

<pre><code>Lʒ¿}P&gt;I÷
</code></pre>

<p><a href="https://tio.run/##MzBNTDJM/f/f59SkQ/trA@w8D2///98MAA" rel="nofollow noreferrer" title="05AB1E – Try It Online">Try it online!</a></p>
</div>
<div id="pu11" class="pu"><h1>J, 33 bytes</h1>
<pre><code>3 :'&lt;.%&amp;y&gt;:*/(#~1&amp;=@(+.&amp;y))1+i.y'
</code></pre>
<p>This one is more of a request to see an improvement than anything else.  I tried a tacit solution first, but it was longer than this.</p>
<h1>explanation</h1>
<p>This is fairly straightforward translation of Mr. Xcoder's solution into J.</p>
<p><a href="https://tio.run/##y/r/P91WT8FYwUrdRk9VrdLOSktfQ7nOUM3WQUNbT61SU9NQO1OvUp0rNTkjXyFdwRDGMIKLGP//DwA" rel="nofollow noreferrer" title="J – Try It Online">Try it online!</a></p>
</div>
<div id="pu12" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, 62 bytes</h1>



<pre class="lang-python prettyprint-override"><code>n=input();k=r=1
exec'r*=k/n*k%n!=1or k/n;k+=1;'*n*n
print-~r/n
</code></pre>

<p><a href="https://tio.run/##HY1BDsIgEEXXcIpxQabFNg0sXJTMYaqiEmTaEJroxqtj2@XPy3t/@ZbXzLY@5gwJAkOe@Okb04G9tKMUgZe1AMF7Stf7NEKSYsmBC6Dq7YqgIHVS@I@/ASJWpkNoWhcpk5E7wKwpDqyj4hOZ7WcbLp7JONSsWR69/pcHrnviDw" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>
</div>
<div id="pu13" class="pu"><h1><a href="https://pyth.readthedocs.io" rel="nofollow noreferrer">Pyth</a>, 11 bytes</h1>
<pre><code>/h*Ff&gt;2iTQS
</code></pre>
<p><a href="https://pyth.herokuapp.com/?code=%2Fh%2aFf%3E2iTQS&amp;test_suite=1&amp;test_suite_input=1%0A2%0A3%0A4%0A5%0A6%0A7&amp;debug=0" rel="nofollow noreferrer">Try it here!</a></p>
<hr />
<h1>How?</h1>
<ul>
<li><p><code>/h*Ff&gt;2iTQS</code> - Full program.</p>
</li>
<li><p><code>S</code> - Generate the inclusive range <strong>[1, input]</strong></p>
</li>
<li><p><code>f</code> - Filter-keep those:</p>
<ul>
<li><p><code>iTQ</code> - whose GCD with the input.</p>
</li>
<li><p><code>&gt;2</code> - Is less than two (can be replaced by either of the following: <code>q1</code>, <code>!t</code>)</p>
</li>
</ul>
</li>
<li><p><code>*F</code> - Apply multiplication repeatedly. In other words, the product of the list.</p>
</li>
<li><p><code>h</code> - Increment the product by 1.</p>
</li>
<li><p><code>/</code> - Floor division with the input.</p>
</li>
</ul>
<p><strong>TL;DR</strong>: Get all the coprimes to the input in the range <strong>[1, input]</strong>, get their product, increment it and divide it by the input.</p>
</div>
<div id="pu14" class="pu"><h1>Mathematica, 91 bytes</h1>
<pre><code>If[(k=#)==1,2,(Times@@Select[Range@k,CoprimeQ[k,#]&amp;]+If[IntegerQ@PrimitiveRoot@#,1,-1])/#]&amp;
</code></pre>
</div>
<div id="pu15" class="pu"><h1><a href="https://github.com/barbuz/Husk" rel="noreferrer">Husk</a>, 11 bytes</h1>
<pre><code>S÷ȯ→Π§foε⌋ḣ
</code></pre>
<p><a href="https://tio.run/##ASEA3v9odXNr//9Tw7fIr@KGks6gwqdmb8614oyL4bij////MjU" rel="noreferrer" title="Husk – Try It Online">Try it online!</a></p>
<h3>Explanation</h3>
<pre><code>          ḣ   Range from 1 to input
     §foε⌋    Keep only those whose gcd with the input is 1
    Π         Product
  ȯ→          Plus 1
S÷            Integer division with input
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/141603/">141603</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




