<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::200685</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>nan</td><td>Pari/GP</td><td>241031T014422Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/276413#276413">138 Aspe</a></td></tr>
<tr d-ix="1"><td>034</td><td>Charcoal</td><td>200307T192455Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200708#200708">Neil</a></td></tr>
<tr d-ix="2"><td>033</td><td>Python 3 + SymPy</td><td>200311T010451Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200856#200856">Bubbler</a></td></tr>
<tr d-ix="3"><td>016</td><td>J</td><td>200310T101654Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200834#200834">Bubbler</a></td></tr>
<tr d-ix="4"><td>2526</td><td>MATL</td><td>200307T173639Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200704#200704">Jonathan</a></td></tr>
<tr d-ix="5"><td>2122</td><td>Jelly</td><td>200307T140016Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200701#200701">Jonathan</a></td></tr>
<tr d-ix="6"><td>068</td><td>R</td><td>200307T115256Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200693#200693">Robin Ry</a></td></tr>
<tr d-ix="7"><td>083</td><td>R</td><td>200310T160959Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200844#200844">Giuseppe</a></td></tr>
<tr d-ix="8"><td>261</td><td>Java 8</td><td>200309T110208Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200786#200786">Kevin Cr</a></td></tr>
<tr d-ix="9"><td>034</td><td>Magma</td><td>200308T070452Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200720#200720">Gymhgy</a></td></tr>
<tr d-ix="10"><td>114</td><td>WIN+APL</td><td>200307T202632Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200709#200709">Graham</a></td></tr>
<tr d-ix="11"><td>033</td><td>SageMath</td><td>200307T105938Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200690#200690">Noodle9</a></td></tr>
<tr d-ix="12"><td>006</td><td>Sledgehammer</td><td>200307T184701Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200706#200706">Expired </a></td></tr>
<tr d-ix="13"><td>025</td><td>Jelly</td><td>200307T111812Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200691#200691">Nick Ken</a></td></tr>
<tr d-ix="14"><td>128</td><td>R</td><td>200307T135429Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200700#200700">Nick Ken</a></td></tr>
<tr d-ix="15"><td>206</td><td>JavaScript ES6</td><td>200307T100328Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200688#200688">Arnauld</a></td></tr>
<tr d-ix="16"><td>023</td><td>Wolfram Language Mathematica</td><td>200307T095948Z</td><td><a href="https://codegolf.stackexchange.com/questions/200685/rgs-4-5-inverting-matrices-modulo-m/200687#200687">ZaMoC</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="http://pari.math.u-bordeaux.fr/" rel="nofollow noreferrer">Pari/GP</a>, <del>505</del> <del>299</del> <del>196</del> 188 bytes</h1>
<p>Saved 317 bytes thanks to @ceilingcat</p>
<hr />
<p>Golfed version. <a href="https://tio.run/##VY7NasMwEITvfQpBKezWG2pJVhKjKuDnMC4Exy4y8Q9yDoXSZ3dXdkubg6Rhv1nNTOfgd@/TsrRQUI/u8zrW5ysM1NBMI9rG9edb8B8wuMcCbTsG8E7SQFF1q5p/LaMbdnLzBCbj6qlXNZeB6soVZUggnJxHqhOoT67DCtH6FqApO/KVA/7hDXzS4TP/emluMONTj68pbYbE9cgbzcsPLZh@LVPwww1aKNWehNxbfSSRyYovg/jwR3MSJrXxiVDndzDjaWZFFndNxHe7mSahUiukIXFkavR/ylMpSTNXKUlFGSutSRlSscVdkOAAbqAU5x1sjNXpdmRuNZO1ABu0Nds8WrUWsdMBcfkG" rel="nofollow noreferrer">Try it online!</a></p>
<pre><code>f(A,m)={local(n,e,s,o);e=matrix(n=#A);for(i=1,n,for(j=1,n,s=matrix(o=n-1);for(r=1,o,for(c=1,o,s[r,c]=A[r+(r&gt;=i),c+(c&gt;=j)]));if((e[j,i]=(-1)^(i+j)*matdet(s)%m)&lt;0,e[j,i]+=m)));e/matdet(A)%m}
</code></pre>
<p>Ungolfed version. <a href="https://tio.run/##fVTNbtpAEL7zFFOkSnayKKwN@anDAfXSHrhU7QmRyjELWWKv3fU6LanyAH2MvlpfhM6sFzAExxK2mf32m2@@mXURa9lbFpvNxRl8EabSqgTzIECqJ6FLAfkCstho@QvGkOXzKs0hY5BrEFrjXS5A5aZGG3mfig4AfCtFTRLPV9UyNmJLkQnzkM8/EGZ85/W4D//@/CWUN/bhDObC4Eu94GEyyDB60cHNTg3GvDGj8Ah@EwukeRKnnmK0194QyYjRj@y6vaFIz6wLQVnejaBrvk/GX7vMrtFlS/G6n1VRGciq0sA9aneiu77FNfkUpsfFUj4T5ZTPol0aRQkaa8HsVZqJ88LlKX9UsRYnsmBDPsZpUqVkIFYmdCZVrAxYZ8gYQuFCraY2D95DdsTxIJJH0takkGWjZYeEVMUymXvW0MwaxttqQJrD7m9HpIs73y6oMV9v1YYwLC@VC@NNsPn8wslq5T0eOUeF4domjOG4KLd/gcXIEWeg9iVSbHUUc2loMu88eb5y07qTTadEKjwPLt32wrTTFZMzzH2w1/ULH3YbDrVkK7/Rve1F3diR3EKf7SnPR1uTrdGn7J5UqZFFut67cr/eOd9qu7afAW9nOnl3tjtb6D1meel0kP@TSAuhYVGpxMhcgclhifNYW@EagBk1HtwnqZag858gIVZzSPK0yhSs3PluuvD6bNtVV1rL2atT7jvc4wx/x1OSF2sQqciEMiWD8lEWRbus7SxoOws9fjghyavoTsZUs4Q6Pp7KhadvJdNMn3OfYTO95HbFEpbg31l0unfO/W3NL5tCS2VHpfERnAaXDPhlFF4zGPAZ3oa@3zmNvGEw7Ef0IGB40wocIGIQwYA4hwRt5RyEDIJ@BHzI4BqRw7ANiQjOWYjYoM94wAb4FoYsGLKAVLeKARSBioMANV1FJC3s1z9@E4W4YkUiIIyGdZygYQik@8r3N/8B" rel="nofollow noreferrer">Try it online!</a></p>
<pre><code>/* Returns the inverse of matrix A modulo m, or error if not invertible
   Uses the adjugate matrix method:
   A^(-1) ≡ adj(A) * det(A)^(-1) (mod m) */
matinversemod(A, m) = {
    local(n, det, detinv, adj);
    
    if (type(A) != &quot;t_MAT&quot;,
        error(&quot;Input must be a matrix&quot;)
    );
    
    n = matsize(A)[1];
    if (n != matsize(A)[2],
        error(&quot;Matrix must be square&quot;)
    );
    
    /* Calculate determinant mod m */
    det = matdet(A) % m;
    
    /* Check if determinant is invertible mod m */
    if (gcd(det, m) != 1,
        error(&quot;Matrix is not invertible modulo &quot; m)
    );
    
    /* Calculate inverse of determinant mod m */
    detinv = lift(Mod(1/det, m));
    
    /* Calculate adjugate matrix */
    adj = matrix(n,n);
    for(i=1, n,
        for(j=1, n,
            /* (-1)^(i+j) * determinant of minor */
            adj[j,i] = (-1)^(i+j) * matdet(matminor(A,i,j)) % m;
            if (adj[j,i] &lt; 0, adj[j,i] += m)
        )
    );
    
    /* Multiply adjugate by inverse determinant mod m */
    return(lift(Mod(adj * detinv, m)));
}

/* Helper function to get minor matrix by removing row i and column j */
matminor(A,i,j) = {
    local(n, minor);
    n = matsize(A)[1];
    minor = matrix(n-1,n-1);
    
    /* Copy elements, skipping row i and column j */
    for(r=1, n-1,
        for(c=1, n-1,
            minor[r,c] = A[if(r&lt;i,r,r+1), if(c&lt;j,c,c+1)];
        )
    );
    return(minor);
}
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, <s>41</s> 34 bytes</h1>
<pre><code>ＩＥη⊟ΦＥＸθη÷λＸθ…⁰η⬤λ⁼⁼ιξ﹪ΣＥλ×π§§ζρξθ
</code></pre>
<p><a href="https://tio.run/##NUzJCoMwFPyVd3zCK9hFKPRUuoAHQdrexEPQUAMx0Rit9OfTROxcZpitapipNJPO5UYoixc2WMxYhw1Brju8C2m5WZxcf7zqCZqIIFX2KiZRc5ShuCYPpt4c41DxIDhLGfJbPzI54EqCYPZZputRanyO7fLuay/R8gE7P7OpqvmMf/4SmCisltM@WnFyrkj2BDuCojgEEZdebhOCY1mWbjPJHw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Takes input as <span class="math-container">\$ m, n, M \$</span> where <span class="math-container">\$ n \$</span> is the size of <span class="math-container">\$ M \$</span>, and does not reduce its output modulo <span class="math-container">\$ m \$</span> (can be done at a cost of 2 bytes). Slow, so times out for the large test cases. (Will crash if given a singular matrix.) Explanation:</p>
<pre><code>  η                                 Input `n`
 Ｅ                                  Map over implicit range
       θ                            Input `m`
      Ｘ                             Raised to power
        η                           Input `n`
     Ｅ                              Map over implicit range
          λ                         Current value
         ÷                          Vectorised integer divide
            θ                       Input `m`
           Ｘ                        Vectorised raise to power
             …                      Range from
              ⁰                     Literal integer `0`
               η                    To input `n`
    Φ                               Filtered where
                 λ                  Current row
                ⬤                   All indices satisfy
                    ι               Outermost value
                   ⁼                Equals
                     ξ              Inner index
                  ⁼                 Equals
                         λ          Current row
                        Ｅ           Map over values
                           π        Current value
                          ×         Multiplied by
                              ζ     Input `M`
                             §      Indexed by
                               ρ    Innermost index
                            §       Indexed by
                                ξ   Inner index
                       Σ            Take the sum
                      ﹪             Modulo
                                 θ  Input `m`
   ⊟                                Take the assumed match
Ｉ                                   Cast to string
                                    Implicitly print
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a> + <a href="https://docs.sympy.org/latest/index.html" rel="nofollow noreferrer">SymPy</a>, 33 bytes</h1>

<pre class="lang-python prettyprint-override"><code>from sympy import*
Matrix.inv_mod
</code></pre>
<p><a href="https://tio.run/##XVLLaoRAELz7FQ256DIJzrSzroHkD/IFMoRAkHjwgWtC/HrTNY2b1YNKd3VVT9U4LvPX0PO6NtPQ0XXpxoXabhym@ZS8fcxT@/vU9j/v3fC5Ni/7RpI0w0RtP37PV/lQnRClOpLWtTsbsudgqOaLocKGkMnHy@uBHl9JBpzUjAFXGeIyhD1fmj7fYKVz9U@30K@AFwL4I1uatogotnul3233hsqNzAdywYZcXG1l7BK5nndc1eYSKnsyKNaKqp49lwpGY8UQFtxpGHduIiIndRoINKTKtwIm7PGY0pNkEKONVuCZc300GRY82t@EvaLgwDUyKbNbolgijnBz7pY8o2LcAPKQRh7XRrmoBUw2O7miJDzTOLX9nDbpSX@MLFv/AA" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>SymPy's Matrix class has a <a href="https://docs.sympy.org/latest/modules/matrices/matrices.html?highlight=inv_mod#sympy.matrices.matrices.MatrixBase.inv_mod" rel="nofollow noreferrer">method for modular inverse</a>.</p>
</div>
<div id="pu3" class="pu"><h1><a href="http://jsoftware.com/" rel="nofollow noreferrer">J</a>, <sup><s>18</s></sup> 16 bytes</h1>

<pre><code>(]%1+.]^5 p:[)%.
</code></pre>

<p><a href="https://tio.run/##dVBNT8JAED3TXzEx9GOLLu62Fd0Es9HEk/HgtWmNgRLrRyCAZo2Vv44zS4GC6WGy2Tdv3nszr@uH6bIAfzYvvsrp5wKW87JY@E4MyjdVGY5DASVfmSoouWHheMhD3j8NxI/0jGLedTnkLv/2nbRyuc629LQquU6JnSrk68aAdnkrWViu/uWyUtooyzzrAw@RbCd23/xJ9BKYqRQZ400vQIG6y/btIHN7VjTLLcBQFLFUWbQJBmnNVDlLvJliK0K3YJBbzIICb@NyN/cCmv5gOrAchqv5Vkf0eFMjI6AWWNUBhIecZiICjkLSgE7zFU5nBG3@lH6H6cxhzgn3JzBU4MMpnIPCOuNw@3h/t95Y71XXzPl4XhJXguzKCwMCK7o0EAvjFKOXKcQJTABJnU7n4YbDvFh8vi93rYpa0KMz75nEG70Uo7cD8SsDybkBerfa0VWrNraa2jvmP@0Ioq5IUFNgcNLHEhIXwDeK8I89ud2l3S8@9Itb/WKIu3gf3EKiixjgG2@cqQTiERZdkIwxQFLnkjZPvd2gffHB4eKD4yDrPw" rel="nofollow noreferrer" title="J – Try It Online">Try it online!</a></p>

<p>Resolves <code>p/q mod n</code> element-wise (instead of using <code>det(M)</code> to resolve the modular inverse globally).</p>

<p>Abuses GCD of rational numbers to extract <code>1/q</code> from <code>p/q</code>.</p>

<h3>How it works</h3>

<pre><code>(]%1+.]^5 p:[)%.    NB. left arg = modulo, right arg = matrix
(            )%.    NB. bind inv(matrix) as new right arg
        5 p:[       NB. phi(modulo)
      ]^            NB. inv(matrix)^phi(modulo) element-wise
   1+.              NB. GCD with 1; GCD(1, p/q) = 1/q
 ]%                 NB. Divide inv(matrix) by the above element-wise
</code></pre>

<hr>

<h1><a href="http://jsoftware.com/" rel="nofollow noreferrer">J</a>, 18 bytes</h1>

<pre><code>%.@]*-/ .*@]^5 p:[
</code></pre>

<p><a href="https://tio.run/##dZBbT8JAEIWf6a@YGKC0wMBeamUTTKOJT4YHXxs1BkpYL4FAMWus/PU6W2gBTR8mk93z7Tkz@5pPlmkC7mqdfOrldgPpWicb15GgXJNpf@Yz0LgzWUej8fzZGH0c9Drsm7eN8trXeowt/HKdOGth9FjicaYxii0dK@KjkwdRC2thVrDRD/JMRUYVZH8A6BNcvKiOT8@sG8BKxUTM9lqHDA6qd5Q95wLdOYwVuNCDISiqPsLtw/1dXjwrDQs89xzn4yW1OAfe5JcGGJW4MiCZcZLpYgkygDkQ1Gg0JjcI62SzfU8rKbMSdK3pkbTcdJFM387MRwaCoQHbS28xqvUm6dS7Iv95CxBNFpAno8GtPxXjtAB1IehMGi93qc@T53myNk@CbNL/0BacUlhIXe6TbTG6F1T2B20wDRAc5uLFPIftwvrFw/PFw7@D5L8" rel="nofollow noreferrer" title="J – Try It Online">Try it online!</a></p>

<p>A dyadic tacit function that takes modulo (left arg) and the matrix (right arg), and gives possibly very large-valued modular inverse of the matrix. To reduce the range, prepend <code>[|</code> at the start of the function.</p>

<h3>How it works: the math</h3>

<p>A simple mathematical way to calculate the modular inverse of a matrix is the following:</p>

<p><span class="math-container">$$
\begin{align}
M^{-1} \text{ mod }n &amp;= \text{cofactor}(M) \times \bigl((\det M)^{-1} \text{ mod }n \bigr) \\
&amp;= M^{-1} \times \det M \times \bigl((\det M)^{-1} \text{ mod }n \bigr)
\end{align}
$$</span></p>

<p>If the matrix <span class="math-container">\$M\$</span> is invertible modulo <span class="math-container">\$n\$</span>, we know that <span class="math-container">\$(\det M)^{-1} \text{ mod }n\$</span> exists, and it can be found using Euler's theorem:</p>

<p><span class="math-container">$$
(\det M)^{-1} \equiv (\det M)^{\varphi(n)-1} \text{ mod }n
$$</span></p>

<p>Then we can simplify the original equation to</p>

<p><span class="math-container">$$
\begin{align}
M^{-1} \text{ mod }n &amp;= M^{-1} \times \det M \times \bigl((\det M)^{\varphi(n)-1} \text{ mod }n \bigr) \\
&amp;\equiv M^{-1} \times (\det M)^{\varphi(n)} \mod{n}
\end{align}
$$</span></p>

<p>And now the fun fact: J has built-ins for matrix inverse, matrix determinant, and Euler's totient function. And it uses built-in rational numbers when calculating the matrix inverse!</p>

<h3>How it works: the code</h3>

<pre><code>%.@]*-/ .*@]^5 p:[    NB. left arg = modulo, right arg = matrix
             5 p:[    NB. totient(modulo)
     -/ .*@]          NB. det(matrix)
            ^         NB. det(matrix) ^ totient(modulo)
%.@]                  NB. inv(matrix)
    *                 NB. inv(matrix) * det(matrix) ^ totient(modulo)
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, (25?) <s>&nbsp;31 29&nbsp;</s> 26 bytes</h1>

<p><em>My first MATL answer</em></p>

<p>-5 bytes &amp; a bug-fix (+2) thanks to Luis Mendo!</p>

<p>The trailing <code>.</code> may be unnecessary - it is if there is only ever a single inverse of <code>M</code> with elements modulo <code>m</code>.</p>

<pre><code>:inZ^!"&amp;G@[]eY*w\tZyXy=?@.
</code></pre>

<p>A full program which prints the elements in row major order separated by newlines.</p>

<p><strong><a href="https://tio.run/##y00syfn/3yozLypOUUnN3SE6NjVSqzymJKoyotLW3kHv/39TrmhDUwVDY2sFI0MgFQsA" rel="nofollow noreferrer" title="MATL – Try It Online">Try it online!</a></strong> - Too slow for any of the given test cases.</p>

<p>Quite possibly not the best approach for MATL.</p>

<h3>How?</h3>

<pre><code>:inZ^!"&amp;G@[]eY*w\tZyXy=?@. - expects inputs m and M
:                          - range (m) -&gt; [1,2,...,m]
 i                         - push input (M)
  n                        - number of elements
   Z^                      - ([1,2,...,m]) Cartesian power (#elements(M))
     !                     - transpose
      "                    - for each column, C:
       &amp;G                  -   push both inputs
         @                 -   push C
          []               -   push an empty array (to make e work as below)
            e              -   reshape (C) to square matrix of side ceil(#elements(C)^0.5)
             Y*            -   (reshaped C) matrix multiplication (copy of M)
               w           -   swap top two stack entries
                \          -   (multiplication result) modulo (copy of m)
                 t         -   duplicate top of stack
                  Zy       -   size
                    Xy     -   (size by size) identity matrix
                      =    -   equal -&gt; logical matrix
                       ?   -   if all are truthy:
                        @  -     push C
                         . -     break
                           - implicit print of stack (the valid C)
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, (21?) 22 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>

<p>The trailing <code>Ṫ</code> may be unnecessary - it is if there is only ever a single inverse of <code>M</code> with elements modulo <code>m</code>.</p>

<pre><code>Ḷṗ⁹L²¤ṁ€⁹æ×%³L⁼þ`$ƑɗƇṪ
</code></pre>

<p>A full program printing the result.</p>

<p><strong><a href="https://tio.run/##y0rNyan8///hjm0Pd05/1LjT59CmQ0se7mx81LQGyDu87PB01UObfR417jm8L0Hl2MST04@1P9y56v///6b/o6MNTXUUDI1jdRSijQzBrFgA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> - Too slow for any of the given test cases (the 35 case took ~20 minutes locally).</p>

<hr>

<p><strong>11 bytes</strong> (but floating point output):</p>

<p>Using <a href="https://codegolf.stackexchange.com/a/200834/53748">Bubler's observation</a> (go upvote!) that raising the determinant to Euler's totient is enough to remove the determinant's denominators:</p>

<pre><code>æ*-×ÆḊ*ÆṪ}ɗ
</code></pre>

<p>However, unlike in J, the inversion of <span class="math-container">\$M\$</span> in Jelly gives floats so we no longer get an integer matrix as output.</p>

<p><a href="https://tio.run/##y0rNyan8///wMi3dw9MPtz3c0aUFJHeuqj05/f///9HRhqY6CoaGOgrGBrE6CtFGBkCekY6CCZhnbKyjYASUN4qN/W9iCQA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 68 bytes</h1>



<pre class="lang-r prettyprint-override"><code>function(M,m,n,A=M){while(any(A%*%M%%m!=diag(n)))A[]=rpois(n^2,9)
A}
</code></pre>

<p><a href="https://tio.run/##K/qfZvs/rTQvuSQzP0/DVydXJ0/H0dZXs7o8IzMnVSMxr1LDUVVL1VdVNVfRNiUzMV0jT1NT0zE61raoID@zWCMvzkjHUpPLsfZ/mkZuYklRZoVGsoaRmY6CIRAbW@gomBhq6hhpAmlTHQUjzf8A" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>

<p>Strikingly slow. Will most likely time out for all test cases on TIO, but is guaranteed to give an answer eventually.</p>

<p>Works by rejection sampling: generates random matrices <code>A</code>, with each value taken from a <span class="math-container">\$Poisson(9)\$</span> distribution, until a solution is found.</p>

<p>Note that to get <code>A</code> of the correct dimensions, it is 6 bytes shorter to initialize it as <code>A=M</code> and then replace all the values with <code>A[]=rpois(n^2,9)</code> than to create it directly with <code>A=matrix(rpois(n^2,9),n)</code>.</p>
</div>
<div id="pu7" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, <s>97</s> 83 bytes</h1>

<pre class="lang-r prettyprint-override"><code>function(M,m,d){while(any(M%*%(x=matrix(T%/%m^(1:d^2-1),d))%%m-diag(d)))T=T+1;x%%m}
</code></pre>
<p><a href="https://tio.run/##TczRCsIwDAXQd79iIIVUb5Fu3RB1n7C3Pg/G5rRgJ4yJFfHbawYKgxDCzUnG2CcnlcT@MbSTuw9UwaOT7@fV3c7UDC@qxEZQKH0zjS6QFTvha9KHrk6VlkylEF51rrkQz9KWdquPgbNPXPf0u2pJI0MOI5FyFdxXyy0nukC2h@GXKWAlTD6jpTHQBoZN/jfZbOIX" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<p>Pretty slow. Takes the <code>d</code>imension of the matrix as input. The previous version using a <code>for</code> loop is a bit faster.</p>
<p>Thanks to Robin Ryder for -14 bytes.</p>
<h3>Explanation:</h3>
<p>We iterate over every number between <span class="math-container">\$1\$</span> and <span class="math-container">\$m^{d^2}\$</span>, converting each to its base-<span class="math-container">\$m\$</span> digits (with leading zeros), reshaping those digits into a matrix of the appropriate size, and testing to see if it's the inverse of <span class="math-container">\$M\$</span> modulo <span class="math-container">\$m\$</span>.</p>
<p>I wanted to attempt the whole series in SNOBOL but I'm not sure I will be able to implement matrix multiplication in SNOBOL in time for it to be a valid submission...</p>
</div>
<div id="pu8" class="pu"><h1>Java 8, <s>270</s> 261 bytes</h1>

<pre class="lang-java prettyprint-override"><code>M-&gt;m-&gt;{int l=M.length,R[][]=new int[l][l],T[][]=new int[l][l],d=0,s=l,r,c,k;for(;d!=1|s!=0;){for(r=l*l;r--&gt;0;R[r/l][r%l]=d*=Math.random())d=m;for(d=1,s=r=l;r--&gt;0;d*=T[r][r]%m)for(c=l;c--&gt;0;s-=T[r][c]%m)for(T[r][c]=k=0;k&lt;l;)T[r][c]+=M[r][k]*R[k++][c];}return R;}
</code></pre>
<p>-9 bytes thanks to <em>@ceilingcat</em>.</p>
<p>Keeps trying random matrices (including duplicates) until it find the correct one, so times out for most test cases. I tried adding a cache so it tries random matrices without duplicates, but then it still times out for the same test cases.</p>
<p><a href="https://tio.run/##hZJRa9swEMff8ynUQMGKZS1uExhVZdjLoA9mkObN@EGzndSxJBtJ7gieP3t2dtWGQdnA4PPd7//X6c4n8SqiU9lcCimsRamo9bBAyDrh6gKdoEp7V0t66HXh6lbT7z54rLXL8iwn/4SetKuOlSHI00mCDohf0ihRUTJAEkmeUlnpo3shu4nguvo10zKHh@w/yZV8TSyXxJCCNOzQmoCVNzz@bW/4muFhShguV5KZKErWbJeZLyA0tzLn5Yqnwr1QI3TZqgDjkqvZoeQxeILMiwDcZwZU@a3CE1BAqZhLNnorFe8l/8UbOL55lAz7RMjTKWjy1S5rwnBKsdFUrjca7dh4YQuYdNf/lDBpP/DXti6RgiUEz87U@pjlSOBpIQi5yrpgSxB6HwYMZhjiLYnvRzLcxdN7xOzK3gP8F3u3IfEG2M1Xstl6dlxctz0fPkunxaiPpaHUt/B8tq5StO0d7aA7J3WwfNJd7@wDUnwZqnDJUArB9Zf4Zow4W1pWVbdv3@4UpNi3@Znfj96B4QP6n8mBiq6TZzDzgcLY32i8/AE" rel="nofollow noreferrer">Try it online</a> (only contains the test cases <code>m=35; M=[[24,14],[48,45]]</code> and <code>m=5; M=[[15,13],[21,13]]</code>).</p>
<p><strong>Explanation:</strong></p>
<pre class="lang-java prettyprint-override"><code>M-&gt;m-&gt;{                    // Method with int-matrix &amp; int parameters and int-matrix return
  int l=M.length,          //  Dimension of the input-matrix
      R[][]=new int[l][l], //  Result-matrix of that same size
      T[][]=new int[l][l], //  Temp-matrix of that same size
      d=0,                 //  Flag for the diagonal
      s=l,                 //  Flag for the decreasing sum
      r,c,k;               //  Index integers
  for(;d!=1                //  Continue looping as long as the diagonal flag isn't 1 yet
       |s!=0;){            //  nor the decreasing sum flag isn't 0 yet:
    for(r=l*l;r--&gt;0;       //   Loop over all cells:
      R[r/l][r%l]=         //     Set the current cell in matrix `R`:
        d*=Math.random())d=m;
                           //      To a random value in the range [0,m)
    for(d=1,               //   Reset the diagonal flag to 1
        s=r=l;             //   Reset the decreasing sum flag to `l`
        r--&gt;0              //   Loop over the rows:
        ;                  //     After every iteration:
         d*=               //      Multiply the diagonal flag by:
            T[r][r]        //       The value in the `r,r`'th cell of matrix `T`
                   %m)     //       Modulo the input `m`
      for(c=l;c--&gt;0        //    Inner loop over the columns:
          ;                //      After every iteration:
           s-=             //       Decrease the decreasing sum flag by:
              T[r][c]      //        The value in the `r,c`'th cell of matrix `T`
                     %m)   //        Modulo the input `m`
        for(T[r][c]=k=0;   //     Reset the `r,c`'th cell of matrix `T` to 0
            k&lt;l;)          //     Inner loop `k` in the range [0, length):
          T[r][c]+=        //      Increase the `r,c`'th cell of matrix `T` by:
            M[r][k]        //       The `r,k`'th cell of matrix `M`
            *R[k++][c];}   //       Multiplied by the `k,c`'th cell of matrix `R`
  return R;}               //  And if the loops are done: return matrix `R` as result
</code></pre>
</div>
<div id="pu9" class="pu"><h1><a href="http://magma.maths.usyd.edu.au/magma/" rel="nofollow noreferrer">Magma</a>, 34 bytes</h1>
<pre><code>func&lt;m,M|Matrix(Integers(m),M)^-1&gt;
</code></pre>
<p>No TIO for magma, though you can try it on <a href="http://magma.maths.usyd.edu.au/calc/" rel="nofollow noreferrer">http://magma.maths.usyd.edu.au/calc/</a></p>
</div>
<div id="pu10" class="pu"><h1>WIN+APL, 114 bytes</h1>
<p>Prompts for matrix followed by modulus.</p>
<pre><code>m←r←⎕⋄z←r[1;1]⋄⍎∊(¯1+1↑⍴r)⍴⊂'z←z×1 1↑r←(1 1↓r)-((1↓r[;1])∘.×1↓r[1;])÷r[1;1]⋄'⋄⌊.5+n|((1=n|z×⍳n)/⍳n←⎕)×(z←⌊.5+z)×⌹m
</code></pre>
<p><a href="https://tio.run/##PU7BSsNAEL3vV8ytu5RUZ3fTNhT/oP2C0kOoRIQ0Snoy9CTShrQpikj9Cw8K4tX8yfxInElB2Bnee/vmzcT3aXD9EKd3N8Eyjdfr22VLx7fZlLbPTlG5S9oVw5yLZdo/FcLmOMEFE6qPVFb69wP7SNsXqr9yw42qx574iuaEIB8yrjv4mptA6w7MOcNQ@T5gV8dxsjDN9394TxYcqkHYzzY8cpVtOI/qz8xcSD9fZJqTllVnY8GUDj@rlg9vE2XB8jV2CDgENwaPyocqUR48y2OIwFrAEVgP7lIeRuAiYGMI1kEoEjucU270Bw" rel="nofollow noreferrer" title="APL (Dyalog Classic) – Try It Online">Try it online! Courtesy of Dyalog Classic</a></p>
</div>
<div id="pu11" class="pu"><h1><a href="https://doc.sagemath.org/html/en/developer/index.html" rel="nofollow noreferrer">SageMath</a>, <sup><s>48</s></sup> 33 bytes</h1>

<p>Saved 15 bytes thanks to ovs!!!   </p>



<pre class="lang-python prettyprint-override"><code>lambda m,M:~Matrix(Integers(m),M)
</code></pre>

<p><em>Nothing on TIO for SageMath unfortunately.</em>  </p>

<p>Modular inverse of a matrix <code>M</code> (input as a Python list of lists) mod <code>m</code>.</p>
</div>
<div id="pu12" class="pu"><h1><a href="https://github.com/tkwa/Sledgehammer" rel="nofollow noreferrer">Sledgehammer</a>, 6 bytes</h1>

<pre><code>⠑⡿⡆⠱⣁⣭
</code></pre>

<p>Decompresses into this Wolfram Language function: </p>

<pre><code>Inverse[#2, Modulus -&gt; #1]
</code></pre>

<p><a href="https://tio.run/##y00syUjNTSzJTE78n2ar8N8zryy1qDg1WtlIR8E3P6U0p7RYQddOQdkwVu1/QFFmXolDWrSxuU51tYWOpY6RkY6hea1OtZGJjrEBCBlaAnnGljoWOiamOkbGQI4pSBiozti4tjb2PwA" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
</div>
<div id="pu13" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 25 bytes</h1>

<pre><code>ÆḊ×Ɱ⁹%ỊTḢ×ZÆḊ-Ƥ$-ƤNÐe⁺€Zʋ
</code></pre>

<p><a href="https://tio.run/##y0rNyan8//9w28MdXYenP9q47lHjTtWHu7tCHu5YdHh6FFhc99gSFSD2Ozwh9VHjrkdNa6JOdf8/vByk8v//6GhDUx0FQ0MdBWODWB2FaCMDIM9IR8EEzDM21lEwAsobxcb@N7EEAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<p>A dyadic link taking the matrix as its left argument and the modulus as its right. Returns a matrix. Append a <code>%</code> to get it within the range <code>0, m</code></p>
</div>
<div id="pu14" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 128 bytes</h1>



<pre class="lang-r prettyprint-override"><code>function(x,m,n)t(round(which((1:m*det(x))%%m&lt;1.5)[1]*outer(1:n,1:n,Vectorize(function(a,b)det(x[-a,-b,drop=F])*(-1)^(a+b))))%%m)
</code></pre>

<p><a href="https://tio.run/##VY7NasMwDMfvewpfClKmjDq222Ys1z3CLqWD5qvNIUkxCS17@Uyyx2gOAlv6/T/8cimWdh6qqRsHeFBPA07gx3mo4X7tqiuAfu@TupnggbjZ9B/6zeFRn5JxnhrPx4FkvppqGn3308C/2ZlKDLpjeqa0pNqPt@LzhAmkGr/h/FoiBktc2uK5Al5iET/eJfSlBV923KeCbEdK75BUBeZAympEsm5F5KTcNhDyFMDkK8Dy1gbAioUTYmVhDaksWmhH6sCAM8@AbLUmZf5ytvzN2Cp@jciZyKTbKprjuFLGqN5HpRWTODqPaiZCLQZN2Lh4F5kxUnaPyy8" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>

<p>A function taking three arguments, <code>x</code> = the matrix, <code>m</code> = the modulus and <code>n</code> the number of rows of <code>x</code>. Returns a matrix. Uses the same method as my <a href="https://codegolf.stackexchange.com/a/200691/42248">Jelly answer</a>. </p>
</div>
<div id="pu15" class="pu"><h1>JavaScript (ES6), <s>&nbsp;209&nbsp;</s> 206 bytes</h1>

<p>Takes input as <code>(modulo)(matrix)</code>.</p>

<p>This transposes the matrix of cofactors (resulting in the adjugate) and multiply it by the inverse of the determinant of <span class="math-container">\$M\$</span> modulo <span class="math-container">\$m\$</span>.</p>



<pre class="lang-javascript prettyprint-override"><code>m=&gt;M=&gt;M.map((r,y)=&gt;r.map((_,x)=&gt;((g=k=&gt;(++k*D(M)%m+m)%m-1?g(k):x+y&amp;1?-k:k)``*D(h(M,x).map(r=&gt;h(r,y)))%m+m)%m),h=(a,n)=&gt;a.filter(_=&gt;n--),D=M=&gt;+M||M.reduce((s,[v],i)=&gt;s+(i&amp;1?-v:v)*D(h(M,i).map(r=&gt;h(r,0))),0))
</code></pre>

<p><a href="https://tio.run/##pZNNc5swEIbv/hW6tKyKIAhBHLsDuaRHTjlSTcLY2CYY8MiUSWby391dyWSmp04bDxZarfQ@@yFeqqk6b0xzGoN@2NaXXXbpsrzAJ@yqE4ARbzzLjTOexCsaAPusxZfvt98eoOBfOr/DIZD3e2j5@tV/@yrvg3bd8udn3HCAAo9ZAZPlB6vI50NcHDKoRI@yVbhrjmNt4CnL@yDg4iHDMPzi/b0ITb39takBzqKctGhw99mHhjDTeuJXSPMHJEIIDZfv5YKVLEkFK8v4VjB5q3Gq7gRLpNYMjX/93dyQVIwCiqTilWBqqTVh1MpicEyj2fefFIeRFPGKpBKkpFeKSwZXZGJdlEz6iWRQbzkzlGOkihgJjrHNROKeu89kks7RqiXRLCSx5SJpKRHtShahRcW1lqIA0B//FW0hdjtWI3adIWG0otmgQslrghRGWeICxkDNlLYCVFQVub@rO7XU1ndWTZ2XzlCxmJ5bReIoSpcs/ui@IkvRLaAi4kJkiVbJypAPoTFek4VehLvB/Kg2B4CyE6zQnGU52wz9eTjW4XHYww46jh@du@rkdN/mRNMpHIfH0TT9Hnh4qraPY2VGiDnzmcc8Hr4MTQ@ex@fZz96zPnrzy28" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>

<h2>Commented</h2>

<h3>Helper function <span class="math-container">\$h\$</span></h3>

<p>The function <span class="math-container">\$h\$</span> removes the <span class="math-container">\$n\$</span>-th entry from the array <span class="math-container">\$a[\:]\$</span>.</p>

<pre class="lang-javascript prettyprint-override"><code>h = (a, n) =&gt;                // a[] = array, n = index
  a.filter(_ =&gt; n--)         // keep all but the n-th entry
</code></pre>

<h3>Helper function <span class="math-container">\$D\$</span></h3>

<p>The function <span class="math-container">\$D\$</span> computes the determinant of the matrix <span class="math-container">\$M\$</span>.</p>

<pre class="lang-javascript prettyprint-override"><code>D = M =&gt;                     // M[] = input matrix
  +M ||                      // if M[] is 1x1, stop recursion and return its unique value
  M.reduce((s, [v], i) =&gt;    // otherwise, for each value v at (0, i):
    s +                      //   add to the sum
    (i &amp; 1 ? - v : v) *      //   either v or -v depending on the parity of i
    D(                       //   multiplied by the result of a recursive call with:
      h(M, i)                //     M[] without the i-th row
      .map(r =&gt; h(r, 0))     //     and without the first column
    ),                       //   end of recursive call
    0                        //   start with s = 0
  )                          // end of reduce()
</code></pre>

<h3>Main function</h3>

<pre class="lang-javascript prettyprint-override"><code>m =&gt; M =&gt;                    // m = modulo, M[] = matrix
  M.map((r, y) =&gt;            // for each position y:
    r.map((_, x) =&gt;          //   for each position x:
      (                      //
        ( g = k =&gt;           //     g is a recursive function taking a counter k
            ( ++k *          //       increment k and multiply it
              D(M)           //       by the determinant of M
              % m + m        //
            ) % m - 1 ?      //       if it's not congruent to 1 modulo m:
              g(k)           //         try again until it is
            :                //       else:
              x + y &amp; 1 ? -k //         return either k or -k
                        : k  //         depending on the parity of x+y
        )`` *                //     initial call to g with a zero'ish value
        D(                   //     multiply by the determinant of:
          h(M, x)            //       M[] without the x-th row
          .map(r =&gt; h(r, y)) //       and without the y-th column
        ) % m + m            //     return the result modulo m
      ) % m                  //
    )                        //   end of inner map()
  )                          // end of outer map()
</code></pre>
</div>
<div id="pu16" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="noreferrer">Wolfram Language (Mathematica)</a>, 23 bytes</h1>

<p>¯\_(ツ)_/¯   the answer was in the documentation of <a href="http://reference.wolfram.com/language/ref/Modulus.html" rel="noreferrer">Modulus</a></p>

<pre><code>Inverse[#2,Modulus-&gt;#]&amp;
</code></pre>

<p><a href="https://tio.run/##y00syUjNTSzJTE78n26r8N8zryy1qDg1WtlIxzc/pTSntFjXTjlW7X9AUWZeiUN6tLG5TnW1hY6ljpGRjqF5rU61kYmOsQEIGVoCecaWOhY6JqY6RsZAjilIGKjO2Li2NvY/AA" rel="noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/200685/">200685</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




