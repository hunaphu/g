<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::278234</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>100</td><td>C++</td><td>250222T102957Z</td><td><a href="https://codegolf.stackexchange.com/questions/278234/can-you-beat-numpy-convolve/278338#278338">l4m2</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>C++, ~100 times</h1>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;math.h&gt;
#include &lt;time.h&gt;
#include &lt;algorithm&gt;
typedef long double ld;
typedef unsigned uint;
void setId(ld&amp; x, uint y) { 3[(int*)&amp;x] = y; }
uint getId(ld&amp; x) { return 3[(int*)&amp;x]; }
typedef struct pz{
    unsigned int a[4];
    bool operator&lt; (const pz&amp; o) const {
        return *(unsigned long*)&amp;a[1] &gt;
             *(unsigned long*)&amp;o.a[1]; }
} *pp;
void mult(uint N, ld* in, ld* out) {
    uint M = pow(N, .75); fprintf(stderr, &quot;IN %ld\n&quot;, clock());
    static ld tmp[9999999];
    for (uint i=0; i&lt;N; ++i) {
        tmp[i] = in[i];
        setId(tmp[i], i);
    }
    for (uint i=0; i&lt;N+N-1; ++i) {
        out[i] = 0;
    }
    std::nth_element(pp(tmp), pp(tmp+M), pp(tmp+N));
    std::sort(pp(tmp), pp(tmp+M)); fprintf(stderr, &quot;PRE %ld %d\n&quot;, clock(), M);
    for (uint i=0; i&lt;M; ++i)
    for (uint j=0; j&lt;M; ++j) {//fprintf(stderr, &quot;[%d %d]&quot;, M, getId(tmp[0]));
        out[getId(tmp[i])+getId(tmp[j])] += tmp[i] * tmp[j];
    }
    ld thro = tmp[M] * tmp[M] * 1e-4;fprintf(stderr, &quot;IRO %ld\n&quot;, clock());
    int kk = 0;
    for (uint i=0; i&lt;N+N-1; ++i) if (out[i]&lt;thro){ ++kk;
        ld ret = 0;
        if (i &lt; N) {
            for (uint j=0; j&lt;=i; ++j)
                ret += in[j] * in[i-j];
        } else { // i-j=N-1
            for (uint j=i-N+1; j&lt;N; ++j)
                ret += in[j] * in[i-j];
        }
        out[i] = ret;
    }fprintf(stderr, &quot;IIRO %ld %d\n&quot;, clock(), kk);
}

int main() {
    const int N = 100000;
    static ld Input[N];
    static ld Output[N*2];
    for (uint i=0; i&lt;N; ++i) scanf(&quot;%Le&quot;, Input+i);
    mult(N, Input, Output);
    for (uint i=0; i&lt;N+N-1; ++i) printf(&quot;%Le\n&quot;, Output[i]);
    
    /*
    mult(10, Input, Output);
    for (int i=0; i&lt;20; ++i) printf(&quot;%Le\n&quot;, Output[i]);*/
}
</code></pre>
<p>Ignore too small products</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/278234/">278234</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




