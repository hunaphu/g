<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::284074</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>166</td><td>APLNARS</td><td>251011T125424Z</td><td><a href="https://codegolf.stackexchange.com/questions/284074/parse-rpip7-musical-notation/284088#284088">Rosario</a></td></tr>
<tr d-ix="1"><td>066</td><td>Charcoal</td><td>251010T230514Z</td><td><a href="https://codegolf.stackexchange.com/questions/284074/parse-rpip7-musical-notation/284084#284084">Neil</a></td></tr>
<tr d-ix="2"><td>181</td><td>Maple</td><td>251011T193940Z</td><td><a href="https://codegolf.stackexchange.com/questions/284074/parse-rpip7-musical-notation/284093#284093">dharr</a></td></tr>
<tr d-ix="3"><td>103</td><td>WhatLang</td><td>251011T155622Z</td><td><a href="https://codegolf.stackexchange.com/questions/284074/parse-rpip7-musical-notation/284090#284090">YufangIG</a></td></tr>
<tr d-ix="4"><td>056</td><td>Jelly</td><td>251010T204744Z</td><td><a href="https://codegolf.stackexchange.com/questions/284074/parse-rpip7-musical-notation/284081#284081">Jonathan</a></td></tr>
<tr d-ix="5"><td>106</td><td>JavaScript ES7</td><td>251010T152740Z</td><td><a href="https://codegolf.stackexchange.com/questions/284074/parse-rpip7-musical-notation/284077#284077">Arnauld</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>APL(NARS), 166 chars</h1>
<pre><code>r←d w;i;l;c;m;n
i←1⋄r←⍬⋄→0×⍳i&gt;l←≢w
m←n←0⋄→4×⍳' '=c←i⊃w
m←{⌊.5+110×2*12÷⍨⍵+3}¯1+'1 2 34 5 6 7d r mf s l tD R MF S L T'⍳c
n+←1⋄→5×⍳l&lt;i+←1⋄→4×⍳'-'=c←i⊃w
r,←⊂m n⋄→2×⍳l≥i
</code></pre>
<p>// +/16 19 20 65 30 16=166</p>
<p>The formula for calculate the notes from Do3 it seems to be</p>
<pre><code>  h←{⌊.5+110×2*12÷⍨⍵+3}
  h¨0..12
131 139 147 156 165 175 185 196 208 220 233 247 262 
Do  Do# Re  Re# MI  Fa  Fa# Sol Sol#La  La# Si  Do
</code></pre>
<p>That would continue to calculate the frequence in herz in both diretion</p>
<pre><code>  Do1  Do2  Do3 Do4  Do5
..-24..-12..0.. 12.. 24..
</code></pre>
<p>How you can see here the notes are 12 not 7.</p>
<p>But the question want find only the subset of these notes
the ones Do  Re  MI  Fa  Sol La Si  Do, 7 notes...</p>
<p>The problem has an easy solution, it is enoght use the formula h above
and build the string of search with spaces where are the lost notes as</p>
<pre><code>'1 2 34 5 6 7d r mf s l tD R MF S L T'
</code></pre>
<p>These are all corrispondences of notes</p>
<pre><code>  ↑¨d '1234567drmfsltDRMFSLT'
131 147 165 175 196 220 247 262 294 330 349 392 440 494 523 587 659 698 784 880 988 
</code></pre>
<p>1 is 131, 2 is 147 ... T is 988</p>
<p>test:</p>
<pre><code>  d 'ssl-s-D-t-- ssl-s-R-D-- ssS-M-D-t-l-- FFM-D-R-D--'
 392 1  392 1  440 2  392 2  523 2  494 3  0 1  392 1  392 1  440 2  392 2  587 2  523 3  0
   1  392 1  392 1  784 2  659 2  523 2  494 2  440 3  0 1  698 1  698 1  659 2  523 2 
   587 2  523 3 
</code></pre>
<p>the note here indicates from &quot;s&quot; has a round value of 392Hz not 391Hz at last seen the table in the wikipedia
page on the notes.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 66 bytes</h1>
<pre><code>≔drmfsltηＦＳ≡ι-⊞υＥ⊟υ⁺κλ ⊞υＥ²κ⊞υ⟦⌊×¹¹⁰Ｘ²∕⁺²÷×¹²∨Σι⁺⁸⌕⁺η↥ηι⁷¦¹²¦¹⟧⭆¹υ
</code></pre>
<p><a href="https://tio.run/##XY9PS8QwEMXv/RRDTxPIgN2LoidhKexhsVg9iYfSptuwaVPyZ/cgfvY63VQEAyGTN28ev2mHxrW2Mcvy7L0@TZh3buy9CbmEQTxlvXWAh2mOoQ5OTycUAvxVh3YA1AK@srbxCnLKH6GKfsAo4djMWNkZo5BQmejxLMEIwWHJC/@8Ownntdupvokm/DU/SmOtwzc9Ko9Fccdx9qrcOrDXF90pvMXz9zCFTdnMrL04rOPIkBvFg4RST12aGSS8z7NyKxEOgj2aCfm551vsbmXxyVDfWcVrB0zbr7iFhMi4y@LJGyJPtCcKRLDWm/J6E5NSEx1/PdzlU1KZlGTLFrqYHw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation: By assigning the values <code>8</code>..<code>21</code> to the letters <code>d</code>..<code>T</code> respectively, the following formula gives the exact frequency of the note:</p>
<p><span class="math-container">$$ f = 110 \times 2 ^ { \frac 1 {12} \left \lfloor \frac { 12 n + 14 } 7 \right \rfloor } $$</span></p>
<pre><code>≔drmfsltη
</code></pre>
<p>Get the notes C4-B4 in a variable to avoid repetition.</p>
<pre><code>ＦＳ≡ι
</code></pre>
<p>Switch over the input characters.</p>
<pre><code>-⊞υＥ⊟υ⁺κλ
</code></pre>
<p>For a <code>-</code>, extend the duration of the previous note or rest.</p>
<pre><code> ⊞υＥ²κ
</code></pre>
<p>For a space, append a length 1 rest.</p>
<pre><code>⊞υ⟦⌊×¹¹⁰Ｘ²∕⁺²÷×¹²∨Σι⁺⁸⌕⁺η↥ηι⁷¦¹²¦¹⟧
</code></pre>
<p>Otherwise, append a length 1 note of the floor of the frequency as given by the above formula.</p>
<pre><code>⭆¹υ
</code></pre>
<p>Pretty-print the final list of notes.</p>
<p>Add 13 bytes to additionally handle <code>(</code> and <code>)</code>:</p>
<pre><code>≔drmfsltη≔¹ζＦＳ≡ι-⊞υＥ⊟υ⁺κ∧λζ ⊞υ⟦⁰ζ⟧(≦⊘ζ)≦⊗ζ⊞υ⟦⌊×¹¹⁰Ｘ²∕⁺²÷×¹²∨Σι⁺⁸⌕⁺η↥ηι⁷¦¹²ζ⟧⭆¹υ
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=VVHLSgMxFMXtfMVlVjeQgNONxa4KZbCL4mB1VboY59EJppMhjxYUV36Gmy4U_SX9Gu88qjUQyD3n5Oaek9fPrEpNplN1OLx7V4rx99nL1Fq5qTHMzba0yoUcKjYJBjTi8EhVqQ3gvG68Wzoj6w0yBnYvXVYBSgZPQZbaAkIRXkLibYWewyJtMNENesYhUd7iA4dpnaNqO9KaDHfg5M7qnMj1L4VEUZthlKtU7Yq8n6fn2T9-pv29Ogryoky9cietY6W1wVu5LSxGET2U6H1hcMRhJncyL7Abksp57QZkEBN2bXDpt2R18DLmEEsy0xUVh7umKUw7FFaMNLI1yOGCdjTqjp2r5yCh8Bz2GbYBUbyeoniz95kdfuRjFYqdCtdfC2bRKiGsEDMhnBAgxB9006EEWcKWQiyOKqJpsRjjHuqFQd_8Bw" rel="nofollow noreferrer" title="Charcoal – Attempt This Online">Attempt This Online!</a> Link is to verbose version of code. (Using ATO to avoid decimals in the output.)</p>
<p>Add 13 bytes to additionally handle <code>{</code> and <code>}</code> (but not nested):</p>
<pre><code>≔drmfsltη≔¹ζＦＳ≡ι-⊞υＥ⊟υ⁺κ∧λζ ⊞υ⟦⁰ζ⟧(≦⊘ζ)≦⊗ζ{≔Ｌυε}Ｆ✂υε⊞υκ⊞υ⟦⌊×¹¹⁰Ｘ²∕⁺²÷×¹²∨Σι⁺⁸⌕⁺η↥ηι⁷¦¹²ζ⟧⭆¹υ
</code></pre>
<p><a href="https://tio.run/##XZHNasMwEITvforFpxXIUOfS0pwCITTQUkPaU@nBteRYRLaMfhJoyLO7a0cNSQwG7X4jMTtbNaWtTKmHYeGc2naYCtvWTvuUQ8PmSezmHH6pqo0FXHd98BtvVbdFxsAdlK8aQMXgmFSlk5Bm6TMUwTUYOLyVPRamx8A4FDo43HFYdAL1@CJ983gHru58PRD8viAkRM9EKy@l3ktx9nPm7IYvTfjRt4IjCSJ9ld3WN5MbeeEn4tNoG60qOTqQNNi/mx3phKzLoP2VxZU2xuKHaqXDPCfDhTlIizMOS7VXQuI0LJXrzsdOFFPv3eImtBRZzOSJw0pRKFPRcPjse2lHb9gw0qgxKA6P9Oez6Tilc0oKWoLH8y7GoGlNgSIdBiGc09pldd221ors6Nx0zE73JBmyvf4D" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. (This version also includes support for <code>(</code> and <code>)</code>, but the support for <code>{</code> and <code>}</code> can also be added to the original version.)</p>
<p>Out of interest, I wrote a ZX Spectrum 128K program to translate a basic rpip7 string to a ZX Spectrum 128 <code>PLAY</code> command string. It only works for note lengths of <code>1-4</code> due to limitations of the <code>PLAY</code> command.</p>
<pre><code>  10 INPUT LINE a$: REM use LET a$=&quot;music goes here&quot; for testing to save retyping each time
  20 LET p$=&quot;&quot;: LET k=1: LET d=15: LET r=16: LET m=17: LET f=18: LET s=19: LET l=20: LET t=21: REM d..t are the note pitches, k is the current length and p$ is the play command string
  30 FOR i=LEN(a$) TO 1 STEP -1: REM looping backwards to make the length calculation easier
  40 IF a$(i)=&quot;-&quot; THEN LET k=k+1: GO TO 90: REM increase the length
  50 IF a$(i)=&quot; &quot; THEN LET p$=&quot;3567&quot;(k)+&quot;&amp;&quot;+p$: GO TO 80: REM a rest of the given length
  60 LET n=VAL a$(i)-7*(a$(i)&gt;&quot;_&quot;)+1: REM pitch of current note, 2=C3 up to 22=B5
  70 LET p$=&quot;O&quot;+STR$ INT ((n+19)/7)+&quot;N&quot;+&quot;3567&quot;(k)+CHR$ (65+n-7*INT (n/7))+p$: REM a note of the right pitch and length
  80 LET k=1: REM reset length
  90 NEXT i
 100 PLAY p$
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.maplesoft.com/" rel="nofollow noreferrer">Maple</a>, 181 bytes, 282* bytes</h1>
<p>Without extensions:</p>
<pre><code>proc(s)S:=seq:g:=table([S(&quot;1.2.34.5.6.7d.r.mf.s.l.tD.R.MF.S.L.T &quot;)]=~[S(floor(110*2^(n/12)),n=3..38),0]);w,j:=&lt;[]&gt;,0;S(`if`(i=&quot;-&quot;,(w[j]+=[0,1]),[(j++),(w(j):=[g[i],1])]),i=s);w end;
</code></pre>
<p>Ugolfed:</p>
<pre><code>proc(s)
S:=seq:        # abbreviate seq as S
# next line sets up a table mapping a character to its frequency using @Arnauld's formula
g:=table([S(&quot;1.2.34.5.6.7d.r.mf.s.l.tD.R.MF.S.L.T &quot;)]=~[S(floor(110*2^(n/12)),n=3..38),0]);
w,j:=&lt;[]&gt;,0;   # initialize output Vector w and its size j
for i in s do
if i=&quot;-&quot; then
  w[j]+=[0,1]  # if &quot;-&quot; then add 1 to beats of previous note
else
 j++;
 w(j):=[g[i],1]
fi
od;
w;
end;
</code></pre>
<p>Inputs string, outputs Vector of [freq,beats]. Golfed version condenses the for loop and if statement into a seq with expression form for if.</p>
<p>Extended version, 282 bytes.</p>
<p>ungolfed;</p>
<pre><code>proc(s)
S:=seq:        # abbreviate seq as S
# next line sets up a table mapping a character to its frequency using @Arnauld's formula
g:=table([S(&quot;1.2.34.5.6.7d.r.mf.s.l.tD.R.MF.S.L.T &quot;)]=~[S(floor(110*2^(n/12)),n=3..38),0]);
w,j,v:=&lt;[]&gt;,0,1;   # initialize output Vector w and its size j and default speed v
for i in s do
if i=&quot;-&quot; then
  w[j]+=[0,v]  # if &quot;-&quot; then add v to beats of previous note
elif i=&quot;(&quot; then
  v/=2         # double speed
elif i=&quot;)&quot; then
  v*=2         # halve speed
elif i=&quot;{&quot; then
  k:=j         # record current position
elif i=&quot;}&quot; then
  w,=S(w[k+1..]); # repeat
  j+=j-k       # update position
else
 j++;
 w(j):=[g[i],v]
fi
od;
w;
end;
</code></pre>
<p>golfed:</p>
<pre><code>proc(s)S:=seq:g:=table([S(&quot;1.2.34.5.6.7d.r.mf.s.l.tD.R.MF.S.L.T &quot;)]=~[S(floor(110*2^(n/12)),n=3..38),0]);w,j,v:=&lt;[]&gt;,0,1;S(`if`(i=&quot;-&quot;,(w[j]+=[0,v]),`if`(i=&quot;(&quot;,(v/=2),`if`(i=&quot;)&quot;,(v*=2),`if`(i=&quot;{&quot;,(k:=j),`if`(i=&quot;}&quot;,[(w,=S(w[k+1..])),(j+=j-k)],[(j++),(w(j):=[g[i],v])]))))),i=s);w;end;
</code></pre>
<p>Note: the beats are output as fractions: 1/2, 3/2 etc. Add one byte to output as floats (initialize v as 1. not 1).</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://esolangs.org/wiki/WhatLang" rel="nofollow noreferrer">WhatLang</a>, 103 bytes</h1>
<pre><code>[( |.-*)g]match@(len@\0,\_:' ?{&quot;1234567drmfsltDRMFSLT&quot;\in@\_12*7/2+flr@12*2\pow@110*flr@\2&gt;!!}_0\2&gt;)#.
</code></pre>
<p>Takes string from the stack as input, outputs the result.</p>
<p>Using the formula: <span class="math-container">$$\mathrm{frequency} = 2^{\frac1{12}\left\lfloor\frac{12x}7+2\right\rfloor}\times110$$</span></p>
<p><a href="https://yufangprobably.github.io/whatlang/?code=%C2%BF%22ssl-s-D-t--+ssl-s-R-D--+ssS-M-D-t-l--+FFM-D-R-D--%22%0A%0A%5B%28+%7C.-*%29g%5Dmatch%40%28len%40%5C0%2C%5C_%3A%27+%3F%7B%22_1234567drmfsltDRMFSLT%22%5Cin%40%5C_12*7%2F2%2Bflr%4012%2F2%5Cpow%40110*flr%40%5C2%3E%21%21%7D_0%5C2%3E%29%23." rel="nofollow noreferrer">Try it here!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 56 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>⁽'ḍBṚÄṾ€;“½⁸VYɼ⁼'»;Œs¤i÷12µ2*×110Ḟ⁸aĖ
‘1¦€0¦;ç¥⁼”-$}?ƒḟ`
</code></pre>
<p>A moadic Link that accepts a list of <code>1234567drmfsltDRMFSLT -</code> characters and yields a list of <code>[length, frequency]</code> pairs.</p>
<p><strong><a href="https://tio.run/##y0rNyan8//9R4171hzt6nR7unHW45eHOfY@a1lg/aphzaO@jxh1hkSf3PGrco35ot/XRScWHlmQe3m5odGirkdbh6YaGBg93zAOqSTwyjetRwwzDQ8uAOg0OLbM@vPzQUqCmRw1zdVVq7Y9NerhjfsL///@ViotzdIt1XXRLdHUVIOwgIA/EDtb1BYvnAHlubiA2WEYJAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong></p>
<h4>How?</h4>
<pre><code>⁽'ḍBṚÄṾ€;“...»;Œs¤i÷12µ2*×110Ḟ⁸aĖ - Link 1: any, Unused; character, C (never '-')
⁽'ḍBṚ                             - 21928 in binary, reversed -&gt; [0,0,1,0,1,0,1,1,0,1,0,1,0,1]
     Ä                            - cumulative sums -&gt; [0,0,1,1,2,2,3,4,4,5,5,6,6,7]
      Ṿ€                          - unevaluate each -&gt; &quot;00112234455667&quot;
                 ¤                - nilad followed by link(s) as a nilad:
         “...»                    -   dictionary-string = &quot;durum&quot;+&quot;fo&quot;+&quot;salet&quot;
                                                        = &quot;durumfosalet&quot;
               Œs                 - swap-case           = &quot;DURUMFOSALET&quot;
              ;                   - concatenate         = &quot;durumfosaletDURUMFOSALET&quot;
        ;                         - concatenate = &quot;00112234455667durumfosaletDURUMFOSALET&quot;
                  i               - first 1-index of {C} or 0 if not found (if C is a space)
                   ÷12            - divide that by twelve
                      µ           - start a new monadic chain - f(E=that)
                       2*         - two exponentiate {E}
                         ×110Ḟ    - multiply that by 110 and floor
                                    -&gt; frequency or 110 if C is a space
                              ⁸a  - E logical AND {that} -&gt; frequency (0 for a space)
                                Ė - enumerate -&gt; [[1, frequency]]

‘1¦€0¦;ç¥⁼”-$}?ƒḟ` - Main Link: list of characters, Score
                ḟ` - {Score} filter discard itself -&gt; []
               ƒ   - starting with Result = [], reduce {Score} by:
              ?    -   if...
         ⁼”-$}     -   ...condition: {Next} is equal to '-'?
   €0¦             -   ...then: to the rightmost element of {Result}:
‘1¦                -              increment the first element (the length value)
      ;ç¥          -   ...else: concatenate the result of Link 1({Result}, {Next})
</code></pre>
<hr />
<p>The warrior was <code>BṚÄṾ€</code> going into battle with only durum fo salet (some wheat for a helmet).</p>
</div>
<div id="pu5" class="pu"><h1>JavaScript (ES7), 106 bytes</h1>
<p><em>-5 by using an unfragmented lookup table, as in <a href="https://codegolf.stackexchange.com/a/284084/58563">Neil's answer</a></em></p>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;s.match(/.-*/g).map(s=&gt;[s&lt;1?0:2**(~~(12*&quot;_1234567drmfsltDRMFSLT&quot;.search(s[0])/7+2)/12)*110|0,s.length])
</code></pre>
<p><a href="https://tio.run/##fYxBS8MwGIbv/oqSU5L5pU2cDmTTy@hBnMK62xxSmqbrSNORLwjC2F/vsgoePHj6nud9@d5D@VVi5dtjANfrejCLARdPKLoyVHuaCuBpw6IdaYy3OJfP2aPinJ7PVCpOPqW6m94/zLTvDNqwXK/y4nVDBNalj/@4zXYsnU0US6ViXMrslN2isLVrwn7Hhqp32Nta2L6hL8X7m8DgW9e05psaShAtICwhACQ/vI525QJWY26j5fmVx4YwlkwS8uEIu/l/Wus4aBGM6TrvNSCO9Hv/9nGZDRc" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<hr />
<h1>JavaScript (ES7), 111 bytes</h1>
<p><em>-2 thanks to <a href="https://codegolf.stackexchange.com/users/53748/jonathan-allan">Jonathan Allan</a></em></p>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;s.match(/.-*/g).map(s=&gt;[(n=&quot; ..1.2.34.5.6.7d.r.mf.s.l.tD.R.MF.S.L.T&quot;.search(s[0])/12)&amp;&amp;2**n*110|0,s.length])
</code></pre>
<p><a href="https://tio.run/##fYw9T8MwFEV3fkXkobJT3s0HFKYwVRkQBalhKx2iJE6DHKfys5CQ@O/BDRIDA9M7996n815/1Ny44ezJTm0362Lm4oEx1r45yQQUJ70K6SxDfZC2EBGQIcfNLTa4w30Lh1GDYeC32GNXosITXgW4q11w8CE9qiTL1WqVx7GNsyz9Sq/Df2d7fzqquZksT6aDmXr5WL08g70bbD/oT6mlYDbEtCVPFP3wPqQLV7RbehNSWV54WYRS0ToSb1aoq//VbRuEhknrcXSuJeaFfu/fPZjV/A0" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Formula</h3>
<p>Given <span class="math-container">\$n\in[3\dots38]\$</span>, the formula for the frequency is:</p>
<p><span class="math-container">$$\left\lfloor2^{(n-24)/12}\times 440\right\rfloor$$</span></p>
<p>Which can be simplified to:</p>
<p><span class="math-container">$$\left\lfloor2^{n/12}\times\left(2^{-24/12}\times 440\right)\right\rfloor=\left\lfloor2^{n/12}\times110\right\rfloor$$</span></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/284074/">284074</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




