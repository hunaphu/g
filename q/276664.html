<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::276664</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>290</td><td>Python's cryptography</td><td>241116T103212Z</td><td><a href="https://codegolf.stackexchange.com/questions/276664/shortest-possible-valid-pem-encoded-ca-certificate/276703#276703">user7610</a></td></tr>
<tr d-ix="1"><td>392</td><td>openssl req</td><td>241113T233840Z</td><td><a href="https://codegolf.stackexchange.com/questions/276664/shortest-possible-valid-pem-encoded-ca-certificate/276665#276665">user7610</a></td></tr>
<tr d-ix="2"><td>493</td><td>openssl req</td><td>241115T112306Z</td><td><a href="https://codegolf.stackexchange.com/questions/276664/shortest-possible-valid-pem-encoded-ca-certificate/276677#276677">Themooni</a></td></tr>
</table>
<div id="pu0" class="pu"><h2>Python's <code>cryptography</code>, 290 bytes</h2>
<p>I could not beat my previous result using <code>openssl req</code>, so I switched to Python's <code>cryptography</code> module, which is somehow able to produce even shorter certs. I again used elliptic curve-based certs because the curves are smaller than RSA. <code>openssl</code> is still happy to load such certificate.</p>
<pre class="lang-python prettyprint-override"><code>from cryptography.hazmat.primitives import serialization
from cryptography.hazmat.primitives.asymmetric import ed25519
from cryptography.x509 import CertificateBuilder
from cryptography import x509

import datetime

def generate_minimal_certificate() -&gt; bytes:
    private_key = ed25519.Ed25519PrivateKey.generate()

    subject = x509.Name([
        # x509.NameAttribute(x509.NameOID.COMMON_NAME, 'localhost')
    ])

    cert = (
        CertificateBuilder()
        .subject_name(subject)
        .issuer_name(subject)
        .public_key(private_key.public_key())
        .serial_number(1)
        .not_valid_before(datetime.datetime.now(datetime.UTC))
        .not_valid_after(datetime.datetime.now(datetime.UTC) + datetime.timedelta(days=365))
        .sign(private_key, None)
    )

    pem_cert = cert.public_bytes(encoding=serialization.Encoding.PEM)
    return pem_cert

if __name__ == '__main__':
    cert = generate_minimal_certificate()
    print(cert.decode())
    print(len(cert))
</code></pre>
<pre><code>-----BEGIN CERTIFICATE-----
MIGrMF+gAwIBAgIBATAFBgMrZXAwADAeFw0yNDExMTYxMDI4MzNaFw0yNTExMTYx
MDI4MzNaMAAwKjAFBgMrZXADIQCf30GvRnHbs9gukA3DLXDK6W5JVgYw6mERU/60
2M8+rjAFBgMrZXADQQCGmeaRp/AcjeqmJrF5Yh4d7aqsMSqVZvfGNDc0ppXyUgS3
WMQ1+3T+/pkhU612HR0vFd3vyFhmB4yqFoNV8RML
-----END CERTIFICATE-----
</code></pre>
</div>
<div id="pu1" class="pu"><h2><code>openssl req</code>, <s>737</s> <s>558</s> <s>526</s> <s>497</s> 392 bytes</h2>
<pre><code>% openssl ecparam -name secp112r1 &gt; ec.params                                          
% openssl req -nodes -x509 -newkey ec:ec.params -days 1 -set_serial 1 -out ca-cert.pem -subj &quot;/&quot;
</code></pre>
<p>With the above I am getting certs that are either 392 or 396 bytes long. So I picked one of the shorter ones.</p>
<pre><code>-----BEGIN CERTIFICATE-----
MIH2MIHBoAMCAQICAQEwCgYIKoZIzj0EAwIwADAeFw0yNDExMTUxODMzMjFaFw0y
NDExMTYxODMzMjFaMAAwMjAQBgcqhkjOPQIBBgUrgQQABgMeAAQ5m1Yk+0ZvpZWY
rCwQ4VBB54eR+XUcHcqsHfEmo1MwUTAdBgNVHQ4EFgQUI3lNljOTV7EyOCeIadTV
9dmqMx0wHwYDVR0jBBgwFoAUI3lNljOTV7EyOCeIadTV9dmqMx0wDwYDVR0TAQH/
BAUwAwEB/zAKBggqhkjOPQQDAgMkADAhAg4UpmaNZ5cNCi8I9JkAswIPAM25KTiV
t33Lue3ZYVo/
-----END CERTIFICATE-----
</code></pre>
<h3>changelog</h3>
<ul>
<li><code>-newkey rsa:512</code>, use smallest possible private key size</li>
<li><code>-subj &quot;/&quot;</code>, the <code>/</code> seems to be the shortest possible accepted argument for <code>-subj</code></li>
<li><code>-set_serial 1</code>, the default is a large random number that takes up bytes</li>
<li><code>-newkey ec:ec.params</code>, picked an elliptic curve from the list <code>openssl ecparam -list_curves</code> that is giving me the smallest key, after trying each once</li>
<li><code>-days 1</code>, does not seem to have impact, but smaller numbers are usually better, copied from Themoonisacheese's answer</li>
</ul>
</div>
<div id="pu2" class="pu"><h1><code>openssl req</code>, <s>518</s> 493 bytes</h1>
<p>-25 bytes: <code>--set-serial 1</code> by user7610</p>
<pre><code>-----BEGIN CERTIFICATE-----
MIIBUTCB/qADAgECAhRuvWYi4YQN7neCssfB+Rsq+yMv5TANBgkqhkiG9w0BAQsF
ADAAMB4XDTI0MTExNTExMTQxNVoXDTI0MTExNjExMTQxNVowADBZMA0GCSqGSIb3
DQEBAQUAA0gAMEUCPgLItpCnD7Ul4vED7loyin38YYetYx4MjeqQNPv6Ri9cvub7
giiduROYMed8ZbXm4h33knJNzVh+RWwnlhY7AgMBAAGjUzBRMB0GA1UdDgQWBBSJ
ST+wBPwEsQqLEDRgo4A0cuugGDAfBgNVHSMEGDAWgBSJST+wBPwEsQqLEDRgo4A0
cuugGDAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAAz8AAeLZkP0i1rMQ
4D2Nt8DdKZgIESBzpFyPI17QR8kqypOdx43Tn+btsB6gAoqhv69GDSFxMtYw+90A
/S/+Fns=
-----END CERTIFICATE-----</code></pre>
<p>generated using:</p>
<pre><code>openssl req -nodes -x509 -key key490.pem -days 1 -subj &quot;/&quot; --set-serial 1&gt; cert.pem
</code></pre>
<p>with <code>key490.pem</code> a 490-bit rsa key generated using:</p>
<pre class="lang-python prettyprint-override"><code>import rsa
import sys
pubkey,privkey = rsa.newkeys(int(sys.argv[1]))
print(privkey.save_pkcs1('PEM').decode('UTF-8'))
</code></pre>
<p>While 512 bits is the smallest openssl will allow you to generate, an RSA key can be as small as 16 bits (!). However, as the key gets smaller, you can encrypt less and less data with it, and openssl is not happy about that. I performed a manual binary search between 16 and 512 to find that 490 bits is the smallest possible key using this technique.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/276664/">276664</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




