<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::84088</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>088</td><td>JavaScript Node.js</td><td>241206T004117Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/277094#277094">l4m2</a></td></tr>
<tr d-ix="1"><td>116</td><td>sed r</td><td>241205T204001Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/277088#277088">Jan Blum</a></td></tr>
<tr d-ix="2"><td>119</td><td>Ruby</td><td>161230T211604Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/105119#105119">pottedme</a></td></tr>
<tr d-ix="3"><td>163</td><td>Lua</td><td>160630T124424Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84100#84100">Katenkyo</a></td></tr>
<tr d-ix="4"><td>110</td><td>Python 3</td><td>160707T080851Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84703#84703">Destruct</a></td></tr>
<tr d-ix="5"><td>327</td><td>C++</td><td>160701T192735Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84237#84237">tachma</a></td></tr>
<tr d-ix="6"><td>108</td><td>Python 2</td><td>160630T120443Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84093#84093">Arfie</a></td></tr>
<tr d-ix="7"><td>237</td><td>C</td><td>160701T051335Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84188#84188">user4677</a></td></tr>
<tr d-ix="8"><td>nan</td><td>Haskell</td><td>160630T215031Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84158#84158">MarLinn</a></td></tr>
<tr d-ix="9"><td>nan</td><td>Perl</td><td>160702T115431Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84291#84291">hvd</a></td></tr>
<tr d-ix="10"><td>184</td><td>Python3</td><td>160701T072607Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84190#84190">Isaac Gr</a></td></tr>
<tr d-ix="11"><td>185</td><td>Powershell</td><td>160701T223439Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84254#84254">Eris</a></td></tr>
<tr d-ix="12"><td>211</td><td>C#</td><td>160630T181339Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84141#84141">Andrew</a></td></tr>
<tr d-ix="13"><td>089</td><td>Python 2</td><td>160701T074044Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84191#84191">beiju</a></td></tr>
<tr d-ix="14"><td>033</td><td>Jelly</td><td>160630T150420Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84122#84122">PurkkaKo</a></td></tr>
<tr d-ix="15"><td>044</td><td>Pyth</td><td>160630T131744Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84106#84106">PurkkaKo</a></td></tr>
<tr d-ix="16"><td>098</td><td>JavaScript ES6</td><td>160630T195234Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84151#84151">Neil</a></td></tr>
<tr d-ix="17"><td>035</td><td>MATL</td><td>160630T143404Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84116#84116">Luis Men</a></td></tr>
<tr d-ix="18"><td>124</td><td>Python 3</td><td>160630T114645Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84091#84091">TuxCraft</a></td></tr>
<tr d-ix="19"><td>044</td><td>Pyth</td><td>160630T114412Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84090#84090">Leaky Nu</a></td></tr>
<tr d-ix="20"><td>038</td><td>Retina</td><td>160630T113858Z</td><td><a href="https://codegolf.stackexchange.com/questions/84088/can-pac-man-eat-this-string/84089#84089">Martin E</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 88 bytes</h1>

<pre class="lang-none prettyprint-override"><code>f=([c,...a],i=1)=&gt;c&amp;&amp;(i+=/[elp]/i.test(c)-/[ghos]/i.test(c))?'_'+f(a,i):'&lt;'+[c]+a.join``
</code></pre>
<p><a href="https://tio.run/##TcixDsIgEADQXyEdyhFaGtdG9BfcSWMvJ7Q0yDXS6Oejo8Nb3oZvLPSK@9FnfvhagwVHnTEGpy7ak7IXaluI2g7Op30aojl8OYBUP7hl5fI36irvUgfALqpRnqV2NGk0G8c8z5U4F07eJF4gQHNDemIWiYsv4oNr/yNGaJSqXw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.gnu.org/software/sed/" rel="nofollow noreferrer">sed</a> <code>-r</code>, 116 bytes</h1>
<pre><code>h
s/[elp]/p/gi
s/[ghos]/g/gi
s/[^gp]/_/g
:1
s/^(_*)p([_p]*)g/__\1\2/
t1
s/g.*//
G
s/\n/&lt;/
:2
s/^( *\w*)\w&lt;./ \1&lt;/
t2
</code></pre>
<p>Pac-Man leaves a space behind for each character eaten (as allowed in the question).</p>
<p><a href="https://tio.run/##NYuxCsIwEIb3e4p0awP1aMfSwUV0UBQUHEwbig1JISahqfTtjVErx3H/93@cF30uzTMEBR5vQrsGHcrhA1JZ36BcqJVRcZRQFRHblNPMpTfuGppJ5JwVrESYPk6uKCJsY2IGa4Sq/D4QymaasbleIWFF7KcyhFN3zw@dIdp64YkSo4BYPWIzD8Ynf/jpuVN5XFKlcNrs95sLWc52dzxfYCe0tuRqR90nUPNkXZQ1j/Oybhqs8SEf3w" rel="nofollow noreferrer" title="sed – Try It Online">Try it online!</a></p>
<hr/>
<p>A variant where Pac-Man leaves underscores behind</p>
<h1><a href="https://www.gnu.org/software/sed/" rel="nofollow noreferrer">sed</a> <code>-r</code>, 120 bytes</h1>
<pre><code>h
s/[elp]/p/gi
s/[ghos]/g/gi
s/[^gp]/ /g
:1
s/^( *)p([ p]*)g/  \1\2/
t1
s/g.*//
G
s/\n/&lt;/
:2
s/^(_*[ p]*)[ p]&lt;./_\1&lt;/
t2
</code></pre>
<p><a href="https://tio.run/##NYvNCoJAEIDv8xTjTQUb9CgeukQdjISCDmkitewK2@7iGr5925rGMD/ffDOWPROu3s4JsHRj0jRkiPczcKFtQ3ylO/cKiUOeeryHGEcmvKFp4ogTYp3WGcE4O76JiWDvp1pRQZBnv4c2Xq7nWmyorVPvxsy5qnskx06h1JZZFGxg4Fcvv5l6ZYM/LHrqROIT8xCqXVnuLri2/eF0vsCBSanxqgf5DKBog22aFa2PjzZjr5V1yfAF" rel="nofollow noreferrer" title="sed – Try It Online">Try it online!</a></p>
</div>
<div id="pu2" class="pu"><h1><strong>Ruby, (119 bytes)</strong></h1>

<pre><code>q=i=0;a=$**" ";a.split(//).each{|c|q+=((c+?p=~/[ple]/i)^1)-((c+?g=~/[ghos]/i)^1);q&lt;0?break : i+=1};p ?_*i+?&lt;+a[i..-1]
</code></pre>

<p>There is probably some things i'm missing as I am new to this...</p>

<p>Ruby is my friend :)</p>
</div>
<div id="pu3" class="pu"><h2>Lua, <s>198</s> <s>190</s> <s>184</s> <s>185</s> 163 Bytes</h2>



<p>Ok, I admit, this is long. Very long. Lua has some tools to play around with strings, but it is limited, same goes for conditionals that takes lots of spaces.</p>

<p><strong>Edit: thanks @LeakyNun for saving me 9 bytes :)
        Lost some bytes to fix a bug</strong></p>

<p><strong>Edit 2: 163 Bytes solution found by @LeakyNun</strong></p>

<pre class="lang-lua prettyprint-override"><code>i=0p=0n=...for c in n:gmatch"."do
p=p+(c:find"[ghosGHOS]"and-1or c:find"[pelPEL]"and 1or 0)if p&lt;0then
break else i=i+1 end end print(('_'):rep(i)..'&lt;'..n:sub(i+1))
</code></pre>

<p><strong>Old 185</strong></p>

<pre class="lang-lua prettyprint-override"><code>p=0z=(...):gsub(".",function(c)p=p+(c:find"[ghosGHOS]"and-1or
c:find"[pelPEL]"and 1or 0)s=p&lt;0 and 1or s
return s and c or'_'end)_,i,s=z:find"(_+)"print((s or'')..'&lt;'..z:sub(1+(i or 0)))
</code></pre>

<h2>Ungolfed</h2>

<pre class="lang-lua prettyprint-override"><code>i=0                        -- number of characters eaten
p=0                        -- pellet counter
n=...                      -- shorthand for the argument
for c in n:gmatch"."       -- iterate over each characters in the input
do
  p=p+(c:find"[ghosGHOS]"  -- if the current char is a GHOST
        and-1              -- decrement the pellet counter
      or c:find"[pelPEL]"  -- if it's a PELLET
        and 1              -- increment it
      or 0)                -- else, leave it alone
  if p&lt;0                   -- if we try to eat a ghost without pellet
  then 
    break                  -- stop iterating
  else
    i=i+1                  -- else, increment our score
  end
end

print(('_'):rep(i)         -- print i*'_'
  ..'&lt;'                    -- appended with Pacman
  ..n:sub(i+1))            -- appended with the remaining characters if we died
</code></pre>
</div>
<div id="pu4" class="pu"><h1>Python 3, <s>114</s> 110 bytes</h1>

<p>My first code golf.</p>

<p>Thanks to Dr Green Eggs and Iron Man for saving 4 bytes.</p>

<pre><code>l,x=1,0
f,y,s="ghosGHOS","pelPEL",input()
while s[x:]*l:l+=(s[x]in y)-(s[x]in f);x+=l&gt;0
print("_"*x+"&lt;"+s[x:])
</code></pre>

<p>Utilises the evaluation of booleans to one and zero to condense a logical AND to a multiplication. (0*0=0, 1*0=0, 1*1=1). I hope this is a good first try.</p>
</div>
<div id="pu5" class="pu"><h1><strong>C++, <strike>315</strike> <strike>373</strike> 327 Bytes</strong></h1>
<p><strong>(Note: still golfing)</strong></p>
<pre><code>#include &lt;iostream&gt;
#include &lt;string&gt;
using namespace std;
int main(){string input;getline(cin, input);
if(input.find(&quot;Pac-Man loses&quot;)!=string::npos||input.find(&quot;Pacman loses&quot;)!=string::npos)
    cout&lt;&lt;&quot;&lt;&quot;&lt;&lt;input.substr(15,input.length()-1);
else{for(unsigned i=0;i&lt;=input.length();++i)
    cout &lt;&lt; &quot;_&quot;;
cout&lt;&lt;&quot;&lt;&quot;;
}return 0;
}
</code></pre>
</div>
<div id="pu6" class="pu"><h1>Python 2, <strike>114</strike> <strike>113</strike> 108 bytes</h1>
<pre class="lang-python prettyprint-override"><code>s=raw_input()
p=i=0
for c in s:
 p+=(c in'plePLE')-(c in'ghosGHOS')
 if p&lt;0:break
 i+=1
print'_'*i+'&lt;'+s[i:]
</code></pre>
</div>
<div id="pu7" class="pu"><h1>C, 237 bytes</h1>

<pre><code>#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
main(p,i,j){char s[99];fgets(s,99,stdin);for(p=i=0;s[i];++i){if(strchr("GHOSghos",s[i])){if(p)p--;else break;}else if(strchr("PELpel",s[i]))p++;}j=i-(s[i]==0);while(j--)printf("_");printf("&lt;%s",s+i);}
</code></pre>
</div>
<div id="pu8" class="pu"><h1>Haskell, <del>119</del> 113 Bytes</h1>

<p>Thanks to Daniel Wagner for 6 bytes less.</p>

<pre><code>p=(0!)
n!(c:s)|elem c"ghosGHOS"=if n&lt;1then '&lt;':c:s else(n-1)&amp;s|elem c"elpELP"=(n+1)&amp;s|0&lt;1=n&amp;s
_!_="&lt;"
n&amp;s='_':n!s
</code></pre>

<p>Call it as <code>p "Hello World!"</code>.</p>

<p>The <code>1then</code> is an edge case that is interpreted correctly in my GHC (7.10), but it throws of most syntax highlighters. So it might be interpreted differently in your compiler as well.</p>

<p>Ungolfed:</p>

<pre class="lang-haskell prettyprint-override"><code>pacman string = go 0 string

-- | In the golfed version: (!)
go _   []                   = "&lt;"                            -- won
go pellets (char:string)
 | char `elem` "ghosGHOS"
 = if pellets &lt; 1        then '&lt;':char:string                -- lost
                         else nextStep (pellets - 1) string  -- ghost
 | char `elem` "elpELP"
 =                            nextStep (pellets + 1) string  -- pellet
 | otherwise
 =                            nextStep  pellets      string  -- anything else

-- | In the golfed version: (&amp;)
nextStep pellets string = '_':(go pellets string)
</code></pre>
</div>
<div id="pu9" class="pu"><h1>Perl, 54 (52+2) bytes</h1>

<pre><code>s/([pel](?1)*[ghos]|[^ghos
])*/'_'x(length$&amp;).'&lt;'/ei
</code></pre>

<p>Needs <code>-p</code> to be specified in the command-line options.</p>

<p>Explanation:</p>

<p>The <code>-p</code> option causes the statement to be wrapped in a read-modify-print loop, where during each loop iteration, <code>$_</code> contains a line of input, including the line delimiter.</p>

<p>The regex is largely the same idea as in the Retina answer.</p>

<p>Call the search pattern <code>([pel](?1)*[ghos]|[^ghos
])*</code> "acceptable". Then it can be recursively defined as:</p>

<p>A string is "acceptable" if:</p>

<ul>
<li>It is a character in <code>PELLET</code> except for <code>T</code>, followed by an acceptable string, followed by a character in <code>GHOST</code> except for <code>T</code>.</li>
<li>It is a character not in <code>GHOST</code> except for <code>T</code> that is not a newline character.</li>
<li>It is a concatenation of any number (including 0) of acceptable strings.</li>
</ul>

<p>This definition allows more pellets than ghosts: a <code>PEL</code> character may be matched as either a pellet character, or a non-ghost character.</p>

<p>The empty string is considered acceptable, therefore the regex is guaranteed to match at position 0, where the longest acceptable substring will be matched.</p>

<p>This longest acceptable substring is then matched by underscores of equal length, followed by <code>&lt;</code>.</p>
</div>
<div id="pu10" class="pu"><h1>Python3, <s>211</s> 184 bytes</h1>
<p>The argument 's' is a string</p>
<pre><code>def f(s):
    p=c=0
    for i in s:
        if i in &quot;gGhHoOsS&quot;:
            if p&lt;1:break
            else:p-=1
        if i in &quot;pPeElL&quot;:p+=1
        c+=1
    return&quot;_&quot;*c + &quot;&lt;&quot; + s[c:]
</code></pre>
<p>I would appreciate any golfing tips as this is my first code golf attempt</p>
<p>Thanks for commenting :)</p>
</div>
<div id="pu11" class="pu"><h1>Powershell, 185</h1>

<pre><code>{$l=1;$o="";for($i=0;($i -lt $_.Length) -or (($o+="&lt;") -and 0); $i++){if ($_[$i] -match '[pel]'){$l++}if($_[$i] -match '[ghos]'){$l--}if(!$l){$o+="&lt;"+$_.substring($i);break}$o+="_"}$o}
</code></pre>

<h3>Ungolfed:</h3>

<pre><code>("Pacman wins!",
"Pacman loses wah-wah :(",
"PELLET PELLET GHOST",
"Hello World!"
) | 
% {
    $l=1;$o="";
    for($i = 0; ($i -lt $_.Length) -or (($o+="&lt;") -and 0); $i++) {
        if ($_[$i] -match '[pel]') { $l++ }
        if ($_[$i] -match '[ghos]') { $l--}
        if (!$l) { $o+="&lt;"+$_.substring($i); break }        
        $o += "_"
    }
    $o
}
</code></pre>
</div>
<div id="pu12" class="pu"><h1>C#, <s>269</s> <s>256</s> <s>232</s> <s>212</s> 211 Bytes</h1>

<p>First ever post on here, so this is probably a lot longer than it could be (and probably because it is in C#). Any tips on where I could shorten it would be great!  </p>

<p>Thank you to everyone in the comments who helped me!</p>

<h3>Golfed version</h3>

<pre><code>static void p(string x){int p=0,i=0;string t='&lt;'+x;var s=t.ToCharArray();for(;++i&lt;s.Length;){if("PELpel".Contains(s[i]))p++;if("GHOSghos".Contains(s[i])&amp;&amp;--p&lt;0)break;s[i]='&lt;';if(i&gt;0)s[i-1]='_';}Console.Write(s);}
</code></pre>

<h3>Ungolfed version</h3>

<pre><code>static void p(string x) {
 int p = 0, i = 0;
 string t = '&lt;' + x;
 var s = t.ToCharArray();
 for (; ++i &lt; s.Length;) {
  if ("PELpel".Contains(s[i])) p++;
  if ("GHOSghos".Contains(s[i]) &amp;&amp; --p &lt; 0) break;
  s[i] = '&lt;';
  if (i &gt; 0) s[i - 1] = '_';
 }
 Console.Write(s);
}
</code></pre>
</div>
<div id="pu13" class="pu"><h1>Python 2, 89 bytes</h1>

<p>Sometimes my stubborn determination to make Python a functional language has its benefits.</p>
<pre class="lang-python prettyprint-override"><code>def f(s,l=1):l+=(s[:1]in'plePLE')-(s[:1]in'ghosGHOS');return s*l and'_'+f(s[1:],l)or'&lt;'+s
</code></pre>
<h3>(Slightly) ungolfed:</h3>
<pre class="lang-python prettyprint-override"><code>def f(s, l=1):
    l += (s[:1] in 'plePLE') - (s[:1] in 'ghosGHOS')
    return (s * l) and ('_' + f(s[1:], l)) or ('&lt;' + s)
</code></pre>
<p>Builds up the result string using recursion. The update to <code>l</code> (for &quot;lives&quot;) adds 1 for pellets (<code>True - False == 1</code>), subtracts 1 for ghosts (<code>False - True == -1</code>),  and adds 0 for any other character. It also adds 0 when <code>s</code> is the empty string, thanks to Python's slicing and the fact that <code>'' in any_str == True</code>, so the pellet and ghost cancel.</p>
<p>The return statement uses <code>test and b or a</code> in place of <code>a if test else b</code> to save one byte. The recursion base case occurs when either the string ends or Pac-Man runs out of pellets, succinctly represented as <code>s*p</code>, which equals <code>''</code> (and therefore evaluates to false) when either <code>s == ''</code> or <code>p == 0</code>.</p>
</div>
<div id="pu14" class="pu"><h1>Jelly, <s>34</s> 33 bytes</h1>
<pre><code>Œl“ʋʋ“ṁḍ»ċ€Ð€IF+\‘0ṭi0ð’”_×;”&lt;;ṫ@
</code></pre>
<p><a href="http://jelly.tryitonline.net/#code=xZJs4oCcyovKi-KAnOG5geG4jcK7xIvigqzDkOKCrElGK1zigJgw4bmtaTDDsOKAmeKAnV_DlzvigJ08O-G5q0A&amp;input=&amp;args=IlBhY21hbiBsb3NlcyB3YWgtd2FoIDooIg" rel="noreferrer">Try it online!</a></p>
<p>I think I'm finally starting to understand Jelly. Feels a bit scary.</p>
</div>
<div id="pu15" class="pu"><h1>Pyth, <s>47</s> <s>46</s> 44 bytes</h1>

<pre><code>++*\_Kh+f!h=+Z-}Jr@zT0"pel"}J"ghos"Uzlz\&lt;&gt;zK
</code></pre>

<p><a href="http://pyth.herokuapp.com/?code=%2B%2B*%5C_Kh%2Bf!h%3D%2BZ-%7DJr%40zT0%22pel%22%7DJ%22ghos%22Uzlz%5C%3C%3EzK&amp;input=Pac-Man+loses+here&amp;debug=0" rel="nofollow">Try it online.</a> <a href="http://pyth.herokuapp.com/?code=%2B%2B*%5C_Kh%2Bf!h%3D%2BZ-%7DJr%40zT0%22pel%22%7DJ%22ghos%22Uzlz%5C%3C%3EzK&amp;test_suite=1&amp;test_suite_input=Pacman+wins%21%0APacman+loses+wah-wah+%3A%28%0APELLET+PELLET+GHOST%0AHello+World%21%0A%3C_%21%4012%3C_%3C_%3C&amp;debug=0" rel="nofollow">Test suite.</a></p>

<p>Quite a different approach from Leaky Nun's, and I'm quite sure this can be golfed further.</p>
</div>
<div id="pu16" class="pu"><h2>JavaScript (ES6), 98 bytes</h2>

<pre><code>s=&gt;s.replace(/./g,c=&gt;p&lt;0?c:(p+=/[elp]/i.test(c)-/[ghos]/i.test(c))&lt;0?"&lt;"+c:"_",p=0)+"&lt;".slice(p&lt;0)
</code></pre>

<p>Explanation: <code>p</code> maintains the current number of pellets. If it's already negative, we just return the character and move on, so that the rest of the string is untouched. Otherwise, we examine the current character, and if that makes <code>p</code> become negative, we insert the <code>&lt;</code> character, otherwise we replace the current character with <code>_</code>. Finally, if <code>p</code> never becomes negative, we suffix a <code>&lt;</code> to the string.</p>
</div>
<div id="pu17" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, <s>37</s> <s>36</s> 35 bytes</h1>
<pre><code>tkt'ghos'mw'pel'm-Ys1=Y&gt;&amp;)g95*60bhh
</code></pre>
<p><a href="http://matl.tryitonline.net/#code=dGt0J2dob3MnbXcncGVsJ20tWXMxPVk-JilnOTUqNjBiaGg&amp;input=J1BhY21hbiBsb3NlcyB3YWgtd2FoIDooJw" rel="nofollow noreferrer"><strong>Try it online!</strong></a></p>
<h3>Explanation</h3>
<pre><code>tkt      % Input string implicitly. Duplicate, convert to lower case, duplicate
'ghos'm  % True for &quot;ghost&quot; characters
w'pel'm  % Swap to bring lowercase copy to top. True for &quot;pellet&quot; characters
-Ys      % Subtract, cumulative sum. Pac-Man can reach until the first &quot;1&quot;
1=       % True for entries that equal 1
Y&gt;       % Cumulative maximum. This gives false until the first true is found, and
         % true from there on
&amp;)       % Split original string in two parts, given by the zeros and ones respectively
g95*     % Convert the first part into ones and multiply by 95. This gives a numerical
         % array containing number 95 (ASCII for '_')
60       % Push 60 (ASCII for '&lt;')
b        % Bubble up second part of original string
hh       % Concatenate the three strings/arrays, automatically converting to char
</code></pre>
</div>
<div id="pu18" class="pu"><h2>Python 3, <s>176</s> <s>157</s> <s>150</s> <s>149</s> <s>134</s> <s>133</s> 124 bytes</h2>

<p>Define a function named <code>f</code> which take the string as argument</p>

<pre><code>def f(s):
 n=i=0
 for c in s:
  if c in"GgHhOoSs":
   if n:n-=1
   else:break
  n+=c in"PpEeLl";i+=1
 return"_"*i+"&lt;"+s[i:]
</code></pre>

<p>Can be probably be golfed more</p>

<p>Thanks to everyone who commented :D</p>
</div>
<div id="pu19" class="pu"><h1>Pyth, <s>53</s> <s>48</s> 44 bytes</h1>
<p>4 bytes thanks to @Pietu1998 for the <code>!!@</code> -&gt; <code>}</code> trick (which only people who know Pyth can understand)</p>
<pre>
<s>++*Jf&lt;@+sM._m-!!@d"PELpel"!!@d"GHOSghos"Q_1T00\_\&lt;&gt;QJ</s>
<s>++*Jf&lt;@+sM._m-!!@d"PEL"!!@d"GHOS"rQ1_1T00\_\&lt;&gt;QJ</s>
++*Jf&lt;@+sM._m-}d"PEL"}d"GHOS"rz1_1T00\_\&lt;&gt;zJ
</pre>
<p><a href="http://pyth.herokuapp.com/?code=%2B%2B%2aJf%3C%40%2BsM._m-%7Dd%22PEL%22%7Dd%22GHOS%22rz1_1T00%5C_%5C%3C%3EzJ&amp;test_suite=1&amp;test_suite_input=Pacman+wins%21%0APacman+loses+wah-wah+%3A%28%0APELLET+PELLET+GHOST%0AHello+World%21%0A%3C_%21%4012%3C_%3C_%3C&amp;debug=0" rel="noreferrer">Test suite.</a></p>
</div>
<div id="pu20" class="pu"><h2><a href="https://github.com/m-ender/retina" rel="nofollow noreferrer">Retina</a>, <s>55</s> 38 bytes</h2>

<pre><code>i`^(([elp])|[^ghos]|(?&lt;-2&gt;.))*
$.&amp;$*_&lt;
</code></pre>

<p><a href="http://retina.tryitonline.net/#code=JShHYAppYF4oKFtlbHBdKXxbXmdob3NdfCg_PC0yPi4pKSoKJC4mJCpfPA&amp;input=UGFjbWFuIHdpbnMhClBhY21hbiBsb3NlcyB3YWgtd2FoIDooClBFTExFVCBQRUxMRVQgR0hPU1QKSGVsbG8gV29ybGQh" rel="nofollow noreferrer">Try it online!</a> (The first line just allows running several test cases at once.)</p>

<h3>Explanation</h3>

<p>The problem is essentially to find the longest prefix that doesn't have an unmatched closing parenthesis. Except that we can use either <code>e</code>, <code>l</code> or <code>p</code> in place of <code>(</code> and either <code>g</code>, <code>h</code>, <code>o</code> or <code>s</code> in place of <code>)</code>.</p>

<p>Hence, this solution is almost a textbook example of balancing groups. I won't go into too much detail about how they work, as this code is essentially the same as the standard example you can read up on <a href="https://stackoverflow.com/a/17004406/1633117">in my SO answer on balancing groups</a>.</p>

<p>The entire program is therefore a single regex substitution. The <code>i</code> activates case-insensitivity. Then we either match a pellet with <code>[elp]</code> and increment the depth counter (in the form of the capture stack of group <code>2</code>), or we match something that isn't a ghost with <code>[ghos]</code> or we match a ghost with <code>.</code> and decrement the depth counter by popping from stack <code>2</code>. Of course, in principle this allows matching a pellet with the <code>[^ghos]</code> section or a non-ghost with the <code>.</code> section, but thanks to greedy matching and the way the regex is backtracked, these possibilities are never attempted by the regex engine.</p>

<p>The substitution then uses two Retina specific features: <code>$*</code> repeats the character to its right as many times as specified by the token on its left. That token is <code>$.&amp;</code> which is the length of the entire match. This just means that we replace each character in the match with a <code>_</code>. And then we also append a <code>&lt;</code> to those underscores. The part of the input that isn't eaten simply remains unaffected by the substitution.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/84088/">84088</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




