<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::125319</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>091</td><td>Regex üêá PCRE2 v10.35 or later</td><td>241029T224928Z</td><td><a href="https://codegolf.stackexchange.com/questions/125319/golf-a-bijection-within-the-natural-numbers-which-map-the-primes-to-a-proper-sub/276398#276398">Deadcode</a></td></tr>
<tr d-ix="1"><td>012</td><td>Jelly</td><td>170610T025656Z</td><td><a href="https://codegolf.stackexchange.com/questions/125319/golf-a-bijection-within-the-natural-numbers-which-map-the-primes-to-a-proper-sub/125720#125720">Dennis</a></td></tr>
<tr d-ix="2"><td>021</td><td>MATL</td><td>170608T152722Z</td><td><a href="https://codegolf.stackexchange.com/questions/125319/golf-a-bijection-within-the-natural-numbers-which-map-the-primes-to-a-proper-sub/125331#125331">Luis Men</a></td></tr>
<tr d-ix="3"><td>075</td><td>JavaScript ES6</td><td>170608T154530Z</td><td><a href="https://codegolf.stackexchange.com/questions/125319/golf-a-bijection-within-the-natural-numbers-which-map-the-primes-to-a-proper-sub/125342#125342">Arnauld</a></td></tr>
<tr d-ix="4"><td>014</td><td>Jelly</td><td>170608T154504Z</td><td><a href="https://codegolf.stackexchange.com/questions/125319/golf-a-bijection-within-the-natural-numbers-which-map-the-primes-to-a-proper-sub/125341#125341">Erik the</a></td></tr>
<tr d-ix="5"><td>048</td><td>Mathematica</td><td>170608T152353Z</td><td><a href="https://codegolf.stackexchange.com/questions/125319/golf-a-bijection-within-the-natural-numbers-which-map-the-primes-to-a-proper-sub/125328#125328">Martin E</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Regex <code>üêá</code> (PCRE2 <sub><sup>v10.35 or later</sup></sub>), <s>102</s> 91 bytes</h1>
<p><code>^(?=(xx)\1+$|(xx+)\2+$|x$|(?*x(x*))(?!(?*(xx+)(x+$))(?=\4*(x+)).*(?=\5\6$)\3\4*$))\1?+\3?x+</code></p>
<p><a href="https://ato.pxeger.com/run?1=hVbLbttGFF0W0FeMGdeeISlXtBrDEE0LjizABhI7UGQ0jaQSNDmUiFBDghzGshNv-wHddtNNlvmgdNnf6KZ3HpJoS0AJW5q5j3Pfl_rzW5inVSn-_WkYfhsZzTQPC3rYPDYm3wcvIhonjKK3vUH_0O9dn_f9m6vLof_L5fnwAh03XiQsTKuIohOpdDA7bYSzoEB-PpogDw2MV3d3H2_b1a_39--Hs6O7Gf5a8bh5_H30G-56eLEgY8fa_QIHi4wP4bSAS9dc4IVJCO7uwFny8MLaFQRv_DMQLEIOTHF5OT7aJeM2EIE7drrWuN1dWMrE3z_8S55bN2xk5p6fW45bc73kRcKmwvc1LcmASoP56YbcaSNhHOVw5D4tiqzAYcZKjmTc5pyWZTClBH0uedTphCCBTk6QJoujpFMWpS4qKK8Khhz3cQNT3MMsoja6zbIUZV4cpKWAlWY03Ojw5dHEbSB4khhhWQJ_SjWGr6WwwsGqhje9i7PBsUk000Zl8kCzGK8c_2lJqckTQqQV8eAMdVUQYVZx1EGrQIkIz5BqSHrQQcaz4KWyYYCWMWYGWeUjhv6bqUhWSWk8NipWJlNGI5RmbKo-Albe0cKVCZvf-2GQpuCGjl3f_Ns0Cz8iM7TRpyyJkBkFPIDciSSJI_I8hAXHJHtrDKKxLWtVmZauzDxIGAYA6WA-gkZIKcM5aToTr-WqEFR3oDz0DNztGC6cLC9XXwa0bk_0MwF6BYjtQ59DUUFXwE_hIKHrQAnLKy7UZWBQQmQWdHmfBzyc-TIWc31WaAUtq5TbqgSuHt13lx_6khLHJQUmxAshTPnsiYCZfaIhBy1dCRjhpf15nqQU66Z493Y4IHl4EPrgLCa2xvjQH1z7w_7gzeXV2bB_viT33w_7V-fivid90t_akxZZd_BOAQ2oc1-fBvmp5WqhexvZ8OEecOrHRTb384BzWjBcQJdf3bx-rQHqOjC6nC44JHF58rbxNSzeQIEIVi24hLBrfWlv67PnAMpUmsyTOkjTIW5NKKI5_1-hgoZVUSYZ2yoozcZZgeR2eVh1LmyMFJY8VoOcMFv1HnGXHS_LAyqsBekJeJZgKbAsP9SfOTbKsxLYigMvjQjvN_e1UfEwR-QWZHa8ep93OkwQu1twkSXlLeQQWBistcZSu1aYY_RO3UbMsZyJC8tmDpnApY32F_vCMUhQCcyJV9NfJSHxmJjBE485LrKspB7xsikfCAKnhBG8P2YQEqQOpGV_xtj4MUL__P4HgldLAiy1QsCxmjU1S2Ion3aXbMz6RIHTCQyE_Fv3NJx1GYm74ZzCPWmhvT1tY8fTUzcYXA_8q-s3Z8PeBXmiKNuvNl7LjcGLij6zQeGts6G73v6wv3XEWza5eB4b689tgxUXlOJ1fJsDrQRWd1LfiIoJO2O1sFUk8OpQvwH--tpqttttdfkP" rel="nofollow noreferrer" title="C++ (GCC) - Attempt This Online">Attempt This Online!</a></p>
<p>Implements the same bijection as <a href="https://codegolf.stackexchange.com/a/125720/17216">Dennis's Jelly answer</a>:</p>
<ul>
<li>Every prime maps to the next prime (implementation adapted from <a href="https://codegolf.stackexchange.com/questions/108512/the-program-that-will-find-the-next-prime-number/250320#250320">The program that will find the next prime number</a>).</li>
<li>Every even number greater than <span class="math-container">\$2\$</span> maps to the previous even number.</li>
<li>Every odd non-prime, and <span class="math-container">\$0\$</span>, maps to itself.</li>
</ul>
<p>The inverse of what the challenge asks, a bijection that maps a proper subset of the primes to the primes, <a href="https://ato.pxeger.com/run?1=hVbNbttGED4W0FOsmdTeFalUtNrAEE0LrizABhI7UGQ0ja0QNLmUFqGWBLmMZVe-5gFy7aWXHPNA6bGv0UtnfyTRloASlrQ_M9_8fTP0n9-iPK1K-QkmUfTtymqleVTQ_daBNf4-fBbThHGK3vSHg_2gf3EyCC7Pz0bBb2cno1N00HjGeJRWMUWHSunF9KgRTcMCBfnVGPloaP16e_vxplP9fnf3bjR9eTvFXyuRtA6-H3zAvSPc8_F8TvC1az8nCwxrm1z_DGuymNs93NvBvQ4h5Hq_N7cXH57jxWJBtP7fP_xLnkJbDmrmfpDbrlfzqxQF4xPp2PqMZXBKw9nRhtxRg3GBcliKgBZFVuAo46VAKqjmjJZlOKEE_VGKuNuNQAIdHiJzLJfqnPI49VBBRVVw5HoPG5hyH2UxddBNlqUo85MwLSWsMmPgrvZ_eTn2GggeliCs8htMqMEIjBTWOFgX6LJ_ejw8aBJz6aCS3dMswSvHf1qe1OQhw8qKfHCGejqIKKsE6qJVoESGZyk1pDzoIutJ8ErZskDLuuYWWeUjAXJNdSSrpDQeGhUv2YTTGKUZn-ivkJe3tPBUwmZ3QRSmKbhhYje74CbNoo-oGTnoU8Zi1IxDEULuZJLkEvk-wvKmSXbXGMRg2_aqMm1TmVnIOAYA5WB-BURIKcc5abljv-3pEDQ7UB75Fu51LQ9Wtp_rH4vgXh8-OwTOK0Ds7AcCigq6En4CCwVdB2I8r4RUV4FBCVGzoMv9LBTRNFCxNNdrjVbQskqFo0vgmb58e_Z-oE6SpKRwCfFCCBMxfSTQzD7RSICWqQT059L-LGcpxYYUb9-MhiSPXkQBOIuJYzDeD4YXwWgwfH12fjwanCyPB-9Gg_MTud9VPplf40mbrBm8UwABTe7r3aC-jVwtdH8jGwHsQ0GDpMhmQR4KQQuOC2D5-eWrVwagrgOtK-hcQBKXK3_bvYHFGygQwYqCSwinxktnG8-eAmhTKZuxOkjLJV5NKKa5-F-hgkZVUbKMbxVUZpOsQGq63K-YCxMjhQmOdSMz7mjuEW_JeFUeUOFtSE8oMoaVwLL8UH_uOijPSrjWN_BGiPFea88YlQ93ZW5BZsev87zb5fKwtwUX2UreRi6BgcHbayw9a6U5Tm_17oq7tjv2YNjMIBO4dNDefE86Bgkq4XLs1_RXSWA-lz146HPXQ7bN6hEvSXlPEDgljeC9aw4hQepAWvEzwdaPMfrn8xcErxYGV3qEgGM1a7qXZFM-ZpciZr2jwGkGDaH-1pyGtSkj8Tac07iHbbS7a2zs-KbrhsOLYXB-8fp41D8ljxQV_WrttZwYoqjoExsU3jobuuvpD_PbRLxlksvnobH-3tZYSUEpXse32dBaYLUn9YmoL2FmrAa2jgReHfp_gL--tludTkdv_gM" rel="nofollow noreferrer" title="C++ (GCC) - Attempt This Online">would be much shorter (56 bytes)</a>.</p>
<pre><code>^                # tail = N = input number
(?=              # Atomic lookahead
    (xx)\1+$         # \1 = 2 if N is even and &gt;2, else \1 = unset
|                # or
    (xx+)\2+$        # N is composite
|                # or
    x$               # N == 1
|                # or
    # Find the smallest prime greater than N
    (?*              # Non-atomic lookahead (try all options until matching)
        x(x*)        # \3 = N - (P - N) = 2*N - P, for conjectured P &gt; N
    )
    (?!              # Negative lookahead - assert that this cannot match
        (?*          # Non-atomic lookahead (try all options until matching)
            (xx+)    # \4 = try all numbers from 2 through N-1
            (x+$)    # \5 = N - \4; assert \4 &lt; N
        )
        (?=          # Atomic lookahead (locks onto the first match)
            \4*(x+)  # \6 = N % \4, giving \4 instead of 0
        )
        .*(?=\5\6$)  # tail = \5 + \6
        \3           # tail -= \3
        \4*$         # Assert tail is divisible by \4
    )
)
\1?+             # tail -= \1, atomically, if \1 is set
\3?              # Optionally, if \3 exists, tail = tail-\3 = P - N;
                 # the following will be evaluated for all options taken:
x+               # Add tail to the number of possible matches
</code></pre>
<h1>Regex <code>üêò</code> (.NET), <s>99</s> <s>93</s> 87 bytes</h1>
<p><code>(?=(xx)\1+$|(xx+)\2+$|x?$|(x)+?(x*$)(?&lt;!(?=\6*(?&lt;=(?=\4\6*$)\5))(^x+)(x+x)))\1?(?&lt;3&gt;x)*</code></p>
<p><a href="https://tio.run/##RZBBboMwEEWv4qKR8ECNktB2EeoSqeueAIiEqBMsOQYZo1hJ2fYAPWIvQk2jqrv3Z/58fU3fnYUZWqHUDIYXRhyFq7ZbLc50F84059Q5LNcxfHiIsdx4cvmiMM6piwBp/nznfeVT5Ikv9OAZsHxEpHt/Q13sEH1I7g3pi8NoDnf3wWt36qUS7wFmcOGr7NAZUTctBUWkJiB1P1q8Qs1BsaFX0gYsyOSBQp003agtU5ZsFkPMoS5W1eQDKGheSG2r30kGminxp9eLjmO8LhknDiZ5q23TioGGLoxA421zwevZSCtY2w128s3W2b8mTHf@NUpqQQLQ5Pvzi4BPS46mG/uhSKukqXs7GjHcSmIwTdO8Ymma/gA" rel="nofollow noreferrer" title="PowerShell ‚Äì Try It Online">Try it online!</a></p>
<p>Returns its output as the capture count of group <code>\3</code>.</p>
<p>The inverse of what the challenge asks, a bijection that maps a proper subset of the primes to the primes, <a href="https://tio.run/##RZBBboMwEEWv4qKRsOMakZBuQl0idd0TEBaIOsGSYyNjFCvE2x6gR@xFKCSqupv3ZvT1NZ25CNu3QqkJLC@tOAlf7XZaXPA@njAuOMaejJtADhsKN@w9JYctBXLztMDF00O8zILg4jV782R1uw9k3IYp3j9H7@bcSSU@I5LDlaf50VhRNy0GhaRGIHU3ODJCzUGxvlPSRSzK5RFDnTRm0I4phzbLAeVQl2kV5gAMmpdSu@puctBMiT9eL0wpGZeMMwebfNSuaUWPYx@vQJPH5krGi5VOsNb0LszN1vk/I6bN/AIltUARaPTz9Y1gTktO1gxdX2ZV0tSdG6zoHyVJFEKYUpZl2S8" rel="nofollow noreferrer" title="PowerShell ‚Äì Try It Online">would be much shorter (63 bytes)</a></p>
<pre><code>                     # tail = N = input number
(?=                  # Lookahead
    (xx)\1+$             # \1 = 2 if N is even and &gt;2, else \1 = unset
|                    # or
    (xx+)\2+$            # N is composite
|                    # or
    x?$                  # N ‚â§ 1
|                    # or
    # Find the smallest prime greater than N
    (x)+?                # Assert N &gt; 0; \3.captureCount += P - N;
    (x*$)                # \4 = N - (P - N) = 2*N - P
    (?&lt;!                 # Right-to-left negative lookbehind
        (?=              # Atomic lookahead
            \6*             # tail = Z = N % \6, giving \6 instead of 0
            (?&lt;=            # Right-to-left atomic lookbehind
                (?=         # Atomic lookahead
                    \4\6*$  # Assert tail-\4, that is, \5+Z-\4, is divisible by \6
                )
                \5          # tail += \5
            )
        )
        (^x+)            # \5 = N - \6; assert \6 &lt; N
        (x+x)            # \6 = try all numbers from 2 through N-1
    )
)
\1?                  # tail -= \1, if \1 is set
(?&lt;3&gt;x)*             # \3.captureCount += tail
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 12 bytes</h1>
<pre><code>√Ün_·∏ç@¬°√ÜP?2¬ª0
</code></pre>
<p><a href="https://tio.run/##ASgA1/9qZWxsef//w4ZuX@G4jUDCocOGUD8ywrsw/zByMjDCtSzDh@KCrEf/" rel="nofollow noreferrer" title="Jelly ‚Äì Try It Online">Try it online!</a></p>
<h3>How it works</h3>
<pre><code>√Ün_·∏ç@¬°√ÜP?2¬ª0  Main link. Argument: n (non-negative integer)

      √ÜP?     If the input is prime:
√Ün                Compute the next prime after n.
              Else:
   ·∏ç@¬°   2        Do once if n is divisible by 2, zero times if not.
  _      2        Subtract 2.
              So far, we've mapped all primes to the next prime, all even integers
              (except 2) to the previous even integer, and all composite, odd,
              positive integers to themselves. In particular, 0 -&gt; -2, but 0 doesn't
              have a preimage, so we need 0 -&gt; 0.
          ¬ª0  Take the maximum of the result and 0, mapping 0 -&gt; max(-2, 0) = 0.
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, 21 bytes</h1>

<p><em>Thanks to <a href="https://codegolf.stackexchange.com/users/47066/emigna">Emigna</a> for spotting a mistake, now corrected</em></p>

<pre><code>tZp?_Yq}q:Zp~fX&gt;sG~E+
</code></pre>

<p><a href="https://tio.run/##y00syfn/vySqwD4@srC20CqqoC4twq7Yvc5V@/9/Q0MA" rel="nofollow noreferrer">Try it online!</a></p>

<p>This implements the following bijection. Write the primes in a row and the non-primes below:</p>

<pre><code>2  3  5  7 11 13 17 ...
0  1  4  6  8  9 10 ...
</code></pre>

<p>Then the output is obtained by following the arrow from the input:</p>

<pre><code>2 &gt; 3 &gt; 5 &gt; 7 &gt; 11 &gt; 13 &gt; 17 ...
^
0 &lt; 1 &lt; 4 &lt; 6 &lt;  8 &lt;  9 &lt; 10 ...
</code></pre>

<h3>Explained code</h3>

<pre><code>t       % Implicit input. Duplicate
Zp      % Is it a prime? Gives true / false
?       % If so
  _Yq   %   Next prime
}       % Else
  q     %   Subtract 1
  :     %   Range from 1 to that
  Zp~   %   Is each entry not a prime? Gives an array of true / false
  f     %   Find non-zero entries, i.e. non-primes. Will be empty for input 1
  X&gt;    %   Maximum. This gives the greatest non-prime less than the input.
        %   Will be empty for input 1
  s     %   Sum. This is to transform empty into 0
  G~E   %   Push input, negate, times 2. This gives 2 for input 0, or 0 otherwise
  E     %   Add. This handles the case of input 0, so that it outputs 2
        % End (implicit). Display (implicit)
</code></pre>
</div>
<div id="pu3" class="pu"><h2>JavaScript (ES6), <s>82</s> <s>77</s> 75 bytes</h2>

<p>Implements the same logic as <a href="https://codegolf.stackexchange.com/a/125331/58563">Luis Mendo's answer</a>.</p>

<pre class="lang-js prettyprint-override"><code>f=(n,i=(P=(n,x=n)=&gt;n%--x?P(n,x):x==1||-1)(x=n))=&gt;x?x==n|P(n)-i?f(n+i,i):n:2
</code></pre>

<h3>Formatted and commented</h3>

<pre class="lang-js prettyprint-override"><code>f = (                   // given:
  n,                    // - n = input
  i =                   // - i = 'direction' to move towards
    (P = (n, x = n) =&gt;  // - P = function that returns:
      n % --x ?         //   - 1 when given a prime
        P(n, x)         //   - -1 when given a composite number
      :                 //
        x == 1 || -1    //
    )(x = n)            // - x = copy of the original input
) =&gt;                    //
  x ?                   // if the input is not zero:
    x == n | P(n) - i ? //   if n equals the input or doesn't match its primality:
      f(n + i, i)       //     do a recursive call in the chosen direction
    :                   //   else:
      n                 //     return n
  :                     // else:
    2                   //   return 2
</code></pre>

<h3>Demo</h3>

<p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-js lang-js prettyprint-override"><code>f=(n,i=(P=(n,x=n)=&gt;n%--x?P(n,x):x==1||-1)(x=n))=&gt;x?x==n|P(n)-i?f(n+i,i):n:2

for(n = 0; n &lt; 50; n++) {
  console.log(n, '-&gt;', f(n));
}</code></pre>
</div>
</div>
</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 14 bytes</h1>

<pre><code>√Ün‚Äô‚Äô√ÜP¬ø$√ÜP?2¬π?
</code></pre>

<p><a href="https://tio.run/##y0rNyan8//9wW96jhplAdLgt4NB@FSBpb3Rop/3///8NAA" rel="nofollow noreferrer" title="Jelly ‚Äì Try It Online">Try it online!</a></p>

<p>Uses Luis's algorithm.</p>
</div>
<div id="pu5" class="pu"><h2>Mathematica, <s>54</s> 48 bytes</h2>

<pre><code>¬±(t=x_?PrimeQ)=NextPrime@x
¬±n_:=Abs[n-1]/.t:&gt;x-1
</code></pre>

<p>Defines the following bijection:</p>

<pre><code> n  0, 1, 2, 3, 4, 5, 6,  7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, ...
¬±n  1, 0, 3, 5, 2, 7, 4, 11, 6, 8,  9, 13, 10, 17, 12, 14, 15, 19, ...
</code></pre>

<p>The basic idea is to map each prime to the next, to ensure that they are mapped to a proper subset. This results in a "gap" at <strong>2</strong>. To fill that gap, we want to map <strong>4</strong> to <strong>2</strong> and then each other composite number to the previous composite number, to "bubble up" the gap. Since <strong>2</strong> and <strong>3</strong> are the only two adjacent primes, we can express both of those mappings as "<strong>n-1</strong> or if that's a prime then <strong>n-2</strong>". Finally, this mapping ends up sending <strong>1</strong> to <strong>0</strong> and we make it send <strong>0</strong> back to <strong>1</strong> by taking the absolute value of <strong>n-1</strong>.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/125319/">125319</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




