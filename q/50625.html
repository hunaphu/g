<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::50625</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>099</td><td>Vyxal</td><td>211217T002253Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/239659#239659">emanresu</a></td></tr>
<tr d-ix="1"><td>404</td><td>Charcoal</td><td>211219T215212Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/239844#239844">jixperso</a></td></tr>
<tr d-ix="2"><td>280</td><td>Vyxal</td><td>210620T074440Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/230069#230069">emanresu</a></td></tr>
<tr d-ix="3"><td>200</td><td>CJam</td><td>150531T090438Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/51061#51061">aditsu q</a></td></tr>
<tr d-ix="4"><td>660</td><td>C</td><td>150523T205406Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/50679#50679">Reto Kor</a></td></tr>
<tr d-ix="5"><td>294</td><td>Perl</td><td>150523T124819Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/50673#50673">nutki</a></td></tr>
<tr d-ix="6"><td>440</td><td>JavaScript ES6</td><td>150523T144958Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/50674#50674">edc65</a></td></tr>
<tr d-ix="7"><td>473</td><td>Haskell</td><td>150523T082317Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/50669#50669">Damien</a></td></tr>
<tr d-ix="8"><td>344</td><td>Python 2</td><td>150522T183842Z</td><td><a href="https://codegolf.stackexchange.com/questions/50625/ascii-art-of-the-day-3-chinese-shrines/50652#50652">Matty</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal/tree/version-2" rel="nofollow noreferrer">Vyxal</a>, <s>120</s> <s>113</s> <s>107</s> <s>101</s> <s>100</s> 99 bytes</h1>
<pre><code>3∵£\.\|?›(‛.[n⇧Ij\#n*+\\\_n›d*+)?⇧Ẏ‛].?⇩1∴\#*j+¥-‛_|:ǏǓ?₌⇧d‹∴Ẏp¥꘍:ð\_VȮȧL‛#/e2Ǔ‛|/fJ2ʀ¥+\_*+÷WøMøĊ⁋
</code></pre>
<p><a href="https://vyxal.pythonanywhere.com/#WyIiLCIiLCIz4oi1wqNcXC5cXHw/4oC6KOKAmy5bbuKHp0lqXFwjbiorXFxcXFxcX27igLpkKispP+KHp+G6juKAm10uP+KHqTHiiLRcXCMqaivCpS3igJtffDrHj8eTP+KCjOKHp2TigLniiLThuo5wwqXqmI06w7BcXF9WyK7Ip0zigJsjL2Uyx5PigJt8L2ZKMsqAwqUrXFxfKivDt1fDuE3DuMSK4oGLIiwiIiwiNSJd" rel="nofollow noreferrer">Try it Online!</a></p>
<p>Posting this as a separate answer because it's so golfed, and uses the latest version of Vyxal.</p>
<h2>Explanation</h2>
<pre><code>----------------- TOP ------------
3∵£\.\|?›(‛.[n⇧Ij\#n*+\\\_n›d*+)
3∵£                              # Store min(input, 3) into the register for later use 
   \.\|                          # Push a . and a |
       ?›(                     ) # For each of 1...n+1, push
          ‛.[   j                # &quot;.[&quot; joined by
             n⇧I                 # that+2 spaces
                 \#n*+           # Append that many #
                        \_n›d*   # And push 2*that+2 underscores
                      \\      +  # Appended to a \
------------------- Doorway ------------------
?⇧Ẏ‛].?⇩1∴\#*j+¥-‛_|:ǏǓ?₌⇧d‹∴Ẏp¥꘍:ð\_V 
?⇧Ẏ           +                         # To the last of what was pushed in the previous, take the first input+2 characters and append
   ‛].       j                          # &quot;].&quot; joined by
      ?⇩1∴\#*                           # max(input-2,1) hashes 
               ¥-                       # Append min(input,3) -
                        ?₌⇧d‹∴          # max(input+2, 2*input-1)
                  ‛_|:ǏǓ      Ẏ         # Repeat '|__' to that length
                  ‛_|          p        # Append '_|'
                                ¥꘍      # Append min(input,3) spaces
                                  :ð\_V # Make a copy, and replace spaces with underscores 

---------- Entrance ------------
ȮȧL‹\#*\/+
ȮȧL                     # Length of top part of doorway with whitespace removed
   ‛#/e2Ǔ               # That-1 #, plus a /
         ‛|/fJ          # Append ['|','/']
              2ʀ¥+      # [a,a+a,a+2] where a = min(3,input)
                  \_*+  # That many underscores appended to each of previous
                      ÷ # Iterate out those on the stack

- Final magic bit -
W      # Get the stack
 øM    # Palindromise each, mirroring brackets
   øĊ  # Center each 
     ⁋ # Join on newlines
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 404 bytes</h1>
<pre><code>≔Ｎν≔⁺⁵×²νη≔× ⁻η⁻∕¹¦²¦¹τ⁺⁺⁺⁺⁺τ.¶τ|¶× ⁻η⁻∕¹²¦²¦¹“±∨N&quot;G:Ｗ⮌+”Ｆν«≔⁺⁺\×_⁺⁷×⁴ι/ε≔× ⁻η⁻∕Ｌε²¦¹τ⁺⁺τε¶≔⁺⁺⁺⁺.× ⁺ι⁴]×#⁺³×²ι⁺⁺[× ⁺ι⁴.ε≔× ⁻η⁻∕Ｌε²¦¹τ⁺⁺τε¶»≔⁻×²⌊⟦³ν⟧¹δ≔∕δ²ζ≔×#⁺¹⁻νζσ≔⁺⁺⁺⁺⁺\×_⁺ν¹]σ.⁺×-δ⁺.⁺σ⁺[⁺×_⁺ν¹/ε≔× ⁻η⁻∕Ｌε²¦¹τ⁺⁺τε¶≔×|__νε≔⁻⁻⁺⁴×²νζ¹τ≔✂ε⁰τ¦¦ε≔Ｌεα≔⁻Ｌε¹β¿⁼✂εβα¦¦|«≔⁺✂ε⁰β¦¦_ε»≔⁺✂ε⁰α¦¦|ε≔⁺⁺ε× δ⮌εα≔⁺⁺ε×_δ⮌εβＭ⁼ν¹¦⁰⁺⁺⁺⁺  α¶¦  βＭ±⁼ν¹¦⁰Ｍ±Ｌα⁰≔×#⁻⁺⁴×²⁻ν·⁵ζε⁺¶⁺⁺ε⁺/⁺⁺×_δ\ε¶≔⁻⁻⁺⁴×²⁻ν·⁵ζ¹ψ⁺× ψ⁺|⁺×_⁺δ²|¶⁺× ⁻ψ¹⁺/⁺×_⁺δ⁴\
</code></pre>
<p><a href="https://tio.run/##lVLNSsNAEH6VRY/Sir8HX8CbL2BLKL0oCILnHBqbQ5QeLblUeouCWmzapGx@EDb3yTvsC@QR4uzkp7HFQ2GTXWa/@b5vZrZ/03vo3/fu8lw@vWTRDGLcpRFIw0ts4UIMKwwkNpNGiEcjlNZYcOEIFz@emgRdr9RsCz81deFvpbhVkhxMxFxa71d7lxdZtJKz0YEcvGaRA7H4qNSDTmJrdFoltjSWwA/B23KSRZ/g/bWSmhjxa5pitSktAI5M3cTex7NYUH28AFw3AO1dhERIUqEik6NnOXXEAns4fRMclurKGsMSdXyiJGGueGPw0@GGy3XV2AneTYdtPCZ2C4mwBCU5VFYpWKF27Upi65qG6l5hmxYCluWwfUrBq8kjQozv1EQWh9DECvMir5Dg4IofaUSEBhfmCqzXQyw5QDlxNMSHGxcFvvSibAI@Ooblzka1VBXWqrCbRV@oqYoXDrI028cYcvrCwV3B8Jk1gBRQxucqqxxHo3wai8AeeuArfwE2rJTH32FxJiOd@omF/zJgIy3CM9r19dTwOehEXUwttdSLIP4KgHSdPD9nZ@yUnbBjdpS3bn8B" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/Lyxal/Vyxal" rel="nofollow noreferrer">Vyxal</a>, 280 bytes</h1>
<pre><code>d5+\.꘍,d5+\|꘍,(n-d:£\.꘍3n+\]꘍\#nd›*\[3n+\.꘍Ṡ,¥›\\꘍ndd7+\_*\/Ṡ,)\.?3+꘍\]\#?d›*\[?3+\.꘍Ṡ,ð\\?›\_*\]?2-1∴\#*\.?d‹5∵-\.?2-1∴\#*\[?›\_*\/Ṡ,3&lt;[⟨0|⟨3⟩|⟨2|1⟩⟩$i|3/⌊d2w$ẋf`013`?3%iIJ';]\_*Ṅðpð+ð\|Vðdp:£3?∵꘍øm,¥3?∵\_*+øm,4&lt;[3+|d]\#*:£ðdp\/\_?d‹5∵*\\¥Ṡ,¥L›\|꘍\_?d‹5∵⇧*\|Ṡ,¥L\/꘍\_?d‹5∵4+*\\Ṡ,
</code></pre>
<p><a href="http://lyxal.pythonanywhere.com?flags=&amp;code=d5%2B%5C.%EA%98%8D%2Cd5%2B%5C%7C%EA%98%8D%2C%28n-d%3A%C2%A3%5C.%EA%98%8D3n%2B%5C%5D%EA%98%8D%5C%23nd%E2%80%BA*%5C%5B3n%2B%5C.%EA%98%8D%E1%B9%A0%2C%C2%A5%E2%80%BA%5C%5C%EA%98%8Dndd7%2B%5C_*%5C%2F%E1%B9%A0%2C%29%5C.%3F3%2B%EA%98%8D%5C%5D%5C%23%3Fd%E2%80%BA*%5C%5B%3F3%2B%5C.%EA%98%8D%E1%B9%A0%2C%C3%B0%5C%5C%3F%E2%80%BA%5C_*%5C%5D%3F2-1%E2%88%B4%5C%23*%5C.%3Fd%E2%80%B95%E2%88%B5-%5C.%3F2-1%E2%88%B4%5C%23*%5C%5B%3F%E2%80%BA%5C_*%5C%2F%E1%B9%A0%2C3%3C%5B%E2%9F%A80%7C%E2%9F%A83%E2%9F%A9%7C%E2%9F%A82%7C1%E2%9F%A9%E2%9F%A9%24i%7C3%2F%E2%8C%8Ad2w%24%E1%BA%8Bf%60013%60%3F3%25iIJ%27%3B%5D%5C_*%E1%B9%84%C3%B0p%C3%B0%2B%C3%B0%5C%7CV%C3%B0dp%3A%C2%A33%3F%E2%88%B5%EA%98%8D%C3%B8m%2C%C2%A53%3F%E2%88%B5%5C_*%2B%C3%B8m%2C4%3C%5B3%2B%7Cd%5D%5C%23*%3A%C2%A3%C3%B0dp%5C%2F%5C_%3Fd%E2%80%B95%E2%88%B5*%5C%5C%C2%A5%E1%B9%A0%2C%C2%A5L%E2%80%BA%5C%7C%EA%98%8D%5C_%3Fd%E2%80%B95%E2%88%B5%E2%87%A7*%5C%7C%E1%B9%A0%2C%C2%A5L%5C%2F%EA%98%8D%5C_%3Fd%E2%80%B95%E2%88%B54%2B*%5C%5C%E1%B9%A0%2C&amp;inputs=5&amp;header=&amp;footer=" rel="nofollow noreferrer">Try it Online!</a>
No, I'm not explaining this.</p>
</div>
<div id="pu3" class="pu"><h1>CJam, 200 bytes</h1>

<pre><code>-4'.-4'|]2/ri:M),{2af.-~[W'.I3+~']'#I)*][-2'\'_I2*4+*]]}fI~[~M)&lt;']
M2m1e&gt;'#*'.'-M3e&lt;:D*][-3"|__"M*M2+M2*(e&gt;:L&lt;"_|"D~][_~~'_*][-3'#L)*
'/'_D*][L2+~'|'_D)*][L)~'/'_D2+*]]{{_0&lt;{~S*}&amp;}%s_W%1&gt;"\/]""/\["erN}%
</code></pre>

<p>Newlines added to avoid scrolling. <a href="http://cjam.aditsu.net/#code=-4&#39;.-4&#39;%7C%5D2%2Fri%3AM)%2C%7B2af.-~%5BW&#39;.I3%2B~&#39;%5D&#39;%23I)*%5D%5B-2&#39;%5C&#39;_I2*4%2B*%5D%5D%7DfI~%5B~M)%3C&#39;%5DM2m1e%3E&#39;%23*&#39;.&#39;-M3e%3C%3AD*%5D%5B-3%22%7C__%22M*M2%2BM2*(e%3E%3AL%3C%22_%7C%22D~%5D%5B_~~&#39;_*%5D%5B-3&#39;%23L)*&#39;%2F&#39;_D*%5D%5BL2%2B~&#39;%7C&#39;_D)*%5D%5BL)~&#39;%2F&#39;_D2%2B*%5D%5D%7B%7B_0%3C%7B~S*%7D%26%7D%25s_W%251%3E%22%5C%2F%5D%22%22%2F%5C%5B%22erN%7D%25&amp;input=5" rel="nofollow">Try it online</a></p>

<p><strong>Brief explanation:</strong></p>

<p>The program builds the left half of the shrine (including the middle), then reverses it and replaces some characters to get the right half. A series of n spaces is represented as the number ~n (bitwise "not") during construction, and replaced with the actual spaces at the end.</p>

<p>The program starts with the top 2 lines, then for each roof level, it prepends all the previous lines with 2 spaces and adds the new roof (2 lines). The last roof is modified to add the "above door" part.</p>

<p>Next, the upper wall is built by repeating "|__" and truncating at the right length, followed by a fixed "_|" and spaces. The wall is then duplicated and the door spaces are replaced with underscores. Finally, the lower part is constructed line by line.</p>
</div>
<div id="pu4" class="pu"><h2>C, 660 bytes</h2>

<p>The pattern just seemed to be too irregular to come up with anything fancy, particularly in a language without string processing. So here is my brute force approach:</p>

<pre class="lang-c prettyprint-override"><code>m,d,w,k,j;r(n,c){for(j=0;j++&lt;n;)putchar(c);}c(char*s){for(;*s;)putchar(*s++);}f(n){m=n*2;d=n&lt;3?m-1:5;w=m-d/2+2;r(m+5,32);c(".\n");r(m+5,32);c("|\n");for(;;){r(m-k*2,32);c(".");r(k+3,32);c("]");r(k*2+1,35);c("[");r(k+3,32);c(".\n");if(k==n)break;r(m-k*2+1,32);c("\\");r(k++*4+7,95);c("/\n");}c(" \\");r(n+1,95);c("]");r(n-d/2,35);c(".");r(d,45);c(".");r(n-d/2,35);c("[");r(n+1,95);c("/\n");for(k=0;k&lt;2;){c("  ");for(j=0;j&lt;w/3;++j)c("|__");c("|_|"-w%3+2);r(d,k++?95:32);c(!w%3?"|":w%3&lt;2?"|_":"|_|");for(j=0;j&lt;w/3;++j)c("__|");c("\n");}c("  ");r(w,35);c("/");r(d,95);c("\\");r(w,35);c("\n");r(w+1,32);c("|");r(d+2,95);c("|\n");r(w,32);c("/");r(d+4,95);c("\\\n");}
</code></pre>

<p>Before golfing:</p>

<pre class="lang-c prettyprint-override"><code>#include &lt;stdio.h&gt;

void r(int n, int c) {
    for (int i = 0; i++ &lt; n; )
        putchar(c);
}

void c(char* s) {
    for (; *s; ++s) putchar(*s);
}

int f(int n) {
    int m = n * 2;
    int d = n &lt; 3 ? m - 1 : 5;
    int w = m - d / 2 + 2;

    r(m + 5, 32);
    c(".\n");

    r(m + 5, 32);
    c("|\n");

    for (int k = 0; ; ++k) {
        r(m - k * 2, 32);
        c(".");
        r(k + 3, 32);
        c("]");
        r(k * 2 + 1, 35);
        c("[");
        r(k + 3, 32);
        c(".\n");

        if (k == n) break;

        r(m - k * 2 + 1, 32);
        c("\\");
        r(k * 4 + 7, 95);
        c("/\n");
    }

    c(" \\");
    r(n + 1, 95);
    c("]");
    r(n - d / 2 , 35);
    c(".");
    r(d, 45);
    c(".");
    r(n - d / 2 , 35);
    c("[");
    r(n + 1, 95);
    c("/\n");

    for (int k = 0; k &lt; 2; ++k) {
        c("  ");
        for (int j = 0; j &lt; w / 3; ++j)
            c("|__");
        c("|_|" - w % 3 + 2);
        r(d, k ? 95 : 32);
        c(!w % 3 ? "|" : w % 3 &lt; 2 ? "|_" : "|_|");
        for (int j = 0; j &lt; w / 3; ++j)
            c("__|");
        c("\n");
    }

    c("  ");
    r(w, 35);
    c("/");
    r(d, 95);
    c("\\");
    r(w, 35);
    c("\n");

    r(w + 1, 32);
    c("|");
    r(d + 2, 95);
    c("|\n");

    r(w, 32);
    c("/");
    r(d + 4, 95);
    c("\\\n");

    return 0;
}
</code></pre>

<p>Not much to explain here. It just goes line by line, and generates the necessary count of each character. I tried to keep the code itself compact, but it still adds up. <code>d</code> is the width of the door, <code>w</code> the width of each brick wall.</p>
</div>
<div id="pu5" class="pu"><h1>Perl, <s>332 316</s> 294</h1>

<pre class="lang-perl prettyprint-override"><code>$:=($w=&lt;&gt;)*2+6;$r=2x($m=$w&gt;3?3:$w);$k=1x($w-3).b.4x$m;
y!a-f1-4!/.|\\[,#_ -!,/,/,s/(.*),(.*).{@{-}}/$2$1/,printf"%$:s%s
",y!/\\[!\\/]!r,(reverse=~s/.//r)for@x=(b,c,
(map{b33.3x$_.e.1x$_,"[#$k,"x/$w/.a__.22x$_}1..++$w),
_c.3x$m.f.($z=substr"|__"x$:,0,2*++$w),"_|$r,$z","d$r,".11x$w,c_.$r,d__.$r)
</code></pre>

<p>Try <a href="http://ideone.com/I6833m" rel="nofollow">me</a>.</p>

<h1>C, 371</h1>

<pre class="lang-c prettyprint-override"><code>d,i,w;char s[1&lt;&lt;24];m(){v(w,13);}p(){puts(s+1);}
v(i,j){s[w-i]=".|]\\#/"[j%7];s[w+i]=".|[/#\\"[j%7];
while(i--)s[w-i]=s[w+i]="# _-"[j/7];}
main(l){scanf("%d",&amp;l);d=l&gt;3?3:l;m(w=l*2+6);p(v(0,0));
for(v(0,1);i++&lt;=l;v(i*2+2,17))p(),v(i*2+3,7),m(p(v(i,2)));v(l+2,2);p(v(d,21));
for(m(i=w-3);i&gt;d+1;i-=3)v(i,15);p(v(d,8));p(v(d,15));
v(w-3,4);m(p(v(d,19)));p(v(d+1,15));p(v(d+2,19));}
</code></pre>

<p>Try <a href="http://ideone.com/sZ0W6q" rel="nofollow">me</a>.</p>

<h1>JavaScript, 365</h1>

<p>The above can be translated almost 1 to 1 into JavaScript:</p>

<pre class="lang-js prettyprint-override"><code>s=[];r="";i=0;m=()=&gt;v(w,13);p=()=&gt;r+=s.join('')+"\n";
v=(i,j)=&gt;{s[w-i]=".|]\\#/"[j%7];s[w+i]=".|[/#\\"[j%7];
while(i--)s[w-i]=s[w+i]="# _-"[j/7|0];};
f=l=&gt;{d=l&gt;3?3:l;m(w=l*2+6);p(v(0,0));
for(v(0,1);i++&lt;=l;v(i*2+2,17))p(),v(i*2+3,7),m(p(v(i,2)));v(l+2,2);p(v(d,21));
for(m(i=w-3);i&gt;d+1;i-=3)v(i,15);p(v(d,8));p(v(d,15));
v(w-3,4);m(p(v(d,19)));p(v(d+1,15));p(v(d+2,19));}
</code></pre>

<p>Use:</p>

<pre class="lang-js prettyprint-override"><code>f(2);console.log(r)
</code></pre>
</div>
<div id="pu6" class="pu"><h1>JavaScript (<em>ES6</em>), 440</h1>

<p><strong>Edit</strong> Fixed lintel bug </p>

<p>A function whith height as a parameter, output to console.</p>

<p>Using template string <em>a lot</em>, all newlines are significant and counted.</p>

<p>Run snippet to test in Firefox (with console output)
<div class="snippet" data-lang="js" data-hide="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>f=x=&gt;{R=(n,s=0)=&gt;' #_-'[s][Z='repeat'](n),M=c=&gt;R(2)+'|__'[Z](z+1).slice(0,z-1)+'_|'+R(y,c)+'|_'+'__|'[Z](z+1).slice(1-z)
for(z=x+x+(x&lt;2)+(x&lt;3),y=x&gt;2?5:x&gt;1?3:1,l=-1,o=`${t=R(x+x+5)}.
${t}|
`;l++&lt;x;)o+=`${t=R(x+x-l-l)}.${u=R(l+3)}]${R(l*2+1,1)}[${u}.
 ${t}\\${l-x?R(7+l*4,2):`${t=R(x+1,2)}]${u=R(x&lt;3||x-2,1)}.${R(y,3)}.${u}[${t}`}/
`;console.log(`${o+M(0)}
${M(2)}
${R(2)}${t=R(z,1)}/${u=R(y,2)}\\${t}
${R(1+z)}|__${u}|
${R(z)}/____${u}\\`)}

// TEST
f(1),f(2),f(3),f(4),f(5),f(6)</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>Output 1 to 6 in console</code></pre>
</div>
</div>
</p>

<p><strong>Ungolfed</strong> version for interactive test:</p>

<p><div class="snippet" data-lang="js" data-hide="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>// Not so golfed

f=x=&gt;{
  R=(n,s=0)=&gt;' #_-'[s].repeat(n); // base building blocks
  M=c=&gt;R(2)+'|__'.repeat(z+1).slice(0,z-1)+'_|'+R(y,c)+'|_'+'__|'.repeat(z+1).slice(1-z); // manage door level

  z=x+x+(x&lt;2)+(x&lt;3); // door and stairs surroundings
  y=x&gt;2?5:x&gt;1?3:1; // door and stairs width
  
  o = `${R(x+x+5)}.\n${R(x+x+5)}|\n`; // top 
  for(l=-1;l++&lt;x;)
    o += `${ // even row
      t=R(x+x-l-l) // left padding
    }.${
      u=R(l+3)
    }]${
      R(l*2+1,1)
    }[${
      u
    }.\n ${ // end even row, start odd row
      t // left padding
    }\\${
      l-x?R(7+l*4,2)
      :`${t=R(x+1,2)}]${u=R(x&lt;3||x-2,1)}.${R(y,3)}.${u}[${t}` // if last row before the door, insert lintel 
    }/\n`;
  
  o += `${
    M(0) // door level row 1
  }\n${
    M(2) // door level row 2
  }\n${
    R(2)}${t=R(z,1)}/${u=R(y,2)}\\${t  // stairs row 1
  }\n${ 
    R(1+z)}|__${u  // stairs row 2
  }|\n${ 
    R(z)}/____${u // stairs row 3
  }\\`;
  
  out(o)
}

out=x=&gt;O.innerHTML=x

f(3)</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;input id=I value=3&gt;&lt;button onclick='f(+I.value)'&gt;-&gt;&lt;/button&gt;&lt;br&gt;
&lt;pre id=O&gt;&lt;/pre&gt;</code></pre>
</div>
</div>
</p>
</div>
<div id="pu7" class="pu"><h1>Haskell, 473 bytes</h1>

<pre><code>g '\\'='/'
g '/'='\\'
g '['=']'
g ']'='['
g x=x
z=reverse
d=min 3
m n s=putStrLn$(6+2*n+1-length s)#' '++map g(z s)++tail s
n#c=replicate n c
t 0=".";t n=n#'#'++"["++(2+n)#' '++"."
r 0="|";r n=(2+2*n)#'_'++"/"
q n=d n#'-'++"."++max(n-2)1#'#'++"["++(n+1)#'_'++"/"
e i n=d n#i++"|_"++z(take(max(n+2)(2*n-1))(cycle"|__"))
b n=d n#'_'++"\\"++max(2*n)(3+n)#'#'
w i n=(d n+1+i)#'_'++["|","\\"]!!i
f n=mapM_(m n)$[u k|k&lt;-[0..n],u&lt;-[t,r]]++(t(n+1):map($n)[q,e ' ',e '_',b,w 0,w 1])
</code></pre>
</div>
<div id="pu8" class="pu"><h1>Python 2, <s>356</s> <s>352</s> <s>347</s> 344 bytes</h1>

<pre class="lang-py prettyprint-override"><code>n=input()
A,B,C,D,E,F,G,H,I='_ |\/#.]['
def p(*S):
 for s in S:print(5+2*n-len(s)/2)*B+s
p(G,C,'.   ]#[   .')
for i in range(n):b=B*(4+i);p(D+A*(7+4*i)+E,G+b+H+F*(3+2*i)+I+b+G)
d=2*min(3,n)-1
a=A*(2+i)
f=F*(1+i-d/2)
j=4+2*i-d/2
w=('|__'*n)[:j-1]+A+C
v=w[::-1]
p(D+a+H+f+G+'-'*d+G+f+I+a+E,w+B*d+v,w+A*d+v,F*j+E+A*d+D+F*j,C+A*(d+2)+C,E+A*(d+4)+D)
</code></pre>

<p>This basically builds the shrine line by line. The function <code>p</code> prints a string with the spaces needed to center it.</p>

<p>I used <em>python 2</em> to save lots of bytes, because the <em>python 3</em> map object doesn't trigger. I guess I should always golf in <em>python 2</em>, just saves a few more bytes (even if it's just to not have to parse the input to int).
Hehehe, it's not like code's pretty for golfing in the first place.</p>

<p>Edit: and of course, I now don't need the map anymore...</p>

<p>Here's the code in ungolfed form:</p>

<pre class="lang-py prettyprint-override"><code>n = int(input())

# A function to print strings centered
half_width = 5 + 2*n
def p(string):
    spaces = ' ' * (half_width - len(string) // 2)
    print(spaces + string)

# The rooftops
p('.')
p('|')
p('.   ]#[   .')
for i in range(n):
    p('\\' + '_'*(7 + 4*i) + '/')
    p('.{0}]{1}[{0}.'.format(' '*(i + 4), '#'*(3 + 2*i)))

# The bottom rooftop
door_width = 2 * min(3, n) - 1
# (11+4i - (3+2i) - 4) / 2 = (4 + 2i) / 2 = 2 + i
p('\{0}]{1}.{2}.{1}[{0}/'.format('_'*(2 + i), '#'*(1 + i - door_width // 2), '-'*door_width))

# The windows
w = '|__'*n
w = w[:4 + 2*i  - door_width // 2]
if w[-1] == '|':
    w = w[:-1] + '_'
w += '|'
p(w + ' '*door_width + w[::-1])
p(w + '_'*door_width + w[::-1])

# The foundation and the stairs
w = '#'*(4 + 2*i - door_width // 2)
p(w + '/' + '_'*(door_width) + '\\' + w)

# The remaining stairs
p('|' + '_'*(door_width + 2) + '|')
p('/' + '_'*(door_width + 4) + '\\')
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/50625/">50625</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




