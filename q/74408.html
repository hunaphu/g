<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::74408</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>285</td><td>Python3</td><td>240716T192106Z</td><td><a href="https://codegolf.stackexchange.com/questions/74408/find-the-haystack-in-the-needles/274202#274202">Ajax1234</a></td></tr>
<tr d-ix="1"><td>152</td><td>JavaScript ES6</td><td>160229T013242Z</td><td><a href="https://codegolf.stackexchange.com/questions/74408/find-the-haystack-in-the-needles/74427#74427">user8165</a></td></tr>
<tr d-ix="2"><td>207</td><td>Ruby</td><td>160228T223538Z</td><td><a href="https://codegolf.stackexchange.com/questions/74408/find-the-haystack-in-the-needles/74417#74417">afuous</a></td></tr>
</table>
<div id="pu0" class="pu"><h2>Python3, 285 bytes</h2>
<p>Similar to the other solutions, the code below builds haystacks by first anchoring the search on each needle present in the input.</p>
<pre class="lang-py prettyprint-override"><code>E=enumerate
def G(x,y,d):
 q,s=[(x,y)],[(x,y)]
 for x,y in q:
  t=[u for X,Y in[(1,0),(-1,0),(0,1),(0,-1)]if d.get(u:=(x+X,y+Y))and u not in s and'#'==d[u]]
  q+=t;s+=t
 return s
def f(b):
 d={(x,y):v for x,r in E(b)for y,v in E(r)}
 return max([G(*i,d)for i in d if'N'==d[i]],key=len)
</code></pre>
<p><a href="https://tio.run/##hVLBjtsgED2XrxiFA5CQKN5kpSoVx9XeOO/KtVa2jLtsE@wAXsWq@u0pYCdbbSvlYGDevJl58NwN/rU1m6@dPZ8fhDL9QdnSK1SrBh7piQ@8ZjsER@5EHkNW8GlH0LQWwhG0gWPggBd5n8An/hzAnGZ8zThdjtuaZ2ldZqzQDdSrH8rTfifoafHEh8UzY6WpoQfT@tjRQQgJJkLUeV@EaXBcCP/NhQWBVb63gZNkNrSKEmvxKwnbvU/CbGzzEJIxHPj7GFr2@1p/KE80f6RzHS4ZSTpSatANkWmuLgr@Uw1irww7uwwEzGYzJDFGUmKEpQwfRhFzd1MSxySWgSDTOWLIbT5KcSpK5XEdkZG1vbLkBwvHcReuvHLvL1wZZUiZ5skoa0RiLj6Ob1@qtrQ1deGNvkz3zvO5LuB640bvvbJUtkZxcCvX7bWn5LshLLicutQ6gOXw4tp973VrUjeogoa/@qPgmUhuoM8OxL/jkwsRCi@dLLtYvqvyU5EPhSBAEHRWm1HH6q3Vhh7KjpLxzCvGWJD2j6yMoalsSebbNfsP5e42ZXObsr1NuWfnPw" rel="nofollow noreferrer">Try it online!</a></p>
<h2>Python3, 559 bytes</h2>
<p>Out of academic curiosity, the solution below finds all possible haystacks with a needle, and then selects the largest. This approach is exactly the opposite of the code above and the other answers.</p>
<pre class="lang-py prettyprint-override"><code>E=enumerate
def f(b):
 d,P={(x,y):v for x,r in E(b)for y,v in E(r)},[]
 q=[([t:=[i for i in d if'#'==d[i]][0]],[t],[],0)]
 for s,S,g,c in q:
  if[]==s:
   if[]==(k:=[i for i in d if i not in[J for K in g+[S]for J in K]and'#'==d[i]]):P+=g+[S]
   if k:q+=[(k[:1],k[:1],g+[S],0)]
   continue
  (x,y),*s=s
  L=[[],[]]
  for X,Y in[(1,0),(-1,0),(0,1),(0,-1)]:
   if d.get(u:=(x+X,y+Y))and u not in S:L[d[u]=='#']+=[u]
  for i in L[0]*(0==c):q+=[(s+L[1]+[i],S+L[1]+[i],g,1)]
  q+=[(s+L[1],S+L[1],g,c)]
 return max([i for i in P if any(d[j]=='N'for j in i)],key=len)
</code></pre>
<p><a href="https://tio.run/##hVNNb@IwED1vfoVFDrGJi0hLpVUkH3tpkYXEpZVrVYEE1nw4NE4qotX@dnbGCQVtV@ohZmbeG8@bYXxo61@lvft5qE6nB1HYZl9UWV0EebEiK7pgaUByPhO/6ZG3LP0gq7IiR14RY8kDwOi2/KNzK/aHKx2Qd6GoqlOhjKcbRHNiVlEYCZEro7Uaa81VDZ/mYwYpyHN8ztd8iex3KAsJSgvh0Oxtuv16KVi2rMFTjx54QmAdq7lG7xG9J53Z/FKcpbNYeEZ3M9mm7zFI3qo00bw7PdxJI2RZ2trYpgDbj4EPnXDgTIVS2AKSsNgzf0EdNIFETm@6nzFP/HmTMN23QvLRuqhpkwp6jJ95G78wBgpJ03dC5ulU5aqBjkG1Bm3NuYRvewrjG9KxEEvWKXfxVCU6hub4/GKuoTLmXVF6GMeMUFXUTWXJPjvS67HOUGNmW5qrDWqQEUIbhAyDCRWt2BWWnVxCBBkMBoEMw0DKMAilhC8MMOZuezBEMJRAkN7GWODuLqmhT/LpeHaRjjX5ZMkLK8RyZ6785N6fuRJlSOnrSZTVRRDDra7Lt0WZVTl1sNw/@hEoNTT6MoGV2dVFRWVpC07cyB12pqbRq40YjM3fkhsIZu2bK3dNbUrrbyML0HB1f0AcBPAZBf8@nLT/Q68eT78dfsX6RXDpQh21arWISBSQQ2Vsp2O0KY2l@@xAo87mC8YYSPsiK2FBn3YTDSdj9h/K7feUu@8pk@8p9@z0Fw" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1>JavaScript (ES6), 152 bytes</h1>

<pre class="lang-js prettyprint-override"><code>s=&gt;[...s].map((n,i)=&gt;n&gt;'M'&amp;&amp;(a=[...s],a[i]=r=1,a.map(_=&gt;a.map((c,j)=&gt;c=='#'&amp;&amp;a[j+1]|a[j-1]|a[j+l]|a[j-l]?a[j]=++r:0)),o=r&gt;o?r:o),o=0,l=~s.search`
`)|o-1
</code></pre>

<h2>Explanation</h2>

<p>For each needle in the input, sets the needle to a part of the haystack (represented by setting it to a non-zero number) and continuously checks hay cells. If hay contains an adjacent part of the hay stack, also sets it part of the haystack and increments the size of the hay stack. Outputs the highest result.</p>

<p><div class="snippet" data-lang="js" data-hide="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>var solution =

s=&gt;
  [...s].map((n,i)=&gt;n&gt;'M'&amp;&amp;(          // for each needle in s at index i
      a=[...s],                       // a = array of each character in s
      a[i]=1,                         // set the starting needle to 1 (haystack)
      r=0,                            // r = haystack size starting from this needle
      a.map(_=&gt;                       // loop to ensure the complete haystack is found
        a.map((c,j)=&gt;                 // for each cell c at index j
          c=='#'&amp;&amp;                    // if the current cell is hay
          a[j+1]|a[j-1]|a[j+l]|a[j-l] // and any adjacent cells are part of the haystack
          ?a[j]=++r:0                 // add the current cell to the haystack, increment r
        )
      ),
      o=r&gt;o?r:o                       // o = max of o and r
    ),
    o=0,                              // o = final output, initialise to 0
    l=~s.search`
`                                     // l = line length of s
  )
  |o                                  // return o</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;textarea id="input" rows="6" cols="40"&gt;N#N#N
#N#N#
##N##
#N#N#
N#N#N&lt;/textarea&gt;&lt;br /&gt;
&lt;button onclick="result.textContent=solution(input.value)"&gt;Go&lt;/button&gt;
&lt;pre id="result"&gt;&lt;/pre&gt;</code></pre>
</div>
</div>
</p>
</div>
<div id="pu2" class="pu"><h2>Ruby, 207</h2>
<pre><code>-&gt;a{d=-&gt;b{0...b.size}
f=c=s=-&gt;y,x{(d[a]===y&amp;&amp;d[a[0]]===x&amp;&amp;!f[y][x]&amp;&amp;a[y][x]==c)?(c,f[y][x]=?#,1
1+s[y,x-1]+s[y,x+1]+s[y-1,x]+s[y+1,x]):0}
d[a].map{|y|d[y].map{|x|f,c=a.map{|b|b.map{p}},?N
s[y,x]}.max}.max-1}
</code></pre>
<p>This is an anonymous function that takes in the input as an array of arrays. Usage:</p>
<pre><code>f=-&gt;a{......}

f[&quot;
N##
NN#
#NN
#N#
&quot;.strip.split.map(&amp;:chars)] # =&gt; 4
</code></pre>
<p>The proc named <code>s</code> recursively finds the size of the haystack with needle at specific coordinates and is called on each needle in the haystack.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/74408/">74408</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




