<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::39951</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>2018</td><td>05AB1E</td><td>190121T110435Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/178959#178959">Kevin Cr</a></td></tr>
<tr d-ix="1"><td>033</td><td>K ngn/k</td><td>210101T210707Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/217144#217144">coltim</a></td></tr>
<tr d-ix="2"><td>027</td><td>Husk</td><td>201005T135202Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/212071#212071">Razetime</a></td></tr>
<tr d-ix="3"><td>030</td><td>Pyth</td><td>190121T143612Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/178963#178963">Sok</a></td></tr>
<tr d-ix="4"><td>035</td><td>APL</td><td>141021T093217Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/40086#40086">TwiN</a></td></tr>
<tr d-ix="5"><td>031</td><td>CJam</td><td>141017T153634Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/39977#39977">Optimize</a></td></tr>
<tr d-ix="6"><td>032</td><td>APL</td><td>141021T091411Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/40084#40084">Moris Zu</a></td></tr>
<tr d-ix="7"><td>186</td><td>LUA 186 Chars</td><td>141021T080358Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/40082#40082">jawo</a></td></tr>
<tr d-ix="8"><td>194</td><td>JavaScript</td><td>141018T142449Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/40000#40000">edc65</a></td></tr>
<tr d-ix="9"><td>nan</td><td></td><td>141018T153105Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/40003#40003">Cristian</a></td></tr>
<tr d-ix="10"><td>125</td><td>Mathematica</td><td>141017T163140Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/39978#39978">DavidC</a></td></tr>
<tr d-ix="11"><td>132</td><td>Python 2</td><td>141017T052057Z</td><td><a href="https://codegolf.stackexchange.com/questions/39951/verify-magic-square/39953#39953">xnor</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, <s>24</s> <s>21</s> 20 (or 18) <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<p>If the size of the input-list can be irregular:</p>
<pre><code>ôDøí‚D€Å\‚O˜Ë²{¹nLQ*
</code></pre>
<p>Inputs in the order: <span class="math-container">\$n,list\$</span>, on separated STDIN lines. Outputs <code>1</code>/<code>0</code> for truthy/falsey respectively.</p>
<p><a href="https://tio.run/##yy9OTMpM/f//8BaXwzsOr33UMMvlUdOaw60xQJb/6TmHuw9tqj60M88nUOv/fxOuaCMdQzMdQ2MdYx1DQx1THQsdQwMdcx1LHUMjHaC4iY6JjqGOoWksAA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##fZCxTsNADIb3e4qqI/IQ23eXZOpSISEhIYaiViVDEQwsZejIgpBgYUGMVR@hbAzsN/Yt8iLpb5cZRUpi@/f/f3dPm9Xd48PQnl@Uz5vJeLRa34/GExQzFP37F4rNUH6m5bd89y/baf@6L2@3@Ls67MrH/Hmxvrw@G2jgsOQuaFhGaklIKVFNDTFl7wqqjElCJ2LadCFalzOxombGCPIKupZYIOYIJROnLmSYKwnkDUltYqlI3clMxRKxI2xLouYqibRyDAVNhC3XJNkSGAGJJCJP8XVIUnUidvaItez8rS@wuYMA7tjk/Cf99zlpTm@xZONSZ0x@jsqIwCJ@C8Axd@Sn7gg" rel="nofollow noreferrer">verify some more test cases</a>.</p>
<p>If the size of the input-list is guaranteed to be of length <span class="math-container">\$n^2\$</span>:</p>
<pre><code>ôDøí‚D€Å\‚O˜Ë²{āQ*
</code></pre>
<p>Same I/O.</p>
<p><a href="https://tio.run/##yy9OTMpM/f//8BaXwzsOr33UMMvlUdOaw60xQJb/6TmHuw9tqj7SGKj1/78JV7SRjqGZjqGxjrGOoaGOqY6FjqGBjrmOpY6hkQ5Q3ETHRMdQx9A0FgA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##fY@hTgRBEET9fsXlJCmx3T0zu6fOXEhQBAEhOVYcAYEBcRIDJGAwBEn4BHAI/OD4i/2RpbpBkxEz3V1d9eZquzm9OJ/63b36dLSczzaXZ7P5ksUhi/HhmcV2qh@r@lnfx5uX1Xj3Vu9P@Nr/fq2Px9dftwc7EyZp1jI01qwTFlAYMjr0EJToKqvCSWYncdoPTfKuFIixFuGI8pa6BUQplkSlQPLQFJoblPIe2rlYW1g4ual6IndUfEnNXTXD2sAw0iTaSgctniAMyNDEPOMdkDALIgn2xLUS/ItYEHcnAd25KeVP@u/51ahnOpEFXY4ftM5CCo3/E8R9mZyHHw" rel="nofollow noreferrer">verify some more test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-none prettyprint-override"><code>ô      # Split the 2nd (implicit) input into parts of a size of the 1st
       # (implicit) input
       #  i.e. [2,16,13,3,11,5,8,10,7,9,12,6,14,4,1,15] and 4
       #   → [[2,16,13,3],[11,5,8,10],[7,9,12,6],[14,4,1,15]]
 D     # Duplicate this matrix
  øí   # Rotate the copy once clockwise:
  ø    #  Zip/transpose; swapping rows/columns
       #   → [[2,11,7,14],[16,5,9,4],[13,8,12,1],[3,10,6,15]]
   í   #  Reverse each inner row
       #   → [[14,7,11,2],[4,9,5,16],[1,12,8,13],[15,6,10,3]]
    ‚  # Pair the two matrices together
       #  → [[[2,16,13,3],[11,5,8,10],[7,9,12,6],[14,4,1,15]],
       #     [[14,7,11,2],[4,9,5,16],[1,12,8,13],[15,6,10,3]]]
 D     # Duplicate the pair of matrices
  €    # Map over both matrices in the duplicated pair:
   Å\  #  Get the top-left to bottom-right main diagonal of it
       #   → [[2,5,12,15],[14,9,8,3]]
     ‚ # Pair the two together
       #  → [[[[2,16,13,3],[11,5,8,10],[7,9,12,6],[14,4,1,15]],
       #     [[14,7,11,2],[4,9,5,16],[1,12,8,13],[15,6,10,3]]],
       #     [[2,5,12,15],[14,9,8,3]]]
O      # Take the sum of each inner-most list:
       #  → [[[34,34,34,34],[34,34,34,34]],[34,34]]
 ˜     # Flatten this list
       #  → [34,34,34,34,34,34,34,34,34,34]
  Ë    # Check if all values are equal to each other
       #  → 1 (truthy)
²      # Push the second input again
 {     # Sort it
       #  → [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]
  ¹n   # Push the first input again, and take its square
       #  → 16
    L  # Create a list in the range [1, squared_input]
       #  → [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]
     Q # Check if the two lists are equal
       #  → 1 (truthy)
*      # Check if both checks are truthy by multiplying them with each other
       #  → 1 (truthy)
       # (after which the result is output implicitly)

  ā    # Push a list in the range [1,length] (without popping the list)
       #  → [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]
       # (the rest is the same)
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://bitbucket.org/ngn/k" rel="nofollow noreferrer">K (ngn/k)</a>, <s>36</s> 33 bytes</h1>
<p>-3 bytes from improvements by @ngn</p>
<pre><code>{1=#?{+/x,'x@'!#x}'(|+:)\(x,x)#y}
</code></pre>
<p><a href="https://tio.run/##HcrLDoIwEAXQX7mki86k@Li0CIUY/RDXuDBhXYJ8e524PTmf0/pea12mnXf32CVcSuvL0zeu6OHlGyZ9SWmLuu2oC85eJM0deAMjIkj0GMErBmSwg3lCAsFeZ4lWB7Nsi8YR418Zmqxafw" rel="nofollow noreferrer" title="K (ngn/k) – Try It Online">Try it online!</a></p>
<p>May be non-qualifying, as this is a function taking two args; the length of the square, and a list of the square's values.</p>
<ul>
<li><code>(x,x)#y</code> build <code>x</code>-by-<code>x</code> matrix of the values from <code>y</code></li>
<li><code>(|+:)\</code> build list of all rotations of the matrix</li>
<li><code>{...}'</code> inner lambda, called on each rotation
<ul>
<li><code>x@'!#x</code> get the main diagonal elements</li>
<li><code>x,'x</code> zip them with the original values</li>
<li><code>+/</code> take the column-wise sum (the last column being the main diagonal)</li>
</ul>
</li>
<li><code>1=#?</code> is there only one distinct sum?</li>
</ul>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/barbuz/Husk" rel="nofollow noreferrer">Husk</a>, 27 bytes</h1>
<pre><code>&amp;=O¹ḣ□³Λ=mΣ+mo►L∂Se↔C³¹S+TC
</code></pre>
<p><a href="https://tio.run/##yygtzv7/X83W/9DOhzsWP5q28NDmc7Ntc88t1s7NfzRtl8@jjqbg1EdtU5wPbT60M1g7xPn///8m/6ONdAzNdAyNdYx1DA11THUsdAwNdMx1LHUMjXSA4iY6JjqGQBWxAA" rel="nofollow noreferrer" title="Husk – Try It Online">Try it online!</a></p>
<p>I don't know any other techniques to golf this further, but it would be really cool if I could get it any lower.</p>
<p>Explanation coming later.</p>
<p>Takes inputs as 2 command line args, since Husk does not have the feature of taking from STDIN.</p>
</div>
<div id="pu3" class="pu"><h1>Pyth, <s>24</s> 30 bytes</h1>
<pre><code>&amp;q1l{sM++JcEQCJm.e@bkd_BJqSlQS
</code></pre>
<p>Try it online <a href="https://pyth.herokuapp.com/?code=%26q1l%7BsM%2B%2BJcEQCJm.e%40bkd_BJqSlQS&amp;input=%5B2%2C7%2C6%2C9%2C5%2C1%2C4%2C3%2C8%5D%0A3&amp;debug=0" rel="nofollow noreferrer">here</a>.</p>
<pre><code>&amp;q1l{sM++JcEQCJm.e@bkd_BJqSlQSQ   Implicit: Q = evaluated 1st input (contents), E = evaluated 2nd input (side length)
                                  Trailing Q inferred
          cEQ                     Chop E into pieces or length Q
         J                        Store in J
                      _BJ         Pair J with itself with rows reversed
               m                  Map the original and it's reverse, as d, using:
                .e   d              Map each row in d, as b with index k, using:
                  @bk                 Get the kth element of b
                                  The result of this map is [[main diagonal], [antidiagonal]]
        +J                        Prepend rows from J
       +     CJ                   Prepend columns from J (transposed J)
     sM                           Sum each
    {                             Deduplicate
   l                              Length
 q1                               Is the above equal to 1?
&amp;                                 Logic AND the above with...
                          SlQ     ... is the range [1-length(Q)]...
                         q        ... equal to...
                             SQ   ... sorted(Q)
</code></pre>
<p><em>Edit: fixed a bug, thanks to @KevinCruijssen for letting me know :o)</em></p>
</div>
<div id="pu4" class="pu"><h2>APL, 35</h2>

<pre><code>∧/2=/(+⌿x,⍉x),+/↑1 1∘⍉¨x(⌽x←⎕⍴⍨,⍨⎕)
</code></pre>

<p><strong>Explanation</strong><br>
<code>x←⎕⍴⍨,⍨⎕</code> prompts for input, shape it into a matrix, and assign to <code>x</code><br>
<code>⌽</code> Reverses the matrix left-to-right<br>
<code>x(...)</code> Create a array of matrices: <code>x</code> and <code>x</code> reverse<br>
<code>1 1∘⍉¨</code> For each of those matrices, take the diagonal<br>
<code>+/↑</code> form a 2×n matrix of the numbers on those diagonals and sum the rows</p>

<p><code>⍉x</code> Transpose <code>x</code><br>
<code>x,</code> then concatenate with <code>x</code> to form a n×2n matrix<br>
<code>+⌿</code> and sum the columns</p>

<p><code>(+⌿x,⍉x),+/↑1 1∘⍉¨x(⌽x←⎕⍴⍨,⍨⎕)</code> concatenate to form an array of the sums<br>
<code>2=/</code> check if consecutive pairs equal<br>
<code>∧/</code> and AND together all those results</p>
</div>
<div id="pu5" class="pu"><h2>CJam, <s>47 39 35 33</s> 31 bytes</h2>

<pre><code>l~/{_1fb_,Y${\(_@=\}%:++\z}2*;=
</code></pre>

<p>Takes input like </p>

<pre><code>4 [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16]
</code></pre>

<p>Outputs <code>1</code> if magic square, <code>0</code> otherwise.</p>

<p><strong>How it works</strong>:</p>

<pre><code>l~/                               "Evaluates the input and split the array into chunks"
                                  "of size N where N is the first integer";
   {                      }2*     "Run this code block 2 times";
    _1fb                          "Copy the 2D array and calculate sum of each row of copy";
        _,                        "Copy the array containing sum of each row and get"
                                  "its length. This is equal to N";
          Y${      }%             "Run this code block for each array of the original"
                                  "2D array that we copied from stack";
             \(_                  "Put the length number to top of stack, decrement and"
                                  "copy that";
                @=\               "Take the element at that index from each row and put"
                                  "N back behind at second position in stack";
                     :+           "Take sum of elements of the array. This is sum of"
                                  "one of the diagonals of the 2D array";
                       +          "Push diagonal sum to row sum array";
                        \z        "Bring original array to top and transpose columns";
                             ;    "At this point, the stack contain 3 arrays:"
                                  "  Array with sum of rows and main diagonal,"
                                  "  Array with sum of columns and secondary diagonal and"
                                  "  The original array. Pop the original array";
                              =   "Check if sum of rows + main diagonal array is equal to ";
                                  "sum of columns + secondary diagonal array";
</code></pre>

<p>This can be golfed further.</p>

<p><a href="http://cjam.aditsu.net/" rel="nofollow">Try it online here</a></p>
</div>
<div id="pu6" class="pu"><p><strong>APL <s>47</s> 32</strong></p>

<p>Using TwiNight's excellent solution and applying some more tweaking:</p>

<pre><code>∧/2=/+⌿(1 1∘⍉∘⌽,1 1∘⍉,⍉,⊢)⎕⍴⍨,⍨⎕
</code></pre>

<p><strong>Explanation:</strong></p>

<p>This uses function trains, which were introduced in v14 of the Dyalog interpreter.
APL is executed from right to left, ⎕'s are inputs, so first the dimensions, then the vector of numbers.</p>

<p>⎕⍴⍨,⍨⎕ creates the matrix NxN </p>

<p>After that comes the function train which are basically just a sequence of functions (between brackets) applied to the right argument.
The functions are:</p>

<p>⊢ Returns just right argument (that is the matrix)</p>

<p>⍉ Transposes the right argument matrix</p>

<p>1 1∘⍉ Returns the diagonal </p>

<p>1 1∘⍉∘⌽ Returns the diagonal of the reversed (horizontally) matrix </p>

<p>All the results are concatenated with the function ","</p>

<p>At this point, the result is a matrix whose columns are then summed (+⌿). The values obtained this way are then checked to be the same with ∧/2=/</p>

<p>I'll leave my old solution here too:</p>

<pre><code>{M←⍺ ⍺⍴⍵⋄d←M=⍉M⋄(⊃≡∪)((+/,+⌿)M),+/∘,¨d(⌽d)×¨⊂M}
</code></pre>

<p>takes dimension as left argument, vector of elements as right argument, for example:</p>

<pre><code>4{M←⍺ ⍺⍴⍵⋄d←M=⍉M⋄(⊃≡∪)((+/,+⌿)M),+/∘,¨d(⌽d)×¨⊂M}16 3 2 13 5 10 11 8 9 6 7 12 4 15 14 1
1
</code></pre>

<p>Can be tried online here: <a href="http://www.tryapl.org" rel="nofollow">www.tryapl.org</a></p>
</div>
<div id="pu7" class="pu"><p><strong>LUA 186 Chars</strong></p>

<pre><code>s=io.read(1)v=io.read(2)d=0 r=0 for i=1,#s do t=0 for j = 1, #s do t=t+s[i][j]end d=d+s[i][i] r=r+s[i][#s-i+1]if t ~= v then o=true end end if d~=v and r~= v then o=true end print(not o)
</code></pre>
</div>
<div id="pu8" class="pu"><h1>JavaScript (E6) 194</h1>
<p>Using prompt to read input and display output.<br />
Test in console with FireFox &gt;31 (Array.fill is very new)</p>

<pre class="lang-javascript prettyprint-override"><code>z=(p=prompt)(n=p()|0).split(' '),u=Array(2*n).fill(e=d=n*(n*n+1)/2),z.map((v,i)=&gt;(r=i/n|0,u[r+n]-=v,u[c=i%n]-=v,d-=v*(r==c),e-=v*(r+c+1==n))),o=!(e|d|u.some(v=&gt;v)),z.sort((a,b)=&gt;a-b||(o=0)),p(o)
</code></pre>
<p><strong>Less golfed</strong></p>
<pre class="lang-javascript prettyprint-override"><code>n = prompt()|0; // input side length
z = prompt().split(' '); // input list of space separeted numbers  
e = d = n*(n*n+1)/2; // Calc sum for each row, column and diagonal
u = Array(2*n).fill(e), // Init check values for n rows and n columns

z.map( (v,i) =&gt; { // loop on number array 
  r = i / n | 0; // row number
  c = i % n; // column number
  u[r+n] -= v; // subtract current value, if correct it will be 0 at loop end
  u[c] -= v; 
  if (r==c) d -= v; // subtract if diagonal \
  if (r+c+1==n) e -=v; // subtract if diagonal /
}),
o=!(e|d|u.some(v=&gt;v)); // true if values for rows, cols and diags are 0
z.sort((a,b)=&gt;a-b||(o=0)); // use sort to verify if there are repeated values in input
alert(o);
</code></pre>
</div>
<div id="pu9" class="pu"><h2>GolfScript 67 (<a href="http://golfscript.apphb.com/?c=Oyc0IDE2IDMgMiAxMyA1IDEwIDExIDggOSA2IDcgMTIgNCAxNSAxNCAxJwoKfl06cSgvcSgvemlwK1txKCkveyhcO30lXStbcSgoLyk7KDt7KFw7fSVdK3t7K30qfSUuJiwyPHEoMj8seyl9JS0hKg%3D%3D&amp;run=true" rel="nofollow">demo</a>)</h2>

<pre><code>~]:q(/q(/zip+[q()/{(\;}%]+[q((/);(;{(\;}%]+{{+}*}%.&amp;,2&lt;q(2?,{)}%-!*
</code></pre>
</div>
<div id="pu10" class="pu"><h1>Mathematica <s>128</s>  125</h1>
<pre><code>d = Diagonal; r = Reverse; i = Input[];
Length@Union[Tr /@ Join[p = Partition[i[[2]], i[[1]]], 
t = Transpose@p, {d@p}, {d@t}, {d@r@p}, {d@r@t}]] == 1
</code></pre>
<p>Takes input such as</p>
<pre><code>{4,{16, 3, 2, 13, 5, 10, 11, 8, 9, 6, 7, 12, 4, 15, 14, 1}}
</code></pre>
<blockquote>
<p>True</p>
</blockquote>
</div>
<div id="pu11" class="pu"><h2>Python 2: 132 chars</h2>

<pre class="lang-python prettyprint-override"><code>n,l=input()
r=range
print r(1,n*n+1)==sorted(l)*len({sum(l[i::j][:n])for(i,j)in zip(r(n)+r(0,n*n,n)+[0,n-1],[n]*n+[1]*n+[n+1,n-1])})
</code></pre>

<p>An example run:</p>

<pre><code>STDIN: 4,[16,3,2,13,5,10,11,8,9,6,7,12,4,15,14,1]
Output: True
</code></pre>

<p>The are two things to check:</p>

<ol>
<li>The sums are the rows, columns, and diagonals are all equal</li>
<li>The elements are a permutation of <code>[1,2,...,n*n].</code></li>
</ol>

<p>The first is checked by taking sums of slices corresponding to these subsets. Each row, column, or diagonal is described by its starting value and its displacement. We take the list corresponding slice, truncate to <code>n</code> elements, and sum it. In Python's <code>[start:end:step]</code> notation, rows are <code>[r*n::1]</code>, columns are <code>[c::n]</code> and the two diagonals are <code>[0::n+1]</code> and <code>[n-1::n-1]</code>. These are stored as a list of <code>2*n+2</code> pairs produced by <code>zip</code>.</p>

<p>We take the sets of sums and check that it has length 1. Also, we sort the input and check that it is the list <code>[1,2,...,n*n].</code> Actually, we combine both into one check by multiplying <code>sorted(l)</code> by the length of the sum-sets, a check that always fails unless the sum-set has length 1.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/39951/">39951</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




