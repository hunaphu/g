<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::181699</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>400</td><td>Python3</td><td>250928T205431Z</td><td><a href="https://codegolf.stackexchange.com/questions/181699/gotta-collect-em-all/283914#283914">Ajax1234</a></td></tr>
<tr d-ix="1"><td>nan</td><td>PHP</td><td>190319T172519Z</td><td><a href="https://codegolf.stackexchange.com/questions/181699/gotta-collect-em-all/181830#181830">640KB</a></td></tr>
<tr d-ix="2"><td>132</td><td>APL Dyalog Extended</td><td>190320T195753Z</td><td><a href="https://codegolf.stackexchange.com/questions/181699/gotta-collect-em-all/181917#181917">voidhawk</a></td></tr>
<tr d-ix="3"><td>622</td><td>Python 3</td><td>190320T135432Z</td><td><a href="https://codegolf.stackexchange.com/questions/181699/gotta-collect-em-all/181887#181887">ABridgeT</a></td></tr>
<tr d-ix="4"><td>173</td><td>JavaScript ES6</td><td>190318T134303Z</td><td><a href="https://codegolf.stackexchange.com/questions/181699/gotta-collect-em-all/181702#181702">Arnauld</a></td></tr>
<tr d-ix="5"><td>233</td><td>Python 2</td><td>190318T184916Z</td><td><a href="https://codegolf.stackexchange.com/questions/181699/gotta-collect-em-all/181728#181728">Erik the</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 400 bytes</h1>
<pre class="lang-py prettyprint-override"><code>E=enumerate
def L(x,y,d):
 q=[(x,y,[(x,y)])]
 for x,y,p in q:
  if(x,y)in d and'T'==d[(x,y)]:del d[(x,y)];return p
  q+=[(*t,p+[t])for X,Y in[(1,0),(-1,0),(0,-1),(0,1)]if(V:=d.get(t:=(x+X,y+Y)))and V!='M'and t not in p]
def f(b):
 d,r={(x,y):v for x,r in E(b)for y,v in E(r)},[]
 x,y=[j for j in d if'P'==d[j]][0]
 while any(j not in r for j in d if'T'==d[j])and(V:=L(x,y,d)):r+=V;x,y=V[-1]
 return r
</code></pre>
<p><a href="https://tio.run/##7Vbfb5swEH4ef8Ut0oQ9nCokbTVR@bFvo8oDiloxNFHZtI4yIMb9gZb97Zntkm2qyETCEu2hOglz5/t8933YwmWt7ot88qmU6/Ul5fnDNy5TxR3GM/iMnklNGA4cWNLYOvaJE5w4kBUSTKgEkcNS54DI7Kx2GaQ5cyOXUtYgAsYXsHEuJFcPModSg5aeXvqjIqUXqwSbRa/JjV4yRj4ZYYKGL8OIDH07@DjRdWYBZSd3XCEVUPTsXZPau8EY66owe0/d0DVvCvJCme7KxPLJ0K3hwoik320jwWPDQpqsSz1t3Jo8vrgS/yCxZqpTaTy3qXOw7ETmTi25eZLEI53ydC8WXJOu0XxTVL4CRA3ANGn636iLA@nR2YUpMouHvl6sUUeuTdOq@HpbpJKhSvf@rpmK05OqXAiF3JWLYz/QMFtNkNTU@/UZUSYWikt0VeScQLUBfcldLZbIQHwYJ45T@UBhMBg43nCrOavpCrbY33HQAxftiQutRT37jA7Jz@hdjXcTPtyTULin8Lvhwj/sWBtkX@En3YXvQyh8JUqXndtnx///wp92ET7cam@4Npt2EP6si/DRVjs8bnrkekfAWeHP@/xcox2PYted9K@Oft96B@Jn9C6lyBXK0O8LlK8vPS3hcXt40h4@bQ@ftYfPdXj9Ew" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://php.net/" rel="nofollow noreferrer">PHP</a>, <del>385</del> <del>335</del> <del>307</del> <del>270</del> 256 bytes</h1>



<pre class="lang-php prettyprint-override"><code>function c(&amp;$m,$x,$r=-1,$d=0){if($r&lt;0)$r=array_search(P,$m);$m[$r]=V;if(!in_array(T,$m))die;foreach([$r%$x?$r-1:-1,$m[$r-$x]?$r-$x:-1,$m[$r+$x]?$r+$x:-1,$r%$x&lt;$x-1?$r+1:-1]as$o=&gt;$n)if($n&gt;=0&amp;$m[$n]!=M&amp;$m[$n]!=V){echo LUDR[$o];c($m,$x,$n,$o);}echo RDUL[$d];}
</code></pre>

<p><a href="https://tio.run/##rZBBa8IwFMfP66eI8DYTTLFlt8UobB4VRKqXEiTEuPbQpLw66BA/e9c4kV23eXgk/N7/F95LXdTdZFYXNbGIHndoa4/H0r3ThInu8OHMsfSOGPoEFYeWA8o45bCXCTuVBwo4SVjPNKL@3DVWoynoikPFBFQ5oJJb0ccGpdtdIjQLPbYvrTh4tLpP96lHaGeAcfoSng5aDK2aXY4bGn2j0RUFZwJtnAYWRKUb8HIKjoWx3FQmT8FzaiCXt9uWnawpPFls5uscvBKGXtdyHDwT50t3Pd8sctgrce6i8Zi86qY05E03NoIqJZLk0cNwNeRD8rvqLfIvK/uTtfxR2V0mzO6ylxKRoaT/UU7SZ8JE1H0B" rel="nofollow noreferrer" title="PHP – Try It Online">Try it online!</a></p>

<p>Uses a recursive depth-first search to crawl the map until all treasures are found.</p>

<p>Input is a one-dimensional array map and number of columns, example: <code>c( $map, 13 );</code>.
<br>Output is to <code>STDOUT</code> as <code>L,R,U and D</code>.</p>

<p>Or <strong>242 bytes</strong> to <a href="https://tio.run/##rZBBa4MwFMfP81Ok8FYTGqmy22IqbOdCD9JLEQkxTg8m8uzAUfrZnelK2XVrD4@EX/6/x3vpm35Ks77piUF0WKLpHR5b@0FjJqb60@pj6yzRdAkdh5EDyijhUMmYndqaAqYxm5lCVF/lYBTqhu44dExAdwAs5F7MsUVry0uE5v6NVa0RtUOj5vSceoYxA4ySV9/aaxGMRXY5bmj1g1ZX5J0UxijxzIuFGsDJDVjmx7IbGS@9Z4uF3N5ue3YyunHghKbXfSwHx8T5gitxnoL1mrypodXkXQ0mgC4hkhyCp3AX8pD8rWaL3GXl/7K2vyp/yIT5Q/YqRKApmX@Uk@SFMBFM3w" rel="nofollow noreferrer">output as numbers</a> (but I prefer the letters).</p>

<p><strong>Ungolfed</strong></p>

<pre class="lang-php prettyprint-override"><code>function c( &amp;$m, $x, $r=-1, $d=0 ) {

    // locate starting room ($r) on first move
    if( $r &lt; 0 )                        
        $r = array_search( 'P', $m );

    // mark square on map ($m) with V to show it has been visited
    $m[ $r ] = 'V';

    // end if no more treasures
    if ( ! in_array( 'T', $m ) )
        exit;

    // generate list of adjacent squares
    $dirs = [
        $r % $x ? $r - 1 : -1,            // Left
        $m[ $r - $x ] ? $r - $x : -1,     // Up
        $m[ $r + $x ] ? $r + $x : -1,     // Down
        $r % $x &lt; $x - 1 ? $r + 1 : -1    // Right
    ];

    // consider valid directions for next move
    foreach ( $dirs as $o =&gt; $n )
        // if not a Wall or Mountain and not Visited
        if ( $n &gt;= 0 and $m[ $n ] != 'M' and $m[ $n ] != 'V' ) {
            // display the direction
            echo 'LUDR'[ $o ];
            // and recursively keep crawling
            c( $m, $x, $n, $o );
        }

    // reached a dead end, go back to previous square
    echo 'RDUL'[ $d ];   // display the reverse direction

}
</code></pre>

<p><a href="https://tio.run/##rZBBa8IwFMfP66eI8DYTTLFlt8UobB4VRKqXEiTEuPbQpLw66BA/e9c4kV23eXgk/N7/F95LXdTdZFYXNbGIHndoa4/H0r3ThInu8OHMsfSOGPoEFYeWA8o45bCXCTuVBwo4SVjPNKL@3DVWoynoikPFBFQ5oJJb0ccGpdtdIjQLPbYvrTh4tLpP96lHaGeAcfoSng5aDK2aXY4bGn2j0RUFZwJtnAYWRKUb8HIKjoWx3FQmT8FzaiCXt9uWnawpPFls5uscvBKGXtdyHDwT50t3Pd8sctgrce6i8Zi86qY05E03NoIqJZLk0cNwNeRD8rvqLfIvK/uTtfxR2V0mzO6ylxKRoaT/UU7SZ8JE1H0B" rel="nofollow noreferrer" title="PHP – Try It Online">Basic Case</a></p>

<pre class="lang-php prettyprint-override"><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+
|P| | | | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | |T| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | |M|M|M|T| | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | |T| | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<p><code>DDDDDRUUUUURDDRUURDDRUURDDDLDLLLDRRRRURUUUURDDDDDLRRU</code></p>

<p><a href="https://tio.run/##7Zbfb9owEMefx19xlTxI1KCS0l9aSNG6PuwBT6gKfYkiZCWGRIU4cugaVvVvZ3YaWo/xY6TptIc9HET2fX13H5/jJGGy6HSTMAHKOeNDThPGZ1E81lq6tRjdx/4sYjH4Wh1NDZQZiNtN00CT/DewW/pjNNIQ77R0MUM4J/NhSgn3Q61voKluoakrnBH37FtLeB5E8TD30hw5rQcRtUaMUyIELuIfUdZFvGl@kqsLJW@izOvmfy9Dh89Dh8WQ1HRQ1jTlmBR6JEXMvkSxLjOLL@1WvS6FsXdg49fHW/2R@iGD3uD6xkXMs3ytqDAWixqI6dZT7nBzPei5KPCsp0Xt6AiuSBr58IWktIamJtjg1j40@g2jAfuZUMGbVE4pFVbMqSRDp5K6PEvA9TUQTA0w26BbNUm7x/w7GsAgEbCPt8DGpUrBpWDvVuEV0Lh0hu/TRAJ2jvpYRf2NwUwcxPSey85ur4H9tlLwFvu9R/ffon8ddnsF9gOZw4zBlH2XvE8K3ngHqTX2X/VifYX3icrbCSk8MD4JIEqBwDgi8Uxt99MCv1Oc9T2sclX/L8aqXrXEf6rivyL@HXyeTOhcsD4reWk6f3QE1zfS@xz3amKVr2vJ@kxlbWamgHwuIQvES5dz4bL0@EqDMQVMfsjOv1B2Ayu3Hd5wVyofD0XWeMNr21n/mVH01bp11dj41znlZbAtq5W5HbE2rLQSy9lxicFr5z@zvlhux@In" rel="nofollow noreferrer">Locked Up</a></p>

<pre class="lang-php prettyprint-override"><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+
|P| | | | |M| | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | | | | |M| | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | |T| | |M| | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M| | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<p><code>DDRUURDD</code></p>

<p><a href="https://tio.run/##7Zbfb9owEMefx19xlTxI1KCS0l9aSNG6PuwBV6gKfUERshIDUUkcOXQNq/q3U5uG4rEAI02nPezhILLv67v7@BwnHsfzVjsex0A5Z3zAacz4NIhGWkO35sOHyJsGLAJPq6LQQKmBuF03DTRZ/Pp2Q38KhhrirYYuZgjnZDZIKOHeWOsaKNQtFPaFM@KufWcJz4MgGiy8NEdO635ArSHjlAhBH/HPKG0jXje/yNWFktdR6rYXf29Dh69Dh9mQ1LRQWjflmBS6JEHMvkSRLjOLLu1GtSqFkXtg49Xjnf5EvTGDTu/6to@Ya3laVmEkFjUQ063nhcPtda/TR75rPc8rR0dwRZLAg28koRUUmmBDv/Kp1q0ZNdjPhArepXIKqbBiTikZOqXU5VoCrqeBYGqA2QTdqkjaHebdUx96sYB9vAU2LlQKLgR7twqvgcaFM/yYJlrBPlZh3zCYiqOYPHDZ280c3O8rBm@x37t0/036h3EvYDfXYD@SGUwZhOyH5H2S8cY7SOXYf9WbdRXeJypvZ0zhkfGJD0ECBEYBiaZqu59m@J3stO9hpau6fzFW@aol/lMV/xXx7uHrZEJngvVZwWvT@aMjmN9IH3Pcy4lVvK4l6zOVtZmaAvK5hCwQL13OhcvS4zv1RxQw@Sk7/0LZDazcd3jDbal8PmRZ4w2vbSf/QyPrq7x11dj41znlZbAtq7W5HbE2rLQWy9lxicGq819ZXyy3Y/4C" rel="nofollow noreferrer">No Treasure:</a></p>

<pre class="lang-php prettyprint-override"><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|P|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<p><code></code>  &nbsp;<em>(no output)</em></p>

<p><a href="https://tio.run/##7Zbfb9owEMefx19xlTxI1KCS0l9aSNG6PuwBT6gKfUERshJDokIcOXQNq/q3MxtC8ViAkabTHvZwENn39d19fI4TB/G81Y6DGCjnjA84jRmfhtFIa@jWfPgYedOQReBpVTQxUGogbtdNA40Xv77d0J/DoYZ4q6GLGcI5mQ0SSrgXaF0DTXQLTfrCGXHXvreE51EYDRZemiOndT@k1pBxSoSgj/hHlLYRr5uf5OpCyesodduLv9eh4@XQcTYkNS2U1k05JoUuSRCzr1Gky8yia7tRrUph5B7ZeP14rz9TL2DQ6d3e9RFzLU/LKozEogZiuvWycLi77XX6yHetl3nl5ARuSBJ68IUktIImJtjQr3yodWtGDQ4zoYI3qZxCKqyYU0qGTil1uZaA62kgmBpgNkG3KpJ2h3kP1IdeLGCf7oCNC5WCC8Her8IboHHhDN@nidawT1XY3xhMxVFMHrns7WYO7rcVg3fY7116@Cb9@7ibG7ifyAymDCbsuyR@lhHHe1jl2H/Vq3WXxBe8z1TeTkDhifGxD2ECBEYhiaZqw59n@J3svB9gpau6fzFW@aoV/nMV/w3xHuDzeExngvVFwYvT@aNDmN9I73Pgy4lVvK4V6wuVtZmaAvKlhCwQr1wuhcvK4yv1RxQw@SE7/0rZDazceHjLfal8QGRZ4y0vbif/UyPrq7x11dj41znlZbArq425PbG2rLQRy9lzjcG685esr1bbMf8J" rel="nofollow noreferrer">No way to move</a></p>

<pre class="lang-php prettyprint-override"><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M|M|M|M|M|M|M|M|M|M|M|P|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<p><code></code>&nbsp; <em>(no output)</em></p>

<p><a href="https://tio.run/##7Zbfb9owEMefx19xlTxI1KCS0l9aSNG6PuwBT6gKfYkiZCUGokIcObQNq/q3MzsNxWUBRkqnPezhILLv67v7@BwnHsXzVjsexUA5Z7zPacz4NIyGWkO35oP7yJ@GLAJfq6KJgVIDcbtuGmic/QZ2Q38KBxrirYYuZgjnZNZPKOH@SOsaaKJbaOIKZ8Q9@9YSngdh1M@8NEdO60FIrQHjlAiBi/hnlLYRr5tf5OpCyeso9drZ3@vQ4cvQYT4kNS2U1k05JoUeSRCzL1Gky8yiS7tRrUph5B3YePl4qz9Rf8Sg07u@cRHzLF/LK4zEogZiuvWcOdxc9zouCjzreV45OoIrkoQ@fCMJraCJCTa4lU@1bs2owW4mVPAulVNKhRVz9pKhs5e6PEvA9TUQTA0wm6BbFUm7w/w7GkAvFrCPN8DGpUrBpWBvV@EV0Lh0hh/TREvYxyrsHwym4igm91z2drMA9/uKwRvs9y7dfZP@fdzNFdyPZAZTBhP2IImf5MTxFlYF9l/1at03xE9U4s6IwiPj4wDCBAgMQxJN1ZY/zTfAyU/8DrZ3Vfcvxtq/SmxAhv9UxX9F/Dv4Oh7TmWB9VvLqdP7oGBa30scc@f3EKl/XgvWZytpMTQH5XEIWiBcu58Jl4fGdBkMKmPyUnX@h7AZW7jy85sZUPiHyrPGaV7dT/LGR91XRumps/HZOeR1symplbkusNSutxHK2XGSw7PwX1heL7Zj/Ag" rel="nofollow noreferrer">The world is a giant treasure</a></p>

<pre class="lang-php prettyprint-override"><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T|T|T|T|T|T|T|T|T|T|T|T|T|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T|T|T|T|T|T|T|T|T|T|T|T|T|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T|T|T|T|T|T|P|T|T|T|T|T|T|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T|T|T|T|T|T|T|T|T|T|T|T|T|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T|T|T|T|T|T|T|T|T|T|T|T|T|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T|T|T|T|T|T|T|T|T|T|T|T|T|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<p><code>LLLLLLUURDRURDRURDRURDDDLLLLLLLDDRURDRURDRURDRURUUUURDDDDDLRRUUUUURDDDDDRUUUUU</code></p>

<p><a href="https://tio.run/##7Zbfb9owEMefx19xlTxI1KCS0l9aSNG6PuwBV6gKfUERshIDUUkcObQNq/q3MztNi0sDjJROe9jDQWTf13f@3DlOPI7nrXY8joFyzviA05jxaRCNtIZuzYd3kTcNWASeVkWhgVIDcbtuGmiS/fp2Q38MhhrirYYuZgjnZDZIKOHeWOsaKNQtFPaFM@KufWMJz70gGmRemiOndT@g1pBxSoSgj/hXlLYRr5vf5OpCyesoddvZ3@vQ/vPQfj4kNS2U1k05JoUuSRCzz1Gky8yic7tRrUph5O7ZePF4oz9Sb8yg07u87iPmWp6W7zASixqI6dZT5nB92ev0ke9aT/PKwQFckCTw4AdJaAWFJtjQr3ypdWtGDbYzoYIPqZxSKqyYs5MMnZ3sy7UEXE8DwdQAswm6VZG0O8y7pT70YgH7cA1sXGoruBTszSq8BBqXzvBzmmgB@1CFfcVgKo5icsdlbzcLcH9sM3iNve/S7Yv07@NuLuF@IDOYMgjZvSR@lBPHG1gV2H/Vq3XfED9SiTtjCg@MT3wIEiAwCkg0VVv@OC@Ak5/4LWznqu5fjLV71aIAx2oBLoh3C98nEzoTtE9KXp7OHx3E4mb6nEO/m1jl97WgfaLSNlNTYD6VmAVk4ZS5nAqXF4@f1B9RwOSX7P4zpR5YuffwiltT@YzI88YrXt9O8QdH3ltF66qx8ds55ZWwLquluQ2xVqy0FMvZcJnBovufWZ@9lGP@Gw" rel="nofollow noreferrer">1x1</a></p>

<pre class="lang-php prettyprint-override"><code>+-+
|P|
+-+
</code></pre>

<p><code></code>&nbsp; <em>(no output)</em></p>

<p><a href="https://tio.run/##7Zbfb9owEMefx19xlTxI1KCS0l9aSNG6PuwBT6gKfYkiZCWGRCVx5KQtrOrfzmwaisv4MVI67WEPB5F9X9/5c@c4aZhOW@00TIFyznif05TxPEqGWkO3poP7xM8jloCvVVFsoLGBuF03DTSa/QZ2Q3@KBhrirYYuZgjnZNLPKOF@qHUNFOsWil3hjLhn31rC8yBK@jMvzZHTehBRa8A4JULgIv4ZjduI180vcnWh5HU09tqzv9ehw5ehw2JIalpoXDflmBR6JEPMvkSJLjNLLu1GtSqFiXdg48Xjrf5E/ZBBp3d94yLmWb5W7DARixqI6dbzzOHmutdxUeBZz9PK0RFckSzy4RvJaAXFJtjgVj7VujWjBruZUMG7VE4pFVbM2UuGzl725VkCrq@BYGqA2QTdqkjaHebf0QB6qYB9vAE2LrUVXAr2dhVeAo1LZ/gxTbSAfazC/sEgF0cxu@eyt5srcL9vM3iD/d6luxfp38fdXML9SCaQM4jZgyR@UhDHW1itsP@qV@u@IX6iEndCCo@MjwKIMiAwjEiSqy1/WhTAKU78DrZ3Vfcvxtq/alGAU7UAV8S/g6@jEZ0I2mclL0/njw7i6mb6mEO/n1jl9yVoz1ifqazNsSkgn0vIAvHc5Vy4zD2@02BIAZOfsvcvlGpg5dbDa@5M5SOiyBqveXk7qz83is5ata4aG7@dU14Im7JamtsSa81KS7GcLVcZLHr/hfXFvBzTXw" rel="nofollow noreferrer">Back Alley</a></p>

<p><code>DDDDDRUUUUURDDDDDRUUUUURDDDDDRUUUUURDDDDDRUUUUURRRRRLLLLLDDRRRRRLLLLLDDRRRRR</code></p>

<p><a href="https://tio.run/##7Zbfb9owEMefx19xlTxI1KCS0l9aSNG6PuwBT6gKfUERshJDopI4cugKq/q3MztLG5cFGCmd9rCHg8i@r@/8uXOcJEiWnW4SJEA5Z3zEacL4LIwnWku3luP72JuFLAZPq6PIQHMDcbtpGmia/fp2S38MxxrinZYuZgjnZDFKKeFeoPUNFOkWiobCGXHXvrWE50EYjzIvzZHTuh9Sa8w4JUIwRPwjmncRb5qf5OpCyZto7nazv5ehw19Dh/mQ1HTQvGnKMSl0SYqYfYliXWYWX9qtel0KY/fAxsXjrf5IvYBBb3B9M0TMtTwt32EsFjUQ062nzOHmetAbIt@1npa1oyO4ImnowReS0hqKTLBhWPvQ6DeMBuxmQgVvUjmVVFgxZy8ZOnvZl2sJuJ4GgqkBZht0qyZp95h3R30YJAL28QbYuNJWcCXY21V4BTSunOH7NFEB@1iF/Y3BTBzF9J7L3m6X4H7bZvAG@71Ldy/Sv4@7vYL7gSxgxiBi3yXxk5w43sKqxP6rXqz/iviJStwJKDwwPvUhTIHAJCTxTG3507wATn7id7C9q/p/Mdb@VUUBTtUCXBHvDj5Pp3QhaJ9VvDydPzqI5c30Pod@P7Gq76ugfabSNuemwHwuMQvIhdO5cHr2@Ur9CQVMfsj@v1AqgpWbD6@5N5UPiTxzvOYF7pR/cuTdVbauGhu/nlNeCpuyWpnbEmvNSiuxnC3XGRT9X8tYXzwXZPkT" rel="nofollow noreferrer">Hedge Maze</a> (an original creation)</p>

<pre class="lang-php prettyprint-override"><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+
|P|M| |T|M| | | |M| |M|M|T|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
| |M| |M| | |M|T|M|T| | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T| | |M| |M| |T|M|M|M| |M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M| | | |M| |M|M| | | |M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T| | |M| |M| | | | |M| |M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|M| |T| | |M|M|M|M|M| |T|
+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<p><code>DDRRUURLDDDDLLRRDRRUULRUURURRDDLDDRRRURRUULLUDRRRUDLDDDDR</code></p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/abrudz/dyalog-apl-extended" rel="nofollow noreferrer">APL (Dyalog Extended)</a>, 132 bytes</h1>

<p>Saved 16 bytes by having the function ouput <code>1 0,0 1,¯1 0,0 ¯1</code> instead of <code>U,L,D,R</code>. TIO link below decodes output back to letters.</p>

<p>I may write an explanation later, but most of the work is creating a graph in a format that the dfns <a href="https://dfns.dyalog.com/n_path.htm" rel="nofollow noreferrer">path function</a> likes, then using it to find successive shortest paths between the start and all treasures. Quite efficient, but because treasures are pathed left-to-right, top-to-bottom instead of being based on proximity, the answers are not optimal.
</p>

<pre class="lang-apl prettyprint-override"><code>{z←×`/d←⍴⍵⋄g←z⍴⊂⍬⋄s t m←(⍸∘∊⍵=⊢)¨'PTM'⋄f←{(⍵∊m)∨0=⍺:⍬⋄g[⍺],←⍵}⋄h←(f`⍨,f)⋄⍬≡t⊣{2h`/⍵⊣2h`⌿⍵}x←d⍴⍳z:⍬⋄⊃,/⊃,/2-/¨{⍸x=⍵}¨¨2(g⌂path,)/s,t}
</code></pre>

<p><a href="https://tio.run/##tVJBSwJBFL77K@Y2CmubaxkEnupQ0KDodhJBYV09ZAltYC5eLGTbGiki8lpelgg6WBBdgu2fvD9ibzYLV5wliN5hdt6333zve2@m2tpLGsfVvYN6sta2avtGzZhM7A70Lz9uK6qBX@DPwF/g/LSOSUdkbg/4IwKHxCJNBOPAX8EZguMiMQvufcL3aF5nFDkm/rfjQsBxmwlwvOUs8Lf1L4F6CfdlJSjy0kWgIdTMCnBPMROYC9rZnQXuyNYaFVXIuCPcwcW7ONFGuhH4G3emkuCeKGqwaEnV92y01s4Kru/5nhavw0WvVbUaSkI9VKzuxAxqD2Bws53DU/5TGvpXmBULG7jqW9vFiZiBTXd3Ngu0JAzwMdqD/jXwB2w6KRJnuJQVXz7Wyt1YTMyE0DyZCRprijYpWQzqi0DGmC47rss10bdAc0dW68giqXUaM4hJMiSVxkk1Q@7YInm2yN0PGCo2ZbAgftdphFVNblUiz6aVZ2YmGeTf3aUl7ths0NBE/g/Mz7tbkbjTZ@NbKQLM/5oZDYbdrUY9wu8XPX8LoeYj70vKlGmG3WVk7uaJa1NiiqQE7xM" rel="nofollow noreferrer" title="APL (Dyalog Extended) – Try It Online">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <s>766</s> 622 bytes</h1>



<pre class="lang-python prettyprint-override"><code>def f(s,W,H):
 Z=enumerate;I=[("L",-1),("R",1),("D",1j),("U",-1j)];o="";P,M,T=map(lambda t:{x+y*1jfor y,l in Z(s)for x,c in Z(l)if c==t},'PMT');E=D={c:{t:0}for t,c in Z(T)}
 while len(E):
  E={}
  for m,N in[(c+d,D[c])for c in D for _,d in I if not c+d in M]:
   if 0&lt;=m.real&lt;W and 0&lt;=m.imag&lt;H:
    T={t:N[t]+1for t in N if not m in D or not t in D[m]}
    if any(T)or not m in D:
     E[m]=T
  for m in E:
   if m in D:
    D[m].update(E[m])
   else:
    D[m]=E[m]
 for m in P:
  if m in D:
   for g in D[m]:
    while D[m][g]:
     for i,d in I:
      if m+d in D and D[m+d][g]&lt;D[m][g]:
       o+=i;m=m+d;break
 return o
</code></pre>

<p><a href="https://tio.run/##bVJfa9swEH/3pzj0UqnWQsLYSxy9OdDCHMLwKFTzimsrqTNbDrbCGkI@e6aT7KWB6uX8@3Onu5P3R/PW6q@XS6k2sKE9f@IPbB7As1D60KguNyp6FJKS74R/mTFOyQ/CXYxt3OHHT1R2LItaQUi05glPRZPvaZ03r2UOZn56D4/3s92m7eDIa6g0PNOeIXznhYc1qzZQCGHO/G6dpHcsWopYnIr5ycynZ7Sa0ZqycwB/36paQa00XWK3sBQnywIaG76yRkmLsOSxLDJ3kcuNnf7CSwSPYG/UrQHrQ5xkWAfJ6UI0k07l9eIJcl16XDX5dvHgLJAK29VKmiycuc4wfTWWa/xNlkfktFg22dllWk@uj3aEQfZmXxWW1ibScQpUlmNLH31YbXLYl/ZlKKYwZFXdq6sskA@uddYo3ZZBbTs25zP9ThHL7UA5WzUsbKBcIb@z2O3HZoQl5ixucwHaUFRRI6wcvdqF/gmgU@bQaWgvRvWmyHvVgwAZSLImGceQ@EN4ACT5FAy@NEntDU6CBFAZwHAG34huJO7jlUq9Ox2Oc9u4/gi8kgVZELhXHwbAPfwfxk6@7yptKPmlyWTXVppKMiH3s29ZOJpCSX47hrHRvaGjyPGXHoGcZuyGYIxd/gE" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>

<p>Fairly certain after this that I will never win code-golf, but contributing because I enjoyed the exercise.</p>

<p>This version works by building a dictionary of reachable locations, with each entry being a dictionary whose keys are a unique ID for the treasure, and whose value is the shortest distance to that treasure.  The code supports multiple values for P: for each one it outputs a path that collects the treasures.  No optimization is attempted.. it picks the nearest treasure from its current location until all treasures are collected.</p>
</div>
<div id="pu4" class="pu"><h1>JavaScript (ES6), <s> 187 183 </s> 173 bytes</h1>
<p>Takes input as a matrix of characters. Returns an array of signed integers: <strong>-2</strong> = down, <strong>-1</strong> = right, <strong>1</strong> = left and <strong>2</strong> = up.</p>

<pre class="lang-javascript prettyprint-override"><code>ff=(m,X,Y,p=[])=&gt;/T/.test(m)?(g=u=&gt;m.some((r,y)=&gt;r.some((c,x)=&gt;(r[o=c=='M'|c&gt;u|(h=X-x)*h+(v=Y-y)*v^c!='P'?0:f(m,x,y,1/X?[...p,h+2*v]:p,r[x]=3-~r[x]),x]=c,o)))?O:g(-~u))``:O=p
</code></pre>
<p><a href="https://tio.run/##7VZda9swFH3Pr7h7kpTIytLBHjyUsLK@1WsoHqQIbxWy8tHGlrFsz4bSv56pbUhbaGkanLDBXo6@0NG999x70ZWspFX5Iiu81MR6tZpynNAJvaAZFxHhw37YZ4W2BU7ICM94yYcJsybRGOe0cef5eqVo7VY4F4YrzlGAbtSwvMFzPvFq0p33cMUvvIZ0q5/qA0djNProT91LNW3ooD8ZCcZYRue9o24V@RnNRR3xT97t3UiomytqCCGjM3@GvduSkMtL/4xnqy@iI9CxtAsFSlqNKIgOgAD3AAUEuwJE9IEG2qYJ26EJnkO4P6fCvcWmEzkmgU6NutYxlNkW4gXt@Bm0I977aIIXdAtadOqwib0W77uBItfSlrm2r@rXuqvB2/B61bRefP@4fr9lA4WBxFRP2mewZZhfhi1z/j/NrjB@VPArzBYyLTZl@KhhuGlZu8DGzoPQjP8qaw5Gs9bwWKprkMulbtr5wITv7xNvJOuBu9YerWkxNmv1BvXgqWz3@1GHTU1@ItUcY2EpJBEBPgRlUmuWmi3NDFuWyfgkjfHgM4EeIB8EcqP7FBOWyAzHdxfQt/Nfpz@QiN3JUUTYlVmkGFF0fyNChKz@AA" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a>
(with the output translated back to <strong>L</strong>, <strong>R</strong>, <strong>U</strong>, <strong>D</strong>)</p>
<h3>How?</h3>
<p>This AI:</p>
<ul>
<li><p>Is definitely more artificial than intelligent.</p>
</li>
<li><p>Rushes like a mad man in the map (i.e. implements a depth-first search).</p>
</li>
<li><p>Stops as soon as there are no more treasures, but otherwise does not care about the positions of the remaining treasures. This test is done with a regular expression.</p>
<pre class="lang-javascript prettyprint-override"><code>  /T/.test(m)
</code></pre>
</li>
<li><p>Compares the <a href="https://en.wikipedia.org/wiki/Rational_trigonometry#Quadrance" rel="nofollow noreferrer">quadrance</a> between its current position <span class="math-container">\$(X,Y)\$</span> and a new position <span class="math-container">\$(x,y)\$</span> with <span class="math-container">\$1\$</span> to know whether it can move there. Or tests if the cell contains <code>&quot;P&quot;</code> if its position is not yet defined.</p>
<pre class="lang-javascript prettyprint-override"><code>  (h = X - x) * h + (v = Y - y) * v ^ c != 'P'
</code></pre>
</li>
<li><p>Writes <span class="math-container">\$4N\$</span> on a cell that has been visited <span class="math-container">\$N\$</span> times and uses this threshold combined with an internal counter <span class="math-container">\$u\$</span> to decide -- in a sudden flash of lucidity -- whether it should backtrack over already visited cells when everything else failed.</p>
</li>
</ul>
</div>
<div id="pu5" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, 233 bytes</h1>



<pre class="lang-python prettyprint-override"><code>G=input()
e=enumerate
P=T=M=E=frozenset()
for i,k in e(G):
 for j,l in e(k):exec l+'|={(i,j)}'
G={0}
c=-1
while T-G|G&amp;M|G-E-T:
 G-=G;e=list(P)[0];x=c=c+1;r=()
 while x:m=x%5%4;x/=5;r+=m,;e=~-m%2*~-m+e[0],m%2*(m-2)+e[1];G|={e}
print r
</code></pre>

<p><a href="https://tio.run/##JY4xb4MwEIV3/wov1Hax1YCSBetGyxMSA1uVoUIXxQkY5BCVNtC/To244U7fO713N/yM197n62rB@eE5ckEQ0D87DF8jkgpqKMHAJfS/6B@47S99oE7eqfMUuRUFoZtyk@2u3EWBEza0TdkML@7kTSyMWHgdFtKAysj31bVIa2Vn@1bOVhlVxwyrwGqE1j1GXonPw1lP0ECTZjpAPEp311R0MCWn5KinDzjpkEIno@tPdUn@HnuK0Sk34J3KRcTsrG38AxcyBOdHGtaVM1OXhknKKlPW2zRmZxOLiX8" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>

<p>Very slow. Most of the test cases would probably time out.</p>

<p><code> MPTLRUD</code> → <code>EMPT1302</code>. Any other characters should be considered to be prefixes, separators or postfixes.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/181699/">181699</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




