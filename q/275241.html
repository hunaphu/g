<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::275241</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>049</td><td>Perl 5</td><td>240925T001521Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275765#275765">Kjetil S</a></td></tr>
<tr d-ix="1"><td>128</td><td>Python 3</td><td>240903T161903Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275326#275326">Digital </a></td></tr>
<tr d-ix="2"><td>050</td><td>Python 2</td><td>240830T114323Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275263#275263">Lucenapo</a></td></tr>
<tr d-ix="3"><td>097</td><td>C gcc</td><td>240830T170906Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275266#275266">Digital </a></td></tr>
<tr d-ix="4"><td>078</td><td>F#</td><td>240831T120047Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275278#275278">Juuz</a></td></tr>
<tr d-ix="5"><td>053</td><td>C gcc</td><td>240829T203006Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275246#275246">jdt</a></td></tr>
<tr d-ix="6"><td>012</td><td>Vyxal 3</td><td>240830T122450Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275264#275264">pacman25</a></td></tr>
<tr d-ix="7"><td>013</td><td>05AB1E</td><td>240830T073517Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275257#275257">Kevin Cr</a></td></tr>
<tr d-ix="8"><td>037</td><td>JavaScript ES6</td><td>240829T171331Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275242#275242">Arnauld</a></td></tr>
<tr d-ix="9"><td>023</td><td>Charcoal</td><td>240829T232654Z</td><td><a href="https://codegolf.stackexchange.com/questions/275241/encode-a-varint/275249#275249">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a>, 49 bytes</h1>

<pre class="lang-perl prettyprint-override"><code>sub f{($n=pop)&gt;&gt;7?($n%128+128,f($n%2**32&gt;&gt;7)):$n}
</code></pre>
<p><a href="https://tio.run/##dZHbboJAEIbvfYoJWQJLMdldwEWNh6TqbROvmrTG9ADWtgIVTDDGZ6e7iwJVO4GBme@fmT0kwfbbK4p09wrhwUTRIIkTPBzykfjXKfPvxGuHMmCW5TBBMO6h6FiE8RY2e0BZkGZgtkDYE4HaBkMwSE6IsbBLSK8hrSHjF5DPKsg8r@P9gZOJDSS/59I3ujDS5dSjDeFsJiWlb3akLnd9p@PyW8KmJ7wqatPLDfxbVE9qV6P8U5FPpOTaE78@DUqdru9cT5pK7zrGQulw66C@m72J1lGyy2xAQZ4Eb1nwjmEAY3U5/ZMGxqs4E9nwJMYVQAIs02y7jlaCf8brCDRbPpuXBNJE5LPQ1EiuE/YosmiJbdWsbFBy0PRUBKpzD/Q2pTI8r0ZmmC8zokzhrgw@glyx9DnSyq1Lay4n@Km3BCMw4i8DemBYljWdzx/mRqOqPIE6PpfVKU0u@vagfutY/AI" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>
<p>Just a port of other answers.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 128 bytes</h1>
<p>Attempt to get an existing library to do the heavy lifting:</p>

<pre class="lang-python prettyprint-override"><code>from google.protobuf.internal.encoder import _VarintEncoder as v
def e(n):
 b=bytearray()
 v()(b.extend,n&amp;(2**32-1),0)
 return b
</code></pre>
<p>Don't <strike><a href="https://tio.run/##PY5BasMwEEX3PsWsghRkYUl27BSyzBW6LVI8TgzJyEyVEJ/enUIp/M28x3z@spZbprBtE@cHXHO@3tEunEtOz8nOVJAp3i3SJY/IMD@WzAW@PiOLO//R@A2vasQJUJH@qCCd0lowMsdV6QpeSqtk8V2QRkM75ff74GunTSOSsTyZIG1TlnqYCZwPbWegMeAkvjfgu@4gxDfH3nUCvWv7dgiHVlwtd/0PBvlwLhyHIDNg@R2pUM3a3vCttN5@AA" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></strike> - TIO would need <code>google.protobuf</code> modules installed.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, <s>98</s> <s>52</s> 50 bytes</h1>

<pre class="lang-python prettyprint-override"><code>f=lambda x:x&amp;-128and[128+x%128]+f(x%2**32&gt;&gt;7)or[x]
</code></pre>
<p><a href="https://tio.run/##K6gsycjPM/r/P802JzE3KSVRocKqQk3X0MgiMS8lGkhpV6gCyVjtNI0KVSMtLWMjOztzzfyi6IrY/wVFmXklCmkaBppcMKYhEtPIHMExMjU1M0XiGliaG5oiKTYyNDE3sTA2M0HSo4skrwtXYIFkg6GhsaWFseZ/AA" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, 97 bytes</h1>
<ul>
<li>Saved 2 bytes, thanks to @jdt</li>
<li>Saved 16 bytes, thanks to @ceilingcat</li>
</ul>
<p>Most of the other entries seem to be taking a recursive approach.  I was curious to try a direct approach using x86 instruction intrinsics.</p>
<p>Returns the output in a <code>uint64_t</code> which can be cast to a 0-terminated char array.</p>

<pre class="lang-c prettyprint-override"><code>#define f(n)_pdep_u64(n+0U,~(~0LU/510))|_pdep_u64((1&lt;&lt;((63-__builtin_clzll(n+0U))/7))-1,~0LU/510)
</code></pre>
<p><a href="https://tio.run/##hVJNb6MwEL3zK0apWtkNNDYBQkW6v2CvPaUVosYES8RE2FRRW/LTl518NJDuYeeAPI/3xm9mLLy1EP2N0qJqcwlLY3Ol7UP5y7nG6p9Qo/Qasf4ml4XSEgqiabrN5TZto4DoKXt292TPfj/PQs4o/Rr@Eb5cEhLNvTR9a1VllU5F9VFVRxGlswWlHncv0v69VjmUcpe3my0RtTYWWvQYpxbua2GlNS4Y9SExr6Re25LCpwMYSAKVHI9F3QBR8AQsAQXLMzGB6VR9sw@xxa5sQSZwy/zdxIVT@ZV6pcmFowogWOoO9mxX0LF6XOFFT0aazhm@14zOcQ42N5nSZOzbSmNFZqRZvaLrT@YOV3A8c38xIH4YRiGmPntc8JC7V4ZG4fNgEcTzKEAtThi8CxC7wDmfP8bzLnH@N7vDrOuCXBxSmP2DrRiO7Od0D1uLAlxTI00UYMGx4GrGoswauEdaW1nkkVNO747Cgfb9KE5EfAW2wcWeU3qu150aaqRtG409OF3/RxRVtja9t8kaUT7pzKp3idnbRvXe@Y3v4gjt4q4eyr8" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<p><a href="https://godbolt.org/z/vrdPG3x5K" rel="nofollow noreferrer">Compiler Explorer was helpful</a></p>
</div>
<div id="pu4" class="pu"><h1>F#, 78 bytes</h1>
<pre class="lang-fs prettyprint-override"><code>let rec e v=
 let b=v&amp;&amp;&amp;127u
 if b=v then[byte b]else byte(b|||128u)::e(v&gt;&gt;&gt;7)
</code></pre>
<p><a href="https://tio.run/##VY3BCoMwDIbvPkUQJnoQbGttFSzsuBfYZeywSmWCdKNWYeC7u@phLJckX/L/@fsp717ObNtoPDjTgYGljWAn3S5JkhAq5giGfkfwT2Nv@uMN6LsZp9DCnOp1XQmVc9Y0Jl2UUiI73r3dYP314S7WQwtzAEZBqRARynHsLcSncxxF/9ICEcFEBWLKecXxpqgF4dhFSSlKyaoSm3Osyn8yiTMJYbVk2xc" rel="nofollow noreferrer">Try it online!</a></p>
<p>A function taking a unsigned 32-bit int (treated as a signed int with the same bits) and returning a list of bytes.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, <s>62</s> <s>59</s> 53 bytes</h1>

<pre class="lang-c prettyprint-override"><code>f(n){printf(&quot;%02X &quot;,n&amp;127|!!(n=n+0U&gt;&gt;7)&lt;&lt;7);n&amp;&amp;f(n);}
</code></pre>
<p><a href="https://tio.run/##bY9ha8MgEIa/91dchQVdEqYmqSlJ@i8Gg9EPxdYibKbUlMGy/PW5S5rm0w5R77n3Xk@dnrUOwVDH@svVus5Q8sTlG5DERUKqn/WausbF/HW3U6yuFatcFI3yaggoh8@DdZRBvwKMEXQn3/n3PTTQA09A4JIqAVkUmwIPvlWiQChFrvIy2@RYSzFPF1BihxDZtsxgqBZb3d5wb8Db71Nr6PQKg5dH/nwHd71pr0DHJtvwCmw99eIljh@DjrF894i2JJkHt/vZZDKi/8DLrfOUkJkMqyH8avNxOPuQfv0B" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<p>The literal <code>0U</code> is an unsigned integer constant. Adding it to <code>n</code> promotes <code>n</code> to an unsigned type.</p>
<p>-6 bytes thanks to @Arnauld!</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal/tree/version-3" rel="nofollow noreferrer">Vyxal 3</a>, 12 bytes</h1>
<pre><code>₃E%₆yDκ≠₆×+Ṛ
</code></pre>
<p><a href="https://vyxal.github.io/latest.html#WyIiLCIiLCLigoNFJeKChnlEzrriiaDigobDlyvhuZoiLCIiLCIyNTU2NSIsIjMuNC4yIl0=" rel="nofollow noreferrer">Try it Online!</a></p>
<p>Port of Charcoal, but there's a one byte built in for 128 so it beats 05ab1e lol</p>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 13 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>žJ%žyвā≠žy*+R
</code></pre>
<p>Port of <a href="https://codegolf.stackexchange.com/a/275249/52210"><em>@Neil</em>'s Charcoal answer</a>, so make sure to upvote that answer as well!</p>
<p><a href="https://tio.run/##yy9OTMpM/f//6D4v1aP7Ki9sOtL4qHMBkKWlHfT/v6GRsYkpAA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfaXL/6P7vFSP7qu8sOlI46POBUCWlnbQf53/0YZGxiamOgY6hjqGRuY6RqamZqY6RgaW5oamhjpGhibmJhbGZibmOrqGOrpGOoaGhsaWFsaxAA" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>  %           # Modulo the (implicit) input-integer by
žJ            # constant 4294967296
     в        # Then convert it from a base-10 integer to a list in base
   žy         # constant 128
      ā       # Push a list in the range [1,length] (without popping)
       ≠      # Check for each that it's NOT 1, so we now have a list [0,1,1,1,...]
          *   # Multiply each by
        žy    # constant 128
           +  # Add that to the values at the same positions in the list
            R # Then reverse the list
              # (after which it is output implicitly as result)
</code></pre>
</div>
<div id="pu8" class="pu"><h1>JavaScript (ES6), 37 bytes</h1>
<p>Expects an integer and returns an array of bytes.</p>

<pre class="lang-javascript prettyprint-override"><code>f=n=&gt;n&gt;&gt;7?[n&amp;127|128,...f(n&gt;&gt;&gt;7)]:[n]
</code></pre>
<p><a href="https://tio.run/##fZHLboQgFIb3PgVx0UCKDOAFp412MaMvMOnKuCBepk6mYNSYLvruFqedW2vK4g98@c45EA5ylH3RNe3gKF1W01RHKopVHIuXTD0wLj4ZDzEhpIYGxgLlT5nKp@fMAoBicLNWK0A/KDWcLXA2cy7wLy5qw7nvBz6@49stNrkR@FzL6Vow/9z55KQpvqRIZ4d5wgvdwDuN@ePcJhXGd@4u@r8/93cuA0L844cULyYN5/cy5q5Dd6F/MqfnWrlFat0lsniDCkQxKLTq9bEiR72Higx6N3SN2kNEWlkmqoSMI/AIzFcg8i5bOM4149VjATKH17atuo3sq@@63SC7AXIMbGojRA66UdAGZoumLw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>f = n =&gt;      // f is a recursive function taking an integer n
n &gt;&gt; 7 ?      // if any bit at position 8 .. 32 of n is set:
  [           //   append:
    n &amp; 127   //     the 7 least significant bits of n
    | 128,    //     with the 8-th bit forced to 1
    ...f(     //     followed by the result of a recursive call:
      n &gt;&gt;&gt; 7 //       pass n right-shifted by 7 positions,
              //       with zero bits shifted in from the left
    )         //     end of recursive call
  ]           //   end of array
:             // else:
  [ n ]       //   append n and stop the recursion
</code></pre>
</div>
<div id="pu9" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="noreferrer">Charcoal</a>, 23 bytes</h1>
<pre><code>∨Ｉ⮌Ｅ↨﹪ＮＸ²Ｉ32¹²⁸⁺ι∧κ¹²⁸0
</code></pre>
<p><a href="https://tio.run/##JYvBDsIgEAV/hXBaEkwELjWe1JMHbeMfYEtiI4VmgfbzV1pvk5n3@o/FPlpP1OEYMrQIN5syvNziMDl42BmudoM4FB/hHuaSn2V6OwQhWRfXClqy/cSN5kJUrXSzRV8SjJJdwgDfvxR75sc6OxMppcypMXRY/A8" rel="noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>      Ｎ                 Input integer
     ﹪                  Modulo
        ²               Literal integer `2`
       Ｘ                Raised to power
          32            Literal string `32`
         Ｉ              Cast to integer
    ↨                   Convert to base
            ¹²⁸         Literal integer `128`
   Ｅ                    Map over list
                ι       Current value
               ⁺        Plus
                  κ     Current index
                 ∧      Logical And
                   ¹²⁸  Literal integer `128`
  ⮌                     Reversed
 Ｉ                      Cast to string
∨                       Logical Or
                      0 Literal string `0`
                        Implicitly print
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/275241/">275241</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




