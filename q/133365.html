<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::133365</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>3975</td><td>Binary Lambda Calculus</td><td>240802T234231Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/274640#274640">short_c1</a></td></tr>
<tr d-ix="1"><td>035</td><td>JavaScript Babel Node</td><td>240727T132433Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/274468#274468">l4m2</a></td></tr>
<tr d-ix="2"><td>048</td><td>Perl 5 p</td><td>201231T222204Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/217095#217095">Xcali</a></td></tr>
<tr d-ix="3"><td>028</td><td>K ngn/k</td><td>201230T210651Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/217047#217047">coltim</a></td></tr>
<tr d-ix="4"><td>008</td><td>Japt g</td><td>190827T084956Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/190933#190933">Shaggy</a></td></tr>
<tr d-ix="5"><td>022</td><td>Brachylog</td><td>190827T082006Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/190932#190932">Unrelate</a></td></tr>
<tr d-ix="6"><td>048</td><td>Haskell</td><td>180331T061459Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/160929#160929">Angs</a></td></tr>
<tr d-ix="7"><td>019</td><td>Pyth</td><td>180330T195008Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/160897#160897">user4854</a></td></tr>
<tr d-ix="8"><td>027</td><td>Pyth</td><td>180330T165211Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/160875#160875">hakr14</a></td></tr>
<tr d-ix="9"><td>nan</td><td></td><td>170726T013022Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/135791#135791">Brad Gil</a></td></tr>
<tr d-ix="10"><td>069</td><td>Common Lisp</td><td>170721T124638Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133719#133719">Renzo</a></td></tr>
<tr d-ix="11"><td>037</td><td>Hexagony</td><td>170721T040453Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133694#133694">Brigmor</a></td></tr>
<tr d-ix="12"><td>2321</td><td>Taxi</td><td>170720T154448Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133571#133571">Engineer</a></td></tr>
<tr d-ix="13"><td>006</td><td>Pyke</td><td>170720T145856Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133560#133560">Blue</a></td></tr>
<tr d-ix="14"><td>074</td><td>Python</td><td>170720T120900Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133537#133537">Anders K</a></td></tr>
<tr d-ix="15"><td>051</td><td>Q/KDB+</td><td>170720T123758Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133538#133538">aodNap</a></td></tr>
<tr d-ix="16"><td>056</td><td>C# .NET Core</td><td>170719T182554Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133422#133422">jkelm</a></td></tr>
<tr d-ix="17"><td>103</td><td>Python 3</td><td>170719T182720Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133423#133423">sTertooy</a></td></tr>
<tr d-ix="18"><td>056</td><td>Java OpenJDK 8</td><td>170719T210023Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133451#133451">Nevay</a></td></tr>
<tr d-ix="19"><td>052</td><td>Python</td><td>170719T153224Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133381#133381">ovs</a></td></tr>
<tr d-ix="20"><td>076</td><td>C gcc</td><td>170719T185343Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133432#133432">cleblanc</a></td></tr>
<tr d-ix="21"><td>024</td><td>x8664 Machine Code</td><td>170719T200501Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133442#133442">Cody Gra</a></td></tr>
<tr d-ix="22"><td>060</td><td>R</td><td>170719T152759Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133375#133375">Giuseppe</a></td></tr>
<tr d-ix="23"><td>043</td><td>Python 2</td><td>170719T191603Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133437#133437">xnor</a></td></tr>
<tr d-ix="24"><td>052</td><td>dc</td><td>170719T163743Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133400#133400">brhfl</a></td></tr>
<tr d-ix="25"><td>007</td><td>Jelly</td><td>170719T152002Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133372#133372">nmjcman1</a></td></tr>
<tr d-ix="26"><td>041</td><td>JavaScript ES6</td><td>170719T162755Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133397#133397">Neil</a></td></tr>
<tr d-ix="27"><td>041</td><td>JavaScript Babel Node</td><td>170719T160355Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133392#133392">Business</a></td></tr>
<tr d-ix="28"><td>234</td><td>Java 7</td><td>170719T155137Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133387#133387">0x45</a></td></tr>
<tr d-ix="29"><td>067</td><td>JavaScript ES6</td><td>170719T155622Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133391#133391">Arnauld</a></td></tr>
<tr d-ix="30"><td>074</td><td>PowerShell</td><td>170719T153205Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133380#133380">AdmBorkB</a></td></tr>
<tr d-ix="31"><td>005</td><td>Neim</td><td>170719T150320Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133366#133366">Okx</a></td></tr>
<tr d-ix="32"><td>006</td><td>05AB1E</td><td>170719T152844Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133378#133378">Okx</a></td></tr>
<tr d-ix="33"><td>084</td><td>Python 3</td><td>170719T152814Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133376#133376">notjagan</a></td></tr>
<tr d-ix="34"><td>030</td><td>Mathematica</td><td>170719T150446Z</td><td><a href="https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number/133368#133368">ZaMoC</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://tromp.github.io/cl/cl.html" rel="nofollow noreferrer">Binary Lambda Calculus</a>, <s>44.375</s> 39.75 bytes</h1>
<pre><code>00010100 01000001 01010101 01010110 11100111 00000101 11001010 11100000 11011101
00000001 00000110 01110000 01100111 00000100 10001011 00001010 10101011 10111001
10000010 00000010 00001100 10000010 11001110 00001001 01011100 00011000 00000111
00101111 01101001 11000001 01010000 10110000 01000000 11101011 00000000 10101111
00000011 00111011 11000110 001010
</code></pre>
<p>This function takes in a Church numeral as input and returns a Church numeral as output. It's a reduced version of</p>
<pre><code>Œªn.closer (boundpair n) n
</code></pre>
<p>where</p>
<pre><code>succ        := Œªn.Œªf.Œªx.f (n f x)
+           := Œªm.Œªn.m succ n

‚ä§           := Œªx.Œªy.y
‚ä•           := Œªx.Œªy.x

pred        := Œªn.Œªf.Œªx.n (Œªg.Œªh.h (g f)) (Œªu.x) (Œªu.u)
-           := Œªm.Œªn.n pred m
is0         := Œªn.n (Œªx.‚ä•) ‚ä§
‚â§           := Œªm.Œªn.is0 (- m n)

nextfib     := Œªp.Œªf.f (p ‚ä•) (+ (p ‚ä§) (p ‚ä•))
boundpair   := Œªn.n (Œªp.‚â§ (p ‚ä•) n (nextfib p) p) (Œªf.f 0 1)
closer      := Œªp.Œªn.‚â§ (- n (p ‚ä§)) (- (p ‚ä•) n) (p ‚ä§) (p ‚ä•)
</code></pre>
<p>All the blocks above <code>nextfib</code> are standard lambda calculus definitions, so I won't go into detail on them.</p>
<p><code>nextfib</code> takes in a pair and returns a pair with the second element and the sum of the two elements. If initialised with <code>(0, 1)</code>, repeated application will create successive terms of the fibonacci sequence.</p>
<p><code>boundpair n</code> finds the pair of consecutive fibonacci terms that are lower and upper bounds on <code>n</code>. The first function applied to <code>n</code> takes a pair of consecutive fibonacci numbers and checks if the second element is less than or equal to n. If it is, we return <code>nextfib</code> of that pair. If the second element is greater than <code>n</code> we return the pair. If we repeatedly apply that to <code>(0, 1)</code> we check a sliding window of fibonacci numbers until we find the bounds. Applying it any more will just repeatedly return that pair. This used to be done recursively, stopping once we hit the pair, but the program still works if we just apply it <code>n</code> times. This is because <code>n ‚â§ F(n + 1)</code>, so we're guarenteed to hit our desired pair by <code>n</code> applications. This takes longer but produces a shorter program.</p>
<p><code>closer</code> finds the difference between each of the elements in the pair and n. Whichever element has the smaller difference gets returned.</p>
<p>To reduce the size, I manually applied functions where the input was only used in one spot and I factored out <code>pred</code> to be an argument to the rest of the program. A similar tactic may be applicable for <code>‚ä§</code> and <code>‚ä•</code>, but I think a larger size reduction might come from making a non recursive algorithm.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://babeljs.io/" rel="nofollow noreferrer">JavaScript (Babel Node)</a>, 35 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(n,x=0,y=1)=&gt;2*n&lt;x+y?x:f(n,y,x+y)
</code></pre>
<p><a href="https://tio.run/##DYlBDoMgFAWvwtIv2Gh3Vn97lqdCoyH8Bk0Dp0c2k8nMgT/ONe6/q1uwWN8F2WwpjptgEvcm80D8frZhTjp/0svVnk11Kk6iagDuJwXM4zgprQFaJZzi7cPLt16jXCVRuQE" rel="nofollow noreferrer" title="JavaScript (Babel Node) ‚Äì Try It Online">Try it online!</a></p>
<p>Based on Alix Eisenhardt's JS solution</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a> <code>-p</code>, 48 bytes</h1>

<pre class="lang-perl prettyprint-override"><code>($a,$.)=($.,$a+$.)while$.&lt;$_;$_=2*$_-$a&lt;$.?$a:$.
</code></pre>
<p><a href="https://tio.run/##DcZLCsIwEADQ/Zwi4CyqtiFjf2BbPIFnKIGOGEiT0KSIlzd283iBN9vmXKAuUZ6nAmWJ@nr08zaWUY44DzhPtwvOFeoR5QP1HWUeUE9qQHlw8s5@hWNeeBEvv4l1t8kEyyJxTFEYJ6JeWWy7ywQ1NNBBD0RAPXQ1kKKfD8l4F3P1bKUilatg/w" rel="nofollow noreferrer" title="Perl 5 ‚Äì Try It Online">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://bitbucket.org/ngn/k" rel="nofollow noreferrer">K (ngn/k)</a>, 28 bytes</h1>
<pre><code>{F@&amp;x=&amp;/x|:-x-:F:x(+':1,)/1}
</code></pre>
<p><a href="https://tio.run/##DchBCoAgEAXQq/yVFiU6aA4OBK08ii0C1wPV2a23fJfrZx@jyV0Po7vx@ohTJ1V0WqzQOnt6R7OEiIQMBhGIkSMo/MmMlBlbCKBYyvgA" rel="nofollow noreferrer" title="K (ngn/k) ‚Äì Try It Online">Try it online!</a></p>
<ul>
<li><code>F:x(+':1,)/1</code> generate the first <code>x+1</code> terms of the fibonacci sequence, storing in <code>F</code> (adapted from @ngn's answer <a href="https://codegolf.stackexchange.com/a/196177/98547">here</a>)</li>
<li><code>x-:F</code> get the difference between <code>x</code> and each term of the sequence, updating <code>x</code> (which now becomes a list)</li>
<li><code>x|:-x</code> take the absolute value of each, updating <code>x</code></li>
<li><code>&amp;x=&amp;/x</code> identify indices in sequence with the smallest value</li>
<li><code>F@</code> index into the actual sequence</li>
</ul>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/ETHproductions/japt" rel="nofollow noreferrer">Japt</a> <a href="https://codegolf.meta.stackexchange.com/a/14339/"><code>-g</code></a>, 8 <a href="https://en.wikipedia.org/wiki/ISO/IEC_8859-1" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>√≤!gM √±aU
</code></pre>
<p><a href="https://petershaggynoble.github.io/Japt-Interpreter/?v=1.4.6&amp;flags=LWc&amp;code=8iFnTSDxYVU&amp;input=MTM5OQ" rel="nofollow noreferrer">Try it</a></p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/JCumin/Brachylog" rel="nofollow noreferrer">Brachylog</a>, 22 bytes</h1>

<pre><code>;I‚âú-.‚àß{0;1‚ü®t‚â°+‚ü©‚Å±h‚Ñï‚Üô.!}
</code></pre>

<p><a href="https://tio.run/##AXQAi/9icmFjaHlsb2cy/3t3IiAtPiAidz/ihrDigoLhuol94bWQ/ztJ4omcLS7iiKd7MDsx4p@odOKJoSvin6nigbFo4oSV4oaZLiF9//9bMSwzLDQsNiw3LDExLDE3LDYzLDEwMSwzNzcsNDY3LDUwMCwxMzk5XQ" rel="nofollow noreferrer" title="Brachylog ‚Äì Try It Online">Try it online!</a></p>

<p>Really all I've done here is paste together Fatalize's classic <a href="https://codegolf.stackexchange.com/a/182381/85334">Return the closest prime number</a> solution and my own <a href="https://codegolf.stackexchange.com/a/190930/85334">Am I a Fibonacci Number?</a> solution. Fortunately, the latter already operates on the output variable; unfortunately, it also includes a necessary cut which has to be isolated for +2 bytes, so the only choice point it discards is <code>‚Å±</code>, leaving <code>‚âú</code> intact.</p>
</div>
<div id="pu6" class="pu"><h1>Haskell, 48 bytes</h1>

<pre><code>(%)a b x|abs(b-x)&gt;abs(a-x)=a|1&gt;0=b%(a+b)$x
(1%2)
</code></pre>

<p><a href="https://tio.run/##y0gszk7Nyfn/X0NVM1EhSaGiJjGpWCNJt0LTDsRIBDJsE2sM7Qxsk1Q1ErWTNFUq/ucmZuYp2CoUFGXmlSioKGgYqhppKpgaGPwHAA" rel="nofollow noreferrer" title="Haskell ‚Äì Try It Online">Try it online!</a></p>
</div>
<div id="pu7" class="pu"><h1>Pyth, 19 bytes</h1>

<pre><code>JU2VQ=+Js&gt;2J)hoaNQJ
</code></pre>

<p><a href="http://pyth.herokuapp.com/?code=JU2VQ%3D%2BJs%3E2J%29hoaNQJ&amp;input=467&amp;debug=0" rel="nofollow noreferrer">Try it here</a></p>

<h3>Explanation</h3>

<pre><code>JU2VQ=+Js&gt;2J)hoaNQJ
JU2                  Set J = [0, 1].
   VQ=+Js&gt;2J)        Add the next &lt;input&gt; Fibonacci numbers.
              oaNQJ  Sort them by distance to &lt;input&gt;.
             h       Take the first.
</code></pre>
</div>
<div id="pu8" class="pu"><h2>Pyth, 27 bytes</h2>
<pre><code>J[Z1)WgQeJ=aJ+eJ@J_2)hoaNQJ
</code></pre>
<p><a href="https://pyth.herokuapp.com/?code=J%5BZ1%29WgQeJ%3DaJ%2BeJ%40J_2%29hoaNQJ&amp;test_suite=1&amp;test_suite_input=1%0A3%0A4%0A6%0A7%0A11%0A17%0A63%0A101%0A377%0A467%0A500%0A1399&amp;debug=0" rel="nofollow noreferrer"><strong>Test suite.</strong></a></p>
Python 3 translation:
<pre><code>Q=eval(input())
def a(x):
    return abs(Q-x)
J=[0,1]
while Q&gt;=J[-1]:
    J.append(J[-1]+J[-2])
print(sorted(J,key=a)[0])
</code></pre>
</div>
<div id="pu9" class="pu">

<h1><a href="https://perl6.org" rel="nofollow noreferrer">Perl¬†6</a>, 38 bytes</h1>

<pre class="lang-perl6 prettyprint-override"><code>{(0,1,*+*...*&gt;$_).sort((*-$_).abs)[0]}
</code></pre>

<p><a href="https://tio.run/##RY7PboJAEMbv8xRzwMo/kXGBLSGaXnvvzZpGYU1IEAi7Nm2MT9ZbX4zu4lr3MPntfPN9M70Ymmw8S4GfWVQWcPrGp7KrBK7HixuHFPqBH0WRv3E@vEh2g3Jdf2F4f5DeNt5dR@14UUIqXGNTt0K63u9PVHang7t8r4Kl/m11zk43X1tVgFn1pscL6Jt9i8HkLeDYDTZmsUHXqdv@rEJHfPWiVKLy8AKItURzmlW9EP/1EGU/1K064nyWVCZiVs21fot5zBVwHQn10xMEzBKD5E6oz0hNYSGmkNl2CtzSMxBZOwPidzSOFZlK2rgiyJh1pkAx3aw5MM5vaziHJHtwGscTZxQDsTyfQtOc/wE" rel="nofollow noreferrer" title="Perl 6 ‚Äì Try It Online">Test it</a></p>

<pre class="lang-perl6 prettyprint-override"><code>{   # bare block lambda with implicit parameter ÔΩ¢$_ÔΩ£

  ( # generate Fibonacci sequence

    0, 1,  # seed the sequence
    * + *  # WhateverCode lambda that generates the rest of the values
    ...    # keep generating until
    * &gt; $_ # it generates one larger than the original input
           # (that larger value is included in the sequence)

  ).sort(           # sort it by
    ( * - $_ ).abs  # the absolute difference to the original input
  )[0]              # get the first value from the sorted list
}
</code></pre>

<p>For a potential speed-up add <code>.tail(2)</code> before <code>.sort(‚Ä¶)</code>.</p>

<p>In the case of a tie, it will always return the smaller of the two values, because <code>sort</code> is a stable sort. (two values which would sort the same keep their order)</p>
</div>
<div id="pu10" class="pu"><h1>Common Lisp, 69 bytes</h1>

<pre><code>(lambda(n)(do((x 0 y)(y 1(+ x y)))((&lt; n y)(if(&lt;(- n x)(- y n))x y))))
</code></pre>

<p><a href="https://tio.run/##JUxLCoNAFLtKEErzKMI8tA6C9C62Igg6I62LmY1X19d2k4T8XvP0WQ/OMa4Y4xsJU8CVigo1GnioQj2aCurM9B5143F3Dlq1rWCItNnSb9iKvR5QPmC0Xwp7ov32y3PoGYRWZIJDFmYob5ZnESE7hK85jexYmk5ilBFE/g050g9P" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu11" class="pu"><h1><a href="https://github.com/m-ender/hexagony" rel="nofollow noreferrer">Hexagony</a>, 37 bytes</h1>

<pre><code>?\=-${&amp;"*.2}+".|'=='.@.&amp;}1.!_|._}$_}{
</code></pre>

<p><a href="https://tio.run/##y0itSEzPz6v8/98@xlZXpVpNSUvPqFZbSa9G3dZWXc9BT63WUE8xvkYvvlYlvrb6/39DQwA" rel="nofollow noreferrer" title="Hexagony ‚Äì Try It Online">Try it online!</a></p>

<p>ungolfed:</p>

<pre><code>   ? \ = - 
  $ { &amp; " * 
 . 2 } + " .
| ' = = ' . @
 . &amp; } 1 . !
  _ | . _ }
   $ _ } { 
</code></pre>

<p>Broken down:</p>

<pre><code>start:
? { 2 ' * //set up 2*target number
" ' 1     //initialize curr to 1

main loop:
} = +     //next + curr + last
" -       //test = next - (2*target)
branch: &lt;= 0 -&gt; continue; &gt; 0 -&gt; return

continue:
{ } = &amp;   //last = curr
} = &amp;     //curr = next


return:
{ } ! @   //print last
</code></pre>

<p>Like some other posters, I realized that when the midpoint of last and curr is greater than the target, the smaller of the two is the closest or tied for closest.</p>

<p>The midpoint is at (last + curr)/2. We can shorten that because next is already last + curr, and if we instead multiply our target integer by 2, we only need to check that (next - 2*target) > 0, then return last.</p>
</div>
<div id="pu12" class="pu"><h1>Taxi, 2321 bytes</h1>
<pre><code>Go to Post Office:w 1 l 1 r 1 l.Pickup a passenger going to The Babelfishery.Go to The Babelfishery:s 1 l 1 r.Pickup a passenger going to Trunkers.Go to Trunkers:n 1 l 1 l.0 is waiting at Starchild Numerology.1 is waiting at Starchild Numerology.Go to Starchild Numerology:w 1 l 2 l.Pickup a passenger going to Bird's Bench.Pickup a passenger going to Cyclone.Go to Cyclone:w 1 r 4 l.[a]Pickup a passenger going to Rob's Rest.Pickup a passenger going to Magic Eight.Go to Bird's Bench:n 1 r 2 r 1 l.Go to Rob's Rest:n.Go to Trunkers:s 1 l 1 l 1 r.Pickup a passenger going to Cyclone.Go to Cyclone:w 2 r.Pickup a passenger going to Trunkers.Pickup a passenger going to Magic Eight.Go to Zoom Zoom:n.Go to Trunkers:w 3 l.Go to Magic Eight:e 1 r.Switch to plan &quot;b&quot; if no one is waiting.Pickup a passenger going to Firemouth Grill.Go to Firemouth Grill:w 1 r.Go to Rob's Rest:w 1 l 1 r 1 l 1 r 1 r.Pickup a passenger going to Cyclone.Go to Bird's Bench:s.Pickup a passenger going to Addition Alley.Go to Cyclone:n 1 r 1 l 2 l.Pickup a passenger going to Addition Alley.Pickup a passenger going to Bird's Bench.Go to Addition Alley:n 2 r 1 r.Pickup a passenger going to Cyclone.Go to Cyclone:n 1 l 1 l.Switch to plan &quot;a&quot;.[b]Go to Trunkers:w 1 l.Pickup a passenger going to Cyclone.Go to Bird's Bench:w 1 l 1 r 1 l.Pickup a passenger going to Cyclone.Go to Rob's Rest:n.Pickup a passenger going to Cyclone.Go to Cyclone:s 1 l 1 l 2 l.Pickup a passenger going to Sunny Skies Park.Pickup a passenger going to What's The Difference.Pickup a passenger going to What's The Difference.Go to What's The Difference:n 1 l.Pickup a passenger going to Magic Eight.Go to Sunny Skies Park:e 1 r 1 l.Go to Cyclone:n 1 l.Pickup a passenger going to Sunny Skies Park.Pickup a passenger going to What's The Difference.Go to Sunny Skies Park:n 1 r.Pickup a passenger going to What's The Difference.Go to What's The Difference:n 1 r 1 l.Pickup a passenger going to Magic Eight.Go to Magic Eight:e 1 r 2 l 2 r.Switch to plan &quot;c&quot; if no one is waiting.Go to Sunny Skies Park:w 1 l 1 r.Pickup a passenger going to The Babelfishery.Go to Cyclone:n 1 l.Switch to plan &quot;d&quot;.[c]Go to Cyclone:w 1 l 2 r.[d]Pickup a passenger going to The Babelfishery.Go to The Babelfishery:s 1 l 2 r 1 r.Pickup a passenger going to Post Office.Go to Post Office:n 1 l 1 r.
</code></pre>
<p><a href="https://tio.run/##tVZNj9owEP0rIy69RYXtZXNb2u2etkVLpUpFHIzjJCOMjWxHaX49deLAJg7kA3UPECX2zLw3b2ZsQ/7i6fQiwUhYSW3gZxwjZWEOc@D2p8pnsEK6z45A4Ei0ZiJhChKJIimtfqUMlmTHeIw6ZaoInDP/c6jPHvu9qUzsmdJnL/VrKGprHnwG1JATNKUFMbA2RNEUeQQ/sgNTksukCOZjNrkQ15Zq@osB6ktU0ScNSyZo2rvxa0G5FKyOWL9VQRR8sUE2ZNtn/iZ3Nswb06Y3yitJkMIzJqmpIzUBVilUlpOT1G149xwKP@VnwYZFu0VvMVbsaaz@SHmo/rqYc3i4cGsYhqzisM7R0LRcO3IiYLabAcYgJFi4jYLphfMdFTvIzKTwopCfY3lfnbTdHLe6qn5OSW1Lz/60PUWRJSMFPHHOCk8accEwVOKem9Hd4OK1rW3YxWTKTchuAPgqklmw2W07hTA0t3oyO374tZ20umk6xfeGG1JlnQlRwHqPTMOKqH3v5t8pMRZWOZC/YRwzZTmyOywc2KtrTp2JbeyTcE3aGE4t6T86HzcwicFyvS9Z6o6EdQZaWSfVkPVbgt4YbDdI5uOO5usHfVslH0lkm5Nuu@eew72Jtv/vajFmtjSuOEH30iMueTid5g@Pj/8A" rel="nofollow noreferrer">Try it online!</a><br />
<a href="https://tio.run/##vVffT9tIEH7nrxjxUmghEHJ3UtMDqVwvFQ@lqKl00kU8rO1xPIqzm9td100Rfzs3u/6BY0KcoKoSJHF2d@ab@b6Z2VjxnR4eJjAiGYFNkD8ESoowJJDZPEANYaoMGgtW@XWSi8zC7d4ErqRZkMYIguUQEmsXZnhyEqoIpyqNe8aKcIbfw0TIKfZCNT/576Q/GAz@@J0P7/FxCecw/vrh6pqfPypn/kaxm89xTCEOc@hDyv/avff2biicZQsQsBDGIFvUMFUkp@7YV0Z1KQJMYzIJ6mWvNNf@fmgqmx32dCZnqE1tp3weyvI849nz8ZMlkdIPhJxsAqPT81MQnMZR/7zPQZ0CGcgFb2K7wsLYCh0mlEZwnc1Rq1RNGWt/q10FknVrZabOurJ0STp6ZeASZZhs3vnXkimXWDktH70fDb9V0Y@UhgNiDvvvmMoLGB3Q4TugN28O4Y6BKo3@KxfSFxWw5y9ORD49B3Tc9wtNTHDvRCVuN0J7tLQ5hE9iSiH8TdPEVmE0fXkmNeesVFex49H4UD7hvtLOFvp5Nn9n2ytvx@D@VWruX9Ygz2HwGGPj7BCLUMYsXk4/Ly5SIWE/2AeKQSpg0A1t9oqavTgvaDUKyKIWlvfAZtJG3CTmKuMK@agpraG0vi70tYaLlU5Qvu/GwAr1Hcl9H0UcrpLwPk1x2eZQ1jg6661taPvaLFyunmfPZy@IvIm77FxtusW@r@fAdXTP7AWznCfEe@YopKk59zXL5ZsjSOSuzxZimmZc50xieYLl4seF9jsXmqRlmdw@lWRnU99E4Q6zoWVmtcRfkMjHNtApgHEm5RLGM0IDN0LPNu/@JxGWobmZ9YHiGDVHii86MmFv5V4eWUfAfyV7FQ9rDxYa2aHzPPFz3HLTTkDRcJodd0WevyCbK5BrwFV@jgr9Pwtfdpff7n75VW5BTJm2TYaOZUcfXjM3nowDJ@tiTrX7RLhhLFzVC7moV47cdVHCXYXyHv6EuwLovRsf3Ec02kxL6NJNvuW97Zl7YEtl7cAi1wAnoet/nxmxzslgEzV3v2dhH/qL8LWyOHRJ4LWIIvnKgll1Eh65NWN5zsGiCMGfDrhzltHnbi1Af8d@HZM29nUjyLLxKpkuKwMu3XyHakfdQHSJocg4GBVDovIm2ZArPTMelPcr0lwszUpgJD0U/Ibcw9mCAEtYc9S8FJaCmUS3P/OavtW4a/xi6K35ESFr4Tw89Adv3/4P" rel="nofollow noreferrer">Try it online with comments!</a></p>
<p>Un-golfed with comments:</p>
<pre><code>[ Find the Fibonacci number closest to the input ]
[ Inspired by: https://codegolf.stackexchange.com/q/133365 ]


[ n = STDIN ]
Go to Post Office: west 1st left 1st right 1st left.
Pickup a passenger going to The Babelfishery.
Go to The Babelfishery: south 1st left 1st right.
Pickup a passenger going to Trunkers.
Go to Trunkers: north 1st left 1st left.


[ Initialize with F0=0 and F1=1 ]
0 is waiting at Starchild Numerology.
1 is waiting at Starchild Numerology.
Go to Starchild Numerology: west 1st left 2nd left.
Pickup a passenger going to Bird's Bench.
Pickup a passenger going to Cyclone.
Go to Cyclone: west 1st right 4th left.


[ For (i = 1; n &gt; F(i); i++) { Store F(i) at Rob's Rest and F(i-1) at Bird's Bench } ]
[a]
Pickup a passenger going to Rob's Rest.
Pickup a passenger going to Magic Eight.
Go to Bird's Bench: north 1st right 2nd right 1st left.
Go to Rob's Rest: north.
Go to Trunkers: south 1st left 1st left 1st right.
Pickup a passenger going to Cyclone.
Go to Cyclone: west 2nd right.
Pickup a passenger going to Trunkers.
Pickup a passenger going to Magic Eight.
Go to Zoom Zoom: north.
Go to Trunkers: west 3rd left.
Go to Magic Eight: east 1st right.
Switch to plan &quot;b&quot; if no one is waiting.

[ n &gt;= F(i) so iterate i ]
Pickup a passenger going to Firemouth Grill.
Go to Firemouth Grill: west 1st right.
Go to Rob's Rest: west 1st left 1st right 1st left 1st right 1st right.
Pickup a passenger going to Cyclone.
Go to Bird's Bench: south.
Pickup a passenger going to Addition Alley.
Go to Cyclone: north 1st right 1st left 2nd left.
Pickup a passenger going to Addition Alley.
Pickup a passenger going to Bird's Bench.
Go to Addition Alley: north 2nd right 1st right.
Pickup a passenger going to Cyclone.
Go to Cyclone: north 1st left 1st left.
Switch to plan &quot;a&quot;.


[b]
[ F(i) &gt; n which means n &gt;= F(i-1) and we need to figure out which is closer and print it]
Go to Trunkers: west 1st left.
Pickup a passenger going to Cyclone.
Go to Bird's Bench: west 1st left 1st right 1st left.
Pickup a passenger going to Cyclone.
Go to Rob's Rest: north.
Pickup a passenger going to Cyclone.
Go to Cyclone: south 1st left 1st left 2nd left.
Pickup a passenger going to Sunny Skies Park.
Pickup a passenger going to What's The Difference.
Pickup a passenger going to What's The Difference.
[ Passengers:n, n, F(i-1) ]
Go to What's The Difference: north 1st left.
Pickup a passenger going to Magic Eight.
[ Passengers:n, n-F(i-1) ]
Go to Sunny Skies Park: east 1st right 1st left.
Go to Cyclone: north 1st left.
Pickup a passenger going to Sunny Skies Park.
Pickup a passenger going to What's The Difference.
[ Passengers: n-F(i-1), F(i-1), F(i) ]
Go to Sunny Skies Park: north 1st right.
Pickup a passenger going to What's The Difference.
[ Passengers: n-F(i-1), F(i), n ]
Go to What's The Difference: north 1st right 1st left.
[ Passengers: n-F(i-1), F(i)-n ]
Pickup a passenger going to Magic Eight.
Go to Magic Eight: east 1st right 2nd left 2nd right.
Switch to plan &quot;c&quot; if no one is waiting.

[ If no one was waiting, then {n-F(i-1)} &lt; {F(i)-n} so we return F(i-1) ]
Go to Sunny Skies Park: west 1st left 1st right.
Pickup a passenger going to The Babelfishery.
Go to Cyclone: north 1st left.
Switch to plan &quot;d&quot;.

[c]
[ Otherwise {n-F(i-1)} &gt;= {F(i)-n} so we return F(i) ]
[ Note: If we didn't switch to plan c, we still pickup F(i) but F(i-1) will be the *first* passenger and we only pickup one at The Babelfishery ]
[ Note: Because of how Magic Eight works, we will always return F(i) in the event of a tie ]
Go to Cyclone: west 1st left 2nd right.
[d]
Pickup a passenger going to The Babelfishery.
Go to The Babelfishery: south 1st left 2nd right 1st right.
Pickup a passenger going to Post Office.
Go to Post Office: north 1st left 1st right.
</code></pre>
</div>
<div id="pu13" class="pu"><h1><a href="https://github.com/muddyfish/PYKE" rel="nofollow noreferrer">Pyke</a>, 6 bytes</h1>

<pre><code>}~F&gt;R^
</code></pre>

<p><a href="https://tio.run/##K6jMTv3/v7bOzS4o7v9/Q0MA" rel="nofollow noreferrer" title="Pyke ‚Äì Try It Online">Try it online!</a></p>

<pre><code>}      -    input*2
 ~F    -   infinite list of the fibonacci numbers
   &gt;   -  ^[:input]
    R^ - closest_to(^, input)
</code></pre>
</div>
<div id="pu14" class="pu"><h1>Python, 74 bytes</h1>



<pre class="lang-python prettyprint-override"><code>import math
r=5**.5
p=r/2+.5
lambda n:round(p**int(math.log(n*2*r,p)-1)/r)
</code></pre>

<p><a href="https://tio.run/##FY1BDoMgEADvvIIj0K26IhJNfEnbg42xmshCNvTQ11Od48xh0i9vkWxZp2c55vBeZkkjxy8tKhmzU1Zhzlt1xI8i0xqGpO@oa9ZiDylyllcWPDljKifSxHV7q1xZI0uSO8kHgoUOevCACOiht4DNKb2HrvfgmgbQDsNrFPIk8bUkWBVpXf4" rel="nofollow noreferrer" title="Python 3 ‚Äì Try It Online">Try it online!</a></p>

<h3>How it works</h3>

<p>For all <em>k</em> ‚â• 0, since |œÜ<sup>‚àí<em>k</em></sup>/‚àö5| &lt; 1/2, <em>F</em><sub><em>k</em></sub> = œÜ<sup><em>k</em></sup>/‚àö5 + œÜ<sup>‚àí<em>k</em></sup>/‚àö5 = round(œÜ<sup><em>k</em></sup>/‚àö5).  So the return value switches from <em>F</em><sub><em>k</em> ‚àí 1</sub> to <em>F</em><sub><em>k</em></sub> exactly where <em>k</em> = log<sub>œÜ</sub>(<em>n</em>‚ãÖ2‚àö5) ‚àí 1, or <em>n</em> = œÜ<sup><em>k</em> + 1</sup>/(2‚àö5), which is within 1/4 of <em>F</em><sub><em>k</em> + 1</sub>/2 = (<em>F</em><sub><em>k</em> ‚àí 1</sub> + <em>F</em><sub><em>k</em></sub>)/2.</p>
</div>
<div id="pu15" class="pu"><h2>Q/KDB+, 51 bytes</h2>

<pre><code>{w where l=min l:abs neg[x]+w:{x,sum -2#x}/[x;0 1]}
</code></pre>
</div>
<div id="pu16" class="pu"><h1><a href="https://www.microsoft.com/net/core/platform" rel="nofollow noreferrer">C# (.NET Core)</a>, <strike>63</strike> 56 bytes</h1>

<p>-1 byte thanks to @Neil</p>

<p>-6 bytes thanks to @Nevay</p>



<pre class="lang-cs prettyprint-override"><code>n=&gt;{int a=0,b=1;for(;b&lt;n;a=b-a)b+=a;return n-a&gt;b-n?b:a;}
</code></pre>

<p><a href="https://tio.run/##dc2xCsIwGATgvU@RscVWDC0tNU0dBCedHJz/xFgC9Q8mqSClzx7rbpbj4OM46QpprAqT0ziQ68d59WSJHME58poT58FrSd5G38kFNKbZnJwmlJ1Gn5M1ejLwgLyf106A73LBKXsYmzLRIQMuCsjEhgOzyk8WCRbQiwIPYg9sCSw5GnRmVNub1V6dNap0SGmW/YcyBlUM6hjQJjqJvpRNdFTVUaJl2/5sWcIX" rel="nofollow noreferrer" title="C# (.NET Core) ‚Äì Try It Online">Try it online!</a></p>
</div>
<div id="pu17" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 103 bytes</h1>

<pre class="lang-python prettyprint-override"><code>import math
def f(n):d=5**.5;p=.5+d/2;l=p**int(math.log(d*n,p))/d;L=[l,p*l];return round(L[2*n&gt;sum(L)])
</code></pre>
<p><a href="https://tio.run/##FY5BDoMgEEXX7SkmroBOVVRq1NgTeAPjognSkigQioue3sLiv8n8@T8Z9wsfa@rz1LuzPsD@Cp@rXBUoYmgvR8FYLgY35uImi2rYRseYNoGkXL7ZN5HMoKO0kMM0zhs6ti2DX8PhDXh7GEmmuWLm@T12MtGFnsp60KANzByhRmgQHggtAo87j7OKapIbj20ZlfwygTcJIiFW6jYFHxGijDFed93SXy/Op/c0ZvdnhopoSs8/" rel="nofollow noreferrer" title="Python 3 ‚Äì Try It Online">Try it online!</a></p>
<p>Sadly, had to use a def instead of lambda... There's probably much room for improvement here.</p>
<p>Original (incorrect) answer:</p>
<h1><s> <a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 72 bytes</s></h1>

<pre class="lang-python prettyprint-override"><code>lambda n:r(p**r(math.log(d*n,p))/d)
import math
d=5**.5
p=.5+d/2
r=round
</code></pre>
<p><a href="https://tio.run/##FYnBDoMgEAXP5Ss2noBurVTRaEJ/pO3BhlhJFMiGHvr1FC/vZWbiL63Bt3kxz7zN@9vO4CfiUUri@5zWegsfbqXHKMTVCub2GCjBkZg1Wspas2hqfbbXGyND4ettXgKBA@fhoRBahA6hRxgQVGFVvi9SNUccCnV9Gd00xbXj@JrYKZLziTusLvcKF@6EyH8" rel="nofollow noreferrer" title="Python 3 ‚Äì Try It Online">Try it online!</a></p>
<p>My first PPCG submission. Instead of either calculating Fibonacci numbers recursively or having them predefined, this code uses how the n-th Fibonacci number is the nearest integer to the n-th power of the golden ratio divided by the root of 5.</p>
</div>
<div id="pu18" class="pu"><h1><a href="http://openjdk.java.net/" rel="nofollow noreferrer">Java (OpenJDK 8)</a>, <s>60</s> <s>57</s> 56 bytes</h1>



<pre class="lang-java prettyprint-override"><code>c-&gt;{int s=1,r=2;for(;c&gt;r;s=r-s)r+=s;return c-s&gt;r-c?r:s;}
</code></pre>

<p><a href="https://tio.run/##RY8xb8IwEIV3fsWNiepESaEgYoVOHTpUDKhT1cF1HGoaztH5goQQvz09Cm3fcL57lv2@25mDyULvcNd8jf3w0XkLtjMxwovxCKcJiCIbFr/1aDrYyYt8YN/l7YCWfcD8GfkVDR3XvSPDgQChHm22OnlkiHWpqL7XbaBE2xXpWFMWU7qroybHAyHYLK4os49URX0e9U/mjeUWfQi@gb0QJRsmj9u3dzC0jekN8KJ/rsjkzP5Ctbl2oU1KBVMFMwVzBQsFpcylnHMxy@JyuZBpNpfyUBTiTZfL9O/rX@V70yeY5rLKk7Gfa2ocuSbZHCM7SRm4qnqh4w7T6xLnyXkyfgM" rel="nofollow noreferrer" title="Java (OpenJDK 8) ‚Äì Try It Online">Try it online!</a></p>

<p>-1 byte thanks to @Neil</p>
</div>
<div id="pu19" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python</a>, <s>55</s> 52 bytes</h1>



<pre class="lang-python prettyprint-override"><code>f=lambda x,a=1,b=1:[a,b][b-x&lt;x-a]*(b&gt;x)or f(x,b,a+b)
</code></pre>

<p><a href="https://tio.run/##FcqxDoIwFEDR/X3FG6mWhCdIAxE3XF3cCEOrJZAgNKXE8vUVxntzzOb6ebqE0FWj/KqPRM9lRVxVVDaSq7ZRsb/5WLanSN09my12keeKy7NiwdmtBMRfP4waX3bVRyEaO0xud8NkVhcxBtq/tXFYPx@1tbM9lJHLEghSyCAHAURAAvIUKNmnEJDlAq5JApQWxR8" rel="nofollow noreferrer" title="Python 2 ‚Äì Try It Online">Try it online!</a></p>
</div>
<div id="pu20" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, <s>86</s> <s>85</s> <s>83</s> 76 bytes</h1>



<pre class="lang-c prettyprint-override"><code>f(n){n=n&lt;2?:f(n-1)+f(n-2);}i,j,k;g(n){for(;k&lt;n;j=k,k=f(i++));n=k-n&lt;n-j?k:j;}
</code></pre>

<p><a href="https://tio.run/##ZdDRboMgFAbge5/CNFkCERKOKMyi64vsZnHRKBldTO8an92CZdiBFxzFT/zP6enY99s2IIPvpjNteTnbewq4cKXEap3ITLQaHRiuC1K6NWruNNHdgKaiwFiZTlPTGjpf9HlW6/bzNRmEs3uW2@t3mcxtQCdwD/Qjh/zt@9OcyIjAfvqPcE94IDwmVSDXJa/dwomtf76KvfD@ICIm0pP3QGRMAHz2Ixkk6UEGZGOV4Faw6cqXjpOTBff5XgImTQODZ8LmOIml05PyORpbw/xk8sdKpMzuxaxmbGcCWGB2L4nGm2Zvum72OR4B7QuH12x7AA" rel="nofollow noreferrer" title="C (gcc) ‚Äì Try It Online">Try it online!</a></p>
</div>
<div id="pu21" class="pu"><h1>x86-64 Machine Code, 24 bytes</h1>
<pre><code>31 C0 8D 50 01 92 01 C2 39 FA 7E F9 89 D1 29 FA 29 C7 39 D7 0F 4F C1 C3
</code></pre>
<p>The above bytes of code define a function in 64-bit x86 machine code that finds the closest Fibonacci number to the specified input value, <code>n</code>.</p>
<p>The function follows the <a href="https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI" rel="nofollow noreferrer">System V AMD64 calling convention</a> (standard on Gnu/Unix systems), such that the sole parameter (<code>n</code>) is passed in the <code>EDI</code> register, and the result is returned in the <code>EAX</code> register.</p>
<p><strong>Ungolfed assembly mnemonics:</strong></p>
<pre><code>; unsigned int ClosestFibonacci(unsigned int n);
    xor    eax, eax        ; initialize EAX to 0
    lea    edx, [rax+1]    ; initialize EDX to 1

  CalcFib:
    xchg   eax, edx        ; swap EAX and EDX
    add    edx, eax        ; EDX += EAX
    cmp    edx, edi
    jle    CalcFib         ; keep looping until we find a Fibonacci number &gt; n

    mov    ecx, edx        ; temporary copy of EDX, because we 'bout to clobber it
    sub    edx, edi
    sub    edi, eax
    cmp    edi, edx
    cmovg  eax, ecx        ; EAX = (n-EAX &gt; EDX-n) ? EDX : EAX
    ret
</code></pre>
<p><strong><a href="https://tio.run/##dVDRaoMwFH33K4JjoFJHbGxU3ApD508se5BobaCNQ@MIjP363E3b9SkJhJOce87l3MvjgfN15aOcFeLHdkI6p9XY9e8f6AX5TJOE6QoznddM7wAx/IvtFStAUjDdvDKdvQHCO4dbQ2174w1W2VVXA@KG6RRuZfzEL71ZtUpwtMhZDLLvUBBBgkbLMPinQkhyS1WuD0Ly09L16HlWnRifjnvPE1KhcytkYB7tNPDNZZQoMp@v0Pv2EJzPCcqHwL@2D5KQqXjP1GPHpL9BdzYsbWpiVROHOrWqU4eaWtXUoc6s6syhThxjuuZM7O0TV39qXwx1bSbBjkDYufnMHsnwju1Tu8PwdscOY6vD8I45SFHYBzEF8FxMU6@WSSJcej/rLz@c2mFe4zNN/wA" rel="nofollow noreferrer" title="C (gcc) ‚Äì Try It Online">Try it online!</a></strong></p>
<p>The code basically divides up into three parts:</p>
<ul>
<li><p>The first part is very simple: it just initializes our working registers. <code>EAX</code> is set to 0, and <code>EDX</code> is set to 1.</p>
</li>
<li><p>The next part is a loop that iteratively calculates the Fibonacci numbers on either side of the input value, <code>n</code>. This code is based on <a href="https://codegolf.stackexchange.com/questions/131513/fibtraction-fibonacci-but-with-subtraction/131706#131706">my previous implementation of Fibonacci with subtraction</a>, but‚Ä¶um‚Ä¶isn't with subtraction. :-) In particular, it uses the same trick of calculating the Fibonacci number using two variables‚Äîhere, these are the <code>EAX</code> and <code>EDX</code> registers. This approach is <em>extremely</em> convenient here, because it gives us adjacent Fibonacci numbers. The candidate potentially <em>less than</em> <code>n</code> is held in <code>EAX</code>, while the candidate potentially <em>greater than</em> <code>n</code> is held in <code>EDX</code>. I'm quite proud of how tight I was able to make the code inside of this loop (and even more tickled that I re-discovered it independently, and only later realized how similar it was to the subtraction answer linked above).</p>
</li>
<li><p>Once we have the candidate Fibonacci values available in <code>EAX</code> and <code>EDX</code>, it is a conceptually simple matter of figuring out which one is closer (in terms of absolute value) to <code>n</code>. Actually taking an absolute value would cost <em>way</em> too many bytes, so we just do a series of subtractions. The comment out to the right of the penultimate conditional-move instruction aptly explains the logic here. This either moves <code>EDX</code> into <code>EAX</code>, or leaves <code>EAX</code> alone, so that when the function <code>RET</code>urns, the closest Fibonacci number is returned in <code>EAX</code>.</p>
</li>
</ul>
<p>In the case of a tie, the <em>smaller</em> of the two candidate values is returned, since we've used <code>CMOVG</code> instead of <code>CMOVGE</code> to do the selection. It is a trivial change, if you'd prefer the other behavior. Returning <em>both</em> values is a non-starter, though; only one integer result, please!</p>
</div>
<div id="pu22" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, <s>70</s> <s>67</s> <s>64</s> <s>62</s> 60 bytes</h1>
<p><em>-2 bytes thanks to djhurio!</em></p>
<p><em>-2 more bytes thanks to djhurio</em>
(boy can he golf!)</p>

<pre class="lang-r prettyprint-override"><code>F=1:0;while(F&lt;1e8)F=c(F[1]+F[2],F);F[order((F-scan())^2)][1]
</code></pre>
<p>Since we only have to handle values up to <code>10^8</code>, this works.</p>
<p><a href="https://tio.run/##K/r/383W0MrAOs@2ODkxT0PTujwjMydVI8/OTdPNNlnDLdowVtst2ihWx03T2i06vygltUhDw003TzPOSDMWKPnf2Nz8PwA" rel="nofollow noreferrer" title="R ‚Äì Try It Online">Try it online!</a></p>
<p>Reads <code>n</code> from stdin. the <code>while</code> loop generates the fibonacci numbers in <code>F</code> (in decreasing order); in the event of a tie, the larger is returned. This will trigger a number of warnings because <code>while(F&lt;1e8)</code> only evaluates the statement for the first element of <code>F</code> with a warning</p>
<p>Originally I used <code>F[which.min(abs(F-n))]</code>, the naive approach, but @djhurio suggested <code>(F-n)^2</code> since the ordering will be equivalent, and <code>order</code> instead of <code>which.min</code>. <code>order</code> returns a permutation of indices to put its input into increasing order, though, so we need <code>[1]</code> at the end to get only the first value.</p>
<h3>faster version:</h3>
<pre class="lang-r prettyprint-override"><code>F=1:0;n=scan();while(n&gt;F)F=c(sum(F),F[1]);F[order((F-n)^2)][‚Äå‚Äã1]
</code></pre>
<p>only stores the last two fibonacci numbers</p>
</div>
<div id="pu23" class="pu"><h1><a href="https://docs.python.org/2/" rel="noreferrer">Python 2</a>, 43 bytes</h1>



<pre class="lang-python prettyprint-override"><code>f=lambda n,a=0,b=1:a*(2*n&lt;a+b)or f(n,b,a+b)
</code></pre>

<p><a href="https://tio.run/##dZAxa8MwEIV3/4ojEJAapdihU1oP6VDo0KlDCyGEsy0lwsrZyDZNfr0rKQ52A/Vine7dd3qvvrTHilZ9r1KDp6xAIIFpLLI0WeMDWz3QCy4yXllQjEQmfNEXUoHStmn3SmcNK/k6AjDpdud@bvjZDbuTckN70AQW6SAHldM9Yl1LKhjyUKPbFbiusrLtLIGJorf3109Ip1ueYh5FfnN@lHm5J4lWXntMCaBAzw3qkyxuTQ9gxCeNQodbQAe8Fy8hSL2HvO3QTCgnTcy/SJTycsupXHtIuSTOx5GB7zt3kJE@mPz7pHRK8LrRqeoo9xY/Nt9pErsvWPXp0phuEvqLZAjZreyMf8k/YQWRVkBVO2ivcwC11dTC7MtWdACk5kdamDdh3byZwRyYj1QMCIDMSizdWZpGXhkDYWMM5JW1Mm9n3tD1esvOQrEz54F4nhpI4oTvoqln3v8C" rel="noreferrer" title="Python 2 ‚Äì Try It Online">Try it online!</a></p>

<p>Iterates through pairs of consecutive Fibonacci numbers <code>(a,b)</code> until it reaches one where the input <code>n</code> is less than their midpoint <code>(a+b)/2</code>, then returns <code>a</code>.</p>

<p>Written as a program (47 bytes):</p>

<pre class="lang-python prettyprint-override"><code>n=input()
a=b=1
while 2*n&gt;a+b:a,b=b,a+b
print a
</code></pre>

<p><a href="https://tio.run/##dZAxa8MwEIV3/4ojEJAapbFDpxQP6VDo0KlDCyEEyZYSYeVsZJsmv96VZAe7gXixpHv33b1XXZtTieuuU6nhZ5FzQMbTmIk02YjVeoVPRCw5LS0ogkwwvhC0y6UCpW3dHJQWNSnoJgIw6W7vfq751TW7k3JNB9AIluNRDiqne@ZVJTEnnIY7d7MC192sbFqLYKLo/ePtC9LplJeYRpGfnJ1kVhxQciv7GlEMMNAzw/VZ5reiBxCkk0KuwytwB7wXLyFIvYesabmZUM4aid@IFfJ6y6nYeEixRErHloHvK3eQkT6Y/L9SOiV43ehUtZh5i5/bnzSJ3Res@nRxTDcJ9UUyhOxGtsZv8iCsINIKsGwGbd8HUFmNDcy@bYlH4Fj/SgvzOoyb1zOYA/GRsgEBIKzkhTtLU8ueMRC2xkBWWiuzZuYN9c87cmGKXCgNxMvUQBIndB9NPdPuDw" rel="noreferrer">Same length</a>:</p>

<pre class="lang-python prettyprint-override"><code>f=lambda n,a=0,b=1:b/2/n*(b-a)or f(n,b,a+b)
</code></pre>
</div>
<div id="pu24" class="pu"><h1>dc, 52 bytes</h1>

<pre><code>si1d[dsf+lfrdli&gt;F]dsFxli-rlir-sdd[lild-pq]sDld&lt;Dli+p
</code></pre>

<p><a href="https://tio.run/##S0n@b2xqgAn@F2capkSnFKdp56QVpeRk2rnFphS7VeRk6hblZBbpFqekROdk5qToFhTGFrvkpNi45GRqF/z/DwA" rel="nofollow noreferrer" title="dc ‚Äì Try It Online">Try it online!</a></p>

<p><strike>Takes input at run using <code>?</code></strike></p>

<p>Edited to assume top of stack as input value, -1 byte.</p>

<p>Input is stored in register <code>i</code>. Then we put 1 and 1 on the stack to start the Fibonacci sequence, and we generate the sequence until we hit a value greater than <code>i</code>. At this point we have two numbers in the Fibonacci sequence on the stack: one that is less than or equal to <code>i</code>, and one that is greater than <code>i</code>. We convert these into their respective differences with <code>i</code> and then compare the differences. Finally we reconstruct the Fibonacci number by either adding or subtracting the difference to <code>i</code>.</p>

<p>Oops, I was loading two registers in the wrong order and then swapping them, wasting a byte.</p>
</div>
<div id="pu25" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>9</s> 7 bytes</h1>

<p>-2 bytes thanks to @EriktheOutgolfer</p>

<pre><code>‚ÄòR√Ü·∏û·∫°√ê·πÇ
</code></pre>

<p><a href="https://tio.run/##y0rNyan8//9Rw4ygw20Pd8x7uGvh4QkPdzb9P9x@dNLDnTNUHjWtifz/P9pQh8tYh8tEh8tMh8tch8sQyDcE0mZAQUMDkKQ5kGdiBiRMDQyAYsaWlrEA" rel="nofollow noreferrer" title="Jelly ‚Äì Try It Online">Try it online!</a></p>

<p>Golfing tips welcome :).  Takes an int for input and returns an int-list.</p>

<pre><code>            ' input -&gt; 4
‚Äò           ' increment -&gt; 5
 R          ' range -&gt; [1,2,3,4,5]
  √Ü·∏û        ' fibonacci (vectorizes) -&gt; [1,1,2,3,5,8]
     √ê·πÇ     ' filter and keep the minimum by:
    ·∫°       ' absolute difference -&gt; [3,3,2,1,1,4]
            ' after filter -&gt; [3,5]
</code></pre>
</div>
<div id="pu26" class="pu"><h2>JavaScript (ES6), 41 bytes</h2>

<p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>f=(n,x=0,y=1)=&gt;y&lt;n?f(n,y,x+y):y-n&gt;n-x?x:y</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;input type=number min=0 value=0 oninput=o.textContent=f(this.value)&gt;&lt;pre id=o&gt;0</code></pre>
</div>
</div>
</p>

<p>Rounds up by preference.</p>
</div>
<div id="pu27" class="pu"><h1><a href="https://babeljs.io/" rel="nofollow noreferrer">JavaScript (Babel Node)</a>, 41 bytes</h1>



<pre class="lang-javascript prettyprint-override"><code>f=(n,i=1,j=1)=&gt;j&lt;n?f(n,j,j+i):j-n&gt;n-i?i:j
</code></pre>

<p>Based on <a href="https://codegolf.stackexchange.com/a/133381/53880">ovs's awesome Python answer</a></p>

<p><a href="https://tio.run/##DchRCoAgDADQ6zhygV@BpJ5FTWNDZmR0fet9Po5vHPmm68EUU2ko/ShzVqdEkzOanQHneZdQ/2HNC4FlFC9IgSzP3GX0VtbWT1WV2QDmBw" rel="nofollow noreferrer" title="JavaScript (Babel Node) ‚Äì Try It Online">Try it online!</a></p>

<h3>Ungolfed</h3>

<pre class="lang-javascript prettyprint-override"><code>f=(n,i=1,j=1)=&gt; // Function f: n is the input, i and j are the most recent two Fibonacci numbers, initially 1, 1
 j&lt;n?           // If j is still less than n
  f(n,j,j+i)    //  Try again with the next two Fibonacci numbers
 :              // Else:
  j-n&gt;n-i?i:j   //  If n is closer to i, return i, else return j
</code></pre>
</div>
<div id="pu28" class="pu"><h1>Java 7, <s>244</s> 234 Bytes</h1>

<pre><code> String c(int c){for(int i=1;;i++){int r=f(i);int s=f(i-1);if(r&gt;c &amp;&amp; s&lt;c){if(c-s == r-c)return ""+r+","+s;else if(s-c &gt; r-c)return ""+r;return ""+s;}}} int f(int i){if(i&lt;1)return 0;else if(i==1)return 1;else return f(i-2)+f(i-1);}
</code></pre>
</div>
<div id="pu29" class="pu"><h2>JavaScript (ES6), 67 bytes</h2>

<pre class="lang-js prettyprint-override"><code>f=(n,k,y)=&gt;(g=k=&gt;x=k&gt;1?g(--k)+g(--k):k)(k)&gt;n?x+y&gt;2*n?y:x:f(n,-~k,x)
</code></pre>

<h3>Test cases</h3>

<p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-js lang-js prettyprint-override"><code>f=(n,k,y)=&gt;(g=k=&gt;x=k&gt;1?g(--k)+g(--k):k)(k)&gt;n?x+y&gt;2*n?y:x:f(n,-~k,x)

console.log(f(1   )) // -&gt; 1
console.log(f(3   )) // -&gt; 3
console.log(f(4   )) // -&gt; 3 or 5 or 3, 5
console.log(f(6   )) // -&gt; 5
console.log(f(7   )) // -&gt; 8
console.log(f(11  )) // -&gt; 13
console.log(f(17  )) // -&gt; 13 or 21 or 13, 21
console.log(f(63  )) // -&gt; 55
console.log(f(101 )) // -&gt; 89
console.log(f(377 )) // -&gt; 377
console.log(f(467 )) // -&gt; 377
console.log(f(500 )) // -&gt; 610
console.log(f(1399)) // -&gt; 1597</code></pre>
</div>
</div>
</p>
</div>
<div id="pu30" class="pu"><h1><a href="https://github.com/TryItOnline/TioSetup/wiki/Powershell" rel="nofollow noreferrer">PowerShell</a>, <s>80</s> 74 bytes</h1>



<pre class="lang-powershell prettyprint-override"><code>param($n)for($a,$b=1,0;$a-lt$n;$a,$b=$b,($a+$b)){}($b,$a)[($b-$n-gt$n-$a)]
</code></pre>

<p>(Try it online! temporarily unresponsive)</p>

<p>Iterative solution. Takes input <code>$n</code>, sets <code>$a,$b</code> to be <code>1,0</code>, and then loops with Fibonacci until <code>$a</code> is larger than the input. At that point, we index into <code>($b,$a)</code> based on Boolean of whether the difference between the first element and <code>$n</code> is greater than between <code>$n</code> and the second element. That's left on the pipeline, output is implicit.</p>
</div>
<div id="pu31" class="pu"><h1><a href="https://github.com/okx-code/Neim" rel="noreferrer">Neim</a>, 5 bytes</h1>

<pre><code>fùêñùïñSùïî
</code></pre>

<p>Explanation:</p>

<pre><code>f       Push infinite Fibonacci list
 ùêñ                     93
  ùïñ     Select the first ^ elements
        This is the maximum amount of elements we can get before the values overflow
        which means the largest value we support is 7,540,113,804,746,346,429
   Sùïî   Closest value to the input in the list
</code></pre>

<p>In the newest version of Neim, this can be golfed to 3 bytes:</p>

<pre><code>fSùïî
</code></pre>

<p>As infinite lists have been reworked to only go up to their maximum value.</p>

<p><a href="https://tio.run/##y0vNzP3/P@3D3AnTPsydOi0YSEz5/9/QHAA" rel="noreferrer" title="Neim ‚Äì Try It Online">Try it online!</a></p>
</div>
<div id="pu32" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E" rel="nofollow noreferrer">05AB1E</a>, 6 bytes</h1>

<pre><code>n√ÖFs.x
</code></pre>

<p><a href="https://tio.run/##MzBNTDJM/f8/73CrW7Fexf//JgA" rel="nofollow noreferrer" title="05AB1E ‚Äì Try It Online">Try it online!</a></p>
</div>
<div id="pu33" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 84 bytes</h1>



<pre class="lang-python prettyprint-override"><code>lambda k:min(map(f,range(2*k)),key=lambda n:abs(n-k))
f=lambda i:i&lt;3or f(i-1)+f(i-2)
</code></pre>

<p><a href="https://tio.run/##NcpBDsIgEIXhfU8xy0GnC4qxCbEnURc0FpwgU4Ld9PSIia5e/i8v79tzFVPDdKsvl@aHg2gTCyaX0VNxEhYcDlEpiss@/S5i3fxG6Rt3/o9s@WLWAh651@r4nUFV34SBBa6awBCcCM4EI4Furce77SAXlg2ZICArVT8" rel="nofollow noreferrer" title="Python 3 ‚Äì Try It Online">Try it online!</a></p>

<p>It may work, but it's certainly not fast...</p>

<p>Outputs <code>True</code> instead of  <code>1</code>, but in Python these are equivalent.</p>
</div>
<div id="pu34" class="pu"><h1>Mathematica, 30 bytes</h1>
<pre><code>Array[Fibonacci,2#]~Nearest~#&amp;
</code></pre>
<p><a href="https://tio.run/##y00sychMLv6fZvvfsagosTLaLTMpPy8xOTlTx0g5ts4vNbEotbikTlntf0BRZl6JgkOagoOhsaXlfwA" rel="nofollow noreferrer" title="Mathics ‚Äì Try It Online">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/133365/">133365</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




