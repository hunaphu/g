<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::278037</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>620</td><td>C gcc</td><td>250207T162136Z</td><td><a href="https://codegolf.stackexchange.com/questions/278037/card-jitsu-part-2-make-a-card-jitsu-clone/278128#278128">Weird Gl</a></td></tr>
<tr d-ix="1"><td>360</td><td>JavaScript V8</td><td>250208T181607Z</td><td><a href="https://codegolf.stackexchange.com/questions/278037/card-jitsu-part-2-make-a-card-jitsu-clone/278143#278143">Arnauld</a></td></tr>
<tr d-ix="2"><td>449</td><td>APLNARS</td><td>250209T093728Z</td><td><a href="https://codegolf.stackexchange.com/questions/278037/card-jitsu-part-2-make-a-card-jitsu-clone/278159#278159">Rosario</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, <s>715</s> <s>685</s> <s>632</s> <s>627</s> 620 bytes</h1>

<pre class="lang-c prettyprint-override"><code>#define y(x);}x(l,n)int*l;{
#define P;printf(
u,v=11,h[5],a[99],b[99],A,B,i,j,k,I,J,K,c,d;o(n){P&quot;%c%c%d&quot;,&quot;FWS&quot;[n/u],&quot;ROYGBP&quot;[n/v%6],n%v+2)y(O)for(i=0 P i&lt;n?&quot;,&quot;+!i:&quot; \n&quot;)-2;)o(l[i++])y(R)k=n?R(l+1,n-1),k^*l?k:-1:rand()%198;}r(n){for(h[n]=-1;R(h,5),h[n]&lt;0;h[n]=k)u=66 y(z)for(i=n;i--;)for(I=l[j=i]/v;J=l[j]/v,K=l[n-1]/v,j++&lt;n;u*=I%6==J%6|I%6==K%6|J%6==K%6||c|d&amp;&amp;!c|c==d|!d)c=I/6-J/6,d=K/6-J/6;}main(w){for(srand(&amp;w);i&lt;5;)r(i++);for(;u;z(b,B)){j=h[J=getchar()-49];R(0,0);K=j%v-k%v;I=j/u^k/u?j/u-(k/u+2)%3?1:-1:(K&gt;0)-(K&lt;0);O(a,A);O(b,B);O(h,5)P&quot;%d\n&quot;,J+1);o(j)P&quot;\n&quot;);o(k)P&quot;\n%d\n&quot;,I);I&gt;0?a[A++]=j:I?b[B++]=k:0;r(J);z(a,A);}}
</code></pre>
<p><a href="https://tio.run/##nZHbjpswEIbv9ykSKlaeMBawbVATx4uSi1bARaL0oqooKxFINhzqVHRhD0mePR2T7gvUSJ5vZvB4/E/GH7PscvmQb3eF2g5e2QuI8wurUUGhnka1ON6851bid0OxHbtpsZOui/t4nGAaTyYJbvp9jgsssMQKAwwxwgxzcWAKjivDzOjLDTS@fP9mxMpuEzTWyx9fFyvtdaaXoDI76w5e2RJ2h4YV0hmsBsVM@XTIGhZTY/BTGcDvBBxYHReWldC/a6ik8testlxU3AWsHka1X025O21SlTMw3clncW50E7rqPlaJ5K5Ysz2OAbU7c0QfraCVnkcKvP27X4mCc9E7gazjUhaJ3YlQIwFGBHSlxtKyZkq0IxmYnpSh6Z16iAjCdzhlp/z2dpidMinz0zCHTAa2x0Pbw1xGVxLnX2mh2PO11z/9C26fQRSzsQBqybJA6IxoxRvb4ALgWMp9HMrH7VO2TxsG/NMkocc56ICIZGl2vDI7EcjSbh8qu/XJckZAQpsffVfrxKJ7BziLZnRkyVKca6OLk9Ei0exyUh5DywWaZkkBPQjCqsdrNgAR3Dt@Gs9pMLKcBv4mXmispo5oWAjUcV/7fL5c3P9bfwE" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<p><em><s>-53</s> <s>-58</s> -65 bytes thanks to ceilingcat, really nice :)</em></p>
<p>This C version was written in order to check that the challenge was able to be solved even without using a modern programming language. This was pretty fun to make actually, since it was my first answer written in C. This answer was originally posted in order to announce a bounty for the first sub 500-bytes answer (<a href="https://codegolf.stackexchange.com/a/278143/126257">Awarded to Arnauld for his JavaScript anwser</a>).</p>
<p>A small explanation of this code:</p>
<ul>
<li><code>u</code> and <code>v</code> are constants (<code>u</code> is also used as the checking boolean at the end of a round in order to check if the game is finished)</li>
<li><code>h</code> is the hand (5 cards chosen randomly with <code>r()</code>), <code>a</code> and <code>b</code> are the winning piles for Player 1 and 2, <code>A</code> and <code>B</code> are the number of cards in each pile, and the other variables are used as temporary values</li>
<li><code>o()</code> prints a single card, <code>O()</code> prints a list of cards, <code>R()</code> generates a random card and checks recursively if the card is contained within l, adds -1 to the list otherwise, <code>r()</code> chooses a new random card for the hand, added at position n, by using <code>R()</code> until the value is a positive number, and <code>z()</code> modifies <code>u</code> if the game is finished</li>
<li>The main program retrieves the two cards chosen by each player, calculates the winner for this round, prints the required lines, adds a new card to the hand, and checks if the game is finished using both <code>a</code> and <code>b</code></li>
</ul>
</div>
<div id="pu1" class="pu"><h1><a href="https://v8.dev/" rel="nofollow noreferrer">JavaScript (V8)</a>, 360 bytes</h1>
<p>Expects an array of user inputs. Uses <code>1</code>/<code>2</code> to show the winning player.</p>

<pre class="lang-none prettyprint-override"><code>a=&gt;a.some(n=&gt;print([...h.map(a=&gt;a.map(g)),n--,g(x=h[2][n],h[2][n]=c(g[x]=g)),g(y=R(V=v)),w=(x-y)%3*11&gt;&gt;2&amp;3||2*(V&lt;v)|V&gt;v].join`
`)|w&amp;&amp;(a=h[--w]).push(z=w?y:x)*a.some(x=&gt;a.some(y=&gt;(F=i=&gt;new Set(g(x)[i]+g(y)[i]+g(z)[i]).size)(1)&gt;2&amp;F(0))),g=n=&gt;E[n%3]+&quot;YORBGP&quot;[n/3%6|0]+(v=n/18+2|0),h=[[],[],[...E=&quot;FWS00&quot;].map(c=_=&gt;1/g[i=(R=_=&gt;Math.random()*198|0)()]?c():g[i]=i)])
</code></pre>
<p><a href="https://tio.run/##hVDbasJAEH3vVxRBmUk2ay5tsdKJUNA@lRYFS1mWGtKYrOAaTJqL5N/tRqSvhR3OGXZmzpnZRVVUxEeVl041OW/pHFEY8eKwT0BTmB@VLkFwzjO@j3K4fPYkRWTacVgKDWXCl0JLdkWKIRWNpL4khZaWsKbK8JqgcVocBpbnhaE/CrrOt2D9VGG3DivJdwelNzcb7OrRyAhlwnFqiTz/KTI4UT1rpw1aV2vNn8mWQliQolAn9e0qKcE4QqGkbaSveOoReaFOCYKHRnoBLvbuyKw4F3oYSHvw@bZ8fnkfCD0Ohg@dK22oSI@9ie13LrKMhJCsf@YWcxosPlauO5CXW8T0RaE3ToUiWPb8NSozfoz092EPaHmPEzMBUM5iwKmpkqRQ4nkLwmM@C9gduzcRGP5vbtp@AQ" rel="nofollow noreferrer" title="JavaScript (V8) – Try It Online">Try it online!</a></p>
<h2>Functions and variables</h2>
<p><code>R</code> is a helper function that returns a random card in <span class="math-container">\$[0\dots198]\$</span>:</p>
<pre class="lang-none prettyprint-override"><code>R = _ =&gt; Math.random() * 198 | 0
</code></pre>
<p><code>c</code> is a helper function that returns a random card for the player, using the underlying object of <code>g</code> to make sure that no duplicate card is selected:</p>
<pre class="lang-none prettyprint-override"><code>c = _ =&gt; 1 / g[i = R()] ? c() : g[i] = i
</code></pre>
<p><code>g</code> is a helper function that converts a card index into its textual representation and saves its value in the global variable <code>v</code>:</p>
<pre class="lang-none prettyprint-override"><code>g = n =&gt; E[n % 3] + &quot;YORBGP&quot;[n / 3 % 6 | 0] + (v = n / 18 + 2 | 0)
</code></pre>
<p>where <code>E = &quot;FWS00&quot;</code> (we obviously only need <code>&quot;FSW&quot;</code>, but <code>E</code> is used elsewhere to get an array of 5 entries).</p>
<p><code>h[]</code> is an array containing:</p>
<ul>
<li>the winning cards of player 1 (initially empty)</li>
<li>the winning cards of player 2 (initially empty)</li>
<li>the hand of player 1 (always filled with 5 distinct card indices)</li>
</ul>
<h3>Main algorithm</h3>
<p>At each iteration:</p>
<ul>
<li><p>We pick the card <code>x</code> with value <code>V</code> played by the player.</p>
</li>
<li><p>The selected card is freed by doing <code>g[x] = g</code>.</p>
</li>
<li><p>We replace it with a new card in the player's hand.</p>
</li>
<li><p>We pick a random card <code>y</code> with value <code>v</code> for the computer.</p>
</li>
<li><p>We set the winning variable <code>w</code> to <span class="math-container">\$0\$</span>, <span class="math-container">\$1\$</span> or <span class="math-container">\$2\$</span> with:</p>
<pre class="lang-none prettyprint-override"><code>w = (x - y) % 3 * 11 &gt;&gt; 2 &amp; 3 // by element
    || 2 * (V &lt; v) | V &gt; v    // by value
</code></pre>
</li>
<li><p>If this is not a tie:</p>
<ul>
<li><p>we add the winning card <code>z</code> to the relevant winning cards array <code>a[]</code>:</p>
<pre class="lang-none prettyprint-override"><code>(a = h[--w]).push(z = w ? y : x)
</code></pre>
</li>
<li><p>we check whether there exists 2 other cards <code>x</code>, <code>y</code> in <code>a[]</code> so that <code>(x,y,z)</code> meets the conditions for winning the whole game:</p>
<pre class="lang-none prettyprint-override"><code>a.some(x =&gt;       // for each card x in a[]:
  a.some(y =&gt;     //   for each card y in a[]:
    ( F = i =&gt;    //     F is a helper function taking i:
      new Set(    //       build a set by splitting this string:
        g(x)[i] + //         either the element or the color of x
        g(y)[i] + //         either the element or the color of y
        g(z)[i]   //         either the element or the color of z
      ).size      //       return the size of the set
    )(1) &gt; 2      //     invoke F for the color (must be 3)
    &amp; F(0)        //     invoke F for the element (must be odd)
  )               //   end of inner some()
)                 // end of outer some()
</code></pre>
</li>
</ul>
</li>
</ul>
</div>
<div id="pu2" class="pu"><h1>APL(NARS), 449 chars</h1>
<pre><code>r←h;g;p;l;m;x;t;a;s;d;w
l←≢m←,(0..2)∘.,(0..5)∘.,2..12⋄a←0
t←m[x←?l]⋄m[x]←m[r←?l]⋄m[r]←t⋄→2×⍳l≥a+←1⋄g←p←⍬⋄r←1+i←1⋄d←{⍵≡⍬:''⋄{'FSW'[1+1⊃⍵],'YORBGP'[1+2⊃⍵],⍕3⊃⍵}¨⍵}⋄w←{⍬≡s←⍵:0⋄∨/{k←⍵⋄0=+/q←{⍵[1]=k}¨s:0⋄3≤≢∪{2⊃⍵}¨q/s}¨0 1 2}⋄x←m[i..i+4]⋄i+←5
⎕←d x⋄a←⍎⍞⋄→0×⍳∼a∊⍳5⋄⎕←d(s t)←x[a],m[i]⋄→0×⍳l&lt;i+←1⋄x←x[a∼⍨⍳5]⋄→6×⍳∼t[1]=3∣1+s[1]
g,←⊂s⋄⎕←1
⎕←d g⋄⎕←d p⋄→9×⍳w g⋄→0×⍳w p⋄x,←m[i]⋄→0×⍳l&lt;i+←1⋄→3
→8×⍳∼s[1]=3∣1+t[1]
p,←⊂t⋄⎕←2⋄→5
→4×⍳s[3]&gt;t[3]⋄→7×⍳s[3]&lt;t[3]⋄⎕←0⋄→5
r←1
</code></pre>
<p>//24+34+180+81+10+50+19+13+35+3=449
At end the h function return 1 if operator wins, 2 if PC wins. It is possible there is some error. test:</p>
<pre><code>  h
 FY2 FO8 WR10 FP11 FO9 
1
 FY2 FG2 
0


 FO8 WR10 FP11 FO9 FY8 
2
 WR10 SG10 
2

 SG10 
 FO8 FP11 FO9 FY8 WY11 
3
 FO9 SP10 
1
 FO9 
 SG10 
 FO8 FP11 FY8 WY11 FO4 
4
 WY11 SB6 
2
 FO9 
 SG10 SB6 
 FO8 FP11 FY8 FO4 WP8 
5
 WP8 FY3 
1
 FO9 WP8 
 SG10 SB6 
 FO8 FP11 FY8 FO4 FR8 
1
 FO8 WO2 
2
 FO9 WP8 
 SG10 SB6 WO2 
 FP11 FY8 FO4 FR8 WO5 
2
 FY8 WG7 
2
 FO9 WP8 
 SG10 SB6 WO2 WG7 
 FP11 FO4 FR8 WO5 SB10 
3
 FR8 SO8 
1
 FO9 WP8 FR8 
 SG10 SB6 WO2 WG7 
 FP11 FO4 WO5 SB10 FO11 
4
 SB10 WR11 
1
 FO9 WP8 FR8 SB10 
 SG10 SB6 WO2 WG7 
 FP11 FO4 WO5 FO11 WB6 
5
 WB6 SP5 
2
 FO9 WP8 FR8 SB10 
 SG10 SB6 WO2 WG7 SP5 
2
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/278037/">278037</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




