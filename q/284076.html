<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::284076</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>173</td><td>JavaScript V8</td><td>251011T110513Z</td><td><a href="https://codegolf.stackexchange.com/questions/284076/dna-reading-frame/284087#284087">Arnauld</a></td></tr>
<tr d-ix="1"><td>148</td><td>Retina</td><td>251011T125836Z</td><td><a href="https://codegolf.stackexchange.com/questions/284076/dna-reading-frame/284089#284089">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://v8.dev/" rel="nofollow noreferrer">JavaScript (V8)</a>, 173 bytes</h1>
<p><em>This assumes that all possible sequences are valid, whether they overlap or not, and with <code>ATG</code> possibly appearing in the middle.</em></p>
<p>Expects a string and prints each match on a single space-separated line.</p>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;[1,-1].map(r=&gt;[...S=s].map((c,i)=&gt;S.slice(i).replace(/^ATG(...)*?T(AA|AG|GA)/,s=&gt;print(j=~r?i+1:S.length-i,j+~-s.length*r,r*i%3+r,s),s=&quot;TCG.A&quot;[c.charCodeAt()%5]+s),s=&quot;&quot;))
</code></pre>
<p><a href="https://tio.run/##TY1Ra4MwFIXf/RVBKE00psgYjIqWICPs2byJBcm0RpxK4vqyrn/dXasbC/eGe@75TtKW19Iqo8cpuL7MdTzbOMlDGoQF@yhHbEAxxrLYrhorqkmcZMx2WlVYE2aqsSthPJy5FBhY4p0k5vzGxU1wcqDw4Gh0P@E2vpuT9sNjxrqqv0xNoGnr3wO7Sc9Q4@ndk2@oJRBzZSoYd3PFVFOadHiv@ITJ7rnwV9slZI5yByGXS/g7FVCSwwTNU1iAgJ0EEwyRcilT6dJHAKiVXoKACL4aAAP3O29nyzyeWBpC0H9bqEU6hcPqwbyWqsEWxQn6Qmro7dBVrBsueP/Wj5/TEe2RjyyJUI2X@z8B8ptE8w8" rel="nofollow noreferrer" title="JavaScript (V8) – Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>s =&gt;                            // s = input string
[1, -1].map(r =&gt;                // for r = 1 and r = -1:
  [...S = s]                    //   S = copy of s
  .map((c, i) =&gt;                //   for each character c at index i in S:
    S.slice(i)                  //     take the substring of S starting at i
    .replace(                   //     search for:
      /^ATG(...)*?T(AA|AG|GA)/, //       a valid ORF at the start of this substring
      s =&gt;                      //       if found, store it in s and
      print(                    //       print:
        j = ~r ? i + 1          //         j = starting position = i + 1 if r = 1
               : S.length - i,  //             or S.length - i if r = -1
        j + ~-s.length * r,     //         ending position = j + (s.length - 1) * r
        r * i % 3 + r,          //         frame = (i % 3) * r
        s                       //         matched sequence s
      ),                        //       end of print()
      s =                       //       build the reverse sequence in s
        &quot;TCG.A&quot;[                //       by prepending the complement nucleobase
          c.charCodeAt() % 5    //       using the ASCII code of c modulo 5:
        ] + s                   //         A: 65 -&gt; 0 -&gt; T, C: 67 -&gt; 2 -&gt; G,
                                //         G: 71 -&gt; 1 -&gt; C, T: 84 -&gt; 4 -&gt; A
    ),                          //     end of replace()
    s = &quot;&quot;                      //     start with s = &quot;&quot; (for the reverse seq.)
  )                             //   end of inner map()
)                               // end of outer map()
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language" rel="nofollow noreferrer">Retina</a>, 148 bytes</h1>
<pre><code>$
¶$`
O$^`\G.

T`ACGT`Ro`^.+
Lv$`(?&lt;=(¶(.*)))?(?&lt;=(.*)(...)*)ATG(...)*?T(AA|AG|GA)(?=((.*)¶))?
$.($1$8$#8*$&amp;); $.($7$2$#2*$&amp;); $#2*+$#8*-$.($3_); $&amp;
</code></pre>
<p><a href="https://tio.run/##LY5BCsIwEEX3OYXQsUxaDLQuLGgJQxazEQSZpdS4cOFGQcRVz9UD9GJ1YhsS8v9/f0Le98/jeaumNXKcwIwDRHOCLl7YGSORAks8v2LnSnP8QkR/aHEc0BXWWv93KtE5ZwtLwrPygkQ9cc9k0beYOuOgAwYcQgUNZE0Bud2vkt9BDVm9eBVloptEttcU5f9/TST6fmDdQqr0UNBAjWaiUAEHEgliUmEuphmlTEYrSvVa1g8" rel="nofollow noreferrer" title="Retina – Try It Online">Try it online!</a> Link includes test cases. Explanation:</p>
<pre><code>$
¶$`
</code></pre>
<p>Duplicate the input line.</p>
<pre><code>O$^`\G.

T`ACGT`Ro`^.+
</code></pre>
<p>Reverse the first line and switch <code>A</code> with <code>T</code> and <code>C</code> with <code>G</code>.</p>
<pre><code>Lv$`(?&lt;=(¶(.*)))?(?&lt;=(.*)(...)*)ATG(...)*?T(AA|AG|GA)(?=((.*)¶))?
</code></pre>
<p>Match all overlapping sequences, plus also capture the suffix or prefix respectively depending on whether this is the first or second line. <code>$.1</code> = length of prefix + <code>1</code>; <code>$.2</code> = length of prefix; <code>$#2</code> = <code>1</code> on the second line, <code>0</code> on the first; <code>$.3</code> = frame - <code>1</code>; <code>$.7</code> = length of suffix + <code>1</code>; <code>$.8</code> = length of suffix; <code>$#8</code> = <code>1</code> on the first line, <code>0</code> on the second.</p>
<pre><code>$.($1$8$#8*$&amp;); $.($7$2$#2*$&amp;); $#2*+$#8*-$.($3_); $&amp;
</code></pre>
<p>Output the positions of the first and last character, the frame and the sequence. If the match is on the first line, the start position is the length of the suffix plus the length of the string, otherwise it is one more than the length of the prefix. Similarly if the match is on the second line then the end position is the length of the prefix plus the length of the string, otherwise it is one more than the length of the suffix.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/284076/">284076</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




