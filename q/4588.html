<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::4588</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>044</td><td>AWK</td><td>250331T174806Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/279011#279011">xrs</a></td></tr>
<tr d-ix="1"><td>nan</td><td></td><td>230613T002214Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/261794#261794">138 Aspe</a></td></tr>
<tr d-ix="2"><td>nan</td><td></td><td>230613T002732Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/261795#261795">138 Aspe</a></td></tr>
<tr d-ix="3"><td>072</td><td>Python</td><td>220205T135146Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/242394#242394">Oliver</a></td></tr>
<tr d-ix="4"><td>033</td><td>C</td><td>171213T235720Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/150562#150562">user2301</a></td></tr>
<tr d-ix="5"><td>nan</td><td></td><td>120110T214352Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/4603#4603">Paul R</a></td></tr>
<tr d-ix="6"><td>nan</td><td></td><td>141227T224236Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/42869#42869">pgy</a></td></tr>
<tr d-ix="7"><td>nan</td><td></td><td>141226T224556Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/42834#42834">AmigoNic</a></td></tr>
<tr d-ix="8"><td>916</td><td>Haskell</td><td>120121T144512Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/4722#4722">Jeff Bur</a></td></tr>
<tr d-ix="9"><td>nan</td><td></td><td>120110T062056Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/4595#4595">user unk</a></td></tr>
<tr d-ix="10"><td>nan</td><td></td><td>120110T011820Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/4594#4594">gnibbler</a></td></tr>
<tr d-ix="11"><td>nan</td><td></td><td>120109T235300Z</td><td><a href="https://codegolf.stackexchange.com/questions/4588/compute-number-of-1-bits-in-a-binary-representation-of-a-number/4593#4593">ratchet </a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.gnu.org/software/gawk/" rel="nofollow noreferrer">AWK</a>, 44 bytes</h1>
<pre><code>{for(;$1;$1=rshift($1,1))and($1,1)&amp;&amp;x++}$0=x
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m704sTx7wYKlpSVpuhY3darT8os0rFUMgci2qDgjM61EQ8VQx1BTMzEvBcJSU6vQ1q5VMbCtgOiBal2wxNDI1ATCBgA" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu1" class="pu"><h1>Rust</h1>
<p>Rust has its <strong>built-in popcount function</strong>:
<code>(num as u128).count_ones();</code></p>
<p>It's also worth noting that <span class="math-container">\$\color{blue}{\text{this function operates in constant time}}\$</span>. That is, regardless of the input value, it always takes the same amount of time to execute. This is because the number of bits in an integer is fixed, so no matter the value, the same number of bits need to be examined.</p>
<h3>u128</h3>
<p><a href="https://tio.run/##XZFNa8JAEIbv@RWjh5LAGtAakZXQQ6HQS3vpTUS2yUSWrpt0d1YP4l9vOsZEbPc0A8@8H6wLnto2eARPpZSk9yjlq/WkLK2iqLKwV9rGCZwi4GeQwIb9JzoPORywGK0zAdNZNheQLeaLbLO6ccr64x03E7AQsGSgI6raQawFPLBcAtoOsqkmdHGSIu/oFOHNe9DlbI5YtU8ppa2PcbL6wzj0wVygmGVAeQjT2TJJizpY2tYW/f@DMrCXri2fdPopGtV4LC/cDVTeo6Mtfo/iq4EYSq71RsD4RWmDJRB66vqdzmNx6XXn1ThtydhRPH7r@kqGBLxzouv0wR8ApL7Q8i6fegEBg9@Qs5c8R@eobX@KyqidbyfPdUMTgwc0@SNvhuq8UsQTV9ohTYom5JbvD/gL" rel="nofollow noreferrer">Try it online!</a></p>
<pre class="lang-rust prettyprint-override"><code>use std::time::Instant;

fn main() {
    let numbers = vec![5, 1254, 56465];
    let answers = vec![2, 6, 8];

    for (i, &amp;num) in numbers.iter().enumerate() {
        let start = Instant::now();
        let result = (num as u128).count_ones();
        let duration = start.elapsed();

        assert_eq!(result, answers[i], &quot;Failed test for {}&quot;, num);
        println!(&quot;Number: {}, Ones: {}, Time taken: {:?}&quot;, num, result, duration);
    }
}
</code></pre>
<h3>u256</h3>
<h4><code>/src/main.rs</code></h4>
<pre class="lang-rust prettyprint-override"><code>use uint::construct_uint;
use std::time::Instant;

construct_uint! {
    pub struct U256(4);
}

fn count_ones(n: U256) -&gt; u32 {
    n.as_ref().iter().map(|&amp;b| b.count_ones()).sum()
}

fn main() {
    let numbers = vec![
        U256::from(5u64),
        U256::from(1254u64),
        U256::from(56465u64),
        U256::from(18446744073709551615u64),
        U256::from_dec_str(&quot;115792089237316195423570985008687907853269984665640564039457584007913129639935&quot;).unwrap(),  // 2^256 - 1
    ];

    let answers = vec![2, 6, 8, 64, 256];

    for (i, num) in numbers.iter().enumerate() {
        let start = Instant::now();
        let result = count_ones(num.clone());
        let duration = start.elapsed();

        assert_eq!(result, answers[i], &quot;Failed test for {}&quot;, num);
        println!(&quot;Number: {}, Ones: {}, Time taken: {:?}&quot;, num, result, duration);
    }
}
</code></pre>
<h4><code>Cargo.toml</code></h4>
<pre class="lang-rust prettyprint-override"><code>[package]
name = &quot;rust_hello&quot;
version = &quot;0.1.0&quot;
edition = &quot;2021&quot;

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
uint = &quot;0.9&quot;
# bitvec = &quot;1.0.1&quot;
</code></pre>
<h4>Build and running</h4>
<pre><code># win10 environment

$ cargo build
$ target\debug\rust_hello.exe


Number: 5, Ones: 2, Time taken: 600ns
Number: 1254, Ones: 6, Time taken: 700ns
Number: 56465, Ones: 8, Time taken: 400ns
Number: 18446744073709551615, Ones: 64, Time taken: 700ns
Number: 115792089237316195423570985008687907853269984665640564039457584007913129639935, Ones: 256, Time taken: 800ns
</code></pre>
</div>
<div id="pu2" class="pu"><h1>Mathematica</h1>
<p><strong>Mathematica has its built-in function <code>DigitCount</code>.</strong></p>
<p><a href="https://tio.run/##PcuxCsIwEIDh3afIqCDkksslOaWD6OLm4CZFooQasGlp0@ePCOLwTx9/H8or9qGkZ6h1HMbjsORyy/dzLrGLUyt2jTilLpUfbIXeCtXuV@uQ5@Y/KEWONXjW6FBZxWQ0kgP2BOCtdwzOE2rL7I21ZA18QzbkyBsAxwqVZovMSO1GysNjHt5LidfUp9xJeZlSLrV@AA" rel="nofollow noreferrer">Try it online!</a></p>
<pre><code>popCount[n_Integer] := DigitCount[n, 2, 1];
(ans=popCount[115792089237316195423570985008687907853269984665640564039457584007913129639935])//AbsoluteTiming//Print
</code></pre>
</div>
<div id="pu3" class="pu"><h1>Python (72 bytes)</h1>
<pre class="lang-python prettyprint-override"><code>x=bin(int(input()));n=0
for i in x:
    if i=='1':
        n+=1
print(n)
</code></pre>
<p>Converts <code>str</code>, to <code>int</code>, to <code>bin</code>, then iterates over the string to count.</p>
</div>
<div id="pu4" class="pu"><h1>C, 33 bytes</h1>

<p>I just saw the challenge today, but thought of a recursive solution.</p>

<pre><code>B(n){return (n&amp;1)+(n?B(n/2):0);};
</code></pre>

<p>Edited to note that I assumed it was a smallest size challenge. The speed is linear to the number of bits required to contain the number. O(N) = k * Log2(N).</p>
</div>
<div id="pu5" class="pu"><h2>C/C++<br></h2>
<pre class="lang-c prettyprint-override"><code>int popcnt(int n)
{
    return __builtin_popcount(n);
}
</code></pre>
<p>For some CPUs <code>__builtin_popcount</code> compiles to a single instruction (e.g. <code>POPCNT</code> on x86).</p>
<p>Note: requires gcc or gcc-compatible compiler (e.g. ICC).</p>
</div>
<div id="pu6" class="pu"><h3>Erlang</h3>

<pre><code>p(N)-&gt;p(N,0).
p(0,S)-&gt;S;p(N,S)-&gt;p(N div 2, S+N rem 2).
</code></pre>

<p>The <code>p</code> function divides the number with 2, adds the remainder to S, and calls itself with N/2 (tail) recursively.</p>

<p>While it takes log2(N) steps (division and function call) to calculate the result, it works with arbitrary large numbers.</p>
</div>
<div id="pu7" class="pu"><p>Here is rachet freak's submission (the 32-bit version) converted to Scala (thanks RF!):</p>

<pre><code>def num1Bits(x: Int) = {
  var i = x
  i = (i &amp; 0x55555555) + ((i&gt;&gt; 1) &amp; 0x55555555)
  i = (i &amp; 0x33333333) + ((i&gt;&gt; 2) &amp; 0x33333333)
  i = (i &amp; 0x0f0f0f0f) + ((i&gt;&gt; 4) &amp; 0x0f0f0f0f)
  i = (i &amp; 0x00ff00ff) + ((i&gt;&gt; 8) &amp; 0x00ff00ff)
      (i &amp; 0x0000ffff) + ((i&gt;&gt;16) &amp; 0x0000ffff)
}
</code></pre>
</div>
<div id="pu8" class="pu"><h3>Haskell, 9 (+16)</h3>

<p>There was a <code>popCount</code> routine added to the <code>Data.Bits</code> module for GHC v7.2.1/v7.4.1 this summer (see tickets concerning the <a href="http://hackage.haskell.org/trac/ghc/ticket/5413" rel="nofollow">primop</a> and <a href="http://hackage.haskell.org/trac/ghc/ticket/5431" rel="nofollow">binding</a>).</p>

<pre><code>import Data.Bits
popCount
</code></pre>

<p>There is a good <a href="http://www.dalkescientific.com/writings/diary/archive/2008/07/03/hakmem_and_other_popcounts.html" rel="nofollow">arbitrary precision popcount function</a> in the GNU Multiple Precision Arithmetic Library (GMP), which GHC <a href="http://hackage.haskell.org/trac/ghc/wiki/ReplacingGMPNotes" rel="nofollow">uses by default</a>, but most other serious languages offer bindings to :</p>

<h3>Python, 16 (+12)</h3>

<pre><code>import gmpy;
gmpy.popcount(...);
</code></pre>

<h3>Perl, 11 (+22)</h3>

<pre><code>use GMP::Mpz qw(:all);
popcount(...);
</code></pre>
</div>
<div id="pu9" class="pu"><h3>scala:</h3>
<pre><code>@tailrec
def bits (i: Long, sofar: Int): Int = if (i==0) sofar else bits (i &gt;&gt; 1, (1 &amp; i).toInt + sofar) 
</code></pre>
<p>computes on a 2Ghz single core for about 1.500.000 64bit Long values the number of bits set.
A straight forward recursive method, comparing the last bit, and shifting the number towards zero. The <code>@tailrec</code> is just a hint to the compiler to warn me, if it can't optimize the tail recursive call - it is not necessary, for the optimization to take place.</p>
<p>It's about 10times faster than the simplest method, using the library function:</p>
<pre><code>def f(n:Long)=n.toBinaryString.count(_=='1')
</code></pre>
<p>Translating them to c++ might not lead to similar results.</p>
</div>
<div id="pu10" class="pu"><p>Using an 8-bit lookup table in the python shell</p>

<pre><code>&gt;&gt;&gt; tab=[0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8]
&gt;&gt;&gt; N=123456789
&gt;&gt;&gt; tab[N&gt;&gt;24]+tab[N&gt;&gt;16&amp;255]+tab[N&gt;&gt;8&amp;255]+tab[N&amp;255]
16
</code></pre>
</div>
<div id="pu11" class="pu"><p>fastest for 32 bit numbers: </p>

<pre><code>int bitcount(int i){
    i=i&amp;0x55555555 + (i&gt;&gt;1)&amp;0x55555555;
    i=i&amp;0x33333333 + (i&gt;&gt;2)&amp;0x33333333;
    i=i&amp;0x0f0f0f0f + (i&gt;&gt;4)&amp;0x0f0f0f0f;
    i=i&amp;0x00ff00ff + (i&gt;&gt;8)&amp;0x00ff00ff;
    return i&amp;0x0000ffff + (i&gt;&gt;16)&amp;0x0000ffff;
}
</code></pre>

<p>for 64 bits: </p>

<pre><code>int bitcount(long i){
    i=i&amp;0x5555555555555555 + (i&gt;&gt;1)&amp;0x5555555555555555;
    i=i&amp;0x3333333333333333 + (i&gt;&gt;2)&amp;0x3333333333333333;
    i=i&amp;0x0f0f0f0f0f0f0f0f + (i&gt;&gt;4)&amp;0x0f0f0f0f0f0f0f0f;
    i=i&amp;0x00ff00ff00ff00ff + (i&gt;&gt;8)&amp;0x00ff00ff00ff00ff;
    i=i&amp;0x0000ffff0000ffff + (i&gt;&gt;16)&amp;0x0000ffff0000ffff;
    return i&amp;0x00000000ffffffff + (i&gt;&gt;32)&amp;0x00000000ffffffff;
}
</code></pre>

<p>these are all for C-based languages that define the binary operators (C, C++, C#, D, java, ...) (barring the <code>int</code> <code>long</code> type, translate as needed)</p>

<p>for arbitrary bit sizes:</p>

<pre><code>int bitcount(BigInt i){
    int c=0;
    BigInt _2_pow_64 = BigInt(2).pow(64);
    while(i&gt;0){
       long rem = i.mod(_2_pow_64);//or AND with 0xffffffffffffffff
       c+=bitcount(rem);//as defined above
       i=i.div(_2_pow_64);//or rshift with 64
    }
    return c;
}
</code></pre>

<p>BigInt being the class for integers of arbitrary size, and the <code>.div</code>, <code>.pow</code>, <code>.mod</code> being the 'divide by', 'to the power of' and 'remainder of' functions reps.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/4588/">4588</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




