<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::157187</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>207</td><td>Python3</td><td>250312T224219Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/278636#278636">Ajax1234</a></td></tr>
<tr d-ix="1"><td>017</td><td>Brachylog</td><td>180316T145819Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/158353#158353">Zgarb</a></td></tr>
<tr d-ix="2"><td>067</td><td>APL Dyalog Classic</td><td>180308T173355Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/157632#157632">Adalynn</a></td></tr>
<tr d-ix="3"><td>nan</td><td>Stax</td><td>180304T145821Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/157196#157196">Weijun Z</a></td></tr>
<tr d-ix="4"><td>017</td><td>Jelly</td><td>180304T123927Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/157193#157193">Dennis</a></td></tr>
<tr d-ix="5"><td>019</td><td>Brachylog</td><td>180304T104413Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/157189#157189">Martin E</a></td></tr>
<tr d-ix="6"><td>020</td><td>Pyth</td><td>180304T143313Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/157195#157195">Mr. Xcod</a></td></tr>
<tr d-ix="7"><td>158</td><td>Ruby</td><td>180304T125301Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/157194#157194">Asone Tu</a></td></tr>
<tr d-ix="8"><td>146</td><td>Python 2</td><td>180304T105213Z</td><td><a href="https://codegolf.stackexchange.com/questions/157187/sort-by-shuffling-blocks/157190#157190">ovs</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 207 bytes</h1>
<pre class="lang-py prettyprint-override"><code>S=sorted
def f(l):
 q,m=[([],l)],len(l)
 for a,b in q:
  T=a+[b]
  if[j for k in S(map(S,T))for j in k]==S(l):m=min(m,max(len(T),max(map(len,T))))
  q+=[(a+[b[:i]],b[i:])for i in range(1,len(b)+1)]
 return m
</code></pre>
<p><a href="https://tio.run/##XVJNb8IwDD0vv8LiQiLcaW35GlL2E3aBW9ZDK9It0IaSZtP265kdYIepimQ/P7/nOB1@4sfJl@shXC5bPZ5CtHuxty20slMbAWfstZGmwk7RsZ5QAe0pQI0NOA9n4sBO1zPTVBS51hxS@cjFrezrQW5xpxRjB8aOldZb1u5177zssa@/JQvvVAq5g1LuUWQF5xn5s7zZuKrCxrhNldQcq4Xav1uZp8kaNcsVDRFs/Awe@ksEDZPJRJhFBdkL5MLkWKSwEOYJC8wxy1NeCpPlmKB7/RlLXBOwSsCcgYKA8gZQxwKZsyJ4jusErpJMxsIFXqO/9iWyQZnYWXE3pkJe4AKXmC3xNkJ5N@D030mlZboIpWUyumpeuxbCrPD6rWm8W3yz4l38ba51XbRBvp68RYiP49C5KKdvfqro2R9qhIa2x49hv@oOwd0ZLEUcooyjDZH@k1qB1tAIMQTniRHtGEcYuL6fqssv" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/JCumin/Brachylog" rel="nofollow noreferrer">Brachylog</a>, 17 bytes</h1>

<pre><code>~c₎{oᵐoc≤₁&amp;lᵐ⌉≤}ᵈ
</code></pre>

<p><a href="https://tio.run/##XY5NCsIwEIWv4srVWzQTm9SrWELQLnRRCLgTUbALsSDiITyAmx6ouUic/KwkhLxv8ubN7I7b7nDq3Z6Cv3/9cJund7h2fnidHUvX@fHD1WXP4J8j02WeHiG0bW2waAUoPhUIAlZEbQUSRr2GRMOgMxCDzFAj/mkurdCUNhtDCFkll0IMk8llqQwQhBoKVqGMknmTCn@3LMhSpuCck9wa@TS8RtHGhM0P" rel="nofollow noreferrer" title="Brachylog – Try It Online">Try it online!</a></p>

<h2>Explanation</h2>

<p>This is a self-answer; I designed this challenge with Brachylog in mind and found <code>~c₎{…}ᵈ</code> an interesting construct.</p>

<p>The built-in <code>c</code> concatenates a list of lists.
If it is given a subscript <code>N</code>, it requires the number of lists to be <code>N</code>.
The symbol <code>₎</code> modifies a built-in to take a pair as input and use its right element as the subscript.
Thus <code>c₎</code> takes a pair <code>[L,N]</code>, requires that the number of lists in <code>L</code> is <code>N</code>, and returns the concatenation of <code>L</code>.
When run in reverse, <code>~c₎</code> takes a list <code>L</code> and returns a pair <code>[P,N]</code>, where <code>P</code> is a partition of <code>L</code> into <code>N</code> blocks.
They are enumerated in increasing order of <code>N</code>.</p>

<p>The metapredicate <code>ᵈ</code> transforms an ordinary predicate into one that checks a relation between the two elements of a pair.
More explicitly, <code>{…}ᵈ</code> takes a pair <code>[A,B]</code>, checks that <code>A{…}B</code> holds, and outputs <code>B</code>.
I use it to verify that <code>P</code> can be block-sorted and only contains lists of length at most <code>N</code>.</p>

<pre><code>~c₎{oᵐoc≤₁&amp;lᵐ⌉≤}ᵈ  Input is a list, say L = [9,2,8,3,7].
~c₎                Guess the pair [P,N]: [[[9],[2],[8,3,7]],3]
   {           }ᵈ  Verify this predicate on P and N and return N:
    oᵐ              Sort each list in P: [[9],[2],[3,7,8]]
      o             Sort lexicographically: [[2],[3,7,8],[9]]
       c            Concatenate: [2,3,7,8,9]
        ≤₁          This list is nondecreasing: true.
          &amp;lᵐ       Length of each list in P: [1,1,3]
             ⌉      Maximum: 3
              ≤     This is at most N: true.
</code></pre>

<p>Note that <code>P</code> may contain empty lists.
This ensures correctness also in those cases where the maximal length of a block is greater than the number of blocks.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.dyalog.com/" rel="nofollow noreferrer">APL (Dyalog Classic)</a>, <s>71</s> 67 bytes</h1>
<pre><code>{⌊/(⌈/≢,≢¨)¨T/⍨{S[⍋S]≡∊⍵[⍋↑⍵]}¨T←{⍵[⍋⍵]}¨¨⊂∘S¨(-≢S)↑¨2⊥⍣¯1¨⍳2*≢S←⍵}
</code></pre>
<p><code>⎕IO</code> must be <code>0</code></p>
<p><a href="https://tio.run/##SyzI0U2pTMzJT9dNzkksLs5M/v//Ud9UT/9HbRMMuNyAZPWjni59jUc9HfqPOhfpAPGhFZqHVoToP@pdUR0c/ai3Ozj2UefCRx1dj3q3griP2iYCWbG1QDVg3VBRiNChFY@6mh51zAg@tEJDF2hWsCZQ@aEVRo@6lj7qXXxovSFQQe9mIy2QFFA3UFctF9A5QKabgrkOBFroWEJZ5v//AwA" rel="nofollow noreferrer" title="APL (Dyalog Classic) – Try It Online">Try it online!</a></p>
<h2>How?</h2>
<ul>
<li><code>⌊/</code> - <strong>Find the minimum of ...</strong></li>
<li><code>(⌈/≢,≢¨)</code> - <strong>... the maximum of the length and number of elements ...</strong></li>
<li><code>¨</code> - <strong>... of each element of ...</strong></li>
<li><code>T/⍨</code> - <strong>... the elements that ...</strong></li>
<li><code>{S[⍋S]≡∊⍵[⍋↑⍵]}¨</code> - <strong>... are sorted when flattened, of ...</strong></li>
<li><code>T←{⍵[⍋⍵]}¨¨</code> - <strong>... the sorted elements of the elements of ...</strong></li>
<li><code>⊂∘S¨(-≢S)↑¨2⊥⍣¯1¨⍳2*≢S←⍵</code> - <strong>... the partitions of the argument (along with some junk)</strong></li>
</ul>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/tomtheisen/stax" rel="nofollow noreferrer">Stax</a>, <s>28</s> <s>26</s> <s>25</s> <s>24</s> 23 <a href="https://github.com/tomtheisen/stax/blob/master/docs/packed.md#packed-stax" rel="nofollow noreferrer">bytes</a><sup>CP437</sup></h1>
<pre><code>é%(&gt;ù│ê²☻û◙T╠►╜◘íaæAtI╥
</code></pre>
<p><a href="https://staxlang.xyz/#p=8225283e97b388fd02960a54cc10bd08a16191417449d2&amp;i=%5B5%5D%0A%5B1,2%5D%0A%5B0,2,1,-1%5D%0A%5B-1,0,2,1%5D%0A%5B9,3,8,2,7%5D%0A%5B9,2,8,3,7%5D%0A%5B5,9,3,7,2,4,8%5D%0A%5B-1,-2,1,2,-1,-2,7%5D%0A%5B6,1,0,3,2,4,-2,-1%5D%0A%5B12,5,6,-6,-1,0,2,3%5D%0A%5B1,0,1,0,1,0,1,0,1,0%5D%0A%5B1,2,1,3,1,2,3,2,4,3%5D%0A%5B7,7,7,7,8,9,7,7,7,7%5D&amp;a=1&amp;m=2" rel="nofollow noreferrer">Run and debug online!</a></p>
<p><em>Credits to @recursive for saving 3 bytes.</em></p>
<p>Stax is a bit verbose here. It takes two bytes to sort an array by default, two bytes to get the maximum/minimum of an array and two bytes to flatten an array. Anyway I am still posting the solution <s> and hope there can be helpful suggestions on how to improve it </s> there is.</p>
<h2>Explanation</h2>
<p>Uses the unpacked version to explain.</p>
<pre><code>%cFxs|!F{{omo:f:^!C_Mch\%|m
%cFxs|!F                        Do for all partitions, grouped by number of sub-arrays
                                    Grouping by number of sub-arrays in this problem does not help but it's the default                    
        {{om{o                  Sort inside block then sort blocks lexicographically
              :f:^              The result when flattened is sorted
                  !C            Skip the rest of the loop if the last line is false
                    _|&lt;         Take the current partition, pad to the longest

                       h        Take the first element, whose length is now the maximum of all sub-arrays in the original partition
                        \       Zip with the current partition, the shorter one is repeated
                         %      Number of elements
                                Which is the maximum of all sub-array sizes and the number of sub-arrays in the current partition  
                          |m    Take the minimum among all choices of partitions
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 17 bytes</h1>

<pre><code>Ṣ€ṢF
ŒṖÇÐṂ+Z$€L€Ṃ
</code></pre>

<p><a href="https://tio.run/##XU67EUIhEMxfHWYuMw@Qjw0Y2YAyhCbOa8CU5KWOgQUY2wAxYyHYCB6fyGHgdu@Wvb1eluVWSo6vb3jTe5g@jxyfaU33HMP2vKH2sY1CSSuBUynOKT/BcYhaZghwMF4x42i04j0kLBHTiSAiO1GoM0OtHez4xqqJQEdNpVHNZFMxMRZwAQUNpjFWyZ5kxt8dAQnKZtx9mtqgH0sxBvaT/wE" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<h3>Alternate version, 15 bytes, postdates challenge</h3>

<p>In the latest version, <code>Ɗ</code> combines three links into a monadic chain. This allows the following golf.</p>

<pre><code>ŒṖṢ€ṢFƊÐṂ+ZLƊ€Ṃ
</code></pre>

<p><a href="https://tio.run/##XY49DgIhEIX7vYqPZAH58QJWXkAJpY3ZC9jSmGxlLDyAtReg3rj3wIvg8FMZAnxveLyZy3marjl/Hik@U3x9w5vO/Tov9xTD5nRY51oKebkRHHN2TvkBjkOUa4QAB@OFGUeVhXeQsCRME4KEbEKhvBkqbWH7N1ZCBBpVl0YJk9XFRG/ABRQ0mEZvJdskI/52H5BQ1uCWU90GbVkao7Mf/A8" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<h3>How it works</h3>

<pre><code>Ṣ€ṢF          Helper link. Argument: P (partitioned array)

Ṣ€            Sort each chunk.
  Ṣ           Sort the sorted chunks.
   F          Flatten.


ŒṖÇÐṂ+Z$€L€Ṃ  Main link. Argument: A (array)

ŒṖ            Generate all partitions of A.
  ÇÐṂ         Keep those for which the helper link returns the minimal array, i.e.,
              those that return sorted(A).
     +Z$€     Add each partition to its transpose.
              Due to how Jelly vectorizes, the length of the sum is the maximum of
              the length of the operands, and the length of the transpose is the
              length of the array's largest column.
         L€   Take the length of each sum.
           Ṃ  Take the minimum.
</code></pre>
</div>
<div id="pu5" class="pu"><h2><a href="https://github.com/JCumin/Brachylog" rel="nofollow noreferrer">Brachylog</a>, <s>23</s> <s>22</s> <s>20</s> 19 bytes</h2>

<p><em>Thanks to Zgarb, H.PWiz and Fatalize for saving some amount of bytes.</em></p>

<pre><code>~cᶠ{oᵐoc≤₁&amp;≡ᵃlᵐ⌉}ˢ⌋
</code></pre>

<p><a href="https://tio.run/##SypKTM6ozMlPN/pf/ahtw6Ompoe7Omsfbp3wvy754bYF1flAZn7yo84lj5oa1R51Lny4tTkHKPSop7P29KJHPd3//0crRJvG6ihEG@oYgSgDHSMdQ514QxA73lAHzAWxLXWMdSyAHHMIxwjIMQZyFGIB" rel="nofollow noreferrer" title="Brachylog – Try It Online">Try it online!</a></p>

<p>I'm sure there's more to golf here...</p>

<h3>Explanation</h3>

<pre><code>~cᶠ      Find all lists that concatenate into the input, i.e. all partitions
         of the input.
{        Discard all partitions for which this predicate fails, and replace
         the rest with the output of this predicate.
  oᵐ       Sort each sublist of the partition.
  o        Sort the entire list.
  c≤₁      And require concatenation of the result to be sorted.
  &amp;        Then:
  ≡ᵃ       Append the partition to itself.
  lᵐ       Map "length" over this list, i.e. we get the length of each block, as
           well as the length of the partition itself.
  ⌉        Take the maximum.
}ˢ
⌋        Take the minimum of all those maxima.
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="https://pyth.readthedocs.io" rel="nofollow noreferrer">Pyth</a>, <s> 24 23 </s> 20 bytes</h1>
<pre><code>hSmeSlMs]Bd.msSSMb./
</code></pre>
<p><strong><a href="https://pyth.herokuapp.com/?code=hSmeSlMs%5DBd.msSSMb.%2F&amp;test_suite=1&amp;test_suite_input=%5B5%5D%0A%5B1%2C2%5D%0A%5B0%2C2%2C1%2C-1%5D%0A%5B-1%2C0%2C2%2C1%5D%0A%5B9%2C3%2C8%2C2%2C7%5D%0A%5B9%2C2%2C8%2C3%2C7%5D%0A%5B5%2C9%2C3%2C7%2C2%2C4%2C8%5D%0A%5B-1%2C-2%2C1%2C2%2C-1%2C-2%2C7%5D%0A%5B6%2C1%2C0%2C3%2C2%2C4%2C-2%2C-1%5D%0A%5B12%2C5%2C6%2C-6%2C-1%2C0%2C2%2C3%5D%0A%5B1%2C0%2C1%2C0%2C1%2C0%2C1%2C0%2C1%2C0%5D%0A%5B1%2C2%2C1%2C3%2C1%2C2%2C3%2C2%2C4%2C3%5D%0A%5B7%2C7%2C7%2C7%2C8%2C9%2C7%2C7%2C7%2C7%5D&amp;debug=0" rel="nofollow noreferrer">Test suite.</a></strong></p>
<h3>How it works</h3>
<pre><code>hSmeSlMs]Bd.msSSMb./ – Full program. Hereby, Q represents the input.
                  ./ – All possible partitions of Q.
           .m        – Take the partitions which yield a minimal (i.e. sorted) list over:
             sSSMb   – Sorting function. Uses the variable b.
               SMb   – Sort each list in each partition b.
              S      – Sort the partition b.
             s       – And flatten (by 1 level).
  meSlMs]Bd          – Map. Uses a function whose variable is d.
        ]Bd          – Pair d with its wrapping in a singleton list. Returns [d, [d]].
       s             – Flatten (by 1 level). Returns [*d, d], where &quot;*&quot; is splatting.
     lM              – Take the length of each element.
   eS                – Retrieve the maximal length.
hS                   – Return the minimum element of the list of maximal lengths.
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, 158 bytes</h1>



<pre class="lang-ruby prettyprint-override"><code>f=-&gt;l,i=[],s=l.size,m=s{k=*l;i.sum==s&amp;&amp;i.map{|z|k.shift(z).sort}.sort.flatten==l.sort&amp;&amp;[m,[i.size,*i].max].min||i.sum&lt;s&amp;&amp;(1..s).map{|z|f[l,i+[z],s,m]}.min||m}
</code></pre>

<p><a href="https://tio.run/##fVB/b4IwEP3fT9FoQtQdjRQBl637Ik2zOAezCGpsSRw/Pjs7Wpxmf4yG9u69u3evvVQf332fcf@tAMWFBM0LqlWdQsl1c@DL4kVRXZWca89TtNyem7ZuD1TvVWbm9YLq08V0dqdZsTUmPfJBAXPPEyUI5dSWSmLzFTd1bFsr@YqK84BSvbjJZgJNPIkaXUApO1dbdv25MppM1RFP8s/3dTIkvZ7TnUk/pxMxIUSISAIJJNg4AIYZG7MVMAjAR5KEI@QHYNGHqmcIYYNYgtj6F2OIhRa7tUYwVCbIrGGDeHKX9Ic5DFz0qBPDMC@0PT5zVm5cwCCCGPwYRlPhw7AB@fMjG9@viUhohzrxoTca2QTc2qDhMbZjJ5Km292eNK2CvCXuyWeNoub0rmmRV9qQcNXhM8@aTCjporybdv0P" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
</div>
<div id="pu8" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, <s>186</s> 146 bytes</h1>



<pre class="lang-python prettyprint-override"><code>lambda l:min(max(map(len,z+[z]))for z in p(l)if sum(s(z),[])==s(l))
p=lambda l:[q+[s(l[i:])]for i in range(len(l))for q in p(l[:i])]or[l]
s=sorted
</code></pre>

<p><a href="https://tio.run/##bZDdboMwDIXv/RS@K1HNVML6MyT2IlkumMq2qPyV0Gmj6rMzJ6nWqkIo6GCOT@yv@x2@2kZOh/xtqor6fV9gldWmierih08XVWVD41KNWoiPtscRTYNcFeYD7amObDQKUlrkueWigC7/T1HHpeKiMpkW2vUa19sXzWfpUp3dVY/XRJUZ9rW9qjTY3Lb9UO6nobSDxRyVWmtSCUl@r0hSQnHCMk7If7F8oZR2rLdeS9ap12tyf7ZceaZdaIldv6SgnGdDLif1nliG6ETSmjYUb@h6SeoHWNHDCWOxSn1oCHHeLYVnxwNctdYAbuXvojqVbm2/XgaIXW@aARfnC8aveL4snthWF0PknYSHIISYmAN4DnDjADcOcMcB7jjAAweY4QAzHGCOA8xygFkOMMvhDw" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>

<p>The second function is taken from <a href="https://codegolf.stackexchange.com/a/53046/64121">this tip</a> by <a href="https://codegolf.stackexchange.com/users/30688/feersum">feersum</a>.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/157187/">157187</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




