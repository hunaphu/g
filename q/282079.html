<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::282079</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>170</td><td>JavaScript ES7</td><td>250601T183145Z</td><td><a href="https://codegolf.stackexchange.com/questions/282079/rays-intersecting-lines/282085#282085">Arnauld</a></td></tr>
<tr d-ix="1"><td>379</td><td>Python 3.8 prerelease</td><td>250601T154945Z</td><td><a href="https://codegolf.stackexchange.com/questions/282079/rays-intersecting-lines/282082#282082">Ted</a></td></tr>
<tr d-ix="2"><td>070</td><td>Charcoal</td><td>250601T112728Z</td><td><a href="https://codegolf.stackexchange.com/questions/282079/rays-intersecting-lines/282080#282080">Neil</a></td></tr>
<tr d-ix="3"><td>044</td><td>Jelly</td><td>250601T181332Z</td><td><a href="https://codegolf.stackexchange.com/questions/282079/rays-intersecting-lines/282084#282084">Jonathan</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>JavaScript (ES7), 170 bytes</h1>
<p>Expects a matrix of ASCII codes. Returns a Boolean value.</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;m.some((r,y)=&gt;r.some((c,x)=&gt;c**3&amp;72&amp;&amp;L.some(([a,b,c])=&gt;(g=(v,q)=&gt;(v/=a*B-A*b)&gt;.5&amp;v&lt;q.length-1.5)(a*C-A*c,m)&amp;g(c*B-C*b,r),L.push([A=4*~-c%7-1,B=c&lt;93,C=A*x+B*y]))),L=[])
</code></pre>
<p><a href="https://tio.run/##zZXLbuIwFIb3fQoLqZFtfOkNVaOpkQBNV911GWdhTAgZ5QJ2ioqG9tWpA@m0maAK2qias0nO5z8nf45j@7daKqtNPC9olk/CzVRsUtFPmc3TEEJDVkj0TZVp8ugyjfGld33heXcV9hUZEx24IRgJuCSL8m7JhcJDOsBj1Gc9b3mzYEmYRcWMnrMeggqP3JgmKfIiqJ1whMfEIHLH5g92Bv2BuMLPVJ9e03MyFPrmxyUZiQF@7A7xKkDICYUfoI0JFw@xCWFnajuImVBNbuMkvF9lGp4hVuT3hYmzCCJm50lcwI7MZOaE09z8UnoGLRB98OcEAJ1ntgApEMC@SZ0wVfOdyGeM2WCb6zLXTM@UGbmODQr3KoR@VlXyJGRJHsEpTEv4hDZdUYvuiQ@2wXcXEJRAvuU7AOTfvAKlpg7A10DDWJP4vFlkfTzYY4RS2rLVPUXkgR3hn2wib88qeOelBnhr810D9Dir9N8itM0/8eO5O9wqb1TlLj5hhB/yCP/iv0pptQi@oYm8zWXVEli/hgOyoZD/k9XW99VyRtwOL@Vxn7eV83X9UODgPdgeHOv9VV8A" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h2>Method</h2>
<h3>Detecting line intersections</h3>
<p>For each line character <span class="math-container">\$c\$</span> at position <span class="math-container">\$(X,Y)\$</span> in the input matrix, we push in the array <span class="math-container">\$L\$</span> the parameters <span class="math-container">\$(A,B,C)\$</span> of the equation of the corresponding line:</p>
<p><span class="math-container">$$Ax+By=C$$</span></p>
<p>where <span class="math-container">\$C=AX+BY\$</span> in all cases, and <span class="math-container">\$A\$</span>, <span class="math-container">\$B\$</span> are defined as follows:</p>
<div class="s-table-container"><table class="s-table">
<thead>
<tr>
<th style="text-align: center;">Character</th>
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">Equation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>\</code></td>
<td style="text-align: center;"><span class="math-container">\$-1\$</span></td>
<td style="text-align: center;"><span class="math-container">\$1\$</span></td>
<td style="text-align: center;"><span class="math-container">\$-x+y=C\$</span></td>
</tr>
<tr>
<td style="text-align: center;"><code>/</code></td>
<td style="text-align: center;"><span class="math-container">\$1\$</span></td>
<td style="text-align: center;"><span class="math-container">\$1\$</span></td>
<td style="text-align: center;"><span class="math-container">\$x+y=C\$</span></td>
</tr>
<tr>
<td style="text-align: center;"><code>-</code></td>
<td style="text-align: center;"><span class="math-container">\$0\$</span></td>
<td style="text-align: center;"><span class="math-container">\$1\$</span></td>
<td style="text-align: center;"><span class="math-container">\$y=C\$</span></td>
</tr>
<tr>
<td style="text-align: center;"><code>|</code></td>
<td style="text-align: center;"><span class="math-container">\$1\$</span></td>
<td style="text-align: center;"><span class="math-container">\$0\$</span></td>
<td style="text-align: center;"><span class="math-container">\$x=C\$</span></td>
</tr>
</tbody>
</table></div>
<p>For each line already stored in <span class="math-container">\$L\$</span> with parameters <span class="math-container">\$(a,b,c)\$</span>, we compute its intersection point <span class="math-container">\$(x,y)\$</span> with the new line:</p>
<p><span class="math-container">$$x=\frac{cB-Cb}{aB-Ab}$$</span>
<span class="math-container">$$y=\frac{aC-Ac}{aB-Ab}$$</span></p>
<p>and test whether we have <span class="math-container">\$x\in(1/2,W-3/2)\$</span> and <span class="math-container">\$y\in(1/2,H-3/2)\$</span>, where <span class="math-container">\$H\$</span>,<span class="math-container">\$W\$</span> are the dimensions of the matrix.</p>
<p><strong>NB</strong>: Although the above definitions of <span class="math-container">\$x\$</span> and <span class="math-container">\$y\$</span> are valid only if <span class="math-container">\$aB-Ab\neq0\$</span>, this will also work as-is in the JS implementation for <span class="math-container">\$aB-Ab=0\$</span> (we'll get either <code>NaN</code> or <code>+/-Infinity</code>, which will make the tests fail as expected).</p>
<h3>Character encoding</h3>
<p>The table below shows the formulas that are used to determine if an ASCII code matches a line character and, if it does, which values of <span class="math-container">\$A\$</span> and <span class="math-container">\$B\$</span> must be used.</p>
<div class="s-table-container"><table class="s-table">
<thead>
<tr>
<th style="text-align: center;">Character</th>
<th style="text-align: center;">c = ASCII code</th>
<th style="text-align: center;">c**3&amp;72</th>
<th style="text-align: center;">A = 4*~-c%7-1</th>
<th style="text-align: center;">B = c&lt;93</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>+</code></td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">n/a</td>
<td style="text-align: center;">n/a</td>
</tr>
<tr>
<td style="text-align: center;"><code>=</code></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">n/a</td>
<td style="text-align: center;">n/a</td>
</tr>
<tr>
<td style="text-align: center;"><code>[</code></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">n/a</td>
<td style="text-align: center;">n/a</td>
</tr>
<tr>
<td style="text-align: center;"><code>]</code></td>
<td style="text-align: center;">93</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">n/a</td>
<td style="text-align: center;">n/a</td>
</tr>
<tr>
<td style="text-align: center;"><code> </code></td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">n/a</td>
<td style="text-align: center;">n/a</td>
</tr>
<tr>
<td style="text-align: center;"><code>\</code></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;"><code>/</code></td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;"><code>-</code></td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;"><code>|</code></td>
<td style="text-align: center;">124</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table></div>
</div>
<div id="pu1" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8 (pre-release)</a>, <s>536</s> 379 bytes</h1>

<pre class="lang-python prettyprint-override"><code>def f(b):
 s,h,w=&quot;-\|/&quot;,len(b),len(b[0])
 for r in range(h):
  for c in range(w):
   if(v:=b[r][c])in s:
    y,x,k,l,z=r,c,*[[0,1],[1,1],[1,0],[1,-1]][s.find(v)],5
    while z:
     if&quot; &quot;!=b[y][x]!=v or v==&quot;\\&quot;and&quot;//&quot;==b[y-1][x]+b[y][x-1]or v==&quot;/&quot;and&quot;\\\\&quot;==b[y-1][x]+b[y][x+1]:return 1
     while(0in[y-h+1+k,x-w+1+l,y+k,x+l])*z:k,l=-k,-l;z-=1
     b[y][x]=v;y+=k;x+=l
 return 0
</code></pre>
<p><a href="https://tio.run/##zVbLbqMwFN3nK27dDRS7TjQaaZTKHzCb2cwSLMQQ06BQJ7KBPMS/Z2wgD5K0k6ZMVUuB@Pjch6/tgxfrfDqX334s1HY7EQkkzh93PACNp3jJEAkqinAmpEGblz/k7gCSuQIFqQQVyWfhTK1JDcYHcFmDkCZOOWZ/fMX9mLtmVNcwrPEKz3CGN0zhGD/4/hCPOPZH7XNYP8mIc18/JqmcOKXL8ffadDlNMwGbxo8JgADdmQhr7q/4HSvB5FEyhoIARXKCKEXMjhpfZtxreKbTsmhNCky7QPNGfKxEXigJoyZaHdsZptIwp97Im@EVWZp3htf2v5dx92EzNhNjZIZJ9rQhrLVsE2Tl09pjs6eVx7IBtM6H2zSBMJTRiwhDYAxQGL5EqQxD1MwyFzqPIy10mMpcKC3iPJXPwMBvnJsWP@pcpQvH3SOHBUEIDTzWad7Ab1i0ZXMLBId@A0Cw77eA5XQB@Bhwltj9hVzpuZfq/cCFTAghfed6wUtwZU3ojWWkPeYKR8l0ANrbkncA8s5cyakX0udufHv1yM11pVfvgU8/W//er/QL5dqc1@otI8OrbID2R3iNGRF81IsszZ3BcWB0j/b9Rjv5ieTKuexVdelZHahpN5SOXmNCP7ozCGk18hMOGO11F/cEVLtmgOCMEXypXP/HiaP2EhAE75xgzadV9@JA4RioLxfVFW53JaNBdx68w3ndwjsXCPvFDLoC0Y5Ap0dvEg8rAikGqx9WCoQsXoSKcuFcvsi5472XhTIDDgrkz6NxhCEFD0buCc16OlKeQhr2XBrXiyK3MpWlOnfUfOk2N/b50iZjjXaq1c7JhEMu3ztSQhvrxOk6PASKtBYqb2hsdzM@5P67iGOhdVJk2RpEGWWFmfkEOhpqk9jNCgOKtOkYf@611TvR5EsF/NWlfOkaDq@s4emn6LUybrekzP4C" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p><strong>Explanation</strong></p>
<p><code>s</code> is all line characters, <code>h</code> and <code>w</code> are the height and width of the board.</p>
<pre class="lang-python prettyprint-override"><code> s,h,w=&quot;-\|/&quot;,len(b),len(b[0])
</code></pre>
<p>Iterate through the board</p>
<pre class="lang-python prettyprint-override"><code> for r in range(h):
  for c in range(w):
</code></pre>
<p>Store the value of the cell we're looking at in <code>v</code></p>
<pre class="lang-python prettyprint-override"><code>v=b[r][c]
</code></pre>
<p>If <code>v</code> is a line character, set up the loop to check for intersections.
Start looking at <code>y,x</code> which is initially set to the current cell <code>r,c</code>. <code>k,l</code> are set to the direction associated with the current line character. <code>z</code> keeps track of when we've finished analysing this cell.</p>
<pre class="lang-python prettyprint-override"><code>   if(v:=b[r][c])in s:
    y,x,k,l,z=r,c,*[[0,1],[1,1],[1,0],[1,-1]][s.find(v)],5
</code></pre>
<p>An intersection has occurred in any of the following conditions:</p>
<ul>
<li>If the currently extended point (<code>b[x][y]</code>) is anything except for an empty space, or the character we're currently extending</li>
<li>If the character being investigated is <code>\</code>, and the cell directly above, and directly to the left are both <code>/</code></li>
<li>If the character being investigated is <code>/</code>, and the cell directly above, and directly to the right are both <code>\</code></li>
</ul>
<pre class="lang-python prettyprint-override"><code>    while z:
     if&quot; &quot;!=b[y][x]!=v or v==&quot;\\&quot;and&quot;//&quot;==b[y-1][x]+b[y][x-1]or v==&quot;/&quot;and&quot;\\\\&quot;==b[y-1][x]+b[y][x+1]:return 1
</code></pre>
<p>This is slightly complicated. Essentially, this serves to reverse the direction we're moving along the line when we hit an edge. This is what the checks for <code>[y-h+1+k,x-w+1+l,y+k,x+l]</code> do. If any of them are 0, our next move would put us on an edge. In that case, we reverse the direction of <code>k</code> and <code>l</code>.
However, we also can end up in a situation where a move in either direction will put us on the edge. E.g.: if the board is 1x1. Therefore, we need to prevent the loop from continuing if this is the case. So instead of an if statement, this is a while loop, which also decrements <code>z</code>, which is the condition controlling the outer loop.</p>
<pre class="lang-python prettyprint-override"><code>     while(0in[y-h+1+k,x-w+1+l,y+k,x+l])*z:k,l=-k,-l;z-=1
</code></pre>
<p>Set the current cell to the character being investigated, move the cursor.</p>
<pre class="lang-python prettyprint-override"><code>     b[y][x]=v;y+=k;x+=l;
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, <s>95</s> 70 bytes</h1>
<pre><code>ＷＳ⊞υιυＵＥ¹¦¹Ｆ⊗ＬυＦ⊗ＬθＦ⁸«Ｊκι≔§-/|\λη¿⁼η⊟ＫＤ²✳λ«Ｗ‹!ＫＫ✳⁺⁴λ¹¿№⁻-/|\ηＫＫ≔-ω»»⎚ω
</code></pre>
<p><a href="https://tio.run/##hVA9T8MwEJ2TX3FkOquOoiIGJMRQtR2KihQJNsKQJm5i1dhpbNNK0N8ebFqlFCJxk@993LtzUedtoXLRdbuaCwa4kI01T6blskJCILW6RkuBk7swdaBB617zvWGyxDGFsevWqgWcKbsSrMQlk5VxFuLMQ8S2J24JfITBg31rnhVujhHBRGteSZyYhSzZHqM4@cyyiIIgFGov4GvA@dbmQmNNIVUNpoxtZrxlheFK4jWFcyOILx8TnM5bMq0xunITvQ09ezzrbEqF1XjjI8nxvuA7dKqskz1y6dh@rZr8GHTaPYodsfO@Q3gIp4LlLfa/5/CuG91f1Ch8gYt69UD2G4BhIPlXMQwkA4o/i3Xxu/gC" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Takes a rectangular array of newline-terminated strings as input and outputs a Charcoal boolean, i.e. <code>-</code> if any rays intersect, nothing if not. Explanation:</p>
<pre><code>ＷＳ⊞υιυＵＥ¹¦¹
</code></pre>
<p>Input the canvas, write it to Charcoal's canvas, then double-space it, using @UnrelatedString's tip to @JonathanAllan.</p>
<pre><code>Ｆ⊗ＬυＦ⊗ＬθＦ⁸«
</code></pre>
<p>Loop over all possible cells and directions.</p>
<pre><code>Ｊκι≔§-/|\λη
</code></pre>
<p>Jump to the cell and work out the ray character for the current direction.</p>
<pre><code>¿⁼η⊟ＫＤ²✳λ«
</code></pre>
<p>If there is an appropriate ray entering this cell, then...</p>
<pre><code>Ｗ‹!ＫＫ✳⁺⁴λ¹
</code></pre>
<p>... extend the ray though any empty spaces, and...</p>
<pre><code>¿№⁻-/|\ηＫＫ≔-ω
</code></pre>
<p>... check whether the ray directly intersected a ray in a different direction.</p>
<pre><code>»»⎚ω
</code></pre>
<p>Clear the canvas and output the final result.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s> 59 </s> 44 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<p>-13 bytes thanks to <a href="https://codegolf.stackexchange.com/users/85334/unrelated-string">Unrelated String</a> (explode the grid first so <code>\</code> always overlaps <code>/</code> at some character).</p>
<pre><code>K€Z$⁺=Ɱ“-|/\”¹ZŒdŒD4ƭoẸ$€¹ZŒḍŒḌ4ƭƊ€SZṖḊƊ4¡ỊȦ
</code></pre>
<p>A monadic Link that accepts a list of lines and yields <code>0</code> if the rays intersect or <code>1</code> if not (i.e. inverted).</p>
<p><a href="https://tio.run/##y0rNyan8/9/7UdOaKJVHjbtsH21c96hhjm6NfsyjhrmHdkYdnZRydJKLybG1@Q937VABKgOLPdzRCyJ6gOLHuoCCwVEPd057uKPrWJfJoYUPd3edWPb/4e4th9v//9e2RQHaXNEKYKAPoRRiQQIxCD5EQCEGzocKgNSgCihQJoDuMAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a> Or see the <strong><a href="https://tio.run/##y0rNyan8/9/7UdOaKJVHjbtsH21c96hhjm6NfsyjhrmHdkYdnZRydJKLybG1@Q937VABKgOLPdzRCyJ6gOLHuoCCwVEPd057uKPrWJfJoYUPd3edWPb/6OSHOxc/atx3aNuhbQ93bzncDtL8/7@2LQrQ5opWAAN9CKUQCxKIQfAhAgoxcD5UAKQGVUCBMgEMh2GKROtjGlJDugAWh@jq6lLZqVgMiSEyRPTJDER96jlVAcktKAL6VItvFAFd0pyqi26ILjVTIv64I96p@him6gMBGQ7RJ0aLPoVpVVcXmgnoEIj61MxWVBKogQGgQAyGipjB5FSql6ugGAGW8DExpHkPrFy/BrVS0FdAFgBXHDWETQUX7vpgA2NgEQDUqh@LogbEAakEK4HIaQMA" rel="nofollow noreferrer" title="Jelly – Try It Online">test-suite</a></strong>.</p>
<h4>How?</h4>
<p>Explode the canvas with space characters:</p>
<pre><code>K€Z$⁺
   $  - last two links as a monad - f(Canvas):
K€    -   join each with space characters
  Z   -   transpose
    ⁺ - repeat that -&gt; A Canvas with space filling between rows AND columns
</code></pre>
<p>Create ray component masks:</p>
<pre><code>=Ɱ“-|/\” - vectorised equals? mapped across &quot;-|/\&quot;
</code></pre>
<p>Extend rays within each of these four masks:</p>
<pre><code>¹ZŒdŒD4ƭoẸ$€¹ZŒḍŒḌ4ƭƊ€
                    Ɗ€ - for each {Mask}:
      4ƭ               -   apply each of these four in turn:
¹                      -     no-op ('-' uses rows)
 Z                     -     transpose ('|' uses columns)
  Œd                   -     anti-diagonals (for '/')
    ŒD                 -     diagonals (for '\')
           €           -   for each &quot;Strip&quot;:
          $            -     last two links as a monad:
         Ẹ             -       any? -&gt; Strip contains ray segment(s)
        o              -       {Strip} vectorised logical OR {that}
                                -&gt; Strip of all ones if any 1s existed, else zeros
                  4ƭ   -   apply each of these four in turn:
            ¹          -     no-op
             Z         -     transpose
              Œḍ       -     convert back from anti-diagonals
                ŒḌ     -     convert back from diagonals
</code></pre>
<p>Check for crossing rays</p>
<pre><code>SZṖḊƊ4¡ỊȦ
S         - sum respective mask values together
     4¡   - do this four times:
    Ɗ     -   last three links as a monad:
 Z        -     transpose
  Ṗ       -     pop
   Ḋ      -     dequeue
       Ị  - insignificant (vectorises) --&gt; 1 at 0 or 1, else 0
        Ȧ - any and all?
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/282079/">282079</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




