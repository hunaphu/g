<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::277735</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>095</td><td>Retina 0.8.2</td><td>250122T093232Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277804#277804">Neil</a></td></tr>
<tr d-ix="1"><td>023</td><td>HOPS</td><td>250121T031839Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277784#277784">alephalp</a></td></tr>
<tr d-ix="2"><td>064</td><td>Wolfram Language Mathematica</td><td>250118T193239Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277744#277744">Greg Mar</a></td></tr>
<tr d-ix="3"><td>021</td><td>Nekomata + n</td><td>250121T082723Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277789#277789">alephalp</a></td></tr>
<tr d-ix="4"><td>066</td><td>Maple</td><td>250118T154018Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277741#277741">dharr</a></td></tr>
<tr d-ix="5"><td>083</td><td>JavaScript ES6</td><td>250118T153211Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277740#277740">Arnauld</a></td></tr>
<tr d-ix="6"><td>106</td><td>R</td><td>250119T141137Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277751#277751">Dominic </a></td></tr>
<tr d-ix="7"><td>050</td><td>Charcoal</td><td>250118T201738Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277745#277745">Neil</a></td></tr>
<tr d-ix="8"><td>098</td><td>Python 3.8</td><td>250119T023824Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277748#277748">Jonathan</a></td></tr>
<tr d-ix="9"><td>019</td><td>Jelly</td><td>250118T220615Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277747#277747">Jonathan</a></td></tr>
<tr d-ix="10"><td>116</td><td>Python</td><td>250118T141905Z</td><td><a href="https://codegolf.stackexchange.com/questions/277735/counting-rota-baxter-words/277739#277739">Albert.L</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language/a950ad7d925ec9316e3e2fb2cf5d49fd15d23e3d" rel="nofollow noreferrer">Retina 0.8.2</a>, 95 bytes</h1>
<pre><code>.+
$*a_b
{%`d
c$'¶$`cad
%`c
b$'¶$`cad
%`b
a$'¶$`ad$'¶$`da$'¶$`ada
}G`^(a)+_(?&lt;-1&gt;.)+$
\b(a+)_\1
</code></pre>
<p><a href="https://tio.run/##K0otycxL/K@q4Z7wX0@bS0UrMT6Jq1o1IYUrWUX90DaVhOTEFC7VhGSuJGRuElcihJuYAqFT4PxErlr3hDiNRE3teA17G11DOz1NbRWumCSNRG3N@BjD//8NuYy4jLlMuEwB" rel="nofollow noreferrer" title="Retina 0.8.2 – Try It Online">Try it online!</a> Link includes faster test cases. Explanation: Based on the Nitrodon's generator in his comment on the question.</p>
<pre><code>.+
$*a_b
</code></pre>
<p>Convert the input to unary, insert a separator, and append the starting symbol (I'm using letters as some of the symbols have a special meaning.)</p>
<pre><code>%`d
c$'¶$`cad
</code></pre>
<p><code>d</code> can be substituted with either <code>c</code> or <code>cad</code>. (These should be <code>(c)</code> but I don't actually need the <code>()</code>s.)</p>
<pre><code>%`c
b$'¶$`cad
</code></pre>
<p><code>c</code> can be substituted with either <code>b</code> or <code>cad</code>. (Again, omitting the <code>()</code>s around the <code>c</code>.)</p>
<pre><code>%`b
a$'¶$`ad$'¶$`da$'¶$`ada
</code></pre>
<p><code>b</code> can be substituted with any of <code>a</code>, <code>ad</code>, <code>da</code> or <code>ada</code>. (The <code>%</code> limits the effect of <code>$'</code> and <code>$`</code> to a single line, so only the line with the match gets replicated.)</p>
<pre><code>G`^(a)+_(?&lt;-1&gt;.)+$
</code></pre>
<p>Discard any substitutions which have become too long. This allows the loop to converge.</p>
<pre><code>{`
}`
</code></pre>
<p>Repeat the above until no new substitutions can be made.</p>
<pre><code>\b(a+)_\1
</code></pre>
<p>Count the number of exact matches.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://akc.is/hops/" rel="nofollow noreferrer">HOPS</a>, 23 bytes</h1>
<pre><code>A=1+A^2*x*(x+1);A+A^2*x
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70kI7-geG20kq5uQVFqsq2RgVLsgqWlJWm6FtsdbQ21HeOMtCq0NCq0DTWtHSE8iCxU0QIoDQA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Derived from the formula in <a href="https://codegolf.stackexchange.com/a/277747/9288">Jonathan Allan's Jelly answer</a>. Here <code>A^2</code> is the generating function of <code>S</code> in Jonathan Allan's answer, which is <a href="https://oeis.org/A052705" rel="nofollow noreferrer">OEIS A052705</a>.</p>
<hr />
<h1><a href="https://akc.is/hops/" rel="nofollow noreferrer">HOPS</a>, 25 bytes</h1>
<pre><code>A=1+(1-A+(1+A+x*A)^2)*x/2
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70kI7-geG20kq5uQVFqsq2RgVLsgqWlJWm6FjsdbQ21NQx1HYGEtqN2hZajZpyRplaFvhFEHqpsAZQGAA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Derived from the generating function formula on <a href="https://oeis.org/A157418" rel="nofollow noreferrer">OEIS</a>.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, <strike>68</strike> 64 bytes</h1>
<pre><code>SeriesCoefficient[(y=4t+4t^2)/(2-t-2t^2+(t+2)√(1-y)),{t,0,#}]&amp;
</code></pre>
<p><a href="https://tio.run/##y00syUjNTSzJTE78n2b7Pzi1KDO12Dk/NS0tMzkzNa8kWqPS1qRE26QkzkhTX8NIt0TXCMjU1ijRNtJ81DFLw1C3UlNTp7pEx0BHuTZW7X9AUSZQk2NRUWJldJqOkUFs7H8A" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a> Uses the generating function given in OEIS, like <a href="https://codegolf.stackexchange.com/a/277741/56178">dharr's answer</a>, but <code>SeriesCoefficient</code> does the coefficient extraction for us. -4 bytes thanks to alephalpha who found an algebraically equivalent generating function that's shorter to use.</p>
<p>I realized that I can avoid the scientific-notation imperfection of the initial submission by replacing <code>(...)^.5</code> with the equivalent <code>√(...)</code>, since <code>√</code> is a three-byte character for Mathematica.</p>
<p>Previous version (68 bytes):</p>
<pre><code>SeriesCoefficient[(2-t-2t^2-(t+2)(1-4t-4t^2)^.5)/2/(t+1)^2,{t,0,#}]&amp;
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/AlephAlpha/Nekomata" rel="nofollow noreferrer">Nekomata</a> + <code>-n</code>, 21 bytes</h1>
<pre><code>ŧĉᵐzç0ɔYṀƵ¿ᵗ{qCᵈƆM→&gt;N
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70iLzU7PzexJHFNtJJurpKOgpJunlLsgqWlJWm6FjfVji4_0vlw64Sqw8sNTk6JfLiz4djWQ_sfbp1eXej8cGvHsTbfR22T7PyWFCclF0P1LFhtyGXEZcxlwmXKZQYRAgA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>A Rota-Baxter word with <span class="math-container">\$n\$</span> <code>a</code>s can be represented as a list of <span class="math-container">\$n\$</span> non-negative integers, where each integer represents the level of nesting of the corresponding <code>a</code>. For example, <code>a(a)a(a(a)a)</code> can be represented as <code>[0,1,0,1,2,1]</code>. It can be easily verified that two different Rota-Baxter words have different representations.</p>
<p>Furthermore, the list representation should satisfy the following conditions:</p>
<ol>
<li>Either the first or the last element is 0. So that the word either starts with <code>a</code> or ends with <code>a</code>.</li>
<li>There are no two consecutive elements that are equal. So that <code>aa</code> and <code>)(</code> does not occur.</li>
<li>For any contiguous subsequences of the list, say <span class="math-container">\$a_i, a_{i+1}, \ldots, a_{j-1}, a_j\$</span>, we must have <span class="math-container">\$\max(a_i, a_j) + 1 \ge \min(a_{i+1}, \ldots, a_{j-1})\$</span>. So that the word does not contain a balanced substring that is enclosed twice.</li>
</ol>
<pre><code>ŧĉᵐzç0ɔYṀƵ¿ᵗ{qCᵈƆM→&gt;N
ŧ                       Find an n-tuple of 0, 1, 2, ..., n-1
 ĉᵐz                    such that no two consecutive elements are equal.
    ç0ɔ                 Prepend and append 0s.
       YṀƵ¿             Check that the list now contains consecutive equal elements,
                            which means that either the first or the last element
                            of the original list is 0.
           ᵗ{           Check that the following condition cannot be satisfied:
             q              Find a contiguous subsequence
              CᵈƆM          such that the max of the first and last elements
                  →         plus 1
                   &gt;N       is less than all the other elements.
</code></pre>
<p><code>-n</code> counts the number of solutions.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://www.maplesoft.com/" rel="nofollow noreferrer">Maple</a>, <s> 72 </s> 66 bytes</h1>
<pre><code>n-&gt;(D@@n)(t-&gt;(2-t-2*t^2-(t+2)*sqrt(1-4*t-4*t^2))/2/(t+1)^2)(0)/n!;
</code></pre>
<p>The expression in t is the generating function given in OEIS. Differentiating n times, evaluating at t = 0 and dividing by n! gives the appropriate coefficient in the series.</p>
<p>Edit: shorter version above by using D for differentiation. Earlier:</p>
<pre><code>n-&gt;eval(diff((2-t-2*t^2-(t+2)*sqrt(1-4*t-4*t^2))/2/(t+1)^2,t$n)/n!,t=0);
</code></pre>
</div>
<div id="pu5" class="pu"><h1>JavaScript (ES6), 83 bytes</h1>
<p><em>-2 thanks to <a href="https://codegolf.stackexchange.com/users/100664/emanresu-a">emanresu A</a></em></p>
<p>This is a port of <a href="https://codegolf.stackexchange.com/a/277739/58563">Albert.Lang's Python answer</a>, with even more recursion.</p>

<pre class="lang-none prettyprint-override"><code>f=n=&gt;n&gt;1?2*h(n)+h(n-1):n
g=(n,k=n)=&gt;--k&gt;1?h(k)*g(n-k)+g(n,k):v=f(n)
h=n=&gt;2*g(n-1)-v
</code></pre>
<p><a href="https://tio.run/##HYzBDoMgEETvfAUHD6yUJnjULv0VjVVsMUujxovh2@nSy8wkb2Y@wzns4/b@Hobia8p5RkJHzj6belEEmsVYaEl4VHQLSIDOmMCFRQWoPeMA2hcG7Ykzb8RSPpo/s2DOPMdNrdMhSaK0HduDveGgNchLSDlG2uM63dfoVT@o6qIE3K2ucpd66ETKPw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>, 106 bytes</h1>
<pre class="lang-r prettyprint-override"><code>\(n,f=expression((2-F-2*F^2-(F+2)*(1-4*F-4*F^2)^.5)/2/(F+1)^2)){for(i in 1:n)f=D(f,&quot;F&quot;)
eval(f)/prod(1:n)}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m72waMHqovySxKTEipLUItulpSVpuhY3s2I08nTSbFMrCopSi4sz8_M0NIx03XSNtNzijHQ13LSNNLU0DHVNtNxAOM5IM07PVFPfSB8oY6gJ5GpWp-UXaWQqZOYpGFrlaabZumik6Si5KWlypZYl5mikaeoXFOWnaIDkaiE2bitOLCjIqQQKWeggnKMJkVywAEIDAA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Uses the generating function <code>(2-t-2*t^2-(t+2)*sqrt(1-4*t-4*t^2))/(2*(t+1)^2)</code> from the OEIS (slightly rearranged).<br />
Hugely inspired by <a href="https://codegolf.stackexchange.com/a/277741/95126">dharr's answer</a> which led me to the R <code>D</code>=<code>deriv</code>ative function: upvote that.</p>
<hr />
<h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>, 93 bytes</h1>
<pre class="lang-r prettyprint-override"><code>\(n)`if`(n&lt;3,n,sum(2*?n,?n-1))
`?`=\(n,C=choose)sapply(1:(n/2),\(i,m=n-i)C(n,i-1)*C(2*m,n)/m)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m72waMHqovySxKTEipLUItulpSVpuhY3Y2M08jQTMtMSNPJsjHXydIpLczWMtOzzdOzzdA01NbkS7BNsgUp0nG2TM_Lzi1M1ixMLCnIqNQytNPL0jTR1YjQydXJt83QzNZ2BqjKBerScgQbk6uRp6udqQizZDtdjaKCDcAJUdsECCA0A" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>A port of the formula in <a href="https://codegolf.stackexchange.com/a/277747/95126">Jonathan Allan's answer</a>, which I haven't even tried to understand: upvote that too.</p>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 50 bytes</h1>
<pre><code>⊞υ⁰≔⟦⁰⟧θＦＮ«≔∨¬ιζη≔↨υ⁰ζ≔Σ×θ⮌υε⊞θ⁺⁺εη⊗ζ⊞υ⁺↨θ⁰ε»Ｉ⁺η⊗ζ
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70iOSOxKDk_MWfBgqWlJWm6Fje_BZQWZ2iU6igYaFpzORYXZ6bnaUQbxOooFAL5aflFChqeeQWlJX6luUmpRRqamgrVXJxQZf5FGn75JRqZmjoKVUCcAdQAk3JKLE6FGAqSQ4gHl-ZqhGTmphZrFOooBKWWpRaB1GlqApWlgpSBHQOUCsgpLdYAE6kgg3UUXPJLk3JSUzSqgGph6kqh6sCWFUIsSwVJ13IFFGXmlWg4JxaXQEzJQDVB03pJcVJyMTQMlkcr6ZblKMUuMjKBCAAA" rel="nofollow noreferrer">Attempt This Online!</a> Link is to verbose version of code. Explanation: Port of @Albert.Lang's ungolfed code, converted to dynamic programming for the functions <code>e</code> and <code>j</code> (<code>b</code>, <code>o</code> and <code>n</code> are only needed transiently.)</p>
<pre><code>⊞υ⁰≔⟦⁰⟧θ
</code></pre>
<p>Start with <code>e[0]=0</code> and <code>j[0]=0</code>.</p>
<pre><code>ＦＮ«
</code></pre>
<p>Loop <code>n</code> times.</p>
<pre><code>≔∨¬ιζη
</code></pre>
<p><code>b(m)=1</code> if <code>m=1</code>, otherwise it equals <code>o(m-1)</code>, whose value would be still be in the variable <code>z</code> by this point on the second loop.</p>
<pre><code>≔↨υ⁰ζ
</code></pre>
<p><code>o(m)=j[m-1]</code>. (<code>AtIndex(u, i)</code> would also work here, but it wouldn't work below.)</p>
<pre><code>≔Σ×θ⮌υε
</code></pre>
<p><code>n(m)</code> is the dot product of <code>e[:m]</code> and <code>j[:m][::-1]</code>.</p>
<pre><code>⊞θ⁺⁺εη⊗ζ
</code></pre>
<p><code>e[m]=n(m)+b(m)+2*o(m)</code>.</p>
<pre><code>⊞υ⁺↨θ⁰ε
</code></pre>
<p><code>j[m]=e[m]+n(m)</code>.</p>
<pre><code>»Ｉ⁺η⊗ζ
</code></pre>
<p>Calculate the final number of Rota-Baxter words.</p>
<p>A port of a mixture of @xnor's port and @JonathanAllan's Jelly answer is only 42 bytes:</p>
<pre><code>Ｉ∨ΣΣＥ⁻ＮＥ³¬ιＥ⊘ι÷Π⁻⊗⁻ι⊕λ…⁰ι×Π⊕⁺…⁰λ…⁰⁻ιλ⁻ι⊕λ¹
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=dZDNCoJAEMcJehDxNIJCX4egYx7yoEl1iw7rutXCusp--DJdJIp6pp6mVRfp0mEG5j__-c0wtze-IoFLxJrmqdU5WH5G41RQrmCNpIKtgL0uuohRBTHlWkLEK60SXWREgOc7bWPuO0mpgHqeFTaI1SQ3gu9EXIW0pjmBVJS5xspiwlJnzHj6irZGLEhBuDIi60g7xC8EJr7Tgw-0IHKg_NpTZhCDm_2ODvgW2Z33b5_tT01ePWSGpX3J6-gGNXNP99miF74" rel="nofollow noreferrer">Attempt This Online!</a> Link is to verbose version of code. Explanation: Charcoal has neither <code>comb</code> nor <code>factorial</code> built in, so I've broken the combinations down into products of ranges, except that the two <code>n!</code>s cancel, and instead of dividing two ranges from <code>1</code> to two values I can just take the product between those values.</p>
</div>
<div id="pu8" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8</a>, 98 bytes</h1>
<p><a href="https://codegolf.stackexchange.com/users/20260/xnor">Xnor</a>'s port of my <a href="https://codegolf.stackexchange.com/a/277747/53748">Jelly answer</a>.</p>

<pre class="lang-none prettyprint-override"><code>lambda N:sum(comb(2*k,n)/k*comb(n,n+~k)for n in[N,N,N-1]for k in range(1,n))or 1
from math import*
</code></pre>
<p>An unnamed function that accepts a positive integer and returns the number of Rota-Baxter words with n <code>a</code>s.</p>
<p><strong><a href="https://tio.run/##PYwxDsIwEAT7vOJK2xghhwZF4gv5QKBwABPL3Nk6TEHD182BBNpqRztbnnXJtN0VbgH2cGg3j/PZwzjcH6hOGWfVm2RJb5L5NrK0eiUdMgNBpGm0krU7fkASAOzpelFOFC3IdYEzAvq6QMSSuZr2c//T3umhg8KRqvwHJWp7Aw" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></strong></p>
<p>Note that for <span class="math-container">\$n&gt;1\$</span> this returns a float, at <span class="math-container">\$n=28\$</span> this becomes inaccurate. An integer version that does not suffer from this is <strong>100 bytes</strong> <a href="https://tio.run/##PY0xDsIwEAT7vOJK2wQlhgZFyhfyAaBwABPL3Nk6TEHD182BBNpmNdrR5mdZEm13mauHEQ715nA@O5iG@wPVKeGsNia2pM23U0urV9RdF8EnBoJA@6mVrO3xA6IAYEfXi7IiaUG28ZwQ0JUFAubExdSf@5/avtdDA5kDFTnxStz6Bg" rel="nofollow noreferrer">TIO</a>:</p>
<pre class="lang-none prettyprint-override"><code>lambda N:sum(comb(2*k,n)*comb(n,n+~k)//k for n in[N,N,N-1]for k in range(1,n))or 1
from math import*
</code></pre>
</div>
<div id="pu9" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s> 28 27 </s> 19 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>_~⁹c×Ḥc¥:⁸ðþṫ-§ṚḄȯ1
</code></pre>
<p>A monadic Link that accepts a positive integer, <span class="math-container">\$n\$</span>, and yields a positive integer, the number of Rota-Baxter words with <span class="math-container">\$n\$</span> <code>a</code>s.</p>
<p><strong><a href="https://tio.run/##ATYAyf9qZWxsef//X37igbljw5fhuKRjwqU64oG4w7DDvuG5qy3Cp@G5muG4hMivMf/Dh@KCrP//MjA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong></p>
<h4>How?</h4>
<p>The number of Rota-Baxter words with <span class="math-container">\$n\$</span> <code>a</code>s with an <code>a</code> at only the left (or, equivalently, right) end is:</p>
<p><span class="math-container">$$S(n) = \sum_{i=1}^{\lfloor \frac{n}{2} \rfloor}{\frac{\binom{n}{i-1}\binom{2(n-i)}{n}}{n-i}}$$</span></p>
<p><span class="math-container">\$S(n-1)\$</span> also gives the number of Rota-Baxter words with <span class="math-container">\$n\$</span> <code>a</code>s with an <code>a</code> at <em>both</em> ends, except when <span class="math-container">\$n=1\$</span> we have <span class="math-container">\$S(0)=0\$</span> rather than the required result of <span class="math-container">\$1\$</span>.</p>
<p>The number of Rota-Baxter words with <span class="math-container">\$n&gt;1\$</span> <code>a</code>s is then <span class="math-container">\$2S(n)+S(n-1)\$</span>.</p>
<pre><code>_~⁹c×Ḥc¥:⁸ðþṫ-§ṚḄȯ1 - Link: integer, N
          ðþ        - {v in [1..N]} by {n in [1..N]} table of f(v,n):
_                   -   {v} subtract {n} -&gt; v-n
 ~                  -   bitwise NOT  {that} -&gt; n-v-1
  ⁹c                -   n choose {that} -&gt; X = C(n, n-v-1)
       ¥            -   last two links as a dyad - f(v, n):
     Ḥ              -     double {v} -&gt; 2v
      c             -     {that} choose {n} -&gt; Y = C(2v, n)
    ×               -   {X} multiply {Y} -&gt; C(n, n-v-1) × C(2v, n)
        :⁸          -   integer divide {that} by v
                                         -&gt; C(n, n-v-1) × C(2v, n) ÷ v
            ṫ-      - tail from index -1 -&gt; rows for n=N-1 and n=N
              §     - sums       -&gt; [CountDoubleEnded, CountSingleEnded]
               Ṛ    - reverse    -&gt; [CountSingleEnded, CountDoubleEnded]
                Ḅ   - from binary -&gt; 2 × CountSingleEnded + CountDoubleEnded
                 ȯ1 - logical OR with 1 (replaces the 0 calculated for N=1 with 1)
</code></pre>
</div>
<div id="pu10" class="pu"><h1><a href="https://www.python.org" rel="noreferrer">Python</a>, 116 bytes</h1>
<pre class="lang-python prettyprint-override"><code>f=lambda m:m&gt;1and 2*j(m-1)+j(m-2)or m
n=lambda m:f(m)+sum(j(k)*n(m-1-k)for k in range(1,m-1))
j=lambda m:2*n(m)-f(m)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=XZBNDoJADIX3nKLLKTiJkJgYEz2CVzAjMPLXDhmGhTvv4YaN3snbyBgIhlWbl_f6vvT5bu-uMDwMr95puf84fWwUXTMFdKBTrDiDJKwEyRgjPxI0FijgxaUFYdT1JCpRY8jeKmvUo62GksEqvuUi3vgLGFRLLvFelD4-dT-0NQS659QZ03RQUmusg8b2l1SlRR6MbPMuzoZzFBo9ykrkX89KrDDwTPTPtNviAVpbshMeY-KYf_EF" rel="noreferrer">Attempt This Online!</a></p>
<h3>How?</h3>
<p>Here is an ungolfed version with an easier to understand recursion:</p>
<h4><a href="https://www.python.org" rel="noreferrer">Python</a>, 704 bytes</h4>
<pre class="lang-python prettyprint-override"><code>lambda m:2*o(m)+b(m)

# helper counts; all count balanced strings containing m a's subject to condition:
# e: enclosable: anything that may be inside a pair of parens within a valid RB
# b: bothsided:valid rb that starts and ends with an a (the same if m=1)
# n: nonesided: any enclosable string that has no a at either end; these are exactly the ones enclosed in a pair of non matching parens
# o: onesided: valid RB that has an a at exactly one end
# j: juxtaposable: anything balanced that may occur next to an a in a valid RB

e=lambda m:m&gt;0 and n(m)+b(m)+2*o(m)
b=lambda m:m&gt;0 and m&lt;2 or j(m-2)
n=lambda m:m&gt;2 and sum(e(k)*(j(m-1-k)) for k in range(m))
o=lambda m:m&gt;1 and j(m-1)
j=lambda m:e(m)+n(m)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZVJLjtQwEJVY5hQlzYJ4mpbolpBGGXoWHIAFayTkOJWJ0_5EdgW6uQqblhDcgR3XgNNQtvvHzCZ2ylWv3ntV335Oexq8O3zvNx9_zNQv7_6--G2kbTsJtlnf-tqKRcufqrqBAc2EAZSfHcV7kMaUO7TSSKewg0hBu8fIYUdSO76DBfkyQpzbERUB-fTWadLeNQyJDaBTxkfZGr5Lx3RSFQ2SwMo9tAjaRd0hSJikDuB7PgO6CF90yuX4Z2l0Bx_eMV7bQOtpSAVdU-KhLWiRZKDILTpu2ZVy_uP6mgaEKC236sFuVoKBXAPOOyxAidcVz6PMAjvIyJmMwndkSDaI4e_5ESOTDgi4k4rMPkUgQR6R2K7M_qSK27FiUll_kcg8fAMXGiehl86Zf-p87MG5qT0Xjg2M847k9Mzb87TOJnul5gAOd3lAGfN_YyvcnJfCPrzOJrrTaizKmlTt8xz7dg0-wFjb5VpU7jphnRPibGust-K2Tjmr5VYI6LlimwgE6R6RkUXlrytXuTLni2q8vKTURWJVFvnPrz54C_3sFHlvImg7-UBgwvxJSTUgm2TRev0V07Q0m6kUGgySsGyHnwnUwCTKsHl6MylvMblxAqnfs-WixqzuSdBlek-Co6iSQHsRuHr1ZiUamHinqO6T3iLgcCjnPw" rel="noreferrer">Attempt This Online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/277735/">277735</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




