<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::279741</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>057</td><td>05AB1E</td><td>250521T105123Z</td><td><a href="https://codegolf.stackexchange.com/questions/279741/form-dots-into-the-highest-scoring-dice/281843#281843">Kevin Cr</a></td></tr>
<tr d-ix="1"><td>386</td><td>Maple</td><td>250518T000400Z</td><td><a href="https://codegolf.stackexchange.com/questions/279741/form-dots-into-the-highest-scoring-dice/279772#279772">dharr</a></td></tr>
<tr d-ix="2"><td>114</td><td>Charcoal</td><td>250517T144500Z</td><td><a href="https://codegolf.stackexchange.com/questions/279741/form-dots-into-the-highest-scoring-dice/279766#279766">Neil</a></td></tr>
<tr d-ix="3"><td>048</td><td>Jelly</td><td>250516T183332Z</td><td><a href="https://codegolf.stackexchange.com/questions/279741/form-dots-into-the-highest-scoring-dice/279751#279751">Jonathan</a></td></tr>
<tr d-ix="4"><td>530</td><td>Python3</td><td>250516T134605Z</td><td><a href="https://codegolf.stackexchange.com/questions/279741/form-dots-into-the-highest-scoring-dice/279745#279745">Ajax1234</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 57 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>|DSðÊ.āsgä2Fø€ü3}€`ʒ€€нJJC•G¶=ÇZb°7(Ú•žAвså}æ¦ε˜ι`DÙQ*O}à
</code></pre>
<p>Multiple lines of input.</p>
<p><a href="https://tio.run/##yy9OTMpM/f@/xiX48IbDXXpHGovTDy8xcju841HTmsN7jGuBVMKpSUASiC7s9fJyftSwyP3QNtvD7VFJhzaYaxyeBRQ4us/xwqbiw0trDy87tOzc1tNzzu1McDk8M1DLv/bwgv//8xXyFYAgnwvEyIcxgLQClwJYQkEBAA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V@m5JlXUFpipaCkU2nLpeRfWgLh2Sv913NyCT684XCX3pHG4vTDS4zcDu941LTm8B7jWiCVcGoSkASiC3u9vJwfNSxyP7TN9nB7VNKhDeYah2cBBY7uc7ywqfjw0trDyw4tO7f19JxzOxNcDs8M1PKvPbzgv5JemM6hbfb/o5XyFRQU8sFQISYPxAQhBQgHJpOvpKOgpADhx@RB5PMhCuAqFSCq8iHa80HKwGwoC6IVaoYCTGV@PqbKfKglEJcgxMBuyFdAgHyY5fmoQhB78lGE4N5BEkJyD8IIuGeQTIX7FMl2bOowXAjmoLoQ4eoBcyEmgGtHF4TGDMIBQMF8DKcj4ghJLR4zFVADCadKigTBSQwTAN0KAwq4BRWggiCnwgTByRWnSgyAI6gJuhxDQT66aD52E/KJtQJf4GNEDpaklU/AinyyvIkPEApLSDihAryhiE0WpAWijUS9eO3FGTfw7ImujQS9hGTzsUijxCeGtFIsAA" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>|                   # Get all lines of input as a list
D                   # Duplicate this list of lines
 S                  # Convert the copy to a flattened list of characters
  ðÊ                # != &quot; &quot; check on each character (0 if &quot; &quot;; 1 if &quot;o&quot;)
    .ā              # Pair each bit with its 0-based index
      s             # Swap to get the list of lines again
       g            # Pop and push its length (amount of lines)
        ä           # Split the list of bit+index into that many equal-sized parts
2Fø€ü3}             # Get all overlapping 3x3 blocks:
2F    }             #  Loop 2 times:
  ø                 #   Zip/transpose; swapping rows/columns
   €                #   Map over each list:
    ü5              #    Convert it to an overlapping list of quintets
       €`           # Flatten this list of lists of 3x3 blocks one level down
ʒ                   # Filter this list of 3x3 blocks by:
 €€                 #  Nested map:
   н                #    Only keep the first item (the bit)
    JJ              #  Join the bits of this 3x3 block together
      C             #  Convert it from a binary-string to a base-10 integer
       •G¶=ÇZb°7(Ú• #  Push compressed integer 76186575295082998979527
         žAв        #  Convert it to base-512 as list: [16,68,84,257,273,325,341,365,455]
            s       #  Swap so the integer is at the top
             å      #  Check whether it's in this list
}æ                  # After the filter: get the powerset of valid dominoes
  ¦                 # Remove the leading empty list
   ε                # Map over each list of 3x3 blocks of bit+index pairs:
    ˜               #  Flatten it to a single list
     ι              #  Uninterleave into two parts to get a pair of lists,
                    #  one list of all bits, and one list of the indices
      `             #  Pop and push both lists to the stack
       DÙQ          #  Check that all indices are unique:
       D            #   Duplicate the list
        Ù           #   Uniquify the copy
         Q          #   Check that the two lists are still the same
          *         #  Multiply this check to the list of bits      
           O        #  Get the sum of this list of bits
   }à               # After the map: pop and leave the maximum sum
                    # (which is output implicitly as result)
</code></pre>
<p><a href="https://codegolf.stackexchange.com/a/166851/52210">See this 05AB1E tip of mine (sections <em>How to compress large integers?</em> and <em>How to compress integer lists?</em>)</a> to understand why <code>•G¶=ÇZb°7(Ú•</code> is <code>76186575295082998979527</code> and <code>•G¶=ÇZb°7(Ú•žAв</code> is <code>[16,68,84,257,273,325,341,365,455]</code>.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.maplesoft.com/" rel="nofollow noreferrer">Maple</a>, <s> 392 </s> 386 bytes</h1>
<pre><code>proc(X)M:=Matrix;s:=seq;Q:=M(subs(&quot; &quot;=0,&quot;o&quot;=1,[s]~(StringTools:-Split(X,&quot;\n&quot;))));r,c:=op(1,Q)-~2;max(map(x-&gt;add(add~(map2(op,1,x))),select(Z-&gt;nops({map(x-&gt;op(op(2,x)),Z)[]})=9*nops(Z),combinat:-powerset(select(x-&gt;ormap(EqualEntries,map(x-&gt;M(3,convert(x,base,2)),[365,455,341,325,273,84,257,68,16]),x[1]),[s(s([Q[(R:=i..i+2),(C:=j..j+2)],{s(s([m,n],m=R),n=C)}],j=1..c),i=1..r)])))))end;
</code></pre>
<p>Slightly ungolfed:</p>
<pre><code>proc(X)M:=Matrix;s:=seq;              # abbreviate Matrix and seq commands
F:=map(x-&gt;M(3,convert(x,base,2)),     # make 3x3 matrices of 0s and 1s
[365,455,341,325,273,84,257,68,16]);  # from coded allowed faces
Q:=M(subs(&quot; &quot;=0,&quot;o&quot;=1,[s]~(StringTools:-Split(X,&quot;\n&quot;)))); # string to Matrix of 0s and 1s
r,c:=op(1,Q)-~2;                      # numbers of rows and columns minus 2
# next line finds all possible 3x3 blocks and their coordinates (as a set of [i,j] pairs)
B:=[s(s([Q[(R:=i..i+2),(C:=j..j+2)],{s(s([m,n],m=R),n=C)}],j=1..c),i=1..r)];
B:=select(x-&gt;ormap(EqualEntries,F,x[1]),B); # filter out bad faces
P:=combinat:-powerset(B);              # all subsets of blocks
W:=select(Z-&gt;nops({map(x-&gt;op(op(2,x)),Z)[]})=9*nops(Z),P); # filter out overlapping blocks
max(map(x-&gt;add(add~(map2(op,1,x))),W)) # add block entries to get totals and find maximum
end:
</code></pre>
<p>Acceptable faces are coded as bit patterns converted to decimal. After decoding they are stored as 3x3 matrices with 0 or 1 entries.</p>
<p>The string is also converted to an (0,1)-matrix. All 3x3 submatrices are found and checked against the valid faces. Then all possible subsets of the set of remaining submatrices are found. Ones with overlapping coordinates are removed, and then the totals are found and the max taken.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 114 bytes</h1>
<pre><code>ＷＳ⊞υι≔⟦⟧ηＦ⁻Ｌυ²Ｆ⁻Ｌθ²«≔⭆✂υι⁺³ι¹✂λκ⁺³κ¹ζ¿№Ｉ⪪”)″GＧ0G¤E-✳?^≦”³⍘ζ o⊞η⟦ικ№ζo⟧»≔⟦⟦⟧⟧υＦυＦηＦ⬤ι⊙…λ²‹²↔⁻ν§κξ⊞υ⁺ι⟦κ⟧Ｉ⌈Ｅυ↨¹Ｅι§λ²
</code></pre>
<p><a href="https://tio.run/##hVFNb4JAED3Lr5hwGpJtIiBq4slyMtHExCPhQCnKxnWhLtuqTX87HT4UTG07CZB97828fUOcRsc4i0RZfqRcJIALmetiUxy53KFlwVqrFDUDbs2MuVJ8JzEIGaR03GZHwBWXWuEykbuCdBYDh5p@Mm8t82kM2imNxSrKcSN4nNQeDNaCetzKjoFNT8MJBvuO29ccvS50iQHfAvqZlgX6kSpwkwteoOmOvZHnuSPbdTxn4g6nI8ebDMfToT02GbhV93OkkjbnhYEJmWld86YMAl57NpMrnuiQ/L5uWwhC2oO@7kG3qdP2OxcCacRcntE/xyLx0yyvcjjkvEyUQofIF5UJXSTtqiQhxUK@Jick55PV1O0P1PFpZLAPLXJd083bzKvoxA/6gNUydRMMbQbVkXcza/OmZmUJD8r4Dczu6gr2VX2wUtSqv5WPZnaS@yt1KvhH@QuY9VCjp7uhRvn0Lr4B" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Takes a list of newline-terminated equal-length strings as input. Explanation:</p>
<pre><code>ＷＳ⊞υι
</code></pre>
<p>Input the strings.</p>
<pre><code>≔⟦⟧ηＦ⁻Ｌυ²Ｆ⁻Ｌθ²«
</code></pre>
<p>Start enumerating dice faces.</p>
<pre><code>≔⭆✂υι⁺³ι¹✂λκ⁺³κ¹ζ
</code></pre>
<p>Extract the next potential face.</p>
<pre><code>¿№Ｉ⪪”)″GＧ0G¤E-✳?^≦”³⍘ζ o
</code></pre>
<p>If this is a valid face (as per my answer to the related question), then...</p>
<pre><code>⊞η⟦ικ№ζo⟧
</code></pre>
<p>... add its position and value to the list.</p>
<pre><code>»≔⟦⟦⟧⟧υＦυＦη
</code></pre>
<p>Start building up permutations of that list.</p>
<pre><code>Ｆ⬤ι⊙…λ²‹²↔⁻ν§κξ
</code></pre>
<p>If this face does not overlap any of the existing faces in this permutation, then...</p>
<pre><code>⊞υ⁺ι⟦κ⟧
</code></pre>
<p>... add a new permutation that includes this face to the list.</p>
<pre><code>Ｉ⌈Ｅυ↨¹Ｅι§λ²
</code></pre>
<p>Output the highest total found.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 48 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>O%3C×Jṣ0ṡ3Z€ṡ€3ẎŒPFQƑ$Ƈµ&gt;0FḄe“Ñ4ÑḌÑ4ÑðZ‘Ä¤ƲƇFS)Ṁ
</code></pre>
<p>A monadic Link that accepts a list of characters (including the newline characters) and yields the maximal pip-count.</p>
<p><strong><a href="https://tio.run/##y0rNyan8/99f1dj58HSvhzsXGzzcudA46lHTGiANJI0f7uo7OinALfDYRJVj7Ye22hm4PdzRkvqoYc7hiSaHJz7c0QOmD2@IetQw43DLoSXHNh1rdwvWfLiz4f9/BV1dXa6afIX8GhQSLAyVyweJKigo1EDZyHJgHQr5Ctj0KSDpw5BTgOtTQJNTQDFTAZs@BTz6FLDpU0CxDyr3H@gqIEchnwvEyIcxgLQClwJYQkEBAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> (Too inefficient for anything much bigger within one minute.)</p>
<h4>How?</h4>
<pre><code>O%3C×Jṣ0ṡ3Z€ṡ€3ẎŒPFQƑ$Ƈµ&gt;0FḄe“...‘Ä¤ƲƇFS)Ṁ - Link: list of characters, Sheet
O%3C                                       - ordinals, mod three, complemented
    ×J                                     - multiply by 1-indices
                                               'o' -&gt; +i, ' ' -&gt; -i, '\n' -&gt; 0
      ṣ0                                   - split at zeros
        ṡ3                                 - slices of length three
          Z€                               - transpose each
            ṡ€3                            - slices of each of length three
               Ẏ                           - tighten -&gt; list of possible 3×3s
                ŒP                         - powerset -&gt; all selections (including overlaps)
                     $Ƈ                    - keep those for which:
                  F                        -   flatten
                   QƑ                      -   is invariant when deduplicated
                                              -&gt; all non-overlapping selections
                       µ                )  - for each:
                        &gt;0                 -   greater than zero? (i.e. recover isPip values)
                                    ƲƇ     -   keep those for which:
                          F                -     flatten
                           Ḅ               -     convert from binary -&gt; ID
                                   ¤       -     nilad followed by links as a nilad:
                             “...‘         -       code-page indices -&gt; [16,52,16,173,16,52,16,24,90]
                                  Ä        -       cumulative sums -&gt; [16,68,84,257,273,325,341,365,455]
                            e              -     {ID} exists in {that}?
                                      F    -   flatten
                                       S   -   sum
                                         Ṁ - maximum
</code></pre>
</div>
<div id="pu4" class="pu"><h1>Python3, 530 bytes</h1>
<pre class="lang-py prettyprint-override"><code>R=range
V=lambda b:sum(L:=[sum(j)for j in zip(*b)])*((not(Y:=sum(L))%2 or b[1][1])and(Y&lt;2 or(any(b[0])and any(b[2])))and L==L[::-1]and(L[1]&lt;=L[2]or Y==1)and Y&lt;7)
def f(b):
 q,s,o=[([],[],0)],[],[]
 N,M=len(b),len(b[0])
 for t,e,c in q:
  F=1
  for x in R(N):
   for y in R(M):
    U={(J,K)for J in R(x,x+3)for K in R(y,y+3)}
    if all(not U&amp;u for u in t)and(E:=sorted(e+[(x,y)]))not in o and x+3&lt;=N and y+3&lt;=M and(v:=V([[int(J=='o')for J in j[y:y+3]]for j in b[x:x+3]])):q+=[(t+[U],E,c+v)];F=0;o+=[E]
  if F:s+=[c]
 return max(s)
</code></pre>
<p><a href="https://tio.run/##vZZbb5swFMef509xVGmL3bApJL3S@LF9aNM8VGqlyEMTNGSjSjkpkCps2mfPfIGQi0O7PQxQsH8@l7@PjZxZkf/ApHc2S5fLO54GyfeIPPBp8ByOAwi9bP5MBx4X6v3EJpjCE8QJ/Ixn9DBkPjukNMGcjjyuLRn72AVpFArXlw8LkjEd9RWiQVLQUHQ0A9Pp@ozp7oDzgfC8z66vHAbSsy9B15eRRpy72mbUP2VkHE1gQkPmEXhxMge5oMJ35NNh@iV8AkPnlk@jRFo5@qVyElDScydyHpX8F@kPV9yVv4ovFLujQxXWkMKQW0Pgnv@i186Nnv@1GVo4i3ZPgxsDCqeQ4Le2jycQTKeqMnD/aa4jzpVVrgtyKYuFaR6NadQWMlAh68iUrbRAUHOVoft8qJuFat6qJn31@AMVIk5yes15C1u1nidReNLS91crFIqFt1CEMe@lLeuUt8W971w6j@1X5l9c8c4FSnwpC6bkXnmZ7D3KXhrl8zSB52BBM7bMXOBwcHBAUE4L9Q1EtdQDul1xJMou65YOYEaIsUPTLx2gMu6toqOhZQosCUIVB4zD0ZoD4rYDmoRGXU2053GlC6G@sJSEm0RnxQ1SzXSN1Npq/2p6axHJZpx9VlrkiU2k7myIXOn@zyJLlafrS7x1kXqfrCUlmwoqiKt7Nd4QFDarYrfUAs@qXbJ71Qz2MjBMJayY3m577HZzaBHnDVV6YxaWqcP2htj1x3fGb6jiTpF3NwY2x8d/mF/juK6l23lHMd8c3FqmpiJbBpWDcforz6ace9et@va2nd7t@cYgWkbJ3j1QLYM6fXP8FmKQjuXh4JEP5WEhxGHs62MuVmfPJJ7mUUqHmEQOZF@y2TTOaetr0mLMJ2SWqhNsQutIrvwbYMFdO@7Z8ZEdH9vxiR2f2vGZHZ/bsduRfPkH" rel="noreferrer">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/279741/">279741</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




