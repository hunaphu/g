<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::274951</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>536</td><td>sed 4.2.2 r</td><td>240815T125547Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/274997#274997">guest430</a></td></tr>
<tr d-ix="1"><td>615</td><td>Python</td><td>240819T183943Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/275054#275054">Kolen Ch</a></td></tr>
<tr d-ix="2"><td>049</td><td>05AB1E</td><td>240814T083430Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/274969#274969">Kevin Cr</a></td></tr>
<tr d-ix="3"><td>101</td><td>Charcoal</td><td>240816T084104Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/275008#275008">Neil</a></td></tr>
<tr d-ix="4"><td>048</td><td>Pyth</td><td>240814T221156Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/274988#274988">CursorCo</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.gnu.org/software/sed/" rel="nofollow noreferrer">sed 4.2.2</a><sub><sup> <code>-r</code>, <s>1303</s> <s>1252</s> <s>1201</s> <s>1053</s> <s>838</s> <s>764</s> <s>710</s> <s>681</s> <s>629</s> <s>615</s> </sup></sub> 536 bytes</h1>
<pre><code>s/^/0/                                               #set initial array to test against
:;h;s/\W+//;y/10/ab/;G                               #the start of the main loop
:b;s/(.*)\b([ab]+)( *)/\2\n\3\1/;h;s/\n.*/\n.... ./  #the start of the shuffle loop
:c;s%(.*)\n((.*) (.*))%sed -r 's/^(\3|.)$/\4\4\&amp;/;T;s/\4/\&amp;\\n/2g;q;:;a\3\3\3\2\4'&lt;&lt;&lt;\1%e;/\n$/!bc
s%.*%sed '1h;1d;x;2!s/\\.//;T;/^\\n/{s/$/\\n/p;z};:;$!x;3~2{H;d}'&lt;&lt;&lt;'&amp;'%e
s/(.)\n/\1/g;y/\n/ /;G;s/\n\w*\n/ /;/[ab]{2}/bb      #the end of the shuffle loop
h;s/\n.*//;y/ /\n/                                   #formatting for the calc loop
:d;s!.*!sed -n 'h;:;x;p;x;s/.//;//b'&lt;&lt;&lt;'&amp;'!e         #start of the calc loop; square everything
:e;s/\b\n\b//;s/ba|ab/a/;te                          #add those squares
s/\n(\n*)/\1/g;/\n/bd                                #remove a layer, end calc loop
y/a/#/;G;s/\n.*\n//                                  #grab input to compare against
T;s/^b*(#*)(\w*)\1$/\2/;tz                           #if they match, output the matrix
s/b*#*//;T                                           #delete the calc result
s/10(0*)(1*)#/01\2\1#/;t                             # v v v v v v v v v v v v v v v v v
s/(0*)0(1*)/\21\1/;t                                 #get the next matrix, end main loop
s/1/0000/g;t                                         # ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
:z                                                   #label for escaping the infinite loop
</code></pre>
<p><a href="https://tio.run/##PZJNU9swEIbv@hWbMYk/KF7bCW1jcexMOTDTCzM9IJiREjVxa2TXUiAJ0J/edDdA7bGy3miffd@1vF0eai093pRn81ucRLiSOyyr6ez846fPcyzeQ6Q9UYHziIO74hRRBg0QgbdLaDzotu0eKQwdBP3LQuP6TaAVNk4Puw@0zcK9pRLUeD6dzcVW7uWW6mlbaNwK7jdtaPr2rdJTQW8HHQhpduDsY9s46wmhnYewtnD57eoL@F4vbEISYg@ds/Cgh0ab1qawssRYdH1DgO7BDvBj6O6Phf1gH5pu42HYuJwyJP7nxgdYtFYPHppwIINYoKzlmryq7@yVZlKgNii/itpQNsmzVJnkRpvb0zSBLEVVKaemqsTXKpdnvNAFOYp6If34WOMS/gFe0jHP7myAmBomavqcpyeoZnRPUF4zZIZqopTDaiV/kxxNfL4rNYsvLi5UObaSmpzgyCyEH@fZERiXa1ku5VZWI0KoHBmGd8x58kgdKOjl/oWAJ6OtnP6pni7l8oWJ8SQeW8HuSCiSFz4MFAH5PppSj9nrK7Lzp@oFjRH//fKYgPeLein9KM9GR4MO4jU128qeHo8sCNG89RtZUVsGGKIb5NNl9DNNWtMBYy00MeV4vqyG4WYpdvRv9K4pZ0koeGB3JkuiLE1IZqpKsloRZE8Qk0Us75rCskgK2lJmaUSnm2ZZEimwaUoXnKeykr8jJ0ss6KLOQdT7w6EQpajEVMzEuZj/7frQdM4fzoZ/" rel="nofollow noreferrer" title="sed 4.2.2 – Try It Online">Try it online!</a></p>
<p>did you know sed is turing complete? I happen to know that, and it makes me do things I shouldn't...</p>
<p>this does basically the same thing that the other answers are doing. we come up with a way to generate an infinite list of matrices <a href="https://tio.run/##VY7bDoIwDIbvfYommnCIZhuX8ircLFBgBjaydaAv79wwmNiLHr72b@uwC@F@Wk6OCZ7zsshFWVwYF03VCFZT5InyhFlTiQMKxqOxoaZwBhqVg9Z0CJuaJnh4R7HUpLRHMJ4WTzEfYJZkVYsOemtm2EZJuKIFR9Lu/VVOUfAyHqIClI6LMYZU5Dhc4dgjRDr@9Sn@j@4/uNFsO9P4JMgWOWAGpv@9UAT@Ngspo1242Q8" rel="nofollow noreferrer">(check the order here)</a>, calculate the value of each matrix <a href="https://tio.run/##bZFLU9swEIDv@hXykMQPwGs56cvycC13ekNlRopF7CGVg@WUUKA/vemuTUjb6TpZrffx7a7sbbXfP4LIQBtghZEeojSJlYmutfl6SgZPYlC5cmquBMgaM5RLE1IoPMWqpfTTocpFdHBS8dTbip93PPRwE6n5cxpPQC3wmYH8QpAFqJlSDvKVvJeF1MinJ1eLsCxLJaZWYpMJBGbJ/DRNBmAoaikquZN5gAiVAsHghjhPHrADGhv54wWBk2An5z/zp0tZvRAxnIVTy2g/HBRwl5V8xAbAQX4ellIPyfgK6kpdgTHsbVnAVE7JrKikD9IkGLZzPKyx005u8O@BpgEwr80CywpLAINogyEPRj/jNWuQPQ2C16UcXS6NQnBTsWKNaRrKUuTzxbv3Hz5@0pm4gOGzxGWaKBHpJI3T5AK/CXIo3ZxCBvsT3teWr7Xv@W277XjjNtvec93ZIdC4qvneVFu95vdbXXXaYbC9HYtat@Kts2f8oW6WNWrrENJ9032Pa2qk8FXXVGeY2d55vm7ubMHYCc9QBvVmC/F/e8zBn8gywQUKhTBjcPxjH3P2g0eQFsQYLZax7E8ZY8eTTHpDIR/Zh/Pg/xtA02VH/ug4lB1K2Qg8Mn61m75pnd@fd78B" rel="nofollow noreferrer">(check the math here)</a>, and then see if it's equal to the input. These two individual steps are fast and easy to check edge cases with; it's only the combined loop that takes a long time.</p>
<p>the tio link has cases <code>0,1,2,3,4,5,9</code> loaded in, which finishes in ~30 seconds, and <code>10</code> will also finish in just under 60 seconds; but if you want to try any other numbers you'll have to run it on your own computer.</p>
<p>in the explanation next to the code, I reference a 'shuffle loop' and a 'calc loop'. both of these are part of the above 'check the math' link, and together they find the value of an arbitrary matrix. the shuffle loop works by first inserting the correct number of newlines to make a <code>4n*n</code> matrix, and then re-ordering the lines so that we have 4 separate quadrants. this gets recursively applied until all arrays are one digit long. you can think of this as like making a list of lists of lists of etc until each item is only one bit. the calc loop then takes this list, squares each number, replaces the innermost lists with their sums, and repeats.</p>
</div>
<div id="pu1" class="pu"><h1>Python, 615 bytes</h1>
<pre class="lang-python prettyprint-override"><code>from numpy import*
Z=zeros
r=range
R=lambda n:r(n,-1,-1)
N=lambda M:M.shape[0]
z=lambda M,n:M if N(M)==n else(lambda w:(a:=Z((n,n)),[a.__setitem__((i*w,j*w),M[i,j])for i in r(N(M))for j in r(N(M))],a)[2])([2**i for i in r(n.bit_length())if N(M)*2**i==n][0])
def g(n):
    if n&lt;2:return array([[n]])
    if n&lt;5:r=Z(4);r[:n]=1;return r.reshape(2,2)
    else:a,b,c,d=(lambda n:next((i,j,k,l)for i in R(n)for j in R(i)for k in R(j)for l in R(k)if i*i+j*j+k*k+l*l==n))(n);A,B,C,D=map(g,(a,b,c,d));m=max(map(N,[A,B,C,D]));return block([[z(A,m),z(B,m)],[z(C,m),z(D,m)]])
lambda n:&quot;;&quot;.join(&quot;&quot;.join(map(str,map(int,l)))for l in g(n))
</code></pre>
<h1>Test</h1>
<p>Assign the function to <code>G</code>, and</p>
<pre class="lang-python prettyprint-override"><code>&gt;&gt;&gt; for i in (0, 1, 3, 4, 5, 9, 15, 67, 78):
&gt;&gt;&gt;     print(i, G(i), sep=&quot; -&gt; &quot;)
0 -&gt; 0
1 -&gt; 1
3 -&gt; 11;10
4 -&gt; 11;11
5 -&gt; 1110;0000;0000;0000
9 -&gt; 1100;1000;0000;0000
15 -&gt; 1111;1000;1010;0000
67 -&gt; 11111000;00000000;00000000;00000000;10001000;00000000;00000000;00000000
78 -&gt; 11111010;00000000;00001000;00000000;10101000;00000000;00000000;00000000
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, <s>50</s> 49 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>∞Íonîü2íε`U0LsãεXô}Σ˜O]í€`.Δ[D˜g5‹#2δô2ô€øOOn}OOQ
</code></pre>
<p>Brute-force. Generates all <span class="math-container">\$2^k\times 2^k\$</span> sized matrices consisting of 0s and 1s, and will output the first valid one for the given input-integer <span class="math-container">\$n\$</span>.</p>
<p>-1 byte by changing the <code>∞&lt;on1š</code> (-1 and prepend <span class="math-container">\$1\$</span> manually) to <code>∞Íonî</code> (-2 and ceil the <span class="math-container">\$0.25\$</span> to <span class="math-container">\$1\$</span>)</p>
<p><a href="https://tio.run/##AVYAqf9vc2FiaWX//@KInsONb27DrsO8MsOtzrVgVTBMc8OjzrVYw7R9zqPLnE9dw63igqxgLs6UW0TLnGc14oC5IzLOtMO0MsO04oKsw7hPT259T09R//8xNQ" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##AWsAlP9vc2FiaWX/N8aSTj8iIOKGkiAiP05WIv/iiJ7DjW9uw67DvDLDrc61YFUwTHPDo861WMO0Xc61zqPLnE9dw63igqxgLs6UW0TLnGc14oC5IzLOtMO0MsO04oKsw7hPT259T09ZUf8iLlYs/w" rel="nofollow noreferrer">verify the smaller test cases up to n=7</a>.</p>
<p><strong>Explanation:</strong></p>

<p>Step 1: Generate a list of all possible outputs:</p>
<pre class="lang-python prettyprint-override"><code>∞          # Push an infinite positive list: [1,2,3,4,5,...]
 Í         # Decrease each by 2 to start at -1: [-1,0,1,2,3,...]
  o        # Take 2 to the power each: [0.5,1,2,4,8,...]
   n       # Square each: [0.25,1,4,16,64,...]
    î      # Ceil each: [1,1,4,16,64,...]
ü2         # Create overlapping pairs: [[1,1],[1,4],[4,16],[16,64],...]
  í        # Reverse each pair: [[1,1],[4,1],[16,4],[64,16],...]
ε          # Map over each pair:
 `         #  Pop and push both to the stack
  U        #  Pop the top smaller value, and save it in variable `X`
  0L       #  Push pair [1,0]
    s      #  Swap so the larger value is at the top of the stack
     ã     #  Cartesian product to create all combinations using the 1s/0s
      ε    #  Map over each list of 1s/0s
       Xô  #   Split it into blocks of size `X`
      }    #  Close the inner map
 Σ         #  Sort by:
  ˜        #   The flattened
   O       #   sum (of 1s)
]          # Close the sort and outer map
 í         # Reverse each inner list
  €`       # Flatten the list of list of lists one level down
           # (which has as side-effect that it reverses the inner lists,
           # hence the need for `í`)
</code></pre>
<p><a href="https://tio.run/##ATMAzP9vc2FiaWX//@KInsONb27DrsO8MsOtzrVgVTBMc8OjzrVYw7R9zqPLnE9dw63igqxg//8" rel="nofollow noreferrer">Try just this first step online.</a></p>
<p>Step 2: Find the first matrix that's a valid reduction for the given input-integer:</p>
<pre class="lang-python prettyprint-override"><code>.Δ         # Find the first matrix in this infinite list that's truthy for:
  [        #  Start an infinite list:
   D       #   Duplicate the current matrix
    ˜      #   Flatten it to a list
     g     #   Pop and push its length
      5‹   #   If this length is smaller than 5 (e.g. either 4 or 1):
        #  #    Stop the infinite inner loop
   2δô2ä€ø #  Split the matrix into four corner-blocks:
    δ      #   Map over each inner row:
   2 ô     #    Split it into pairs
      2ä   #   Then split the entire list into 2 equal parts as well
        €  #   Map over each inner matrix:
         ø #    Zip/transpose; swapping rows/columns
   OO      #  Sum each inner-most matrix
     n     #  Then square those sums
  }        # After the infinite loop to reduce it to a 2x2 matrix:
   OO      # Sum the four values in this matrix as well
     Q     #  Check whether it now equals the (implicit) input-integer
           # (after which the found matrix is output implicitly)
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/f8/2uX0nHTTRw07lY3ObTm8xejwlkdNaw7v8Pe3zasFEkAF0YY6MGgAwrE60QY6KBBJxBBDBKEGqh@vGsIisQA" rel="nofollow noreferrer">Verify the resulting <span class="math-container">\$n\$</span> for a given matrix to test just this second step</a> (minus leading <code>.Δ</code> and trailing <code>Q</code>). I've added <code>=</code> after both <code>OO</code>, so you can also see the intermediate steps of the reduction.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 101 bytes</h1>
<pre><code>Ｎθ≔⦃⁰⟦0⟧¹⟦1⟧⦄ηＷ∧¬§ηθη«≔⦃⦄η≔ＥιλζＦζＦζＦζＦζ«≔ΣＸ⟦νμλκ⟧²ε≔⁺Ｅ§ιν⁺ξ§§ιμπＥ§ιλ⁺ξ§§ικπδ¿∨¬§ηε‹ΣΣδΣΣ§ηε§≔ηεδ»»§ηθ
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=fVFBasMwEKTH-hWLThIoEBcKpTn5GEhSQ4_GB8eWaxFZdiS7CQl-SS-htLRf6Rf6mkqOBamhFQhpZ2dmd6WXz7RIVFol4nR6b5t8cvd99TWXddus2nLNFN6SmRdozZ8kPk7vIUJTFFPw7c1HcUehMIRdwQUDHMgMr6oGB81cZmyPCwpbQiyFwNG7djaDyMXLpMacgjDEg4XzSgE-EPjrNE5O-tiWOKx2ps1IUiiNCYWNae_GVmXWzDFD0eq-kuvNVJSG1ON7Cg6-SJcmXRPrNNKJ_3WbQWeOrG-B54Af1PhlmCUsmNb9FHZnFnHBb6ZdcB7lMjFU6LzOCxWX45efvel1qod__YjQ5Fmg-NW_PQM_" rel="nofollow noreferrer">Attempt This Online!</a> Link is to verbose version of code. Explanation: Lots of brute force, so can only solve inputs with <code>4×4</code> outputs before the heat death of the universe.</p>
<pre><code>Ｎθ
</code></pre>
<p>Input <code>n</code>.</p>
<pre><code>≔⦃⁰⟦0⟧¹⟦1⟧⦄η
</code></pre>
<p>Start with solutions for <code>0</code> and <code>1</code>.</p>
<pre><code>Ｗ∧¬§ηθη«
</code></pre>
<p>Repeat until a solution for <code>n</code> is found. (Also makes a copy of the solutions so far.)</p>
<pre><code>≔⦃⦄η
</code></pre>
<p>Start building solutions of twice (4×) the size.</p>
<pre><code>≔ＥιλζＦζＦζＦζＦζ«
</code></pre>
<p>For all possible sets of subsquares:</p>
<pre><code>≔ΣＸ⟦νμλκ⟧²ε
</code></pre>
<p>Calculate the value.</p>
<pre><code>≔⁺Ｅ§ιν⁺ξ§§ιμπＥ§ιλ⁺ξ§§ικπδ
</code></pre>
<p>Calculate the resulting square.</p>
<pre><code>¿∨¬§ηε‹ΣΣδΣΣ§ηε§
</code></pre>
<p>If this is a better square, then...</p>
<pre><code>≔ηεδ
</code></pre>
<p>... add or replace the previous solution for that value.</p>
<pre><code>»»§ηθ
</code></pre>
<p>Output the square for <code>n</code>.</p>
<p>108 bytes for a slightly less forceful version:</p>
<pre><code>Ｎθ≔⦃⁰⟦0⟧¹⟦1⟧⦄ηＷ∧¬§ηθη«≔⦃⦄η≔ΦＥιλ¬›×κκθζＦζＦζＦζＦζ«≔ΣＸ⟦νμλκ⟧²ε≔⁺Ｅ§ιν⁺ξ§§ιμπＥ§ιλ⁺ξ§§ικπδ¿∨¬§ηε‹ΣΣδΣΣ§ηε§≔ηεδ»»§ηθ
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=fVHdToMwFI6X8hQnXJWkSzZvXNwVN5olOkn0jnDBoEhDKYyCW7bwJN4sRqPP5Ev4Cp52NJlLlATafuf7OYe-fCZ53CRVLPb7967NRtOvs--5rLt20ZVL1pCVN3N8pfiTJLvxFYTu2I0oTPRu4kY9hRwJ65wLBsSXKVlULfHbuUzZhuQUVp6nKR7snHNrM4js-ZqLFoPu4ppwCgL52uOmYbGGH3nJFCkoFJ5xw-9Wi7OqAbL14K8V82zAQ1eSoFqjWSgplJiBbjjEhTZj2swyA9Ep04idABuSSDL4hoKFj8ollmvT1olO_K8rBh0uqWmBZ0Dum9P_xzThlillptBvqhF7-M3UDxxGOS4MCb3TO0HD5en9zN7UMlHD7X-E7uhZuNHr5fQA_AA" rel="nofollow noreferrer">Attempt This Online!</a> Link is to verbose version of code. Explanation: As above but when generating the list of possible solutions, excludes values whose square exceeds the input.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/isaacg1/pyth" rel="nofollow noreferrer">Pyth</a>, 48 bytes</h1>
<pre><code>M?Gho_SsNmsCMc2sgLtGdfqHs*VTT^UhH4]]Hgf&gt;2eSsgTQZ
</code></pre>
<p><a href="https://tio.run/##K6gsyfj/39fePSM/PrjYL7fY2TfZqDjdp8Q9Ja3Qo1grLCQkLjTDwyQ21iM9zc4oNbg4PSQw6v9/SwA" rel="nofollow noreferrer" title="Pyth – Try It Online">Try it online!</a></p>
<p>Can run up to about 30 before timing out online. Try a more performant, 5 byte longer version <a href="https://tio.run/##K6gsyfj/39fePSM/PrjYL7fY2TfZqDjdp8Q9Ja3Qo1grLCREzzk0o9jBw0jBJDbWIz3Nzig1uDg9JDDq/39DAwMDAA" rel="nofollow noreferrer">here</a> (can easily do 1000 without timing out). The faster version is the same except instead of looking at all permutations of 4 numbers in the entire range of the input, we only look at all combinations (with repetition) of 4 numbers in the range up to the square root of the input.</p>
<p>This answer uses a recursive approach.</p>
<h3>Explanation</h3>
<pre><code>M?Gho_SsNmsCMc2sgLtGdfqHs*VTT^UhH4]]Hgf&gt;2eSsgTQZQ    # implicitly add Q
                                                     # implicitly assign Q = eval(input())
M                                                    # define g(G,h)
 ?G                               ]]H                #   recursive base case, if G==0: return [[H]]
                              UhH                    #   list(range(H+1))
                             ^   4                   #   4x repeated cartesian product
                     f                               #   filter this list on lambda T (this keeps only quadruplets whose squares sum to the desired value)
                        s                            #     sum of
                         *VTT                        #     vectorized product of T and T
                      qH                             #     is equal to H
         m                                           #   map over lambda d (this constructs possible outputs from the recursive calls)
                gLtGd                                #     map g over d with a first argument of G-1
          sCMc2s                                     #     take four square matrices and put them in a bigger square
    o                                                #   sort by lambda N
       sN                                            #     flattened N
      S                                              #     sorted
     _                                               #     reversed
   h                                                 #   take the first element
                                      f        Z     # find the first integer which satisfies lambda T, counting up from 0
                                            gTQ      #   g(T, Q)
                                           s         #   flatten list
                                         eS          #   largest element
                                       &gt;2            #   is less than 2
                                     g          Q    # apply g on the result and the input
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/274951/">274951</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




