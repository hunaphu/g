<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::281920</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>051</td><td>Nekomata + n</td><td>250725T085202Z</td><td><a href="https://codegolf.stackexchange.com/questions/281920/count-all-the-fish/282803#282803">alephalp</a></td></tr>
<tr d-ix="1"><td>419</td><td>Python</td><td>250722T123435Z</td><td><a href="https://codegolf.stackexchange.com/questions/281920/count-all-the-fish/282734#282734">SevC_10</a></td></tr>
<tr d-ix="2"><td>219</td><td>JavaScript ES11</td><td>250523T220545Z</td><td><a href="https://codegolf.stackexchange.com/questions/281920/count-all-the-fish/281938#281938">Arnauld</a></td></tr>
<tr d-ix="3"><td>084</td><td>Charcoal</td><td>250525T144843Z</td><td><a href="https://codegolf.stackexchange.com/questions/281920/count-all-the-fish/281958#281958">Neil</a></td></tr>
<tr d-ix="4"><td>064</td><td>Jelly</td><td>250524T164606Z</td><td><a href="https://codegolf.stackexchange.com/questions/281920/count-all-the-fish/281946#281946">Jonathan</a></td></tr>
<tr d-ix="5"><td>104</td><td>05AB1E</td><td>250523T141717Z</td><td><a href="https://codegolf.stackexchange.com/questions/281920/count-all-the-fish/281927#281927">Kevin Cr</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/AlephAlpha/Nekomata" rel="nofollow noreferrer">Nekomata</a> + <code>-n</code>, 51 bytes</h1>
<pre><code>~q&quot;&lt;&gt;&lt;&gt;&quot;q3L=$qŤqN:Ť#3*äLᶜ{↔Ť↔Ť}:ᵐ↔Ðᵐ{xᶻŘᵐh≡}&quot;\\/&quot;=?
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=7VU9SgNBFC4FTzGMVpLwijQS1vUCwQtkU0SJCJLIkghCiKVgl8JC0CLCCha2prEMOYR2yUl8fzszazbaWKRwmZ2ded_3fmdm5-Gl1zm_6LYH7demrXZtxdhqz7Ymz5eD0-r-R-M6tVEcxTatNQ5203mWHtXn2U5tb5Y1FtPH4fLmbp5xN6ov3sY4mo3xO7xaTN_n9zg6W94-jWySgD04zPrHJ321PPnc6jStMZAkBh8wxlYsfWgOQAoVCwThkN4kQQGCGA2OMSRWYLYo8ZzZSCGBbW03MXj9BAMdIhVys-yAx-wblECmXIz8qFOKQt06cR5MIGexz8AjApCI3EnGpMxyZxlAlKU2IHYI555zpCI526DOCF_JgBPUTEGT1mpii2KG8EFI6icAq0VUcXwVI6LTAgi0IHeAdhkH0VHnJAVgrTjiGMC5iEEZ1FFeUcGFrpYsndaOWJqvGAuKyIXIi_ALGwK28esdKOg0V-LOuxFtnprAmzEeL0QSGHDqzgYUWD46E8b-F3YkIv_IQoYS3SUbT1gVuk25ERBV2p2m0pbvrbVN9-K_BT6jPxDcNVCO-p9DGegPcQlGIF8f3yC5UegvF_NPLGzMV6OrHgs3QSks98GabEx-ztcSsFpy3X4B" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Takes input as a list of strings. The lengths of these strings must be the same.</p>
<p>This is slow for large inputs, so I did not test the last test case.</p>
<h2>Explanation</h2>
<p>For small fish (<code>&gt;&lt;&gt;</code> or <code>&lt;&gt;&lt;</code>), we simply check that its length is <code>3</code> and that it is a substring of <code>&lt;&gt;&lt;&gt;</code>.</p>
<p>Larger fish are more interesting. We first check the size of the rectangle: the width must be 3/2 of the height. After that, we optionally rotate the rectangle by 180 degrees, so that the fish is in the correct orientation (if it really is a fish).</p>
<p>Then we rotate the <code>n</code>th column of the rectangle by <code>n</code> positions, and check that all characters in the first row are <code>\</code>. For example, let's look at this fish:</p>
<pre><code>\  /\ 
 \/  \
 /\  /
/  \/ 
</code></pre>
<p>After rotating the <code>n</code>th column of the rectangle by <code>n</code> positions, it becomes:</p>
<pre><code>\\\\\\
 / / /
      
/ / / 
</code></pre>
<p>All characters in the first row are <code>\</code>, so this is a fish.</p>
<p>We also need to check the <code>/</code> part. Now we take the original rectangle, reverse each column, and then rotate the <code>n</code>th column of the rectangle by <code>n</code> positions again. Now we check that all characters in the first row are <code>/</code>.</p>
<p>This is enough to determine whether the rectangle is a fish or not.</p>
<p>The code non-deterministically takes a rectangle from the input, and checks if it is a fish using the above method. <code>-n</code> prints the number of solutions.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, 419 bytes</h1>
<pre class="lang-python prettyprint-override"><code>from re import match as M
R=range
B=bool
s='.'
def f(l):
 t=0
 for w,r in enumerate(l):
  for c in R(len(r)):
   t+=('&lt;&gt;&lt;'==r[c:c+3])+('&gt;&lt;&gt;'==r[c:c+3])
   for d in R(len(l)):
    e,g,h=d+1,0,0
    for i in R(e):
     a,b,k=r'\\'+s*(d-i)*2,s*i*2,l+[s]*e*e
     p,q,x,y=fr'{s*i}{a}/{b}\\',f'{s*(d-i)}/{b}{a}/',k[w+i][c:],k[w+i+e][c:]
     g,h=g+B(M(p,x))+B(M(q,y)),h+B(M(q,x))+B(M(p,y))
    t+=(g==2*e)+(h==2*e)
 return t
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZZG9bsIwEMfV1U9xm-3YfJQuFaoZ2FlYgSGAk1iEJDhGgBBP0gWpatc-T_sqXeqPVFCQJef8u_9d7uP1ozqYrCzOXz9G1gYEaIwxgmnn9gCCOwoOwi3zEG4YoJeBPRfmXgPk74vSa3z4dU5ocv7_e4C3dTp4V_sUkOsK5aqQtQDXabuucmU8IPR9a5LW8_fDW6LLNWgJal2V2sA6NosM4hpGaCx0XKQSDcW8LHNUC9zGaCkTSEhO-wiM6CJISg07rkEVIIvtWurYyOD2roVzjEkuC6Kpp2CYINj2jIXQk0V_wZ5mlBFsx3BNnNIlWF4S5E0CkDzlmViyR97lXU-cUgWlbEQQ8zlfCY2nU8zqiCxbikY9XkfK3jmb1LNIRjJIK77he34QicZHKzgd41PnOD_ZSJ444oM9ch7MV5MdUzNb6iyYTPpHSOZqS9mQjEjF95R6a8MPlPKssf9o5agPcjNJhehF0o4iCwayWzFbXYAJu_qstCoMscN3G6TNBs_n8P0F" rel="nofollow noreferrer">Attempt This Online!</a></p>
<hr />
<p>Commented code:</p>
<pre class="lang-python prettyprint-override"><code>from re import match as M

R=range
B=bool

# single character in the regex search pattern
s='.'


def f(l):
    &quot;&quot;&quot;
    Finds the fish in the text
    
    params
    l: list of text lines
    
    return: total fish found
    &quot;&quot;&quot;
    
    # total fish found
    t=0
    
    # loop on text lines
    for w,r in enumerate(l):
    
        # loop on the (indexes of) charaters of the line
        # search fish starting from this position
        for c in R(len(r)):
            
            # search fish of size 0 (height = 1 line)
            t+=('&lt;&gt;&lt;'==r[c:c+3])+('&gt;&lt;&gt;'==r[c:c+3])
            
            # loop on fish size to search on text lines
            # up to the maximum number of lines of text
            for d in R(len(l)):
                
                # e = fish size (d = 0, e = 1: fish on 2 lines)
                # g, h = counter of matched lines for right- and left-facing fish
                e,g,h=d+1,0,0
                
                # loop index on fish size
                # to search all corresponding pattern on consecutive lines
                for i in R(e):
                    
                    # a, b = auxiliary strings to build regex pattern
                    # k = extend the original text lines list to avoid index error
                    # (meaningless added lines to not match any fish)
                    a,b,k=r'\\'+s*(d-i)*2,s*i*2,l+[s]*e*e
                    
                    # p, q = pattern for regex search of fish shape
                    # considering spaces between symbols scaled according to fish size (d)
                    # and based on the line of the fish (i)
                    # x, y = lines of text in which to check the current patterns
                    # x for the upper half of the fish, y for the lower half of the fish
                    p,q,x,y=fr'{s*i}{a}/{b}\\',f'{s*(d-i)}/{b}{a}/',k[w+i][c:],k[w+i+e][c:]
                    
                    # check the matching pattern on lines
                    # (for each fish check a line in upper and lower half)
                    # add to the counter for each right- and left-facing fish
                    g,h=g+B(M(p,x))+B(M(q,y)),h+B(M(q,x))+B(M(p,y))
                
                # add to the total fish found if matched lines correspond to fish size
                # (e = 1, fish on 2 lines: found if 2 lines matched)
                t+=(g==2*e)+(h==2*e)
    
    # return total number of fish
    return t
</code></pre>
</div>
<div id="pu2" class="pu"><h1>JavaScript (ES11), 219 bytes</h1>
<p>Expects a matrix of characters.</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;m.map((r,y)=&gt;r.map((c,x)=&gt;m.map((_,n)=&gt;N+=n?[1,-1].some(o=&gt;(g=k=&gt;k?m[Y-=-2/i|1]?.[X+=i&gt;1?o:-o]==&quot;\\/&quot;[i+!~o&amp;1]&amp;&amp;g(k-1):++i)(n*2,i=0,X=x+o,Y=y+1)*g(n,Y--)*g(n,X-=o)*g(n*2,Y++)):/&lt;&gt;&lt;|&gt;&lt;&gt;/.test(r[x-1]+c+r[x+1]))),N=0)|N
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=1ZXNbtNAEMePSPsUSw6Nt1574tKikmadExx76aWRN0JV6gSrjV3sILWicOSExIUbIFUI3oFXAW59Ae6cmP2w13HLBakH1slm5z-_Gc9OnM2HL3lxnF59nouvL1bzYPf7z6WIl-Hy6MzzSn7BRFwaY8bPWeN5ynM09n2Rj5OIB9E0rIpl6hUi9hbiRMQn42UyCUSwBdllNB2HyaEvsjgaF8OgmArRkxJ6Sebff11sRNONjYV3EkRs6PsZ8_LNLZ6JAT8U537BJ-LCj9jmwsv5JAjM4jAQhV4hOfF9xoYwikeX8SiGcJVWK69MzrEkf-bjwo-mjDG-Lwbsct9u8fesyKsVTc_P0tkqPaaCJjt8wLf4No_4Q_4I5y28ImU-2Nnl0e6Ab0_3SJk-f5GVqdebVz0WlunR8ZPsND24yGfegIWr4mBVZvnCY2F1dpqtvJ7MZY7gvCgfH82eeV7FacaoiOlLQqmpYYk3rxyPtOpvpaAkDMNqyjgtU7Tp3FuyPRtXnKbhabHw0GPdotlNkk3pmPZ_fXt3_fE9zn06pP3rT2_7GP2KmQ5c_bj3hlKQFAdQStSEBoAEAkqUgC9JJMXGgsTOIiOpxXCtAHShQcgoVu96Vp8SQAVjBklUTiAmU31LPVRCld2ktJK9idNIU0yjKQlNzKsrVgGkKQ0VHaD2pAjtlubGpM4DJinq7cKwWlUyYOFm2yBHsVR7AaK3qhSERtgPGStJgoUAagp0CoxWOihKpVU2gALjETFRyq0d-CYwcnl087CJZpdEbxObqTdqu6GqvsUJ1kmbPltALw3UyqJh22uVjNJar_PXuIVNADgfcbqq4h9iiNTD9M-s71pqG_Z7u2OJmAdn_SK3aPDfkOr77V7mWOho9ge8rtnHbl2j5vhwmjlM9OxIzejwdk53LHRU0tX0OXBDA3MSmCHtLFuHlTuy1hi4wRC6ztRP_jrSZurfQhdxDFBHryO14u5Qr5ou13U41ikNsn7sQltpkKaOxtMoDQI3aq6VGoFOf1oKcZV3etisiCO6PawV0iL-0kPSJtp1uEE6trxBmD_NDtNRSMdu12GH-T_-Aw" rel="nofollow noreferrer">Attempt This Online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>m =&gt;                                // m[] = input matrix
m.map((r, y) =&gt;                     // for each row r[] at index y in m[]:
  r.map((c, x) =&gt;                   //   for each character c at index x in r[]:
    m.map((_, n) =&gt;                 //     for n = 0 to m.length - 1:
      N +=                          //       update the output N
      n ?                           //       if n is not 0:
        [1, -1].some(o =&gt;           //         for o = 1 and o = -1:
          ( g = k =&gt;                //           g is a recursive function taking k
            k ?                     //           if k is not 0:
              m[Y -= -2 / i | 1]?.[ //             update Y (i=0,1,2,3 → -1,+1,+1,-1)
                X += i &gt; 1 ? o : -o //             update X (i=0,1,2,3 → -o,-o,+o,+o)
              ] == &quot;\\/&quot;[           //             test the character at M[Y][X],
                i + !~o &amp; 1         //             which must be either '\' or '/'
              ] &amp;&amp; g(k - 1)         //             if successful, do a recursive call
            :                       //           else (k = 0):
              ++i                   //             stop and increment i
          )(                        //           1st call to g with:
            n * 2, i = 0,           //             k = 2n, i = 0
            X = x + o, Y = y + 1    //             and (X,Y) set to the correct
          )                         //             starting position
          * g(n, Y--)               //           2nd call with k = n and Y adjusted
          * g(n, X -= o)            //           3rd call with k = n and X adjusted
          * g(n * 2, Y++)           //           4th call with k = 2n and Y adjusted
        )                           //         end of some()
      :                             //       else (n = 0):
        /&lt;&gt;&lt;|&gt;&lt;&gt;/.test(             //         look for a small fish ('&lt;&gt;&lt;' or '&gt;&lt;&gt;')
          r[x - 1] + c + r[x + 1]   //         centered at the current position
        )                           //
    )                               //     end of map()
  ),                                //   end of map()
  N = 0                             //   start with N = 0
) | N                               // end of map(); return N
</code></pre>
<h3>Path</h3>
<p>Below is the path that is tested with the 4 calls to the helper function <span class="math-container">\$g\$</span>, given the current position <span class="math-container">\$(x,y)\$</span>, the fish size <span class="math-container">\$n\geq1\$</span> and the horizontal direction <span class="math-container">\$o\$</span> (a symmetric path is also tested with <span class="math-container">\$o=-1\$</span> for a fish facing right).</p>
<p><a href="https://i.sstatic.net/ykdx9wW0.png" rel="nofollow noreferrer"><img src="https://i.sstatic.net/ykdx9wW0.png" alt="path" /></a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 84 bytes</h1>
<pre><code>ＷＳ⊞υ⪫  ιＵＭυ⁺ι⮌§⮌υκＦＬυＦＥ⊘⁻Ｌυι✂υι⁺ι⊗⊕κＦＬ⌊υＭ⁼⭆×¹·⁵Ｌκ⁺§§κμ⁺λμ§§⮌κμ⁺λμ…\/×³Ｌκ→Ｉ⁺ⅈＬ⌕ＡΣυ&gt;&lt;&gt;
</code></pre>
<p><a href="https://tio.run/##ZZBRS8MwFIXf@ysufbqB6BDxxY3CqIoTB2PzwYe@xDauoWky26Tqr69Jtm6zo5Dmnpx7vtzkJWtyzWTff5dCcsCF2lmzMY1QWyQEVrYt0VJ40UJhDBBTEIRMoyXbpbqumSr86UraFgWFNe9403Kcm4Uq@A8OtSUUKkJ846duAF@52hqX6wChdmn4zGTHC1wK5bKOhoCjsJEi554kTrAHbT@k61iovOE1V8btA2RIPYS4RFHb2tMILHXH8fHLMtnifkrPfhM1b/Hm@o7Coany1EAaZhn@FYV6OJN@74qxZ5i7IhdmV6W/ueRpqXcYZ9nEvegef3sO9777tdiWxr3Zyt3TYMpagyHpHcnR@yRUMZcSN2FCCnEyS@LwCNO@h2wy/iCCCxW8CGMtiDDSIJo5wOyk@SqJwnpyBk9oP8@EQ@Z/@l4c39OLF3fPIOqvOvkH" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Takes input as a rectangular list of newline-terminated strings. Explanation:</p>
<pre><code>ＷＳ⊞υ⪫  ι
</code></pre>
<p>Input the strings and give them extra side padding to avoid cyclic indexing wraparound false positives.</p>
<pre><code>ＵＭυ⁺ι⮌§⮌υκ
</code></pre>
<p>Rotate the input by 180° and append that to the right so that only right-facing fish need to be detected.</p>
<pre><code>ＦＬυＦＥ⊘⁻Ｌυι✂υι⁺ι⊗⊕κ
</code></pre>
<p>Loop through all sets of rows of even height.</p>
<pre><code>ＦＬ⌊υＭ⁼⭆×¹·⁵Ｌκ⁺§§κμ⁺λμ§§⮌κμ⁺λμ…\/×³Ｌκ→
</code></pre>
<p>Loop through all column indices and count any fish of that height found.</p>
<pre><code>Ｉ⁺ⅈＬ⌕ＡΣυ&gt;&lt;&gt;
</code></pre>
<p>Add on any one-liners. (<code>FindAll</code> finds with overlaps, whereas <code>Count</code> would not.)</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 64 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>U,µŒd;ŒDẈ.ị$ƙ$ŒHḢ€ZẎ€Q€F)UÐeċØ^
ẆZ€$⁺€ẎµZL÷3Ḥ⁼LµƇÇ€
KOṡ3IA§=4;ÇS
</code></pre>
<p>A monadic Link that accepts a list of lists of <code>\&lt; &gt;/</code> characters (lines <em>of equal length</em>) and yields the count of fish.</p>
<p><strong><a href="https://tio.run/##RYyxCsJADIb3e4oOXQQxg26eB4KIoiAiLiU46SK@gKMOVhBEOumoCC6OFrU69azvcX2RM6mIucvl8v9fMh5NJlNr@/k4TIJhOQlqJloWzGPlvnduEjTM7ZDOz56J1lS6lPVcX29Gr5XeDoSJFh5JbjqLqBATh15bX4vmdkxnz3Ycvn3tkyNaHXPfF5vV@FQplbXfs@Zx0b616EglHQeQLgUgCMw0@qFUpFAIJZEZPiiROsUSeV8I4EdBtoKmWQemeC33AAwqKb5TbGcGpQD538MPqg8" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> Or see the <a href="https://tio.run/##1ZW9btRAEMf7eYotrkGKmCJ0MZaQUBREJISiNKcRFWlQXiDlUXCRIiF0NFCSREpDyYXkgihsLu@x9yLOzM5@X2iQUrA@27v/@e3s7Niee3dweHg0DPsb3Xw5e7u1nD23i@PH9uZkdPt1tJzt2KvT1fvvY7v4yLfXfG4/2u8/Hfw56b@8Abv4MGZptJos@MZMNx/v9j837dX5avJrt5vfTvspW@DlK3v9bfPFs@7i6ZOtfro3LD/b67PV5Hd32V3amx/9dMTYMBiDZLihMSAXHiASAopIyD8CMk3bILVNywwZj3FfADbxAKBp5QxXuROiTGYPBOITQT2FJV0Th@JdXXrJL5I0iMFETSQesl8XsUyAGBorboLsSQhnJl0Ygh9Up6zngXG0EjJy4LptpKYl2QuC26ooDDWcD2pFIvQQYqDQueDZoqNQ4lbGiAK2DegsMTsDn4BN8uOSx0nUXYLbJifTbdRnQ6K@x4jeaGKePeC6CmVeHOxzLc6MCXrwH3AP6wRMNki6RPEPc4Bc0/xp/6GlfOCf2wNLoC9OecA9Gv43pDzf@tCyUGn@Ay41/9qVmtHykTQtJu6aSMe46bnPVBYqFWrN1QGzviX9pkwqPWQoK1apZBUMrjFgSia8@SWSM@FbqJHEoClWzZCgpBVCL2Y5xJHYpESkLLuYKxGJcURLVKBePcWMVCJY5SdTIEVe5TD2IBF1DoMCGfGXHEJO5HEU2S3GtEbon2bFVApU4zwO3@4A" rel="nofollow noreferrer" title="Jelly – Try It Online">test-suite</a>.</p>
<h4>How?</h4>
<pre><code>KOṡ3IA§=4;ÇS - Main Link: Lines
K            - join with spaces
 O           - cast to ordinals (&quot;\&lt; &gt;/&quot; -&gt; [92,60,32,62,47])
  ṡ3         - length three slices -&gt; [[a, b, c], ...]
    I        - forward differences of each -&gt; [[b-a, c-b], ...]
     A       - absolute values of all
      §      - sum of each
       =4    - for each: equals 4? -&gt; is tiny fish
         ;Ç  - concatenate Link_2(Lines) (see below)
           S - sum -&gt; total count of fish

ẆZ€$⁺€ẎµZL÷3Ḥ⁼LµƇÇ€ - Link_2: Lines
ẆZ€$                - transpose each non-empty contiguous sublist
    ⁺€              - ...and do that again for each
      Ẏ             - tighten -&gt; all rectangles
       µ       µƇ   - keep those for which:
        ZL          -   transpose, length (i.e. the width)
          ÷3Ḥ       -   divided by three then doubled
             ⁼L     -   equals length (i.e. 2/3 width = height)
                 Ç€ - call Link_3 for each such rectangle

U,µŒd;ŒDẈ.ị$ƙ$ŒHḢ€ZẎ€Q€F)UÐeċØ^ - Link_3: Rectangle
U                               - reverse each row
 ,                              - pair with {Rectangle}
  µ                     )       - for each:
   Œd;ŒD                        -   antidiagonals concatenate diagonals
            ƙ$                  -   for groups of...
        Ẉ                       -     ...equal: lengths
         .ị$                    -     ...do: get [last, first]
              ŒH                -   split into two halves
                Ḣ€              -   head of each (the parts that would constitute a full-scale fish)
                  Z             -   transpose
                   Ẏ€           -   tighten each
                     Q€         -   deduplicate each
                       F        -   flatten
                         UÐe    - reverse the second
                            ċØ^ - count occurrences of &quot;/\&quot;
                                   -&gt; number of fish of Rectangle's size
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, <s>114</s> <s>109</s> 104 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>J»…&gt;&lt;&gt;º2ä¢IεN&gt;xs3*&quot;I€üÿø€üÿ&quot;.VεDεεRεºθ}}}«}JNU1DúεXN+4и2.ýZXĀ+N_XΘ*-.ø1šs•1ø~üû•S.Λ}θVεε»YÏ…\/\X&gt;×ºQ]˜«O
</code></pre>
<p>Input as a rectangular matrix of characters.</p>
<p><a href="https://tio.run/##yy9OTMpM/a/n9KhpTfChlf@9Du1@1LDMzsbu0C6jw0sOLTq07txWP7uKYmMtpUPrgGoO7zm8//AOKENJL@zcVpdzW89tDTq39dCucztqa2sPra718gs1dDm869zWCD9tkws7jPQO742KONKg7RcfcW6Glq7e4R2GRxcWP2pYZHh4Rx3QHKCNi4L1zs2uPbcjDGTYod2Rh/uBrojRj4mwOzz90K7A2NNzDq32//9fSUlJQUE/RgEI9IGYC0QCefr6MfpcIAGFGH0giuGKUbCxs9GPAXqDCywPVgXWAFIBlANxgYb919XNy9fNSayqBAA" rel="nofollow noreferrer">Try it online.</a></p>
<p>I attempted to make a test suite, but it became a complete mess with work-around fixes (mostly because the Canvas should be cleared). Nonetheless, here is one for the original 114 bytes version, with additional <code>.BðδÜõK.B»</code> within the code and <code>X&gt;4и2.ýZ&gt;.ø1šð•1ø~üû•S.Λ\</code> after each test case to clear up the Canvas for the next iteration: <a href="https://tio.run/##dVJNaxRBEL3nVzRzNLtTbCIeZOzAkosrbNBgWLVFIngIyETYRIwwEjx5EY8eXAQXESQS9uDIsJsgdOMp0Pgb9o@M9dEzsxt1mI@qV69eVdfU/nD38d6T8nl0M312eHBdRa2jGyvR1uGBeBtxd/7627b9WvbcxJ27s3U7XfPf3eeL0fz4i060HdtTn/f1i@H6lcieItmduZ@uCEYU7/h80@c@v@NzO/VFlmX2JOv1H@31bEEiHw1cm795a8fupH@3s@mmPh/0V6/@LtZid35fx67o/Po0nB@PO654hZIzNLdj/yHzRdx1E@xl5PJbcdfOdqiMnd1z77A1A2ag3Xs7vY0Vs4vR1mrZsj82Vgb6krSb/K1tygcRni1qqQgMKqX0MuQaoxSaJlUIKcUWCJiyD8RSguEHoZTfRBEtoABlsyhpq0QnaGJFxcKqyiCXqUggn7SlrUQ3X7GQBkFPhNHkihD6RmLdF19Si2qHahVatbAAE9o03QQYJwR4HiCzYLhWBRmMjAJEhEkm9EMzqXVBVWyjLncux5LzgZw0zA7vRHOEppDKuCAQ8UpovPhIiGh1DkCTA5U4inIYOCPUJRCAc5Cc1ipMDASuk0KyJB/@jZbdkAWCeoHC0aEe8tKi/ZO3uGr/o4WtbMYpjmpWWDWx5a3lnV0oBuH38rLyHf5bcFi02lUWjR6W7Xa63366@/LoDw" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<p>Step 1: Count all small fish (that only use <code>&gt;&lt;</code> as characters):</p>
<pre class="lang-python prettyprint-override"><code>J                       # Join the rows of the (implicit) input-matrix together
 »                      # Then join this list of lines with newline delimiter
  …&gt;&lt;&gt;                  # Push string &quot;&gt;&lt;&gt;&quot;
      º                 # Mirror it to &quot;&gt;&lt;&gt;&lt;&gt;&lt;&quot;
       2ä               # Split it into two equal-sized parts: [&quot;&gt;&lt;&gt;&quot;,&quot;&lt;&gt;&lt;&quot;]
         ¢              # Count how many times each of those occur in the string
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/a/n9KhpTfChlf@9Du1@1LDMzsbu0C6jw0sOLfr/X0lJSUFBP0YBCPSBmAtEAnn6@jH6XCABhRh9IIrhilGwsbPRjwFq5QLLg1WBNYBUAOVAXKBh/3V18/J1cxKrKgE" rel="nofollow noreferrer">Try just step 1 online.</a></p>
<p>Step 2: Count all larger fish (that only use <code>\/ </code> as characters):</p>
<pre class="lang-python prettyprint-override"><code>I                       # Push the input-matrix again
 ε                      # Map over each row:
  N&gt;                    #  Push the 1-based row-index
    x                   #  Double it (without popping)
     s                  #  Swap so the 1-based index is at the top again
      3*                #  Multiply it by 3
        &quot;I€üÿø€üÿ&quot;      #  Push this string, where the `ÿ` are replaced with the 3(N+1)
                        #  and 2(N+1) respectively
                  .V    #  Execute it as 05AB1E code:
         I              #   Push the input-matrix
          €             #   Map over each row:
           üÿ           #    Split it into overlapping 3(N+1)-sized sublists
             ø          #   Zip/transpose; swapping rows/columns
              €         #   Map over each list again:
               üÿ       #    Split it into overlapping 2(N+1)-sized blocks
                        #  (we now have a list of overlapping 3(N+1) by 2(N+1) sized blocks
   εDεεRεºθ}}}«}        #  Create a mirrored copy of each block:
   ε           }        #   Map over the list of lists of blocks
    D                   #    Duplicate the current list of blocks
     εε     }}          #    Nested map over each row of each block
       R                #      Reverse the row
        ε  }            #      Inner map over each character within this row
         º              #       Mirror it
          θ             #       Pop and leave the last (mirrored) character
              «         #    After the inner maps: merge the lists of blocks together
   J                    #  Join each inner-most row of characters together
    NU                  #  Store the current 0-based map-index in variable `X`
    1Dú                 #  Push &quot; 1&quot; (push 1; duplicate; pad that many spaces)
       ε                #  Inner map over this pair of characters:
        X               #   Push `X`
         N+             #   Add the inner map's 0-based index `N` to it
           4и           #   Repeat that four times
             2.ý        #   Intersperse with 2s
                Z       #   Push the maximum (the `X+N`) without popping the list
                 XĀ+    #   Add (X!=0) to it
                      - #   And then possibly decrease it by:
                 N_     #   (N==0)
                     *  #   AND
                   XΘ   #   (X==1)
                 .ø     #   Prepend &amp; append that `X+N+(X!=0)-((N==0)*(X==1))`
                   1š   #   And prepend an additional 1
        s               #   Swap so the current character (&quot; &quot; or &quot;1&quot;) is at the top
        •1ø~üû•         #   Push compressed integer 8332107655
               S        #   Convert it to a list of digits
        .Λ              #   Use the (modifiable) Canvas builtin with these three options
       }θ               #  After the map: keep the last one for character &quot;1&quot;
                        #  (the first iteration with &quot; &quot; was to clean the Canvas)
         V              #  Pop and store this fish-shape in variable `Y`
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/a/n9KhpTfChlf@9Dm84vPfwHuNDu4zObTm85PScRw3L7GzsDi06tO7cVj@7imJjLaVD64CKD@85vP/wDihDSS/s3FaXc1vPbQ06t/XQrnM7amtrD62u9fILNXQ5vOvc1gg/bZMLO4z0Du@NijjSoO0XH3Fuhpau3uEdhkcXFj9qWGR4eEcd0JzdQGaw3rnZted2/Nc5tM3@v5KSkoKCfowCEOgDMReIBPL09WP0uUACCjH6QBTDFaNgY2ejHwN0KBdYHqwKrAGkAigH4gIN@6@rm5evm5NYVQkA" rel="nofollow noreferrer">Try this sub-step online to see the created fish-shapes.</a></p>
<pre class="lang-python prettyprint-override"><code> εε                     #  Nested map over each block:
   »                    #   Join the lines together with newline delimiter
    Y                   #   Push the fish-shape of 1s from variable `Y`
     Ï                  #   Only keep the characters at the truthy (==1) locations
      …\/\              #   Push string &quot;\/\&quot;
          X&gt;×           #   Repeat it `X+1` amount of times
             º          #   Mirror that entire string
              Q         #   Check if the two strings are equal
]                       # Close all maps
 ˜                      # Flatten the list of lists of 0s and 1s
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/a/n9KhpTfChlf@9Du1@1LDMzsbu0C6jw0sOLTq07txWP7uKYmMtpUPrgGoO7zm8//AOKENJL@zcVpdzW89tDTq39dCucztqa2sPra718gs1dDm869zWCD9tkws7jPQO742KONKg7RcfcW6Glq7e4R2GRxcWP2pYZHh4Rx3QHKCNi4L1zs2uPbcjDGTYod2Rh/uBrojRj4mwOzz90K7A2NNz/v9XUlJSUNCPUQACfSDmApFAnr5@jD4XSEAhRh@IYrhiFGzsbPRjgH7gAsuDVYE1gFQA5UBcoGH/dXXz8nVzEqsqAQ" rel="nofollow noreferrer">Try just step 2 online.</a></p>
<p>Step 3: Sum those counts together, and output the result</p>
<pre class="lang-python prettyprint-override"><code>«                       # Merge this list to the pair of step 1
 O                      # Take the sum of this list
                        # (after which the result is output implicitly)
</code></pre>
<p><a href="https://codegolf.stackexchange.com/a/166851/52210">See this 05AB1E tip of mine (section <em>How to compress large integers?</em>)</a> to understand why <code>•1ø~üû•</code> is <code>8332107655</code>.<br />
<a href="https://codegolf.stackexchange.com/a/175520/52210">See this 05AB1E tip of mine</a> to understand how the Canvas builtin works, and why I've used the following options to draw the fish:</p>
<ul>
<li>Character to draw: <code>1</code></li>
<li>Directions to draw in: <span class="math-container">\$[8,3,3,2,1,0,7,6,5,5]\$</span> aka <span class="math-container">\$RESET↘↘→↗↑↖←↙↙\$</span></li>
<li>Lengths of each section: <span class="math-container">\$v=X+N, \\
t=v+(X\neq0)-(N=0)\times(X=1) \\
[1,t,v,2,v,2,v,2,v,t]\$</span></li>
</ul>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/281920/">281920</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




