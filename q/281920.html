<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::281920</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>221</td><td>JavaScript ES11</td><td>250523T220545Z</td><td><a href="https://codegolf.stackexchange.com/questions/281920/count-all-the-fish/281938#281938">Arnauld</a></td></tr>
<tr d-ix="1"><td>109</td><td>05AB1E</td><td>250523T141717Z</td><td><a href="https://codegolf.stackexchange.com/questions/281920/count-all-the-fish/281927#281927">Kevin Cr</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>JavaScript (ES11), 221 bytes</h1>
<p>Expects a matrix of characters.</p>
<pre class="lang-javascript prettyprint-override"><code>m=&gt;m.map((r,y)=&gt;r.map((c,x)=&gt;[1,-1].map(o=&gt;m.map((_,n)=&gt;N+=n?(g=k=&gt;k?m[Y-=-2/i|1]?.[X+=i&gt;1?o:-o]==&quot;\\/&quot;[i+!~o&amp;1]&amp;g(k-1):!!++i)(n*2,i=0,X=x+o,Y=y+1)&amp;g(n,Y--)&amp;g(n,X-=o)&amp;g(n*2,Y++):/&lt;&gt;&lt;|&gt;&lt;&gt;/.test(r[x-1]+c+r[x+1])/2))),N=0)|N
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=bVJNj9MwEJU4-i9wcXtY2TjJND2hErsnOPayl63iCFXdtERt4iXJSq0oXPkRXFYr-FEg8V-YsdN2D0T5mHnz5nneKD9-Nu6-fHre6F-P_SZ--_tvrU2d1KsHIdroKLVpQ7KODpjkaRSnhUfchfcxarC0ULqZi63eabOb1_ky1vEUqlNazJP8TunKpHM3i12h9dhaGOeVGn1zN2lxsxW7OJWz0UipSormzTSq9CS60wfloqU-qlQipYmWcRyCu1g7HyFzqZScQWayk8kMJH3Z9aLNDzijWisMVFpImEopo4WeyNNiMPm9LT8_Vm0pxptuLJO2XN1_qPbl7bFZi4lMenfbt1WzFTLpHvZVL8a2sQ0SN659v1p_Eh3Xhn9hnO_Lntdc8-5KRBptxVPyJEm6Qr5D5to1nduXyd5txUbUEsGvMozz9OfVa87BcryAc0YvTAAsMCDQAt6WWY5GwaJT5Fg-0DAmApYwYSwz9Jzf9LUA1IwKlpEmsKB0PtJfJEjqQXKAhkOuGLsMc8EIwhR1_cTUwC6jIeIbyBMxfNmGg9lZB4Io4i8Hw2lpZMDBg22wmbHkBZi3SgiSMtyHNQRZGEgAZxZ4CewmHIhFspQDENFkLHRR2RfwYZBddfzycInBJfM2cZne6LANmvo_RRiK_LLngeDDQHqh4snDrkmM8zMefpJ_" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, <s>114</s> 109 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>Jðýü3º2δä˜…&gt;&lt;&gt;¢IεN&gt;xs3*&quot;I€üÿø€üÿ&quot;.VεDεεRεºθ}}}«}JNU1DúεXN+4и2.ýZXĀ+N_XΘ*-.ø1šs•1ø~üû•S.Λ}θVεε»YÏ…\/\X&gt;×ºQ]˜O+
</code></pre>
<p>Input as a rectangular matrix of characters.</p>
<p><a href="https://tio.run/##yy9OTMpM/a/n9KhpTfChlf@9Dm84vPfwHuNDu4zObTm85PScRw3L7GzsDi06tO7cVj@7imJjLaVD64CKD@85vP/wDihDSS/s3FaXc1vPbQ06t/XQrnM7amtrD62u9fILNXQ5vOvc1gg/bZMLO4z0Du@NijjSoO0XH3Fuhpau3uEdhkcXFj9qWGR4eEcd0JzdQGaw3rnZted2hIEMO7Q78nA/0AEx@jERdoenH9oVGHt6jr/2//9KSkoKCvoxCkCgD8RcIBLI09eP0ecCCSjE6ANRDFeMgo2djX4M0ANcYHmwKrAGkAqgHIgLNOy/rm5evm5OYlUlAA" rel="nofollow noreferrer">Try it online.</a></p>
<p>I attempted to make a test suite, but it became a complete mess with work-around fixes (mostly because the Canvas should be cleared). Nonetheless, here is one for the original 114 bytes version, with additional <code>.BðδÜõK.B»</code> within the code and <code>X&gt;4и2.ýZ&gt;.ø1šð•1ø~üû•S.Λ\</code> after each test case to clear up the Canvas for the next iteration: <a href="https://tio.run/##dVJNaxRBEL3nVzRzNLtTbCIeZOzAkosrbNBgWLVFIngIyETYRIwwEjx5EY8eXAQXESQS9uDIsJsgdOMp0Pgb9o@M9dEzsxt1mI@qV69eVdfU/nD38d6T8nl0M312eHBdRa2jGyvR1uGBeBtxd/7627b9WvbcxJ27s3U7XfPf3eeL0fz4i060HdtTn/f1i@H6lcieItmduZ@uCEYU7/h80@c@v@NzO/VFlmX2JOv1H@31bEEiHw1cm795a8fupH@3s@mmPh/0V6/@LtZid35fx67o/Po0nB@PO654hZIzNLdj/yHzRdx1E@xl5PJbcdfOdqiMnd1z77A1A2ag3Xs7vY0Vs4vR1mrZsj82Vgb6krSb/K1tygcRni1qqQgMKqX0MuQaoxSaJlUIKcUWCJiyD8RSguEHoZTfRBEtoABlsyhpq0QnaGJFxcKqyiCXqUggn7SlrUQ3X7GQBkFPhNHkihD6RmLdF19Si2qHahVatbAAE9o03QQYJwR4HiCzYLhWBRmMjAJEhEkm9EMzqXVBVWyjLncux5LzgZw0zA7vRHOEppDKuCAQ8UpovPhIiGh1DkCTA5U4inIYOCPUJRCAc5Cc1ipMDASuk0KyJB/@jZbdkAWCeoHC0aEe8tKi/ZO3uGr/o4WtbMYpjmpWWDWx5a3lnV0oBuH38rLyHf5bcFi02lUWjR6W7Xa63366@/LoDw" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<p>Step 1: Count all small fish (that only use <code>&gt;&lt;</code> as characters):</p>
<pre class="lang-python prettyprint-override"><code>J                       # Join the rows of the (implicit) input-matrix together
 ðý                     # Then join this list of lines with space delimiter
                        # (any non-newline delimiter is fine here)
   ü3                   # Split it into overlapping triplets
     º2δä˜              # Create a mirrored copy of each triplet:
     º                  #  Mirror each inner triplet
       δ                #  Then map over each sextet:
      2 ä               #   Split it into two equal-sized parts
         ˜              #  Flatten this list of pairs
          …&gt;&lt;&gt;¢         # Count how many times &quot;&gt;&lt;&gt;&quot; occurs in this list
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/a/n9KhpTfChlf@9Dm84vPfwHuNDu4zObTm85PScRw3L7GzsDi36/19JSUlBQT9GAQj0gZgLRAJ5@vox@lwgAYUYfSCK4YpRsLGz0Y8B6uICy4NVgTWAVADlQFygYf91dfPydXMSqyoB" rel="nofollow noreferrer">Try just step 1 online.</a></p>
<p>Step 2: Count all larger fish (that only use <code>\/ </code> as characters):</p>
<pre class="lang-python prettyprint-override"><code>I                       # Push the input-matrix again
 ε                      # Map over each row:
  N&gt;                    #  Push the 1-based row-index
    x                   #  Double it (without popping)
     s                  #  Swap so the 1-based index is at the top again
      3*                #  Multiply it by 3
        &quot;I€üÿø€üÿ&quot;      #  Push this string, where the `ÿ` are replaced with the 3(N+1)
                        #  and 2(N+1) respectively
                  .V    #  Execute it as 05AB1E code:
         I              #   Push the input-matrix
          €             #   Map over each row:
           üÿ           #    Split it into overlapping 3(N+1)-sized sublists
             ø          #   Zip/transpose; swapping rows/columns
              €         #   Map over each list again:
               üÿ       #    Split it into overlapping 2(N+1)-sized blocks
                        #  (we now have a list of overlapping 3(N+1) by 2(N+1) sized blocks
   εDεεRεºθ}}}«}        #  Create a mirrored copy of each block:
   ε           }        #   Map over the list of lists of blocks
    D                   #    Duplicate the current list of blocks
     εε     }}          #    Nested map over each row of each block
       R                #      Reverse the row
        ε  }            #      Inner map over each character within this row
         º              #       Mirror it
          θ             #       Pop and leave the last (mirrored) character
              «         #    After the inner maps: merge the lists of blocks together
   J                    #  Join each inner-most row of characters together
    NU                  #  Store the current 0-based map-index in variable `X`
    1Dú                 #  Push &quot; 1&quot; (push 1; duplicate; pad that many spaces)
       ε                #  Inner map over this pair of characters:
        X               #   Push `X`
         N+             #   Add the inner map's 0-based index `N` to it
           4и           #   Repeat that four times
             2.ý        #   Intersperse with 2s
                Z       #   Push the maximum (the `X+N) without popping the list
                 XĀ+    #   Add (X&gt;0) to it
                      - #   And then possibly decrease it by:
                 N_     #   (N==0)
                     *  #   AND
                   XΘ   #   (X==1)
                 .ø     #   Prepend &amp; append that `X+N+(X&gt;0)-((N==0)*(X==1))`
                   1š   #   And prepend an additional 1
        s               #   Swap so the current character (&quot; &quot; or &quot;1&quot;) is at the top
        •1ø~üû•         #   Push compressed integer 8332107655
               S        #   Convert it to a list of digits
        .Λ              #   Use the (modifiable) Canvas builtin with these three options
       }θ               #  After the map: keep the last one for character &quot;1&quot;
                        #  (the first iteration with &quot; &quot; was to clean the Canvas)
         V              #  Pop and store this fish-shape in variable `Y`
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/a/n9KhpTfChlf@9Dm84vPfwHuNDu4zObTm85PScRw3L7GzsDi06tO7cVj@7imJjLaVD64CKD@85vP/wDihDSS/s3FaXc1vPbQ06t/XQrnM7amtrD62u9fILNXQ5vOvc1gg/bZMLO4z0Du@NijjSoO0XH3Fuhpau3uEdhkcXFj9qWGR4eEcd0JzdQGaw3rnZted2/Nc5tM3@v5KSkoKCfowCEOgDMReIBPL09WP0uUACCjH6QBTDFaNgY2ejHwN0KBdYHqwKrAGkAigH4gIN@6@rm5evm5NYVQkA" rel="nofollow noreferrer">Try this sub-step online to see the created fish-shapes.</a></p>
<pre class="lang-python prettyprint-override"><code> εε                     #  Nested map over each block:
   »                    #   Join the lines together with newline delimiter
    Y                   #   Push the fish-shape of 1s from variable `Y`
     Ï                  #   Only keep the characters at the truthy (==1) locations
      …\/\              #   Push string &quot;\/\&quot;
          X&gt;×           #   Repeat it `X+1` amount of times
             º          #   Mirror that entire string
              Q         #   Check if the two strings are equal
]                       # Close all maps
 ˜                      # Flatten the list of lists of 0s and 1s
  O                     # Sum to see how many were truthy
</code></pre>
<p><a href="https://tio.run/##LU6xSgNBEO3vK5YtE26XSyyPKyRVihMNhlNWJIKFIKa4RoWVwx@wVDCNQQRRgoULyyVB2NEqMPgN9yPr7OEwM8ybefN403JycnbqxXZz@z5yr34IH7CGVd/VPfyE582sqV6yNHNzt0CTZ5dlv8Pdgsiwgi@w/wMXYzQDNGj20Lgardbavelhvp8MoEZT5N2tX9sTsD4svqtuflzgQycWYJOfp7Kp5gnYG9JZ0jgS@KjRjoOYWx7AHRlQUhUZ3Lt692gz2/Gec86YVIxCUkWhE5JSySgsmJKUKlIszVKpyH/U3ltW@xAYdAuQxHwcX0zj88n11R8" rel="nofollow noreferrer">Try just step 2 online.</a></p>
<p>Step 3: Add those counts together, and output the result</p>
<pre class="lang-python prettyprint-override"><code>+                       # Add the sum of larger fish to the count of smaller fish
                        # (after which the result is output implicitly)
</code></pre>
<p><a href="https://codegolf.stackexchange.com/a/166851/52210">See this 05AB1E tip of mine (section <em>How to compress large integers?</em>)</a> to understand why <code>•1ø~üû•</code> is <code>8332107655</code>.<br />
<a href="https://codegolf.stackexchange.com/a/175520/52210">See this 05AB1E tip of mine</a> to understand how the Canvas builtin works, and why I've used the following options to draw the fish:</p>
<ul>
<li>Character to draw: <code>1</code></li>
<li>Directions to draw in: <span class="math-container">\$[8,3,3,2,1,0,7,6,5,5]\$</span></li>
<li>Lengths of each section: <span class="math-container">\$v=X+N, \\
t=v+(X&gt;0)-(N=0)\times(X=1) \\
[1,t,v,2,v,2,v,2,v,t]\$</span></li>
</ul>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/281920/">281920</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




