<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::276711</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>015</td><td>05AB1E</td><td>241118T095956Z</td><td><a href="https://codegolf.stackexchange.com/questions/276711/the-smallest-number-with-a-given-water-capacity/276730#276730">Kevin Cr</a></td></tr>
<tr d-ix="1"><td>018</td><td>Jelly</td><td>241118T041559Z</td><td><a href="https://codegolf.stackexchange.com/questions/276711/the-smallest-number-with-a-given-water-capacity/276727#276727">Jonathan</a></td></tr>
<tr d-ix="2"><td>207</td><td>Python 2</td><td>241117T234001Z</td><td><a href="https://codegolf.stackexchange.com/questions/276711/the-smallest-number-with-a-given-water-capacity/276725#276725">Lucenapo</a></td></tr>
<tr d-ix="3"><td>066</td><td>Charcoal</td><td>241117T215949Z</td><td><a href="https://codegolf.stackexchange.com/questions/276711/the-smallest-number-with-a-given-water-capacity/276723#276723">Neil</a></td></tr>
<tr d-ix="4"><td>166</td><td>JavaScript ES6</td><td>241116T232957Z</td><td><a href="https://codegolf.stackexchange.com/questions/276711/the-smallest-number-with-a-given-water-capacity/276713#276713">Arnauld</a></td></tr>
<tr d-ix="5"><td>025</td><td>MATL</td><td>241117T185149Z</td><td><a href="https://codegolf.stackexchange.com/questions/276711/the-smallest-number-with-a-given-water-capacity/276721#276721">Luis Men</a></td></tr>
<tr d-ix="6"><td>177</td><td>R+numbers</td><td>241117T060021Z</td><td><a href="https://codegolf.stackexchange.com/questions/276711/the-smallest-number-with-a-given-water-capacity/276717#276717">Eonema</a></td></tr>
<tr d-ix="7"><td>039</td><td>J</td><td>241117T113106Z</td><td><a href="https://codegolf.stackexchange.com/questions/276711/the-smallest-number-with-a-given-water-capacity/276719#276719">ovs</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 15 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>∞.ΔÒγPLζðδÚ˜ð¢Q
</code></pre>
<p><a href="https://tio.run/##ASYA2f9vc2FiaWX//@KIni7OlMOSzrNQTM62w7DOtMOay5zDsMKiUf//NA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##ATsAxP9vc2FiaWX/NUwzS3Z5PyIg4oaSICI/ecKp/@KIni7OlMOSzrNQTM62w7DOtMOay5zDsMKiwq5R/30s/w" rel="nofollow noreferrer">verify four test cases</a>. (It's very slow, so it'll time out for <span class="math-container">\$n=3\$</span> or <span class="math-container">\$n\geq6\$</span>..)</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-none prettyprint-override"><code>∞               # Push an infinite positive list: [1,2,3,...]
 .Δ             # Pop and find the first value that's truthy for:
   Ò            #  Get the prime factors (including duplicates) of the current value
    γ           #  Group the same adjacent factors together
     P          #  Take the product of each inner group
      L         #  Map each product to a ranged [1,product]-list
       ζ        #  Zip/transpose; swapping rows/columns, using &quot; &quot; as filler-char for
                #  unequal length rows
         δ      #  Map over each inner list:
        ð Ú     #   Trim all leading/trailing &quot; &quot;
           ˜    #  Then flatten this list of lists
            ð¢  #  Count the amount of &quot; &quot; that are left
              Q #  Check whether this equals the (implicit) input-integer
                # (after which the found result is output implicitly as result)
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 18 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>ÆF*/€Rz0t€0Fċ0⁼ð1#
</code></pre>
<p>A monadic Link that accepts a positive integer and yields a singleton list containing the first number with that capacity<br />
...or a full program that prints the number.</p>
<p><strong><a href="https://tio.run/##y0rNyan8//9wm5uW/qOmNUFVBiVAysDtSLfBo8Y9hzcYKv///9/QDAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong></p>
<h4>How?</h4>
<p>Starting at the given capacity, and then counting up, find the first number with the given capacity (a number can't have a capacity greater than itself).</p>
<p>Find the capacity of a number by building its prime-factor landscape, overfilling it with water (as if walls of the highest peak were on each side), removing any water not held, and counting the remaining water units.</p>
<pre><code>ÆF*/€Rz0t€0Fċ0⁼ð1# - Link: positive integer, Capacity
               ð1# - set k=Capacity and find the smallest k such that:
ÆF                 -   prime factorization of {k}
  */€              -   reduce each {prime, exponent} by exponentiation
     R             -   range (vectorises) -&gt; [[1..p^e] for each [p,e]]
      z0           -   transpose with filler zero (water)
        t€0        -   trim zeros from each end of each
           F       -   flatten
            ċ0     -   count the remaining zeros -&gt; k's capacity
              ⁼    -   equals {Capacity}?
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, 207 bytes</h1>

<pre class="lang-none prettyprint-override"><code>def T(d):
 a=e=0
 while d-e:
&#9;a+=1;A=a;D=[]
&#9;while A&gt;1:
&#9;&#9;c=1;x=[b for b in range(2,A+1)if A%b&lt;1][0]
&#9;&#9;while A%x&lt;1:A/=x;c*=x
&#9;&#9;D+=[c]
&#9;e=sum(max(0,min(D[b-1],D[b+1])-D[b])for b in range(1,len(D)-1))
 print a
</code></pre>
<p><a href="https://tio.run/##XY3BioMwFEXX5iveppBXlfoK3WjfQMBP6C5kETW2gRrF6TDp1zsZSmGY1YV7zuUuz8dtDsdtG9wIFzlgLcCy40rA983fHQylq0Vmc6ZGsW1a1kZkL6Q@KKGsTyiy7mCcV@jAB1htuDp5LFRO6EdQu@5MRldp@F7u4plqdeDY9HuOqW9z1n0SHH9@TXKyUVbF5INsdVeSKVLkZLBMafDfDxV3l0QsCVHAsvrwALv9SvavRCesL9Li9gM" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 66 bytes</h1>
<pre><code>ＮθＷ¬⁼θω«→≔⟦⟧υ≔ⅈηＦ…²η«≔Ｘκ⌕Ｘ⁰⮌↨ηκ⁰ζ≧÷ζη¿⊖ζ⊞υζ»≔ΣＥυ⁻⌊⟦⌈…υ⊕λ⌈✂υλ⟧κω»Ｉⅈ
</code></pre>
<p><a href="https://tio.run/##TZAxb8IwEIXn8Cs8niVXgo5lakMrZQhCsFRCDG5yxBaODbGdtFT89tROk9Ll5Hv39L0nF4I3heGq7zN99m7t6w9s4EKXs05IhQTWxsHrxXNl4cJIRykl37MkNy3C01ZWwgVr8mytrDTsD4z4f/s7UEZEFI6mIbDlukJ4jNIAmWwb04XMEyNvUpfjNmdkiy02FuGFhyEYOYVsRuZxXCMzyfn5lzD0gEy7lWxlieE@xibySGCFRYM1aoclXEPyxlsBfoTc/srufA2BGC@51N5CmLIO4j7nn8Mj/SoUpsIMnkzfqWpoNtl2ShYYLUE@0Kl3F9Jus00jtYOUWxc/h9Jl3y8W/UOrfgA" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Too slow on TIO for results of four or more digits. Explanation: Port of @Arnauld's JavaScript answer.</p>
<pre><code>Ｎθ
</code></pre>
<p>Input <code>n</code>.</p>
<pre><code>Ｗ¬⁼θω«
</code></pre>
<p>Repeat until a number with a water capacity of <code>n</code> is found.</p>
<pre><code>→≔⟦⟧υ≔ⅈηＦ…²η«
</code></pre>
<p>Start factorising the next number.</p>
<pre><code>≔Ｘκ⌕Ｘ⁰⮌↨ηκ⁰ζ
</code></pre>
<p>Try to raise each factor to its multiplicity.</p>
<pre><code>≧÷ζη
</code></pre>
<p>Divide by the result.</p>
<pre><code>¿⊖ζ⊞υζ
</code></pre>
<p>Save the prime factorisation if it was nontrivial.</p>
<pre><code>»≔ΣＥυ⁻⌊⟦⌈…υ⊕λ⌈✂υλ⟧κω
</code></pre>
<p>Calculate the water capacity.</p>
<pre><code>»Ｉⅈ
</code></pre>
<p>Output the found number.</p>
<p>72 bytes for a slightly faster version that can produce four-digit results but not five:</p>
<pre><code>ＮθＷ¬⁼θω«→≔⟦⟧υ≔²η≔ⅈζＷ⊖ζ«Ｗ﹪ζη≦⊕η≔Ｘη⌕Ｘ⁰⮌↨ζη⁰ε≧÷εζ⊞υε»≔ΣＥυ⁻⌊⟦⌈…υ⊕λ⌈✂υλ⟧κω»Ｉⅈ
</code></pre>
<p><a href="https://tio.run/##TVA9b4MwEJ3hV3g8S1SKok7N1CatlIEIJUulKIMLp9iqsQO2oaXKb6eGGMRy8t37uHfOOatzzWTf79XN2YMrv7CGim7ilguJBA7awnvlmDRQJaSllJK/OEp1g/ByFFduPTV6NUZcFZwvCXGLfp0Qvmg/gSakGwbBe4d5jSUqiwV0D@MJSnXhpIZucKAkZbfgsVezJJhP7plufXKekA@hitCtEnLEBmuD8MZ8edj5FKuh4Cifvcdr/AK7E40o0OMhbZQ5w8EFwX2@5@RK8OoBSYVyBnwVpR@eU/YzPra/ucQt1yNnER3kmGKinaTIcaD48cXPv0e09dvucVYLZWHLjB3@j9JN36@f@6dG/gM" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation: As above except:</p>
<pre><code>→≔⟦⟧υ≔²η≔ⅈζＷ⊖ζ«
</code></pre>
<p>Start factorising the next number.</p>
<pre><code>Ｗ﹪ζη≦⊕η
</code></pre>
<p>Find the next (prime) factor.</p>
<pre><code>≔Ｘη⌕Ｘ⁰⮌↨ζη⁰ε
</code></pre>
<p>Raise it to its multiplicity.</p>
<pre><code>≧÷εζ
</code></pre>
<p>Divide by the result.</p>
<pre><code>⊞υε
</code></pre>
<p>Save the prime factorisation.</p>
</div>
<div id="pu4" class="pu"><h1>JavaScript (ES6), 166 bytes</h1>
<pre class="lang-none prettyprint-override"><code>c=&gt;{with(Math)for(d=n=[];d.reduce((t,v,i)=&gt;v&gt;1?t-max(0,min(m=m&gt;v?m:v,max(...d.slice(i)))-v):t,c);)for(d=[x=m=1],N=++n;x++&lt;N;d.push(g()))g=_=&gt;N%x?1:x*g(N/=x);return n}
</code></pre>
<p><a href="https://tio.run/##LY1BboMwFET3OYUXqfRdG7d0ifPhBOUCUdQgY8ARNhEY1xLi7NSRuprR6M3MownNombz9JmbWn10eCgst1/jB/hu/EC7aYYWHV5vshWzblelATwP3FAsQ5lXPrNNhE9ujQOLtgyVLQJ/ZUKIViyjSQ1DKc0CLTxXVP5vXiNazG@8RsacjIxd6nTxXJcBekh8jz9Y1m@xyov43kP9gZHKWft1dsTtx2tk1J4ogiSXSS5Jv5JhjJLtRIia3DKNWoxTD/cGzpvaaWLPWweK7ncqT/vxBw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Output</h3>
<p>This is far too slow for TIO, so here is the full output computed on my laptop:</p>
<pre><code>a(1) = 60
a(2) = 120
a(3) = 440
a(4) = 168
a(5) = 264
a(6) = 840
a(7) = 2448
a(8) = 528
a(9) = 1904
a(10) = 624
a(11) = 1360
a(12) = 2295
a(13) = 816
a(14) = 1632
a(15) = 20128
a(16) = 1824
a(17) = 48300
a(18) = 3105
a(19) = 15392
a(20) = 2208
a(21) = 13024
a(22) = 2400
a(23) = 10656
a(24) = 4080
</code></pre>
<h3>Method</h3>
<p>For each integer <span class="math-container">\$n\$</span>, we compute the values <span class="math-container">\$d_k=k^{e_k}\$</span> where <span class="math-container">\$1\le k\le n\$</span> and <span class="math-container">\$e_k\$</span> is the highest value such that <span class="math-container">\$k^{e_k}\$</span> is a divisor of <span class="math-container">\$n\$</span>. We go on until we have:</p>
<p><span class="math-container">$$n=\prod{d_k}$$</span></p>
<p>This gives us a list in which each <span class="math-container">\$1\$</span> corresponds to either a composite value or a prime number that is not a divisor of <span class="math-container">\$n\$</span>.</p>
<p>For instance, <span class="math-container">\$120\$</span> gives the list <span class="math-container">\$[1,8,3,1,5]\$</span>:</p>
<p><span class="math-container">$$120=1^0\times 2^3\times 3^1\times 4^0 \times 5^1$$</span></p>
<p>For each value <span class="math-container">\$d_k\neq 1\$</span> in this list, we compute the amount of water that can be poured in this column with:</p>
<p><span class="math-container">$$\max(0,\min(max\_b_k,max\_a_k)-d_k)$$</span></p>
<p>Where <span class="math-container">\$max\_b_k\$</span> and <span class="math-container">\$max\_a_k\$</span> are the maximum values in the list <em>before</em> and <em>after</em> the current value respectively.</p>
<p>We return the smallest integer <span class="math-container">\$n\$</span> for which the sum of these water amounts is the target capacity <span class="math-container">\$c\$</span>.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, 25 bytes</h1>
<p>Based on <a href="https://codegolf.stackexchange.com/users/64121/ovs">@ovs'</a> <a href="https://codegolf.stackexchange.com/a/276719/36398">J answer</a>.</p>
<pre><code>`@&amp;YF^ttP,wY&gt;]P&amp;vX&lt;-sG+}@
</code></pre>
<p>Try it at <a href="https://matl.io/?code=%60%40%26YF%5EttP%2CwY%3E%5DP%26vX%3C-sG%2B%7D%40&amp;inputs=1&amp;version=22.8.0" rel="nofollow noreferrer">MATL online!</a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>+numbers, <s>186</s> 177 bytes</h1>
<pre class="lang-r prettyprint-override"><code>\(x,n=0)repeat{if({a=numbers::primeFactors(n&lt;-n+1);b=unique(a)^table(a);d=(0*b+1)%o%b;sum(pmax(pmin(apply(d*upper.tri(d),1,max),apply(d*lower.tri(d),1,max))-b,0))}==x)return(n)}
</code></pre>
<p><a href="https://rdrr.io/snippets/embed/?code=f%3C-function(x%2Cn%3D0)repeat%7Bif(%7Ba%3Dnumbers%3A%3AprimeFactors(n%3C-n%2B1)%3Bb%3Dunique(a)%5Etable(a)%3Bd%3D(0*b%2B1)%25o%25b%3Bsum(pmax(pmin(apply(d*upper.tri(d)%2C1%2Cmax)%2Capply(d*lower.tri(d)%2C1%2Cmax))-b%2C0))%7D%3D%3Dx)return(n)%7D%0A%60names%3C-%60(sapply(1%3A8%2Cf)%2C1%3A8)" rel="nofollow noreferrer">Run in it rdrr.io</a></p>
<p>Test sequence:</p>
<pre class="lang-r prettyprint-override"><code>f&lt;-\(x,n=0)repeat{if({a=numbers::primeFactors(n&lt;-n+1);b=unique(a)^table(a);d=(0*b+1)%o%b;sum(pmax(pmin(apply(d*upper.tri(d),1,max),apply(d*lower.tri(d),1,max))-b,0))}==x)return(n)}
`names&lt;-`(sapply(1:24,f),1:24)

#&gt;     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15 
#&gt;    60   120   440   168   264   840  2448   528  1904   624  1360  2295   816  1632 20128 
#&gt;    16    17    18    19    20    21    22    23    24 
#&gt;  1824 48300  3105 15392  2208 13024  2400 10656  4080 
</code></pre>
<p>Ungolfed:</p>
<pre class="lang-r prettyprint-override"><code>\ (x,n=0) {
  repeat{
    if (
      {
        # increment n in the arguments of `primeFactors`
        a=numbers::primeFactors(n&lt;-n+1)
        # heights of bars
        b=unique(a)^table(a)
        # repeat b as length(b) rows to make a square matrix
        d=(0*b+1)%o%b
        # calculate amount of water per bar and sum
        sum(pmax(
          # the lesser height of the tallest bars on either side, minus the bar height
          pmin(
            # vector of tallest bars to the left for each position
            apply(d*upper.tri(d),1,max),
            # vector of tallest bars to the right for each position
            apply(d*lower.tri(d),1,max)
          )-b,
          0
        ))
      } == x ) 
    {
      return(n)
    }
  }
}
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://www.jsoftware.com" rel="nofollow noreferrer">J</a>, 39 bytes</h1>
<pre><code>(]+[~:1#.[:(-~&gt;./\&lt;.&gt;./\.)__^/@q:])^:_~
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70wa8FOJT31NAVbKwV1BR0FAwUrINbVU3AO8nFbWlqSpmtxU10jVju6zspQWS_aSkO3zk5PP8ZGD0TqacbHx-k7FFrFasZZxddBlG_Q5EpNzshXSFOzM9TO1DMygQgvWAChAQ" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre><code>(              )^:_~   Starting with the input, call the inner function 
                       until the output does not change.

            __^/@q:]   prime factorization as a list of prime powers.

  (-~&gt;./\&lt;.&gt;./\.)      water capacity of each column:
         &lt;.             element-wise minimum of ...
     &gt;./\                cumulative maximum and ...
           &gt;./\.         cumulative maximum from the back.
   -~                   subtract the column heights from this.

     1#.               sum to get total water capacity.
  [~:                  is this not equal to the input?
]+                     add to the current value.
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/276711/">276711</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




