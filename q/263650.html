<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::263650</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>195</td><td>Python 3.8 prerelease</td><td>230805T212937Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263766#263766">Donat</a></td></tr>
<tr d-ix="1"><td>257</td><td>AWK</td><td>230817T142533Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/264295#264295">Marius_C</a></td></tr>
<tr d-ix="2"><td>276</td><td>Java JDK</td><td>230824T181610Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/264598#264598">Donat</a></td></tr>
<tr d-ix="3"><td>271</td><td>BASH</td><td>230828T095017Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/264698#264698">Ivan</a></td></tr>
<tr d-ix="4"><td>177</td><td>JavaScript Node.js</td><td>230821T204343Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/264462#264462">Donat</a></td></tr>
<tr d-ix="5"><td>289</td><td>Haskell</td><td>230818T174535Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/264363#264363">Donat</a></td></tr>
<tr d-ix="6"><td>190</td><td>Perl 5</td><td>230817T070117Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/264287#264287">Donat</a></td></tr>
<tr d-ix="7"><td>247</td><td>Python 3.8</td><td>230804T162400Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263701#263701">CursorCo</a></td></tr>
<tr d-ix="8"><td>086</td><td>05AB1E</td><td>230811T121922Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/264010#264010">Kevin Cr</a></td></tr>
<tr d-ix="9"><td>nan</td><td>Python 3</td><td>230803T235855Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263676#263676">anderium</a></td></tr>
<tr d-ix="10"><td>235</td><td>Javascript</td><td>230803T172940Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263668#263668">ccprog</a></td></tr>
<tr d-ix="11"><td>244</td><td>Perl 5</td><td>230805T150004Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263745#263745">good old</a></td></tr>
<tr d-ix="12"><td>188</td><td>JavaScript ES12</td><td>230804T175339Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263704#263704">Arnauld</a></td></tr>
<tr d-ix="13"><td>213</td><td>K ngn/k</td><td>230803T095734Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263659#263659">doug</a></td></tr>
<tr d-ix="14"><td>425</td><td>Python3</td><td>230803T162027Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263667#263667">Ajax1234</a></td></tr>
<tr d-ix="15"><td>078</td><td>Pyth</td><td>230803T221935Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263673#263673">CursorCo</a></td></tr>
<tr d-ix="16"><td>061</td><td>Charcoal</td><td>230803T153908Z</td><td><a href="https://codegolf.stackexchange.com/questions/263650/s-n-a-k-e-a-r-o-u-n-d/263665#263665">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8 (pre-release)</a>, <s>239</s> <s>209</s> <s>205</s> <s>204</s> <s>199</s> <s>197</s> <s>196</s> 195 bytes</h1>

<pre class="lang-python prettyprint-override"><code>def f(s,n):
 i=n%-2;g=&quot;--.\n&lt;-'&gt;&quot;[i:7-i]
 while(i:=i+2)&lt;n:m=&quot;--&quot;*i;g=m+f&quot;--.\n.-%s |\n'{m}-'&quot;%g.replace(&quot;\n&quot;,&quot; |\n| &quot;);z=d=0;*a,=g
 for c in s:d+=a[z]in&quot;.'&quot;;a[z]=c;z+=2*(1,n,-1,-n)[d%4]
 return a
</code></pre>
<p><a href="https://tio.run/##dY89T8MwFEX3/ArLVWSnsSP6AZSkZmBgYENiaztYiZOaJs@R06hQym8PNggJUdiedM@5erd93W8NzBatHYZClaikHYMoDZAWEPJpVgnMebKGJSe3eKXTa643ATpsda2oToWOp9ES0sZTeKwd3sTll5HwsEOnNZC35p0THFaJVW0tc0XxGjDDPjshHGVHUYiLbCyZqAJUGotypAF1aRELuTpuNOCE4MyfIs@OsZiO6YQB4xPGIVoV4dw9ZNW@t4DkMPps0L7BSqgUnTF04/aMkJuGMdNREPwi5gwt/OLWatg7Jnk2GmhJSQdyp6Q1PRTEiVH0zfzs8PrVnzoYU9SqkXAmn6FPW/XY63x3Z80B7s3LQ9@0HWGXXvvfamslOwWGsJkDhw8" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>I was able to simplify again by a significant amount. Now the output is a simple array of characters (this is better than before).</p>
<p>The recursive function <code>g</code> makes an empty snake, function <code>f</code> fills in the given string <code>s</code>.</p>
<ul>
<li>minus 30 bytes by simplification of function <code>g</code></li>
<li>minus 4 bytes by inlining the function <code>g</code> (now non-recursive)</li>
<li>minus 1 byte thanks to c--</li>
<li>minus another 5 bytes thanks to c-- !</li>
<li>minus 2 bytes by using f-string and formatting</li>
<li>minus 1 byte thanks to c--</li>
<li>minus 1 byte thanks to Jakque</li>
</ul>
<h2>Here are my older versions:</h2>
<h3><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8 (pre-release)</a>, <s>271</s> <s>269</s> <s>257</s> 254 bytes</h3>
<p>This new version (built from the 275 bytes solution) stretches the output rules to the maximum, or even beyond? The output array contains iterables as elements, either strings or arrays of strings. By <code>&quot;&quot;.join(e)</code> we always get a string out of element <code>e</code>.</p>
<ul>
<li>Minus 2 bytes, thanks to an idea of noodle man!</li>
<li>Minus 12 bytes by myself, using new algorithm for spiral</li>
<li>Minus 3 bytes by myself - small improvement</li>
</ul>

<pre class="lang-python prettyprint-override"><code>g=lambda n:[(m:=&quot;-&quot;*(2*n-3))+&quot;-.&quot;]+[&quot;.|- &quot;[i&gt;0::2]+g(n-2)[i]+&quot; |&quot;for i in range(n-2)]+[f&quot;'{m}'&quot;]if n&gt;2else[&quot;--.&quot;,&quot;&gt;&quot;,&quot;&lt;-'&quot;][n&lt;2::2]
def f(s,n):
 z=d=0;a=g(n)
 for c in s:l=list(a[z//n]);d+=l[z%n*2]in&quot;.'&quot;;l[z%n*2]=c;a[z//n]=l;z+=(1,n,-1,-n)[d%4]
 return a
</code></pre>
<p><a href="https://tio.run/##jY@xTsMwFEX3fMWTEUrc2IGmBUFSd2BgYENiszKYxmlNnecoSQUU@PbiAB2oADF48H3vHF83z/3K4eSiaXe7pbCqvi8VYCajOhOEk1GUjpBPKI0JT0gRS5K8ciDSzE@zLC3iZYQ8pdIUMYFXUrkWDBiEVuFSf4w8UpHwpX4LSWEqwHmqbacl4V7HyNyfGfcjibN0EAalrqCKOoY0C2ArSnGaK@FfoQEM9sVg7zIrrOn6SMntyQkWNC9jYeX2GEdpYZAkIcn3V7HIv7aEzbexiMYMGR8zjlSWx9MigFb3mxZB7Y7goP@EwaWvcQS@ESHM0CA42JgyuBiKDrEd4ioKO1RrrVq3wTL0TAZNa7D3guTBGYws9V/5jL58exCdK62uFYZs@iO2p36Bzv@EvlF3K327MYv1Vese8do93WzqpgvZ2f8NjdWq0@hCNvkJ2r0D" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<h3><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8 (pre-release)</a>, <s>361</s> ... 275 bytes</h3>
<ul>
<li>Minus 18 bytes, thanks to noodle man!</li>
<li>Minus 18 bytes additionally by myself</li>
<li>Minus 9 bytes by myself</li>
<li>Minus 9 bytes by myself</li>
<li>Minus 11 bytes by myself</li>
<li>Minus 20 bytes by returning a 2 dimensional array, thanks to noodle man!</li>
<li>Minus 1 byte by myself</li>
</ul>

<pre class="lang-python prettyprint-override"><code>g=lambda n:[(m:=&quot;-&quot;*(2*n-3))+&quot;-.&quot;]+[&quot;.|- &quot;[i&gt;0::2]+g(n-2)[i]+&quot; |&quot;for i in range(n-2)]+[f&quot;'{m}'&quot;]if n&gt;2else[&quot;--.&quot;,&quot;&gt;&quot;,&quot;&lt;-'&quot;][n&lt;2::2]
def f(s,n):
 x,y,k,a=0,0,7,[list(s)for s in g(n)]
 for c in s:k=(7-5*(k&gt;6),-5*(k&gt;1),k)[&quot;.'&quot;.find(a[y][x])];a[y][x]=c;x+=k//3;y+=k%3-1
 return a
</code></pre>
<p><a href="https://tio.run/##jY8xT8MwEIX3/IqTKxS7sUubUFpS0oGBgQ2JzcpgGqeYJOcobkUr4LcXB8oAAsRg@e6dv3fP7X7zYDGZt93hsM5q1dwXCjCVtEkzIsiQxkMUCWMRESOSR5KMXgQQaZbjNI3zaE1RxEyaPCLwQkrbgQGD0Clc6/eRR0oSPjevIclNCbiMde20JMLbcbL051L4kcTLuDcMCl1CSR1Hlgaw43tecZWN@ZjPuKyN21DH@i2u3@KXszyAvl/1vUurjM7EdEir5TnjH8WE8Yr52CEZlQYLquQ@l7uc5Ytjla0WuyirTk@Txd7fJ4mYBNDpzbZDUIcBfPtUwuHCZxuAj0kINywIvr044zDv0/dy3cslDR2qSqvObrEIPZNC2xnceIPRozVIa8aCo3T0@wTR2qLWjcKQn/2IfVK/QOd/Ql@ouwd9uzWr6qqzT3htdzfbpnUhn/7foa21chptyJOfoMMb" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>Recursive, but not shortest, unfortunately.</p>
<p>Function <code>g</code> makes an empty snake, function <code>f</code> fills in the string.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.gnu.org/software/gawk/manual/gawk.html" rel="nofollow noreferrer">AWK</a>, <strike>332 321 317 281 273</strike> 257 bytes</h1>
<pre><code>func R(C){r=++c&lt;A*A?length($1)&lt;c?i&lt;A?C:S%2?&quot;'&quot;:&quot;.&quot;:substr($1,c,1):S%2?&quot;&lt;&quot;:&quot;&gt;&quot;;g[x,y]=S%2?G r:r G}func f(){for(x=c=S=i=0;i&lt;A=$2;R(B=&quot;-&quot;,G=++i&lt;A?B:&quot;&quot;))y=i;while(S++&lt;=A){for(i=S;i++&lt;A;R(&quot;|&quot;,G=i&lt;A?&quot; &quot;:B))x+=t=S%2*2-1;for(i=S;i++&lt;A;R(B,G=i&lt;A?B:&quot;&quot;))y-=t}return G}
</code></pre>
<p><a href="https://tio.run/##XU7dboIwGL3nKZpGs1ZwUbe5BOgMmMxkyS4mu3NeMCxaxGIKRIzj2dkHuDnXq55zvvPjH7ZVFeYyQHMypSfFdD2wnZ4ziblcZxvSGVI7mAjbmUxNrzua4Bts4ltspvlnmimQjcAY0layQXrC1npRGMclq6kZUqZCs7IpCAk9hYkiBQuYxwQbWBDLOiNrTlyG@9iYQXnd5JoYU3pkwjpsRMyJp@s2c1qzYJ4lADvgwl@1p3ZghE2X0kJnWd3bG/WH1v9r93x7Tu@zrFQ8y5WEfdVJQ/D2SsgMdQYGxOGGefUzJQoG0xvYZg4sJGzYjSCats4fMarFqBEjENvEkOBuio31QhjRkv7eNxqBMQ1TXhbA/YcEuqxS6W@5r5JcrtC99hc9XKHxFXrUZJKsYr7zJbgu/7H2vuFvuQi2rkoO8jkpXvLdPoWsfcz9lMsE3X0D" rel="nofollow noreferrer" title="AWK – Try It Online">Try it online!</a></p>
<ul>
<li>-11 bytes, replaced <code>condition ? var = val1 : var = val2</code> with <code>var = condition ? val1 : val2</code></li>
<li>-4 bytes, replaced <code>function</code> with <code>func</code></li>
<li>-36 bytes, thanks to <a href="https://codegolf.stackexchange.com/users/52904/ceilingcat">@ceilingcat</a>. Chained <code>=</code>, chained ternary operator and other optimization</li>
<li>-8 bytes, thanks to <a href="https://codegolf.stackexchange.com/users/52904/ceilingcat">@ceilingcat</a></li>
<li>-16 bytes, thanks to <a href="https://codegolf.stackexchange.com/users/52904/ceilingcat">@ceilingcat</a>. Passed ternary operator as second arg for <code>func R(C)</code> and moved incrementation of <code>c</code> in same function to allow more efficient one-liner loop.</li>
</ul>
<hr />
<h2>Ungolfed</h2>
<pre><code>function result(string2)
{
    rep = string2
    if ( i == $2-1 ) step % 2 ? rep = &quot;'&quot; : rep = &quot;.&quot;
    if ( length($1) &gt; cpt ) rep = substr($1, cpt+1, 1)
    if ( cpt == ($2 * $2)-1 ) step % 2 ? rep = &quot;&lt;&quot; : rep = &quot;&gt;&quot;
    return rep
}

function snakearound()
{
    x = 0
    y = 0
    cpt = 0
    step = 0
    for(i = 0; i &lt; $2; i++)
    {
        grid[x, y] = result(&quot;-&quot;)
        if (i+1 &lt; $2) grid[x, y] = grid[x, y] &quot;-&quot;
        cpt++
        y++
    }
    y--
    while(step &lt;= $2)
    {
        step++
        step % 2 ? tmp = 1 : tmp = -1
        for(i = step; i &lt; $2; i++)
        {
            x += tmp
            grid[x, y] = result(&quot;|&quot;)
            i == $2-1 ? string = &quot;-&quot; : string = &quot; &quot;
            step % 2 ? grid[x, y] = string grid[x, y] : grid[x, y] = grid[x, y] string
            cpt++
        }
        for(i = step; i &lt; $2; i++)
        {
            y -= tmp
            grid[x, y] = result(&quot;-&quot;)
            i == $2-1 ? string = &quot;&quot; : string = &quot;-&quot;
            step % 2 ? grid[x, y] = string grid[x, y] : grid[x, y] = grid[x, y] string
            cpt++
        }
    }

    for(i = 0; i &lt; $2; i++){
        for(j = 0; j &lt; $2; j++) printf(&quot;%s&quot;, grid[i, j])
        printf(&quot;\n&quot;)
    }
}
<span class="math-container">```</span>
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="http://jdk.java.net/" rel="nofollow noreferrer">Java (JDK)</a>, <s>279</s> <s>278</s> 276 bytes</h1>

<pre class="lang-java prettyprint-override"><code>char[]f(String s,int n){var a=g(n).toCharArray();int z=0,d=0;for(var c:s.toCharArray()){d+=a[z]/2&amp;1;a[z]=c;z+=(d%2&lt;1?1:n)*(d%4&lt;2?2:-2);}return a;}String g(int n){String m;return n&gt;1?(m=&quot;--&quot;.repeat(n-2))+&quot;--.\n&quot;+(n&gt;2?&quot;.-&quot;+g(n-2).replace(&quot;\n&quot;,&quot; |\n| &quot;)+&quot; |\n'&quot;+m:&quot;&lt;&quot;)+&quot;-'&quot;:&quot;&gt;&quot;;}
</code></pre>
<p><a href="https://tio.run/##dZBRb5swFIXf9yuuLG21S2AN7aQJx4m2SXvo25S9pXm4A4fSwDWyTbom5bdnJqFa@1AkxDXnO5zDfcAdxg/F9pjX6BwsCbcaDsf8Hu1qveFLbysqwU0q8kDisEMLqEpOIvHmR4C@WYtPXMhB36urSaGu5MZYPoB55t5S4lBEClf79ef001QOg8rlPlK8@JjOpotpRuIyzDezdJFmcSpkb7XvLAHKfmxS8rHJeG7kiNB8uuCNYnHMEqtbjZ5T@ISIwpvkjljEaZ4uWBKzqDwpA1VjrjkL6oTB8x09Awv8MF2wqMnYbDjGFyxjcyb7I0Brqx16Dc6jr3LYmaoAr53/vyc414PDBwjX8sl53SSm80mwkq@Jk348b5mLZMODgYSQ78EnpQ932/2pQ@Dr3AYrGnNXa0BbupfUsH84ralSNxIqmMHX8Igice7K3BCP1nRUsFB4jH/HpdIXGxlT1LpBemU6K7/v9a@uyrffrXmkn@bvbde0LlBf3lBtrdFpMkG4Hn@sP/4D" rel="nofollow noreferrer" title="Java (JDK) – Try It Online">Try it online!</a></p>
<p>I have derived this from my JavaScript answer. Java is not really good for code golf, but I think, the result is not too bad.</p>
<ul>
<li>minus 3 bytes, thanks to ceilingcat</li>
</ul>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.gnu.org/software/bash/" rel="nofollow noreferrer">BASH</a> , <s>580 349 308 303 291 286 283 277 275 272</s> 271 bytes</h1>
<p>Found this very entertaining, thanks! First variant was 580 bytes, then 349, ..., now 271:</p>

<pre class="lang-bash prettyprint-override"><code>s=$1 n=$2 N=$[n+n-1];f(){ b=$1;for((j=1;j&lt;n;j++));{((c&lt;N))&amp;&amp;T+=%s;[[ $4 ]]&amp;&amp;h=$4 S[i+$2/2]=-;t=${s:c:1} S[i]=${t:-$b} b=$3;$[i+=$2,c++];S[i-($2/N)]=\ ;};};while((n&gt;0));do f . 2 - \&gt;;$[n-=a];f . $N \|;f \' -2 - \&lt;;$[n--];f \' -$N \|;a=1;done;S[i]=$h;printf $T\\n &quot;${S[@]}&quot;
</code></pre>
<p><a href="https://tio.run/##LZBNboMwEIWvMopcast1W5OumDjqCdgkO@wFvwIaDRUQdUE5O50k1WzG7/PzG0@RT@22TU5YICdiSJ3ISJOxARupFiiYYDOMUvbOYn8g7LVWChcpy0OqVBSdtXuaMMtAfEAIUdQ6bk5Zp0X8FgdncHZimZIysetNDnyaEyOK9fb2HgXf5OCXUuuAzI1kX6qC84Ar10/bXWop6fjOqdUADbxCDAb8ka1kXM6DsiRS8L/c@Wcwd3y4YxP@tQfP@Q/VQDU@Bmnxe@xobkCcvSfYieWUfYZ1t/FGKP@q83G4UtVcqZy7gdh36ageN2v/AA" rel="nofollow noreferrer">Try it online!</a></p>
<p>Squeezed to 271(with <code>2&gt;/dev/null</code>):</p>
<pre class="lang-bash prettyprint-override"><code>#!/bin/bash
s=$1 n=$2 N=$[n+n-1]
f(){ 
    b=$1
    for((j=1;j&lt;n;j++)); {
        ((c&lt;N))&amp;&amp;T+=%s
        [[ $4 ]]&amp;&amp;h=$4 S[i+$2/2]=-
        t=${s:c:1} S[i]=${t:-$b} b=$3
        $[i+=$2,c++]
        S[i-($2/N)]=\ 
    }
}
while((n&gt;0));do
    f .  2    - \&gt;; $[n-=a]
    f .  $N  \|
    f \' -2   - \&lt;; $[n--]
    f \' -$N \|   ;   a=1
done;S[i]=$h;printf $T\\n &quot;${S[@]}&quot;
</code></pre>
<p>First variant was:</p>
<pre class="lang-bash prettyprint-override"><code>#!/bin/bash

s=$1
n=$2
l=${#s}
N=$((n+n-1)) # items per row

# Check if n is in range
(( (n*n)&gt;=(l+1) )) || { echo &quot;n must be 'n^2≥l+1'&quot;; exit 1; }

# Fill the 'area' with spaces
for ((i=0; i&lt;n*N; i++)); { snake[$i]=&quot; &quot;; }

# Create printing template
printf -v row &quot;%${N}s&quot;
row=${row// /%s}

# Setcounters
i=0
c=0
a=0


forward(){
    b='.'
    for ((j=1; j&lt;n; j++)); do
        cut=${s:c:1}
        snake[$i]=${cut:-$b}
        snake[$((i+1))]=&quot;-&quot;
        b='-'
        h='&gt;'
        ((i+=2))
        ((c++))
    done
    ((n-=a))
}


down(){
    b='.'
    for ((j=1; j&lt;n; j++)); do
        cut=${s:c:1}
        snake[$i]=${cut:-$b}
        b='|'
        ((i+=N))
        ((c++))
    done
}


back(){
    b=&quot;'&quot;
    for ((j=1; j&lt;n; j++)); do
        cut=${s:c:1}
        snake[$i]=${cut:-$b}
        snake[$((i-1))]=&quot;-&quot;
        h='&lt;'
        b='-'
        ((i-=2))
        ((c++))
    done
    ((n--))
}


up(){
    b=&quot;'&quot;
    for ((j=1; j&lt;n; j++)); do
        cut=${s:c:1}
        snake[$i]=${cut:-$b}
        b='|'
        ((i-=N))
        ((c++))
    done
    a=1
}


print(){
    printf &quot;$row\n&quot; &quot;${snake[@]}&quot;
#    echo $i,$c,$n
}


# Create snake
while ((n&gt;0)); do
    forward
    down
    back
    up
done
snake[$i]=$h; printf &quot;$row\n&quot; &quot;${snake[@]}&quot;
</code></pre>
<p><a href="https://tio.run/##vVTBjtowEL37K6bGu0mWTbPhUgnwqtJKPXLpsd1KjjEbL2ESxaGpBHxAP6Q/1h9JJ4aFtqirnrCU4BmPZ9570SNTLu@6wZsks5hkFDDmpEgZSjFihRSbgduxmRRhiEOM0yiCAdjGrBxUpoa6bBkbwENu9BLsAhCsA4tQK3wyLAwhxBuM7mVYDNMI6PJ2CxswOi@BI6zWroHMQIBfRj@//6CagE/AfLMNpBPY9Z0/2KKAJqcaVRsVQGubHFyltHFsUdYQhlbeTcBO8WZGP8NhFE1ogkO1NJ@EfZQc@KHVAzVoDFS1xcbiExCJqqAM85kFxF97OsCvxGa2c5xRQPTpnSSQXDnf46NpdLnGxtSO0WCm6VH0sB5Mq@p5GG0Y0Mpk8Dbwuz3KZ0mMnqdIrz3GeelP@6XXDQ1yYz1Od8fkiYHYUME4FtnZIZEnWSMiGfPjGU2Og2OUy@D@FPUX5CiKfkvoHo6P5yUatk9iLBVliTKbly1ehhR13/4FdfYa1B5dpvTyhI4H/AKSx2eSk8jT4B8foL/wf5LHB8XX1WUYnekdv653v1Ey9Ri9ZV5gHvzDBXnlM5LhCIcf/P5xx8k0tLzjhb0V@lag73D0oy9lbW4LA@MjpYOdDtNb3OtBX9tv1tWLalN5R/8q19d/eF7kE8io@7J3vsfuIXZd52tUTRae63Jl3H7bvfsF" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, <s>193</s> <s>192</s> <s>190</s> <s>188</s> <s>187</s> <s>182</s> 177 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;n=&gt;s.map(c=&gt;a[d*=/[.']/.test(a[z-=d])?d*d&lt;5?n:-1/n:1,z]=c,d=z=-2,a=[...g(n)])&amp;&amp;a
g=(n,m)=&gt;--n?(m=&quot;--&quot;.repeat(--n))+`--.
${n?`.-${g(n).split`
`.join` |
| `} |
'`+m:&quot;&lt;&quot;}-'`:&quot;&gt;&quot;
</code></pre>
<p><a href="https://tio.run/##jc47a8MwFIbh3b/CiBBLiaTQS1IwkQ0dOnQrdHMNEpacOrHPMZbTllx@uxt3a8nQ6cAHz8vZmg/ji65qewFo3VCqwasEVOJlY1paqMRkdqYWmYzyheyd76nJDkLZnKV2ZtfLFGJxs4D4hh9yVXCrDkrccqMyKeWGAsvZdGqCjaLAG6YSISCljSJCENm51pmeXibG5loIGUyOkGopJsdRSt/WVa8DLbdYgQ5PwSnU58uJ9LyJyZqcRaRjkpChxC6kVYhlmN3zJV/xh5yFBYLH2skaN7Sk4zuRB7NzpsM92ChntGI/ZUoIm5M3ICz4FVpdjwCirV1j4Hriinh9dy/7qtg9dvgJT/j1vG9aP@rlf3RbO@Md4Aju/oLhGw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>Now even shorter than Arnauld's excellent answer!</p>
<ul>
<li>Minus 5 bytes thanks to noodle man!</li>
<li>Minus 5 bytes by clever improvement thanks to Arnauld!</li>
</ul>
<p>This answer has been derived from my Python solution.</p>
<p>Function <code>g</code> makes an empty snake and function <code>f</code> updates it with the chars from string <code>s</code>. The function has to be called by <code>f(s,n)</code> and returns a plain array of single char strings.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, <s>333</s> 289 bytes</h1>

<pre class="lang-hs prettyprint-override"><code>f s n=h s n 0 0$concatMap(++&quot;\n&quot;).g$n
h(c:t)n d z m=take z l++c:drop(z+1)l where e=mod(d+sum[1|a&lt;-&quot;.'&quot;,m!!z==a])4;l=h t n e(z+2*[1,n,-1,-n]!!e)m
h _ _ _ _ m=m
g 1=[&quot;&gt;&quot;]
g 2=[&quot;--.&quot;,&quot;&lt;-'&quot;]
g n=(m++&quot;--.&quot;):(map(++&quot; |&quot;).h)b++[&quot;'-&quot;++m++&quot;'&quot;]where b=g(n-2);m=b&gt;&gt;&quot;--&quot;;h(l:k)=[&quot;.-&quot;++l]++map(&quot;| &quot;++)k
</code></pre>
<p><a href="https://tio.run/##bZBfS8MwFMXf@ynuwmCJacs6p0K37MEHH8Q9iL7VIlmbraPJTekfJmPfvaZOdA8jEG5@nHvOIYVsSqV132@hARTFcMMUpuPMYibbtawo5@QDCQt3Y/QKmsUtQ8jhCEa0slRu0JxncV7bih55xDQcClUrUMLYnOa86UwSneQyIOGE@GY0OgohUzZfaJfWujTl1mY3SeSjH0R@gOlopJjxCvj8PUYYbweRSMiKpG6auSkIQuKTZTD5ISiocTUHyGJqzqXh5EoXbMN5QiYB4XyQOP253kbsKAYztjBis1q5VbIoqI5L5szDQa1Tt@GcyAnci5W9kXsUjqyh6tq3tn5BSDwAugXSoPsJWdsOcwJz5l/Dd9fx/XX88IfR2lwrI/HS@QL@G7wX6rXbZ@VjbQ/4ZL@eO1M1l8GVVrJRaAncsrT/Bg" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>
<p>Function <code>g</code> makes an empty snake as a list of strings. Function <code>h</code> fills in the given string <code>s</code> while converting the list of strings to a single string. Function <code>f</code> is the resulting target function.</p>
<p>In function <code>h</code>, <code>d</code> is the direction where to go for the next character of string <code>s</code> and <code>z</code> is the position of the character to replace.</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a>, <s>236</s> <s>224</s> <s>222</s> <s>214</s> 190 bytes</h1>
<ul>
<li>minus 24 bytes, thanks to: good old time!</li>
</ul>

<pre class="lang-perl prettyprint-override"><code>sub g{my$m=&quot;--&quot;x($n=-2+pop);$m?&quot;$m--.\n.-@{[g($n)=~s/\n/ |\n| /gr]} |\n'$m-'&quot;:$n?&quot;&gt;&quot;:&quot;--.\n&lt;-'&quot;}sub f{$a=g$p=pop;$z+=(1,$p,-1,-$p)[($#_+=(substr$a,2*$z,1,$_)=~/[.']/)%4]for$_[$z=0]=~/./g;$a}
</code></pre>
<p><a href="https://tio.run/##bc3BToNAEAbgu0@xWccAdhdsbTUprjUeevBm4g0IWS1gU5jdLCVWWnx1XDwoB2@Tf75/RmemXPR93byS4lh9QiUo5/TgAgo@m2ilvRCqFYWKcz9Gnz8co8IuPfFVBzEG5BTjiQSFSbphdKxz6BJwRe/pkv507mzSDffzI0hRgBb2agjtRLhTBprxKeOgvciF89RmVtZ7A5LNLqFlVqT2VxD5ThJ4F/MkVwbSCFpxldjYD4oQZNdrs8W9m7tOjXKXSaMa3DhDlREaY4zUI7ZI3Lnv33rh2S9HpTZlVkn8F7ObsX15z56b7dvu0agPXKvDU1Pp2mFk8dcbaV1mss5QWXA9Av03" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>
<p>I have derived this from my Python answer. Function <code>g</code> makes an empty snake, function <code>f</code> fills in the string.</p>
<p>Here is the same code with a little more spacing for better readability:</p>

<pre class="lang-perl prettyprint-override"><code>sub g{
  my$m=&quot;--&quot;x($n=-2+pop);
  $m?&quot;$m--.\n.-@{[ g($n)=~s/\n/ |\n| /gr ]} |\n'$m-'&quot;:$n?&quot;&gt;&quot;:&quot;--.\n&lt;-'&quot;
 }
sub f{
  $a=g$p=pop;
  $z+=(1,$p,-1,-$p)[($#_+=(substr$a,2*$z,1,$_)=~/[.']/)%4] for $_[$z=0]=~/./g;
  $a
}
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8</a>, <s>254</s> 247 bytes</h1>

<pre class="lang-python prettyprint-override"><code>lambda n,s:(r:=range,G:=[&quot;&lt;&gt;&quot;[n%2]],[(K:=(s+''.join((2*[(n+~h//4)*&quot;-&quot;,(n-2-h//4)*&quot;|&quot;],&quot;.''.&quot;)[h%2][h//2%4]for h in r(4*n))[len(s):])[~(f+1)**2:],G:=['-'.join(K[:f+1])]+[G[~g][::-1]+&quot;- &quot;[f-g&gt;1]+K[f-~g]for g in r(f)])for f in r(1,n)])and'\n'.join(G)
</code></pre>
<p><a href="https://tio.run/##LY1NboMwEIWvYlmKmAE7EZRIlVWyZcERJl64AgNtOiCTLipVXJ06Dbv3M/O9@ec@TPzyOofNV9ft5r7eWydYLQaCqYLjvlO1qUi@XSTxobBWETSmgiVLkuPHNDJAkRJwtg6nU4mp1FIB60Lv9ldaJY/xViIN8Z9iXhxK66cgBjGyCFCmjEi3jmFBY5FW8FmOaVoY@7@d6H2pIRMbizajmtbekjE6t5nUQpLX/SXqJorYPOj9k@7R4sP6p80Vx8Bxm1x5x9a4zWHkO3g4KyEXdp@dC9M3txJx@wM" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>Essentially a port of my <a href="https://codegolf.stackexchange.com/a/263673/73054">Pyth answer</a>.</p>
<p>I'll hand wave a bit of an explanation. We start by assigning <code>G</code> to the center of the spiral, <code>n</code> being even or odd determines if the arrow points left or right. Next we construct the string for the spiral as if <code>s</code> was an empty string, then replace the beginning of that string with <code>s</code>. We then build the rest of the square, each iteration we flip <code>G</code> 180 degrees and add to the top and the right side. After <code>n-1</code> iterations of this, we return <code>G</code> joined on newlines.</p>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 86 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>LR·&lt;€D¬šIõ¹·nи«'-ýŽ9¦S.Λ¶¡ιн»¶«„ -Â‚Dð¶:«D'-'|::2äε„|-Â‚D'|„.'Nè::¹N+ÉiNi'''&lt;.;ë¨'&gt;«]J
</code></pre>
<p>Inputs in the order <span class="math-container">\$n,S\$</span>, where <span class="math-container">\$S\$</span> is a list of characters.<br />
Outputs with two trailing newlines. If this is not allowed, a trailing <code>¨</code> or <code>?</code> could be added so it'll output a single trailing newline instead.</p>
<p><a href="https://tio.run/##yy9OTMpM/f/fJ@jQdptHTWtcDq05utDz8NZDOw9tz7uw49Bqdd3De4/utTy0LFjv3OxD2w4tPLfzwt5Du4Gs1Y8a5inoHm561DDL5fCGQ9usDq12UddVr7GyMjq85NxWoGwNVFa9BsjRU/c7vMLK6tBOP@3DnZl@merq6jZ61odXH1qhbndodazX///mXNFKxUo6SnlAnAjE2UCcCmUXAXE@EJdC5VOUYgE" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##ZY/PSgJRFMb38xSXS3AXjSP0l6bBIExIQikrAhO6Ohcc1HsHZwZbuBB3vUJBIEQYI9JGLWI25@JWfAZfZLqWm3J1zu/7zvk4p0y9alyhPkqhirCZITxadhiyLHSSz2j4lLuB75kIH@kazge@IgX67V3hCt5wfHYBE2vRHaRhMO3dyBEMYcLnHxCShIym0QG8FozZE4yhN/ucR/ClunDReUYJ2V10HtPyHcYmhGmSIG3T3JIvs5Fy2yuXtBUYJCf7pgnD3KZ8cHIOIcQyDmUIfZKCsJSNsXGta8tbtVbVqTPUZNRGDtdsoSGUFK6f/H1pVf59aaGNn1nO4uKOjj1Oa4w2RcBtXNKKu2vK3pqyv6aoHC6EXWcNylc7f1ilXlbZeeBUasdN0eIZcZ8NGq639LZ17NYZ9RgXCr8B" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<p><em>Step 1: Prepare the input character-list by joining by <code>-</code> and adding additional trailing <code>-</code>. Then use the (modifiable) Canvas builtin to put this string itself and all spaces at the correct positions in the output rectangle:</em></p>
<pre class="lang-python prettyprint-override"><code>LR·&lt;€D¬š         # Create the list of lengths for the Canvas builtin:
L                #  Push a list in the range [1, first (implicit) input-integer]
 R               #  Reverse it to range [n,1]
  ·              #  Double each inner value
   &lt;             #  Decrease each by 1
    €D           #  Duplicate each value within the list
      ¬š         #  And prepend an additional copy of the first/largest item
Iõ¹·nи«'-ý      '# Create the string to draw for the Canvas builtin:
I                #  Push the second input-list of characters
  ¹·n            #  Push the first input, double it, take the square of that: 4n²
 õ   и           #  Create a list with that many empty strings &quot;&quot;
      «          #  Append it to the input-list
       '-ý      '#  Join this list with &quot;-&quot; delimiter
Ž9¦S             # Create the list of directions for the Canvas builtin:
Ž9¦              #  Push compressed integer 2460
   S             #  Convert it to a list of digits: [2,4,6,0]
.Λ               # Use the (modifiable) Canvas builtin with these three options
¶¡ιн»            # Remove all (0-based) odd-indexed rows
¶¡               # Split it on newlines
  ι              # Uninterleave it into two parts
   н             # Pop and only leave the first part
    »            # Join it back together by newlines
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/f/fJ@jQdptHTWtcDq05utDz8NZDOw9tz7uw49Bqdd3De4/utTy0LFjv3OxD2w4tPLfzwt5Du///N@eKVipW0lHKA@JEIM4G4lQouwiI84G4FCqfohQLAA" rel="nofollow noreferrer">Try just step 1 online.</a></p>
<p><a href="https://codegolf.stackexchange.com/a/175520/52210">For more information on how the Canvas builtin works, see this 05AB1E tip of mine.</a><br />
<a href="https://codegolf.stackexchange.com/a/166851/52210">See this 05AB1E tip of mine (section <em>How to compress large integers?</em>)</a> to understand why <code>Ž9¦</code> is <code>2460</code>.</p>
<p><em>Step 2: Replace all <code>-</code> that are currently at edge or corner positions with <code>|</code>:</em></p>
<pre class="lang-python prettyprint-override"><code>¶«               # Append a trailing newline
„ -              # Push string &quot; -&quot;
   Â             # Bifurcate, short for Duplicate &amp; Reverse copy: &quot;- &quot;
    ‚            # Pair them together: [&quot; -&quot;,&quot;- &quot;]
     D           # Duplicate it
      ð¶:        # Replace all spaces with newlines in the copy: [&quot;\n-&quot;,&quot;-\n&quot;]
         «       # Merge the two together: [&quot; -&quot;,&quot;- &quot;,&quot;\n-&quot;,&quot;-\n&quot;]
D                # Duplicate it
 '-'|:           # Replace all &quot;-&quot; with &quot;|&quot; in the copy: [&quot; |&quot;,&quot;| &quot;,&quot;\n|&quot;,&quot;|\n&quot;]
:                # Replace all [&quot; -&quot;,&quot;- &quot;,&quot;\n-&quot;,&quot;-\n&quot;] respectively with
                 # [&quot; |&quot;,&quot;| &quot;,&quot;\n|&quot;,&quot;|\n&quot;]
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/f/fJ@jQdptHTWtcDq05utDz8NZDOw9tz7uw49Bqdd3De4/utTy0LFjv3OxD2w4tPLfzwt5Du4Gs1Y8a5inoHm561DDL5fCGQ9usDq12UddVr7Gy@v/fnCtaqVhJRykPiBOBOBuIU6HsIiDOB@JSqHyKUiwA" rel="nofollow noreferrer">Try the first two steps online.</a></p>
<p><em>Step 3: Replace all <code>|</code> at corner positions with either <code>.</code> (for the top halve) or <code>'</code> (for the bottom halve):</em></p>
<pre class="lang-python prettyprint-override"><code>2ä               # Split the string into two equal-sized parts
  ε              # Map over both parts:
   „|-           #  Push string &quot;|-&quot;
      Â‚         #  Bifurcate and pair again: [&quot;|-&quot;,&quot;-|&quot;]
   D             #  Duplicate it
    '|     :    '#  Replace all &quot;|&quot; with the following in the copy:
      „.'Nè     '#   The map-index'th character of string &quot;.'&quot;
   :             #  Replace all [&quot;|-&quot;,&quot;-|&quot;] respectively with
                 #  [&quot;.-&quot;,&quot;-.&quot;] for the first iteration of the map
                 #  or [&quot;'-&quot;,&quot;-'&quot;] for the second iteration of the map
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/f/fJ@jQdptHTWtcDq05utDz8NZDOw9tz7uw49Bqdd3De4/utTy0LFjv3OxD2w4tPLfzwt5Du4Gs1Y8a5inoHm561DDL5fCGQ9usDq12UddVr7GyMjq85NxWoGwNVFa9BsjRU/c7vMLK6n@s139zrmilYiUdpTwgTgTibCBOhbKLgDgfiEuh8ilKsQA" rel="nofollow noreferrer">Try the first three steps online.</a></p>
<p><em>Step 4: And finally, fix the <code>&gt;</code> or <code>&lt;</code></em>, and output the result:</p>
<pre class="lang-python prettyprint-override"><code>    i            #   If
¹N+              #   the first input + the (0-based) map-index
   É             #   is odd:
     Ni          #    If it's the second iteration of the map:
       '' '&lt;.;  '#     Replace the first &quot;'&quot; with &quot;&lt;&quot;
      ë          #    Else (it's the first iteration of the map)
       ¨         #     Remove the last character of the first part
        '&gt;«     '#     And append a &quot;&gt;&quot; instead
]                # Close both if-statements and the map
 J               # Join the two modified parts back together
                 # (after which the result is output implicitly with trailing newline)
</code></pre>
</div>
<div id="pu9" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <s>371</s> <s>274</s> 255 and 253 bytes</h1>
<pre class="lang-python prettyprint-override"><code>def f(s,n):
 for y in(a:=range(n)):
  for x in a:r=min(x,y,n+~x,n+~y);i=4*r*(n-r)-2*r+x+y+2*(2*(n+~r)-x-y)*(y&gt;x);H=max(n+~y,y)&gt;x&gt;min(y-2,n-y-2);b=x+1&gt;n/2;print(s[i:]and s[i]or&quot;|-..''&gt;&lt;&quot;[H+2*((n+2*~x)*b-~x==y)+4*((n+~x-x)*b+x==n+~y)],end=&quot; -&quot;[H])
  print()
</code></pre>
<p><a href="https://tio.run/##XZDBa8MgGMXv/SskPaiJdizNRpfMHHYYZbfBbiUHu9g1tPkMpmUKI/96pilldCAf8n7Pp8/OnfYalqvOjGOtdmhHegY0n6GdNsihBojMhZHwpQjQoE/AeoBkbkTrDZY5Bslgw3C0aEQWm5gAN5SnsUls4pI0Jn557jXLHY2JKy0t1qKVNsiOOVraMqQ5njLgftJiK2xyX8JdWnSmgRPpN01eSaiR31TaRD98scC4fI4263CDD0rjwdJ4ywcrhKNJNomD5UFMvDa9sGIKahEh7s9V1De6pNNxPnVrQrdL4yVDT77z3JcmUcQaOpv9c2QMrabfIrgHeVDS6DPUOFivsf4MwaB1fVStBMwyOruSW/D4BwL52Kv3c/N5eDH6G161fTu3XY/Zw62rOyrZK9CYLen4Cw" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>Minus 64 bytes thanks to @noodleman and another 11 bytes thanks to @Kevin Cruijssen!  I then saved another 22 bytes.  Most recent improvement of 6 bytes by @xnor and 13 bytes by me.</p>
<p>Instead of most other solutions (as far as I can tell), I tried calculating the index into the string.  I dug up a post on <a href="https://stackoverflow.com/a/18786566/11298075">StackOverflow</a> that helped with this, though a lot was just throwing random equations and seeing what they do.  Maybe the indexing equation can be simplified with a bit more thought, but it's surprisingly short already.</p>
<p>There are lots of places where <code>-x-1</code> is replaced with <code>+~x</code> (or variants).  Booleans are heavily used for indexing and cancelling parts of equations with multiplication.</p>
<p>Ungolfed:</p>
<pre class="lang-python prettyprint-override"><code>def function(string: str, number: int):
  for y in range(number):
    for x in range(number):
      rounds = min(x, y, number - x - 1, number - y - 1)
        # total increments after `rounds` revolutions and fix for overcounting
      index = 4 * rounds * (number - rounds) - 2 * rounds
      index += x + y  # east + south increment
      index += 2 * (2 * (number - rounds - 1) - x - y) * (y &gt; x)  # west + north

      # See below for explanation
      is_horizontal = max(number - y - 1, y) &gt; x &gt; min(y - 2, number - y - 2)
      is_right = x + 1 &gt; number / 2
      # Both inlined
      is_up_corner = x + 1 + is_right * (number - 2 * (x + 1)) == y
      is_down_corner = x + is_right * (number - 1 - 2 * x) == number - y - 1

      # is_middle = x + 1 - number % 2 == y == number // 2
      # is_middle = is_up_corner and is_down_corner
      # is_down = y &gt; number / 2
      # is_left_corner = y + is_down * (number - 2 * y) == x + 1
      # is_right_corner = y + is_down * (number - 1 - 2 * y) != number - x - 1

      print(
        # string[index] if index &lt; len(string) else
        string[index:] and string[index] or \
        # See below for explanation
        &quot;|-..''&gt;&lt;&quot;[is_horizontal + 2 * is_up_corner + 4 * is_down_corner],
        end=&quot; -&quot;[is_horizontal]
      )
    print()
</code></pre>
<p>Explanation of <code>is_horizontal</code> boolean:
There are effectively four quadrants in which we need to determine whether the coordinate is a horizontal part in the snake, we can do this for the upper right corner with <code>number - y - 1 &gt; x</code>.  On its own this is not enough, because the lower part of the snake is now messed up.  Taking <code>y &gt; x</code> works for the lower right quadrant, but messes up the snake above.  Combining these two equations into <code>max(number - y - 1, y) &gt; x</code> leaves only the left part of the snake to fix.  Creating conditions for the other corners you can combine <code>x &gt; min(y - 2, number - y - 2)</code> into one large expression.</p>
<pre><code>------------.                 ------------.                 ------------.
.---------. |                 .---------. |                 .---------. |
--.-----. | |                 --.-----. | |                 | .-----. | |
----.-&gt; | | |     becomes     ----.-&gt; | | |     becomes     | | .-&gt; | | |
----' | ' | |                 ----'---' | |                 | | '---' | |
--' | | | ' |                 --'-------' |                 | '-------' |
' | | | | | '                 '-----------'                 '-----------'
</code></pre>
<p>Explanation of special character indexing into <code>|-..''&gt;&lt;</code>:
There are six special characters that we need to index into, which can be separated into three categories: Straight, corner and tail.  By virtue of the equations, we can determine we need a tail if something is both an up- and down-corner.  Obviously, if it is not a corner or tail, it should be a straight piece.  Using the equation <code>is_up_corner + 2 * is_down_corner</code> we can differentiate the four cases straight, up-corner, down-corner, and tail.  To select the correct straight and tail pieces we still need a more granular distinction.  Using <code>is_horizontal</code> obviously works for straight pieces and additionally it works for the tail, because the left-pointing arrow has an appendage whereas the right-pointing does not.  This can be combined with the previous equation by doubling the corners.</p>
<h2>253 bytes solution</h2>
<p>This solution outputs not a string, but a nested array/matrix of characters.  This might be allowed according to the meta post: <a href="https://codegolf.meta.stackexchange.com/a/25275/58563">Strings and arrays of characters are interchangeable</a>.</p>
<p>It's effectively the same as the above, but also returns instead of prints.  It unfortunately requires <code>*''.join()</code> in the inner loop, because you cannot populate an array with two items per iteration.  (And by doubling the iterations I only managed to golf to 255.)</p>
<pre class="lang-py prettyprint-override"><code>lambda s,n:[[*''.join((r:=min(x,y,n+~x,n+~y),i:=4*r*(n-r)-2*r+x+y+2*(2*(n+~r)-x-y)*(y&gt;x),H:=max(n+~y,y)&gt;x&gt;min(y-2,n-y-2),b:=x+1&gt;n/2,s[i:]and s[i]or&quot;|-..''&gt;&lt;&quot;[H+2*((n+2*~x)*b-~x==y)+4*((n+~x-x)*b+x==n+~y)])[4]+&quot; -&quot;[H]for x in range(n))]for y in range(n)]
</code></pre>
<p><a href="https://tio.run/##ZZBBS8MwFMfv@xShOyQvTSZ2VWaxPXgQ8SZ464pkttPq@lLSDROQfvWZdnOKQnhJfvzyf@G1bvuqcb5ozX6dLvcb1axKRTqBSZ5zSmdvukbGTJI2frfCCQx7OxQHok7SmBvOUBqQETehDV0YceaXFzyz0gFnLrMg7nyCsgN3wkFmsyHPyUig9BXEKklteJ7hWSS6vE4KhSXxh0Kb4FPOZpRm10F@N6T7jIj3FvhK9jZNHYTxCHsrBxh6Nn6vgDwuwoBI/65Ya0MsqZEYhS8VQ4ARud@o2JfVmpT6ac24Mi8dJBOid9v0@zohralxy@gSj3NpVMuOMxLeBDg5MJlMydCh/ukwF@TKZ07JoUcQiNprf6RYkMXQeFRoh@q9UkbvsKSjfcCodbmpGoVUxPCfXZ7Ex9fqYVc/v98Y/YG32t7vmraj4uIktJtKdRVqKuaw/wI" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu10" class="pu"><h2>Javascript, <s>384</s> <s>371</s> <s>304</s> <s>288</s> <s>263</s> 235 bytes</h2>
<pre><code>s=(S,n)=&gt;(t=[...S],A=Array,a=A.from(A(n),r=&gt;A(2*n).fill(e=' ')),x=y=0,p=(b,d,f)=&gt;(a[y][x]=x&amp;1&amp;&amp;t.shift()||b[d],f?.(d)),i=2*n-1,m=d=&gt;(z=d&amp;2,d&amp;1?y+=1-z:x+=1-z,--i?p('-|-|',d,m):n&lt;2?p('&gt;&gt;&lt;&lt;',d):(i=d&amp;1?2*--n:n-1,p(&quot;..''&quot;,++d%4,m))),m(0),a)
</code></pre>
<p>-13 bytes saved thanks to Samathingamajig<br />
-67 bytes by folding functions <code>u()</code> and <code>d()</code> into <code>v(±1)</code> and <code>l()</code> and <code>r()</code> into <code>h(±1)</code><br />
-16 bytes with only one recursive function<br />
-25 bytes because of <a href="https://codegolf.meta.stackexchange.com/questions/2447/default-for-code-golf-input-output-methods/25275#25275">this</a><br />
-28 bytes with more golfing</p>
<h3>Try out</h3>
<p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>s=(S,n)=&gt;(t=[...S],A=Array,a=A.from(A(n),r=&gt;A(2*n).fill(e=' ')),x=y=0,p=(b,d,f)=&gt;(a[y][x]=x&amp;1&amp;&amp;t.shift()||b[d],f?.(d)),i=2*n-1,m=d=&gt;(z=d&amp;2,d&amp;1?y+=1-z:x+=1-z,--i?p('-|-|',d,m):n&lt;2?p('&gt;&gt;&lt;&lt;',d):(i=d&amp;1?2*--n:n-1,p("..''",++d%4,m))),m(0),a)

;[
  [ 'snake', 4 ],
  [ 'snakearound', 5 ],
  [ 'snakearoundandround', 6 ]
]
.forEach(([ S,n ]) =&gt; {
  console.log(s(S,n).map(r=&gt;r.join('')).join('\n'))
})</code></pre>
</div>
</div>
</p>
<h2>Ungolfed</h2>
<pre><code>s = (S,n) =&gt; {
  t = [...S];
  a = Array.from(Array(n), r =&gt; Array(2*n).fill(e=' '));
  x = y = 0;
  p = (b,d,f) =&gt; {            // set letter in all odd positions until
                              // exhausted, otherwise use snake
    a[y][x] = x&amp;1 &amp;&amp; t.shift() || b[d];
    f?.(d);                   // recurse unless end
  }
  i = 2*n-1;                  // counter for going in the same direction
  m = d =&gt; {
                              // the next position is set before p is called
    z = d&amp;2;                  // forward or back?
    if (d&amp;1) {                // vertical or horizontal?
      y+=1-z;
    } else {
      x+=1-z;
    }
    if (--i) {               // go on
      p('-|-|', d, m);
    } else if (n&lt;2) {        // stop
      p('&gt;&gt;&lt;&lt;', d);
    } else {                 // next direction
      i = d&amp;1 ? 2*--n : n-1; // set going length, decrement n if horizontal
      p(&quot;..''&quot;, ++d%4, m);
    }
  }
  m(0);
  return a;
}
</code></pre>
</div>
<div id="pu11" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a>, <strike>255</strike> 244 bytes</h1>

<pre class="lang-perl prettyprint-override"><code>sub r{$a='';$a.=$/while s/.$/$a.=$&amp;;''/emg;$_=$a}sub f{($s=pop.'-'x--($n=2*pop)**2)=~s/.\K/-/g;$k=local$_=($&quot;x$n.$/)x$n;r while s@ +$|&gt;(  )+@$_=substr$s,0,-1+length$&amp;,'';s/^-/$k&amp;2?&quot;'&quot;:'.'/e;$k++&amp;1&amp;&amp;y/-/|/;&quot;$_&gt;&quot;@me;$n&amp;2&amp;&amp;y/&gt;/&lt;/||r&amp;r;s/.\K.//g;r}
</code></pre>
<p><a href="https://tio.run/##LY5bS8NAEIXf/RVDGHZzHxvwguvWIuiDPojgo1hiTZvQdBN2U9vS1L8ep9WBYZjDfGdOW9j6Yhjc@hPsHnMtpcI81UibsqoLcJQinQShpKRitVA41ZgfjsB876PTbdOmMpHbJPHR6CzkPQjDLNA/DL8/U0LMLHXdzPKaWR@9LRp2DXgoC/9/JhBhP/YBgmjCV2zvOosuPo@TUVQXZtGVKGJO5@gjIVyK7M6T3o1MORTbR5EYCbHjZz0pD6djb7Ji3YjsqI7plvreCqtOkVLiSPYwtLYyHcwBpzHIt7J4XVez5b1tNuax2T6tV617@S7sA/euKyuzkGfAlZsv@CORYN5YuIzhKoZrNfwC" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>
<p>Here's with newlines for better readability:</p>
<pre class="lang-perl prettyprint-override"><code>sub r{$a='';$a.=$/while s/.$/$a.=$&amp;;''/emg;$_=$a}
sub f{
($s=pop.'-'x--($n=2*pop)**2)=~s/.\K/-/g;
$k=local$_=($&quot;x$n.$/)x$n;
r while s@ +$|&gt;(  )+@
$_=substr$s,0,-1+length$&amp;,'';
s/^-/$k&amp;2?&quot;'&quot;:'.'/e;
$k++&amp;1&amp;&amp;y/-/|/;
&quot;$_&gt;&quot;
@me;
$n&amp;2&amp;&amp;y/&gt;/&lt;/||r&amp;r;
s/.\K.//g;
r
}
</code></pre>
<p>I'm sure there are glaring opportunities to golf it further, but at least, for now, it's decently competitive with other answers, considering sigils. I was more interested to play with algorithm -- the square-ish string is actually rotated while being filled. Replace <code>r while...</code> with <code>print &amp;&amp; r while...</code> to see intermediate steps.</p>
<p>P.S. It's funny to watch how snake's head moves and serves as anchor where to place the next fragment.</p>
<p><strong>Edit:</strong> Just a little bit shorter. Rotation subroutine is also slightly less ugly and can now handle rectangular (not just square) shapes (but of course there ought to be Perl golfing pre-fab somewhere for the purpose, 20-odd years old, so I'm re-inventing the wheel), which fact was immediately used and lead to another couple bytes off.</p>
<p>In fact <code>local</code> can be ditched (-5) and TIO's footer written so that the <code>$_</code> doesn't hold read-only value while testing. And further couple bytes less if string is temporarily padded with arbitrarily large number of hyphens (<code>1E6</code>, say) instead of value computed from <code>n</code>. But I'm not that much desperate, yet :)</p>
</div>
<div id="pu12" class="pu"><h1>JavaScript (ES12), 188 bytes</h1>
<p>Expects <code>(string)(n)</code>. Returns a matrix of characters.</p>
<pre class="lang-javascript prettyprint-override"><code>s=&gt;n=&gt;eval(`for(m=[k=x=y=0];~n;)for(d=-2;i=~n&amp;&amp;d++&lt;2;n-=!n|d&amp;!!y)for(;i++&lt;(d&amp;1?w=n*2-1:n||2);x-=d%2,y-=~-d%2)(m[y]||=[...&quot;&quot;.padEnd(w)])[x]=d*x+1&amp;1&amp;&amp;s[k++]||&quot;|-..''&lt; &gt;&quot;[i&gt;2?d&amp;1:d-3*~!n];m`)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=TZBNTsMwEIX3PYUbicRuYoumtKC6TiUkWLBDYmcs1apTGpqMq4TSVIRehE2F4BZchFNwBdIfUFcz896nGb15-wBr4s37RHwunib04vurEBGIKH7WKR5NbI4zIWeiFCtxqvgaONlqRtCQJ2INrmt8fxByoKIJlXGbzdUO4EktY-O2h0sBrZC2-1BVIeElFeYkDFZUrGndEJzJlaoqIRljjsPm2lyBwUuiiCyVMK3Sb7tt1y3kzPdrzqkoY543QJEjkygc1gf6hnZa6yYono3IIcMPlw2EJHIK0LNY53YBxglq4SxA3QD1AnSOFFLBHgJrTRpnGv6Q3pF5N41vF8l4dpnbJVzb8maRzYsd2D2i5mmsixjszuhsjYZqsPoRV3o8xViiIkAaKYJEhPS_Dtvxpd4wtlDYNGapfcATXBAMhGV6jvMtkLNHmwD2PEIO3T14BPloV3njlRxibzb7-gs" rel="nofollow noreferrer">Attempt This Online!</a></p>
<h3>Alternate formula</h3>
<p>I've found the following alternate formula for special characters where each entry appears only once in the lookup string. But in the end, it's just as long as the simpler one.</p>

<pre class="lang-javascript prettyprint-override"><code>&quot;.&lt;'&gt;|-&quot;[i &gt; 2 ? d &amp; 1 | 4 : !n ^ d * 3 &amp; 2]
</code></pre>
<h3>Commented</h3>
<p>This is a version without <code>eval()</code> for readability.</p>
<pre class="lang-javascript prettyprint-override"><code>// s = input string, n = size parameter
s =&gt; n =&gt; {
  for(
    // m[] is the output matrix
    // k is a pointer into s
    // (x, y) is the current position in the matrix
    m = [k = x = y = 0];
    // stop when n = -1
    ~n;
  )
    for( 
      // d is the direction
      d = -2;
      // stop when n = -1 or d = 2
      // i is the counter for the next loop
      i = ~n &amp;&amp; d++ &lt; 2;
      // decrement n if n = 0, or d is odd and y != 0
      n -= !n | d &amp; !!y
    )
      for(
        ;
        // the width is 2n-1 if d is odd, or n if d is even
        // there's a special case for the last iteration
        i++ &lt; (d &amp; 1 ? w = n * 2 - 1 : n || 2);
        // (x, y) &lt;- (x + dx, y + dy)
        x -= d % 2,
        y -= ~-d % 2
      )
        // if m[y] is undefined, initialize it to w spaces
        (m[y] ||= [...&quot;&quot;.padEnd(w)])[x] =
          // if either d or x is even, attempt to get the next
          // character from s
          d * x + 1 &amp; 1 &amp;&amp; s[k++]
          // if falsy or undefined, use a special character:
          // - &quot;|&quot; or &quot;-&quot; for segments (i &gt; 2)
          // - &quot;.&quot; or &quot;'&quot; for corners (i = 2, n ≠ 0)
          // - &quot;&lt;&quot; or &quot;&gt;&quot; for the final character (i = 2, n = 0)
          || &quot;|-..''&lt; &gt;&quot;[i &gt; 2 ? d &amp; 1 : d - 3 * ~!n];
  return m
}
</code></pre>
</div>
<div id="pu13" class="pu"><h1><a href="https://codeberg.org/ngn/k" rel="nofollow noreferrer">K (ngn/k)</a>, <s>337</s> <s>331</s> <s>315</s> <s>290</s> <s>279</s> <s>231</s> <s>224</s> <s>211</s> 213 bytes</h1>
<pre><code>{(x,w)#@[(x*w)#&quot; &quot;;i,*|i;:;@[&quot;|-&quot;{1|1=x|-x}@-':i:0,+\(,/-:\1,w:-1+2*x)4!2_&amp;s;(-2_-2+\s;!#y);:;(&quot;.''.&quot;4!!-2+#s:,/+|1(2*1+)\|!x; y:,/((#l)#(&quot;-&quot;;&quot;&quot;)){x/y}',''l:(0,((#y)&gt;)#+\(0,(-1+#l)#-1 1)+l:1_|1+&amp;x#2)_y)],&quot;&lt;&gt;&quot;2!x]}
</code></pre>
<p><a href="https://ngn.codeberg.page/k#eJw9jVFrwjAUhd/9Fe0NmNwmUROqg2QT2cMe9jbYW1s6mZYVazssxRTT/75sA58u55yP+1Xmxpy4ItllzCXhQgS2FomvrbG7DLyEm/LqyXnppp2kpjYrwXMmltLkSlyNVFwnDtNYl/PeMqlLqXne25iMGF4wWFC6gDSOQ016I5bcK6YTxTH3sbPRGCrGSIOEgQQLgHhzy3GigtLGsJUI44hbJEEaQtD9slJFCnljVOkVnzuisRyxEPC4BR27YprNPlaGBhlLiQCwVWahb/en4/7SDe0BCppG62gTPaC9k/pOtl13aI7nffvHbf4ZFlYUVba28P51fBvqz9Pzpbu2L517Hc7fPRSzHycXU3s=" rel="nofollow noreferrer">Try it online!</a></p>
<p>-6  : Save a few bytes with shorter names.<br/>
-16 : Tidying up<br/>
-25 : Cruft<br/>
-46 : Golfing gets me back under limits<br/>
-7  : Cleaner<br/>
-13 : A single statement!<br/>
+2  : handle empty string</p>
</div>
<div id="pu14" class="pu"><h1>Python3, 425 bytes</h1>
<pre class="lang-py prettyprint-override"><code>R=range
def f(n,s):
 r=[[' ']*2*n for x in R(n)];x=y=X=K=0;Y=C=1
 while 1:
  K+=1
  if s:r[x][y]=['-',s[0]][C%2or X!=0];s=s[C%2or X!=0:];C+=1
  else:r[x][y]='-|'[X!=0]
  if(y+Y==2*n-1or(0&lt;=y+2*Y&lt;2*n-1and' '!=r[x][y+2*Y])or Y&lt;-y)and Y:
   if K==2:r[x][y]='&lt;&gt;'[Y&gt;0];return r
   if r[x][y]in'-|':r[x][y]=&quot;'.&quot;[Y&gt;0]
   X=Y;Y=0
  elif(x+X==n or' '!=r[x+X][y])and X:
   if r[x][y]in'-|':r[x][y]=&quot;'.&quot;[X&lt;0]
   Y=-X;X=C=K=0
  x+=X;y+=Y
</code></pre>
<p><a href="https://tio.run/##nZHNbuIwFEbXk6dwK42cEIICzE9FclkM0iyG1aAubFleRINTPKXXkQ1qIs27Uzu0DItKbVnm5jufj32bbrcxOL1p7OGwAlvhnYrWqiZ1jEOXzCJiQQhKqBxMBkhqY0lLNJJVjIksWuiAwRLygsMCxhF53OitImOPkWUaBkTXxM2saKXoJAia0aETuZRi8Xniu9gV5LJw4M6@Z7JYHFm1derE0uwfFX2@b427lAN4p2xsbJyX0KWTAS/7QYVrb3wFRzTMZeLLeZl1if9HePALZkvf8P@Ack4Fn3sfq3Z7i8Q@p54DGoPCKX5NR9d9PKQYcP8Eee/s3dqUASAx9kUjZYHpD2ezt2tZeazlkLGC@add9t1tCqzoUuCHsAcd9lDHX4bUYXWvKmv2/t5@ZZ8aq3EXUzr6azTGOkmi4ySJzrivF3LfLuS@X8j5@6Ex6616qPBDlhdQ/k1uN@r3Xv@5/2HNI/407a/9Q@Pe3zAd0marKqfQvA4dngA" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu15" class="pu"><h1><a href="https://github.com/isaacg1/pyth" rel="noreferrer">Pyth</a>, 78 bytes</h1>
<pre><code>ju&amp;K&gt;*hhHH+z&gt;s.i_Psm*Rd&quot;-|&quot;Qs@L_B&quot;.'&quot;tQlz.e++b?%klGd\-@K+Hk+j\-&lt;KH__MGStQ]@&quot;&lt;&gt;
</code></pre>
<p><a href="https://tio.run/##K6gsyfj/P6tUzdtOKyPDw0O7yq5YLzM@oDhXKyhFSbdGKbDYwSfeSUlPXakkMKdKL1VbO8leNTvHPSVG18Fb2yNbOytG18bbIz7e1z24JDDWQcnG7v9/U67ivMTs1MSi/NK8FAA" rel="noreferrer" title="Pyth – Try It Online">Try it online!</a></p>
</div>
<div id="pu16" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 61 bytes</h1>
<pre><code>Ｆ⮌Ｓ⊞υιＮηＦ⊖η«Ｆ⊖⁻ηι⎇υ⁺⊟υ-²↷²⎇υ⊟υ§.'ιＦ⁻⁻ηι²⎇υ⊟υ¹↷²⎇υ⊟υ§'.ι¹»§&lt;&gt;η
</code></pre>
<p><a href="https://tio.run/##nZDPisIwEMbP9ilCL05ABb14qAgLe/GgFHdfINuOJlgTmSZFWfbZs9NWVBAvXsL8@b7fN6TQigqnqhh3jgRssUGqEVb2FPyXJ2P3IKUUeag1hJEwMku63SYcf5BAc98ZP7EgPKL1WPJQit9k8DRfGxtq0C2lRTLcwzeSVXRp2XnF29ydIMiRSMcpvzPJ/EFuGue3Zq89zLr@yXk1ffiVLfEM6WSY9inZ9Yw@@uGAji1ekqZvBg8n9@BePeXyL@nrm2yxZBl/UxZjbdUBFblgy2Qex031Dw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>Ｆ⮌Ｓ⊞υι
</code></pre>
<p>Get the reverse of the input into a stack, so that characters can be processed by popping from it.</p>
<pre><code>Ｎη
</code></pre>
<p>Input <code>n</code>.</p>
<pre><code>Ｆ⊖η«
</code></pre>
<p>Repeat <code>n-1</code> times. The loop counter is taken as an ascending number for the purposes of calculating which corner character to print, but for the side lengths I show how the actual number of repetitions of the inner loops vary.</p>
<pre><code>Ｆ⊖⁻ηι
</code></pre>
<p>Repeat from <code>n-1</code> down to once...</p>
<pre><code>⎇υ⁺⊟υ-²
</code></pre>
<p>... output the next character followed by a <code>-</code>, or two <code>-</code>s if none.</p>
<pre><code>↷²
</code></pre>
<p>Start moving vertically.</p>
<pre><code>⎇υ⊟υ§.'ι
</code></pre>
<p>Output the next character or <code>.</code> or <code>'</code> appropriately if there are none left.</p>
<pre><code>Ｆ⁻⁻ηι²
</code></pre>
<p>Repeat from <code>n-2</code> down to zero...</p>
<pre><code>⎇υ⊟υ¹
</code></pre>
<p>... output the next character or <code>|</code> if there are none left.</p>
<pre><code>↷²
</code></pre>
<p>Start moving horizontally, but in the other direction.</p>
<pre><code>⎇υ⊟υ§'.ι¹
</code></pre>
<p>Output the next character or <code>'</code> or <code>.</code> appropriately if there are none left.</p>
<pre><code>»§&lt;&gt;η
</code></pre>
<p>Output the head of the snake.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/263650/">263650</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




