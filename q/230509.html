<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::230509</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>073</td><td>JavaScript Node.js</td><td>210626T001434Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230513#230513">emanresu</a></td></tr>
<tr d-ix="1"><td>4344</td><td>C++ gcc</td><td>210630T181104Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230797#230797">Nick Ken</a></td></tr>
<tr d-ix="2"><td>536</td><td>Python 3.8</td><td>210626T084548Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230534#230534">ovs</a></td></tr>
<tr d-ix="3"><td>941</td><td>Julia 1.6</td><td>210629T135728Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230706#230706">Glen O</a></td></tr>
<tr d-ix="4"><td>168</td><td>Jelly</td><td>210626T231732Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230575#230575">Nick Ken</a></td></tr>
<tr d-ix="5"><td>213</td><td>J</td><td>210626T115707Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230542#230542">xash</a></td></tr>
<tr d-ix="6"><td>051</td><td>Julia 1.0</td><td>210626T145842Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230554#230554">Kirill L</a></td></tr>
<tr d-ix="7"><td>093</td><td>R</td><td>210628T083843Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230622#230622">Dominic </a></td></tr>
<tr d-ix="8"><td>017</td><td>Husk</td><td>210628T002012Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230614#230614">Dominic </a></td></tr>
<tr d-ix="9"><td>017</td><td>Vyxal</td><td>210626T050824Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230522#230522">hyperneu</a></td></tr>
<tr d-ix="10"><td>012</td><td>Jelly</td><td>210626T000227Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230511#230511">hyperneu</a></td></tr>
<tr d-ix="11"><td>060</td><td>Ruby</td><td>210626T080052Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230532#230532">G B</a></td></tr>
<tr d-ix="12"><td>023</td><td>Vyxal</td><td>210626T035400Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230521#230521">wasif</a></td></tr>
<tr d-ix="13"><td>097</td><td>Python 3</td><td>210626T023047Z</td><td><a href="https://codegolf.stackexchange.com/questions/230509/find-the-erd%c5%91s-woods-origin/230518#230518">wasif</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, <s>101</s> <s>95</s> <s>90</s> 73 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>k=&gt;f=(a,i,g=(x,y=a+i)=&gt;y?g(y,x%y):x)=&gt;i&gt;k?a:g(a)*g(a+k)&gt;1?f(a,-~i):f(-~a)
</code></pre>
<p><a href="https://tio.run/##DcvBCoQgEIDhp1mYKQ267EEYfZah0maNjFpCL726efnhO/w/vvmaTjn@ek/zUleqkawnYCUqEGRViHtBssUFKCp/CprcKDY6NgEYu5Y@oh2db5d@BI0H/TDWKe1X2pZhSwFWGL8IiPUF" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>-5 thanks to Arnauld. I feel like the recursion here has a few bytes left to shave, but this is good enough for now.</p>
<h1>Explanation</h1>
<pre class="lang-javascript prettyprint-override"><code>k =&gt;                        // The function, taking a parameter k
f = (                       // Our inner recursive function
  a,                        // Taking a, the output value we're currently testing,
  i                         // and i, the index up to k that we're checking
                            // both initialised to undefined - as a=0 isn't a valid output, 
                            // and i=0 corresponds to checking gcd(a,a) ≠ 1,
                            // we can get away with this and use -~ to increment these into 1s,
                            // so long as we're careful to make sure the conditionals line up the right way
  g=(x,y=a+i)=&gt;y?g(y,x%y):x // and define g to be the standard JS gcd function, 
                            // with its second argument defaulting to a + i 
                            // (the value whose gcds we're currently testing)
) =&gt;           
  i &gt; k ?                   // If i has gone beyond k, i.e. we've checked every value in [a, a + k], then
    a :                     // return this value of a
    g(a) * g(a + k) &gt; 1 ?   // Otherwise, if one of gcd(a+i,a) and gcd(a+i,a+k) is not 1
                            // (literally: their product is &gt;1)
      f(a, -~i) :           // test the next value of i
      f(-~a)                // otherwise increment a and start over
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C++ (gcc)</a>, 4344 bytes</h1>

<pre class="lang-cpp prettyprint-override"><code>#include&lt;iostream&gt;
#include&lt;set&gt;
#include&lt;vector&gt;
#include&lt;array&gt;
#include&lt;chrono&gt;
#include&lt;map&gt;
#include&lt;boost/multiprecision/cpp_int.hpp&gt;
#include&lt;thread&gt;
#include&lt;future&gt;
using namespace boost::multiprecision;using namespace std;int S(set&lt;int&gt;&amp;x){return x.size()?*x.begin(): 0;}void M(vector&lt;array&lt;int1024_t,2&gt;&gt;*f,vector&lt;int&gt;*nr,vector&lt;array&lt;int1024_t,2&gt;&gt;*q,int x,int ct,int nt,promise&lt;int1024_t&gt;*pr){int1024_t m=0;for(size_t i=0;i&lt;f-&gt;size();i++){if(i%nt==ct){array&lt;int1024_t,2&gt;h={1,1};for(int j=0;j&lt;2;j++){int1024_t c=(*f)[i][j];int k=0;while(c&gt;0){if(c%2){h[j]*=(*nr)[k];}c&gt;&gt;=1;k++;}}for(auto j=q-&gt;begin();j!=q-&gt;end();j++){int1024_t g0,g1,f0,f1;int64_t f2,f3;g0=h[0]*(*j)[0];g1=h[1]*(*j)[1];vector&lt;int1024_t&gt;d;vector&lt;int64_t&gt;e;if(g0&gt;g1){swap(g0,g1);}f0=g0;f1=g1;while(f0&gt;1&amp;&amp;(f0&gt;=INT32_MAX/2||f1&gt;=INT32_MAX/2)){int1024_t n=f0;d.push_back(f1/f0);f0=f1%f0;f1=n;}if(f0&gt;1){f2=(int64_t)f0;f3=(int64_t)f1;while(f2&gt;1){int64_t n2=f2;e.push_back(f3/f2);f2=f3%f2;f3=n2;}}f2=0;f3=1;for(auto k=e.rbegin();k!=e.rend();k++){int64_t n2=f3;f3=*k*f3+f2;f2=n2;}f0=f2;f1=f3;for(auto k=d.rbegin();k!=d.rend();k++){int1024_t n=f1;f1=*k*f1+f0;f0=n;}int1024_t K=(x*f0+g0/2)/g0;int1024_t o=min(abs(f1*x-g1*K)*g0,abs(f0*x-g0*K)*g1);if(!m||o&lt;m){m=o;}}}}pr-&gt;set_value(m);}int main(){int nt=8;double tt=0;int x;while(cin&gt;&gt;x){auto start=chrono::system_clock::now();vector&lt;array&lt;set&lt;int&gt;,2&gt;&gt;v(x-1),nv;vector&lt;pair&lt;array&lt;int1024_t,2&gt;,int&gt;&gt;r,s;vector&lt;array&lt;int1024_t,2&gt;&gt;f;map&lt;int,int&gt;c;set&lt;int&gt;y;int1024_t t=1;int mp=0;for(int i=2;i&lt;x;i++){if(!v[i-1][0].size()){for(int j=1;j&lt;(x-1)/i+1;j++){v[i*j-1][0].insert(i);v[x-i*j-1][1].insert(i);}if(x%i==0){t*=i;}else if(!mp){mp=i;}}}if(v[0][1].size()==1){continue;}for(auto i=v.begin();i!=v.end();i++){bool e=0;if((*i)[0].size()){for(auto j=(*i)[0].begin();j!=(*i)[0].end();j++){if(t%*j==0){e=1;break;}}}if(e){continue;}if(S((*i)[0])!=mp){nv.push_back(*i);}for(int j=0;j&lt;2;j++){for(auto k=(*i)[j].begin();k!=(*i)[j].end();k++){auto ci=c.find(*k);if(ci==c.end()){c.insert(make_pair(*k,1));}else{ci-&gt;second++;}}}}v=nv;map&lt;int,int&gt;ns;vector&lt;int&gt;nr;vector&lt;array&lt;pair&lt;int1024_t,vector&lt;int1024_t&gt;&gt;,2&gt;&gt;bs;int cn=0;for(auto i=v.begin();i!=v.end();i++){if(((*i)[0].size()==1&amp;&amp;(*i)[0].size()==1&amp;&amp;c[*((*i)[0].begin())]&lt;3&amp;&amp;c[*((*i)[1].begin())]&lt;3)){int z=*((*i)[0].begin());if(z!=*((*i)[1].begin())){z*=*((*i)[1].begin());};if(!y.count(z)){y.insert(z);}}else{array&lt;pair&lt;int1024_t,vector&lt;int1024_t&gt;&gt;,2&gt;b;for(int j=0;j&lt;2;j++){b[j].first=0;for(auto k=(*i)[j].begin();k!=(*i)[j].end();k++){auto ni=ns.find(*k);int1024_t c;if(ni==ns.end()){ns.insert(make_pair(*k,cn));nr.push_back(*k);c=((int1024_t)1)&lt;&lt;cn;cn++;}else{c=((int1024_t)1)&lt;&lt;ni-&gt;second;}b[j].second.push_back(c);b[j].first|=c;}}bs.push_back(b);}}sort(bs.begin(),bs.end(),[](array&lt;pair&lt;int1024_t,vector&lt;int1024_t&gt;&gt;,2&gt;&amp;x,array&lt;pair&lt;int1024_t,vector&lt;int1024_t&gt;&gt;,2&gt;&amp;y){return min(x[0].first,x[1].first)&lt;min(y[0].first,y[1].first);});r.push_back(make_pair(array&lt;int1024_t,2&gt;{((int1024_t)1)&lt;&lt;ns[mp],0},0));bool D=false,D2=false;while(!D&amp;&amp;r.size()&gt;0){if(D&amp;&amp;!D2){D2=true;}s.clear();for(auto i=r.begin();i!=r.end();i++){for(;i-&gt;second&lt;bs.size();i-&gt;second++){bool e=0;if(!((i-&gt;first[0]&amp;bs[i-&gt;second][0].first)||(i-&gt;first[1]&amp;bs[i-&gt;second][1].first))){break;}}if(i-&gt;second==bs.size()){D=true;f.push_back(i-&gt;first);}else{for(int j=0;j&lt;2;j++){for(auto k=bs[i-&gt;second][j].second.begin();k!=bs[i-&gt;second][j].second.end();k++){if(!(i-&gt;first[0]&amp;*k||i-&gt;first[1]&amp;*k)){array&lt;int1024_t,2&gt;b{i-&gt;first[0],i-&gt;first[1]};b[j]|=*k;bool e=true;if(D2){for(auto l=f.begin();l!=f.end();l++){if((*l)[0]&amp;b[0]==(*l)[0]&amp;&amp;(*l)[0]&amp;b[1]==(*l)[0]){e=false;break;}}}if(e){s.push_back(make_pair(b,i-&gt;second+1));}}}}}}sort(s.begin(),s.end());s.erase(unique(s.begin(),s.end()),s.end());r=s;}if(!D){continue;}size_t w=y.size();vector&lt;array&lt;int1024_t,2&gt;&gt;q(((size_t)1)&lt;&lt;w);for(int j=0;j&lt;(int)(1&lt;&lt;w);j++){q[j]={1,1};auto l=y.begin();for(int k=0;k&lt;w;k++,l++){q[j][(j&amp;(1&lt;&lt;k))/(1&lt;&lt;k)]*=*l;}q[j][0]*=t;}vector&lt;thread&gt;ts(min(f.size(),(size_t)nt));vector&lt;promise&lt;int1024_t&gt;&gt;ps(ts.size());for(size_t i=0;i&lt;ts.size();i++){ts[i]=thread(&amp;M,&amp;f,&amp;nr,&amp;q,x,i,nt,&amp;ps[i]);}int1024_t m=0;for(size_t i=0;i&lt;ts.size();i++){ts[i].join();int1024_t o=ps[i].get_future().get();if(!m||o&lt;m){m=o;}}double rt=(double)((chrono::duration&lt;double&gt;)(std::chrono::system_clock::now()-start)).count();tt+=rt;cout&lt;&lt;x&lt;&lt;&quot;-&gt;&quot;&lt;&lt;m&lt;&lt;&quot; : &quot;&lt;&lt;rt&lt;&lt;&quot; secs;total &quot;&lt;&lt;tt&lt;&lt;&quot; secs&quot;&lt;&lt;endl;}}
</code></pre>
<p><a href="https://tio.run/##lVdbb@o6Fn7Pr4AzKorT0OYGm93gjEbqy@hozzyceRgJoSqEhIZLkiaGQiF/fTqfnZtbus@lErXXxZ/XzSt2kGXDVRC8v/8tToLtfhlO47RgeejvPKVlFSGTqEMYsDSXGH6e@yeJDp7zNEklxs7PJGqRYof73X7L4iwPg7iI0@Q@yLKnOGF3z5msyp5hyVJiRHu2z0NP2Rdxsuol/i4sMj8IewLz4eEjqPtZq2BLF5v0flPh0RQzb3Ak5zwEZtI73hXxW6iSv2vHu0W4ihOVPPQMtzyk8bL3Q628rnzlS03Dcp6YbnmeFum1kCNqSa7/ju6Lzg04iv8BE0PC9CxPd3ERdrqeluXk3JK9HTXcKM1VbiLIGGQ8jYZeZbIb395CO1Ljm4RRGjByvt77mZ5N3SwFDN92DYz11HLXYm27U0BVLSKzeD5bz0WwNtB7fY63oRp4htgluLHI@RlyDbpJTmabuVsGnkdNd3N765Yl38LfsxR7vAy9Opjuus@pMFny@cdNV4a@MvXI0COT7znmvMjSI9tdGfR5Zsw1VVsTjO7KBG3WtDl3u8jXgVtKLI7jhS5MXhneyiTn4tXPVLEZccvIoCtE1aQrs3YwMjxzMOAD/ee//mNbTz/@8d9763KJzA8MIpue0Mhwl3fZvnh@WvjBRo3M@8ggLtAj8yYSGyRuCRs4OjlHFlVr0wiX2hLZ2mFxzSYQiUUjyw3lLez7yMIWENg3kAEksXjcLSoQTbfNwIaGd3mTgU2fU1UGNnUG2i1svlLbaJF9yyEtAcm9sLgLXNxhLj9gLj9jdqEx@VoOat5yZw0RilbhV6oetci4XRkI6j2S0YlSugO8vygQT@04XJnar0RD5gTH4BxDcJBIhLa/u1zS6Y6cdzRFHMoyy3E2QvZ08Lf7UN0RsWtv53OTz9WhoxN3me4X27DHGBVb945NoceJ56EzCG8L5ueMVj3t4aE4FSzcPQXbNNg8PCTpK9z@cNybzsJP@0E9Dk2iJ4dGJfPjr9oCbwOel@uF@/POEbnoopwllAO32eckBY1RcXx6u6xuF5yIqYVecWx7RP8wi4fmHIepbnioybYlmGgJwuj7@NasTinUtXW9IE6KMGdqDJ9nx2HNN2U@L/TjTUwpWgXTaOyW4bYIeyJHGfKTcVbJtQ4A5GsrIyhFxQdpwuJkH7pdB4npoenGbtwHUVWacAZNf9sLee4iVdVi8tmlugU1IqkPNSy5GUUqu9HWwvAQcVjgy7OpTQ1l00D/1mxH@pR7lRykw6nxKHzZZKUDJNavO5s2/ZYlHSWhHMQ0uIticLWNKHYwwBFqsKuJ/c7fhE@8vqCmm4RUgT8HMT8IsH4pOnNZHijKUS6lpJA6ppfkH2tQVGxXiFftVtT5ohBlFyR12f1h5njCPmYM@UfnvWYFM039lEAyn9qSwPwgqHpz741eL@Oxe@vT62Xk/KZ9wXZL0VpOd0G6T5j6Br1TE@03SKsA//kwLb7@9C540qM4L5gcvb9UIklMk0Kqke5jzj2AlIvrgsHsq4oJEjic5HIdAwmXAbVFIyaZToPEDRJeSlV1XcmTtt7cUnhWERJuQNzO5QsNEMhFIckXPLRFCgPBrp3XF7X9@myu/vmID476X1A@tVdB/uk58tIRNupHXhViSqZcdOpEp07klsSV49eF97qbn6/CVsx22Vw3St1AHkRje6SRjxjrj1Y1qb9N/cfBIK9PSH0fA6f/iCsZNFnOW1RxF2xDP0eNSKcxl09jLp9GruS2eZsi1s21susdH7ttH/YPPeE3YjFYFLNWdd4Gh1wunZb5WauNG2qy6bX8BttoUNraAc8qxyIpvA1y0@j@qON@3L0rTOl4/UxFvtxw32XXtc3lIjuJU/PV5Xtxlhbp0oJSHIYL7khuHWDhKc@qJdm/pVFr6bYPorJp2zRTbUtEIvCP0oYadGyzY/PPW1VQnz5xxZfFu9C7KhCfFfEnzmd3PJvu4mKS@0Wo7pP4BReva41ONaeF@Jj2H@Wva/3AeaWnpgh/fiV6wUek0hdn6JV8arB8SlRTSEQ5vCDU9SuojuqpjWqzlD93NtNXnm592yyaqesBB0Jy76sRbx9t65ZCiOcJZXgoVobWb1ZWqLxXRLUbemMpTGp9un72eVmhsrbur598rDub3DaGip3Takd18EMfRPoA78/Bi44Xpo4P/CDjGkS@dH/5lPwK926dVu1CupQLuLsVbtbVS1wlnFC/uoTXl2vcndVqSlS1uUUv97nP8EKfVhKPqHiaPzz8ziV7KK7hhNQfY@Iydktz5oJk0@lxOv1l6P0yne4w6T30MMsZn6JwC5elzN9yHmt5IFCGSGD5/m6OFctSbEexx4ozVkZjZewo47HyzVC@4f9EmYyVyUT5binfHeX7WDENAz@MpoUfHyeKaYFnOYppYwSU6UDm8BHyEcYx@GPwgGV@xxw4luEolmnghzkwLGBYsMSy@Q801loOxhH4sMoChgUMawweLLMmoCd8BA3rLI75faLYsM824BFstIFvA98Gtg37bIvPoQM7bfhrOxgd7j3m2MOG3/Y30HDbnmCEyzZwHWA6sNcx@HyiOCbmwHWA6Vh8BA@YDux2gOXAZ2fE44kfAukA0/kGHux2Jhhht4M4OMB3YPMIsRwBb4Q4jGDrCJgjYI4QixHiOYKtI3vyvyDa@qviffjvyC/Y@zCrSv//" rel="nofollow noreferrer" title="C++ (gcc) – Try It Online">Try it online!</a></p>
<p>This C++ version is primarily written to maximise the speed of generating results. It is loosely based on the approach of my Jelly solution, but includes further optimisations. The version on TIO can produce the minimal <span class="math-container">\$a(n)\$</span> for all Erdős–Woods numbers &lt;= 538 within about 30 seconds in total, not including the compilation time.</p>
<p>It initially assumed that all Erdos-Woods numbers were even, but they're not - the smallest non-even one is 903 (<a href="https://oeis.org/A111042" rel="nofollow noreferrer">OEIS A111042</a>). The code posted should handle odd Erdos-Woods numbers too.</p>
<p>Below is a slightly expanded version that will also generate the Erdos-Woods numbers themselves from scratch (i.e. doesn't use a presupplied list). Here's some more results (from an older version for now):</p>
<p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-html lang-html prettyprint-override"><code>16 -&gt; 2184 : 0.0023778 secs; total 0.0023778 secs
22 -&gt; 3521210 : 0.0007892 secs; total 0.003167 secs
34 -&gt; 47563752566 : 0.0007036 secs; total 0.0038706 secs
36 -&gt; 12913165320 : 0.0008207 secs; total 0.0046913 secs
46 -&gt; 21653939146794 : 0.0011214 secs; total 0.0058127 secs
56 -&gt; 172481165966593120 : 0.0013218 secs; total 0.0071345 secs
64 -&gt; 808852298577787631376 : 0.0011176 secs; total 0.0082521 secs
66 -&gt; 91307018384081053554 : 0.0006865 secs; total 0.0089386 secs
70 -&gt; 1172783000213391981960 : 0.0009034 secs; total 0.009842 secs
76 -&gt; 26214699169906862478864 : 0.001472 secs; total 0.011314 secs
78 -&gt; 27070317575988954996883440 : 0.0016488 secs; total 0.0129628 secs
86 -&gt; 92274830076590427944007586984 : 0.0032485 secs; total 0.0162113 secs
88 -&gt; 3061406404565905778785058155412 : 0.0008836 secs; total 0.0170949 secs
92 -&gt; 549490357654372954691289040 : 0.001961 secs; total 0.0190559 secs
94 -&gt; 38646299993451631575358983576 : 0.0012295 secs; total 0.0202854 secs
96 -&gt; 50130345826827726114787486830 : 0.007897 secs; total 0.0281824 secs
100 -&gt; 35631233179526020414978681410 : 0.0255103 secs; total 0.0536927 secs
106 -&gt; 200414275126007376521127533663324 : 0.0011955 secs; total 0.0548882 secs
112 -&gt; 1022681262163316216977769066573892020 : 0.0016636 secs; total 0.0565518 secs
116 -&gt; 199354011780827861571272685278371171794 : 0.0068985 secs; total 0.0634503 secs
118 -&gt; 5084808394825008411597027854612265320 : 0.0140484 secs; total 0.0774987 secs
120 -&gt; 33088145229978950006171841905081799893430 : 0.0282395 secs; total 0.105738 secs
124 -&gt; 9132534211053896168120244510786592061314796 : 0.0119749 secs; total 0.117713 secs
130 -&gt; 1010223786859974709684811231603116447862010 : 0.0085169 secs; total 0.12623 secs
134 -&gt; 918536092326116746940802093225005168208856 : 0.0080068 secs; total 0.134237 secs
142 -&gt; 326415290503067481481262636553276300760538971418633970 : 0.0097704 secs; total 0.144007 secs
144 -&gt; 12519236270374172120152530393181563366703899726 : 0.0104701 secs; total 0.154477 secs
146 -&gt; 30102196727419035397352263664971701624550 : 0.001873 secs; total 0.15635 secs
154 -&gt; 250086121511153463601017992836053431027953173230156 : 0.0128302 secs; total 0.169181 secs
160 -&gt; 16823726350582448550419008635093980344211195490 : 0.0121503 secs; total 0.181331 secs
162 -&gt; 971838598937769539765770921839883750903640741790 : 0.0048932 secs; total 0.186224 secs
186 -&gt; 1794082996332254346315702546582790195234663527026144577149550 : 0.0059784 secs; total 0.192202 secs
190 -&gt; 100043328863825836942691086460363243931180087197722910850 : 0.0080825 secs; total 0.200285 secs
196 -&gt; 17018920629980040075969105511895180448985253900154238700 : 0.0085788 secs; total 0.208864 secs
204 -&gt; 481578279081960788203960306279407682980396228758026204933056959715840 : 0.0472954 secs; total 0.256159 secs
210 -&gt; 29225782603870300544827882241040291898185518589118372486421537923611871170 : 5.60295 secs; total 5.85911 secs
216 -&gt; 440200183843647241078327939248364204862519711650712622914040841410 : 0.0077262 secs; total 5.86683 secs
218 -&gt; 67518017451793349875086631136663331002689144202850547609381398525979202451060 : 0.0092965 secs; total 5.87613 secs
220 -&gt; 1459104994350090197385240721881419804872579186868731078959002070 : 0.0179516 secs; total 5.89408 secs
222 -&gt; 398425392772309365488991662748906112633693445300311983234641390568 : 0.0085589 secs; total 5.90264 secs
232 -&gt; 907378346149256277304071914319955007121813704909147483268086111540 : 0.0361636 secs; total 5.9388 secs
238 -&gt; 45894107313965996638570818463974089099761314947922544200331971462236682 : 0.0174366 secs; total 5.95624 secs
246 -&gt; 127209574731840814488699664382213489925455290327133090193663688070010069772464 : 0.14518 secs; total 6.10142 secs
248 -&gt; 87349027419299768189875606566564845285333219860920999198422625577318053831430260 : 0.0417115 secs; total 6.14313 secs
250 -&gt; 1274769952223858733770020211602403840979999894289407226855668118167657960120 : 0.0177074 secs; total 6.16084 secs
256 -&gt; 211337714604794757725712768305031523837613606852887423808080138155983960657486438548840080 : 0.0095592 secs; total 6.1704 secs
260 -&gt; 611379532364397862318258986724238889055579879595343134082300581949384481717350 : 0.0143897 secs; total 6.18479 secs
262 -&gt; 457385261010485284248495193082983704923527433029112880026848488309914263938871758209640697245248 : 0.0057613 secs; total 6.19055 secs
268 -&gt; 3837924875435446453632171348188362753950788432477364059540845274930576542794383781497646020913032 : 0.0041049 secs; total 6.19466 secs
276 -&gt; 690516469573823892560050501225021813072395907134207867385994632898243111919015752071367994 : 0.133966 secs; total 6.32862 secs
280 -&gt; 47182555594339904819679927877406287035566782878354969819901299764693418800067961552340 : 0.0912517 secs; total 6.41987 secs
286 -&gt; 120610684017694120228701154065517023464640987099534560151170016560718941441263176114 : 0.0114873 secs; total 6.43136 secs
288 -&gt; 138971473108541248222606578801479253148138919955516661540809691054255010511185699956086224052870 : 0.0775585 secs; total 6.50892 secs
292 -&gt; 185675662432708092090998266897578702332183677920758773231493308055529123987258619622978284717475820 : 0.012051 secs; total 6.52097 secs
296 -&gt; 528072426832989018489058277937146939019285808979376200830352699489792774867918795228285244 : 0.0120736 secs; total 6.53304 secs
298 -&gt; 7925959560314994619176238662647274773767908511981401648794904625493728870549039264807892534696970055800 : 0.0128203 secs; total 6.54586 secs
300 -&gt; 3830358397632282878932144419312617888493673029003334276706856317887318564286779642788172700903966820 : 2.7098 secs; total 9.25566 secs
302 -&gt; 40657328466375053173917761727511056770288784946750010931930738501228836738754637506437259099070010911712995558 : 0.0027574 secs; total 9.25842 secs
306 -&gt; 40577677425253871035899827941839786555247037625668392197716461967627850030740187779049330460230 : 0.413231 secs; total 9.67165 secs
310 -&gt; 538488606541428281546338121909778865003615807576612791533987823960965825028425066849096657000 : 0.0080856 secs; total 9.67973 secs
316 -&gt; 7872867140686218605593823674909333997835782911606331664298338788801081063003828117779226595689776787167680 : 0.0036166 secs; total 9.68335 secs
320 -&gt; 151976414541647699016758460810943108138612297987590453341893209833547476537041052081981397479713129600 : 0.0557666 secs; total 9.73912 secs
324 -&gt; 26361986955675918481699797183223411546429483863365717815976219805637972415698978214362140147547701812766 : 0.0969804 secs; total 9.8361 secs
326 -&gt; 3789841018118926364678300055227311891347014053695801630069508088470681947289010244266304599643061195254304 : 0.002667 secs; total 9.83877 secs
328 -&gt; 10928038824030068766469302266515597858847366735722411591364684152289531562139922070667848114860 : 0.0040279 secs; total 9.84279 secs
330 -&gt; 32164328124314699652501607056033487951959073966795652571372554775412926044029553406890067889637692284566807340 : 93.6157 secs; total 103.458 secs
336 -&gt; 3106020225275080429219264134875355687747745764370605877192451827687782320288332577944406977489148953164 : 0.246205 secs; total 103.705 secs
340 -&gt; 29825269805686870505819604699502725220723406983445751308008620959839573168190344914196554174050824118754330 : 0.0289699 secs; total 103.734 secs
342 -&gt; 240212844654937042612584799122424026485025869333251741199943878938676548397965251130234996068893280600 : 0.22941 secs; total 103.963 secs
346 -&gt; 543096578713377998688537214746167217275303559738471072780629061333582537465383342959631810586241474719593516160 : 0.0062745 secs; total 103.969 secs
356 -&gt; 16954869911528757517125591203874504442168457692764697546479952706970406480165191259262577720757385141714267796770657531340 : 0.002579 secs; total 103.972 secs
366 -&gt; 4389659730095193754318655326327264752833785100279687859257349610267590708369010442448055310835588452360330889210894 : 0.0927121 secs; total 104.065 secs
372 -&gt; 7377842100032579096970847665137405200105289987277245889432100309989104285888041825332110324561692968177624974176800 : 0.336335 secs; total 104.401 secs
378 -&gt; 973134143857711984548808752932685151707551919556522506881076061012440046791171659775408389749625215164909147269668871280 : 2.50325 secs; total 106.904 secs
382 -&gt; 672269870455295752749941691733331442902745781790421727886817450524410833032155123359740686629763506140323192428376385310 : 0.0025048 secs; total 106.907 secs
394 -&gt; 221289329584737900269172059924096886744337194160035374991996053169800056881835752028310810922527670054056514781556013120958243152651198947795931415976 : 0.0032405 secs; total 106.91 secs
396 -&gt; 1962986156270498590837428040271644141937106717996208244700227775952029989686778918949868920441390965913892352842577184164989322280 : 0.357485 secs; total 107.267 secs
400 -&gt; 7487622941447424114189400327301794212912996211997720849199184913543025205738725722282996789897024593595594873848452690 : 0.0106362 secs; total 107.278 secs
404 -&gt; 104988944031640566696876252223159702218634054291721114053942362103943547825159449331266825026341053836613626131254908908390059949340029727927290 : 0.0068556 secs; total 107.285 secs
406 -&gt; 3140483434894111885957811121301682079786715171339614782737909232797671719266043287171188825464389608552117061317022641877667150 : 0.0183488 secs; total 107.303 secs
408 -&gt; 211579081971284319753516661852997477765586890005276537318680476829494942508856533853247237516980759776245938593513888662281476762 : 0.484314 secs; total 107.788 secs
414 -&gt; 184227830045234549016502848638570064283232747405972675492625247428967117610127137967793024207389649680803110124047199844886032416070 : 1.70146 secs; total 109.489 secs
416 -&gt; 89716593469689252073694377593991599925396252252128033061971555378192612549403678662751600278716749636229262016871937541224901670587864 : 0.0045737 secs; total 109.494 secs
424 -&gt; 190621313082002759082457531048983736857933425199317500309526460260480903992578039696090385642014886318893763859405914277246805656256382726421852130 : 0.0129013 secs; total 109.507 secs
426 -&gt; 93728800773978265556429683027376173974950491906681697895736778157191134689503042887570278926594182170446133332560163856227637704274 : 0.160621 secs; total 109.667 secs
428 -&gt; 2931848991408268124639635840008496586773506309953806810487482744551349578602533515984624684883631658704332317293256288264488948110946767780308172 : 0.0070358 secs; total 109.674 secs
430 -&gt; 27478709895719298365755297812017619883221248788103553267387547041210617817326144730386583943696714770371394850963566107511565760 : 0.183163 secs; total 109.857 secs
438 -&gt; 10912133713738946485738976131261562575408798493640821012109929982555297357336779342832390534219583446609310610201415309129133752660304392 : 0.447402 secs; total 110.305 secs
446 -&gt; 1140646211956922665110130943268802509462711871461936692317977656567336777075905111559102852981167574234825226618883638636541407433356327827292857571679143420 : 0.0030787 secs; total 110.308 secs
454 -&gt; 32778488604746971516107026989471786134873496259639072415065379151165026246089617762655468453355618291470712565631400415148976402188426870828927155076332524667888122690930 : 0.0045086 secs; total 110.312 secs
456 -&gt; 151096680791287555145708840203295091586008659656829222140415372024546189048930084841422098326639382479146980605530110525787281920838306339978674 : 30.045 secs; total 140.357 secs
466 -&gt; 1567036107936517776618947389958745525432586256910736346537512869766866036596967674195302350096711059648145953613686739267169651942922997304140534784421838930674 : 0.0076627 secs; total 140.365 secs
470 -&gt; 442636529132068806081734237157206434836968006423546114466573521440524351421895912515760783653974315127885405849361383716546069303602606144594769938590 : 0.039894 secs; total 140.405 secs
472 -&gt; 10184617044462151138890133863697369948628720643109450174383206953743306700307307177810890693876133203419020147232151560327552759086619074348 : 0.0036374 secs; total 140.409 secs
474 -&gt; 1617367866042184847828111911826113198686256982420665156527057977530672664118556420609597651648637558677521232503264167513016194613324137370193144481380920 : 2.84999 secs; total 143.259 secs
476 -&gt; 236014456526751889817622944694390965881058524509721339611383876800307554765688174182401020296857582255254583552096165354006185460487674653777209920 : 0.0580355 secs; total 143.317 secs
484 -&gt; 141976867395758552861787541457927126724538937293609458854032925303046910754958179365387268701118922730055897358394006290803374658100681262033519449099698126678176542426356 : 0.0118532 secs; total 143.328 secs
486 -&gt; 356334501749931789484943782741090710258398678714033932161852193144903024991207070454724045209936833184480106332413355129475649065855116232678542708710 : 0.331206 secs; total 143.66 secs
490 -&gt; 61142856427699216317652651451852676228906233471655696309019956924256750472168114478752815319180103091541437573463446889733710647242210167431263330 : 0.500067 secs; total 144.16 secs
494 -&gt; 13360851385477005746836609396303165290377765108365352964375482734646350283757930339054998760291263161974941451315337859589050340422814787615218791854992672068532376 : 0.0281845 secs; total 144.188 secs
498 -&gt; 37136456756237928456333082900289626867300753740238089774205977596971973140622723718171174705485552866608478552058362711323479010006038966108413071907792830 : 1.73238 secs; total 145.92 secs
512 -&gt; 3056747870887228098274237048029194850161865139074924724362956728582114272246014987352232242442837952089404728413292444253101127040775837013188315154874080676006495913028031281141819149290683720 : 0.0070583 secs; total 145.927 secs
516 -&gt; 1131555242873749534137274770219505280389897328648902629475343634265231956226997190950103242905773228961039181493470861979226757872075973587099786609188514377605334 : 7.83639 secs; total 153.764 secs
518 -&gt; 477900440773544256479262259016273308559590588598496935263961967987794124526804855066381826565156468459813846151185097284888144391947088957185250310387800 : 0.0518673 secs; total 153.816 secs
520 -&gt; 53295397262268776453849317832027361287530404818968588036673281812052585944521470485678375302855137955202286016365201707282088250452598123166205568775120 : 0.531242 secs; total 154.347 secs
526 -&gt; 19424119374445642412403413515452767870220141285947188050541538624609193256956205716630247444614560168795810201142653834560712410450343710094164276418543086083594 : 0.005264 secs; total 154.352 secs
528 -&gt; 30694089378160770896860118764822753631340537417762572149219922646503153282141487639750918973387074051444909686447639044669850144084746728440401948616591058733242 : 4.03965 secs; total 158.392 secs
532 -&gt; 13459822155848911563783687954011789407239432497812485476640425254665924231709912955546596483553340050690865588404870256974711800204194799241717025037756572273760675620938682735309504734045828 : 0.0423439 secs; total 158.434 secs
534 -&gt; 117525677123012146851504206773256702574127049792880307128940336050833225345490730514792535209749918559665667573312048870436744825997262807901807331654750578881556 : 2.11484 secs; total 160.549 secs
536 -&gt; 37953035901675033874082777749737339776908186726114170955384846260192326022205601462847134971612903086043582609431025333685948238062884527557649582702731422543516117121509592615405126096626578954525664 : 0.0192415 secs; total 160.568 secs
538 -&gt; 16196651398204425343126936097310356120271733322915212745417863402087632834855106079328035191739382581211211313371102200810776477533999356496876819775145135505886294417405826796677815167202187231226380 : 0.042992 secs; total 160.611 secs
540 -&gt; 7457024203430025045000252745986378288257798055712938914631895114617942193302064491548616645193114952485328586549524995017851549385933748399627674884768699761301176072240176523890 : 2386.21 secs; total 2546.82 secs
546 -&gt; 906090109321101729491726881541053979178972487361799219712590335175522483559909203865941393722108527136430394867372834736293604286304634557871670431017044124429073624820 : 420.93 secs; total 2967.75 secs
550 -&gt; 197490094160544395396549305368226880292622861915466587917449780781018793491009064512769135161880021395235171684350281153672504648514849424450310672780491899440 : 0.067318 secs; total 2967.82 secs
552 -&gt; 38282359610231628282831498788938209861245275810769012526965243452818895402093285406329236081174607890226405739681916179312332654073751190321978668248231301342117758090838 : 5.12497 secs; total 2972.94 secs
554 -&gt; 23771229990533688222255135237644396999826197982957529226466440286239303888103093086197321252728038657983679097634246530566372011748924965172231144135340117582179405787427960559356 : 0.0090439 secs; total 2972.95 secs
556 -&gt; 4857603802034637317375127547951669382523516071838990950169026514282756467102928060519727335056584226078970170169997806868256439476020543753338168433279838045467101152377717213736949622910183068526164222761690 : 0.0185084 secs; total 2972.97 secs
560 -&gt; 272208909506156925953839876645187050133348076516401932496369349850650627386265629609139875758757383483902068443401226921109116925430747778344298173444558100717973475040 : 4.8772 secs; total 2977.85 secs
574 -&gt; 1275435375517115512897300542185833966066491035597727224272604123011644504993482909778354167419041389947805448830560987552251025577696795933590399032890985110764978616637169064008224056 : 0.247191 secs; total 2978.1 secs
576 -&gt; 298179859257470177908263364628436856057468391489349634019593712133109176917547027197861721857175410707099262876487528771785466600654551807115456199471239220370627625375591985253094 : 5.12889 secs; total 2983.22 secs
580 -&gt; 21873582157258215963234358946291447731672986994580045624239305366301962394860230998609841412492534091851025222512678649387067473981514527023124860468541170665880381031035147283606967668817905144610277505238789780220 : 0.102718 secs; total 2983.33 secs
582 -&gt; 4016161829994147748845913407152041076046399031071578083952592814719712711657040785664701106746617570126732355008201518684816875880016705765815939547243584178063162124164510986182282668 : 30.3593 secs; total 3013.69 secs
584 -&gt; 45236247400020666480545468726212341723354946922526038432436575755942047488070730224099526255539687116442535538297431957422886242989193405914582974720765434432095661188486323999254703593523324436166436 : 0.0333996 secs; total 3013.72 secs
590 -&gt; 6889383848839915217298949398094374036081630617210157374425520209355276133085552242919621853522810182287592498800627273029020556556839621250456907629276436543675881587810593393893172922948383090 : 0.220044 secs; total 3013.94 secs
604 -&gt; 184620358713498811801944896187295122445956608695311712336954912905293602586260534536882742021739645300399687912768638069331331947240622029962453788103384878521654162484119512065511477948572693795158016 : 0.0051752 secs; total 3013.94 secs
606 -&gt; 89109072215348433817469024454151710803903802285944117425044464435650940985590337051487256308784368328494208624852157573845648189779542064325949845825271360650274235846701393496355129321994 : 162.689 secs; total 3176.63 secs
612 -&gt; 1321055404144574513003582655172280650647793869743403412906828920247108131151252250102075322103991976505400372137998390669329045466134906760071523081549148156083653841941857156040536507968 : 38.5042 secs; total 3215.14 secs
616 -&gt; 9666621445450430777433009930239370627075507536582044785966540594215112757983327047885354306763860678983983146559225232690773501091711583869809931872697919620408682024744046390333114740 : 0.56366 secs; total 3215.7 secs
624 -&gt; 5787931117691527449382170368040556978905353865643472593867302507531631417320117806460428790429845594369595233599226031846058723763606389486025690470528950041577838749110533253673486411705923136 : 111.509 secs; total 3327.21 secs</code></pre>
</div>
</div>
</p>
<pre class="lang-cpp prettyprint-override"><code>#include&lt;iostream&gt;
#include&lt;set&gt;
#include&lt;vector&gt;
#include&lt;array&gt;
#include&lt;chrono&gt;
#include&lt;map&gt;
#include&lt;boost/multiprecision/cpp_int.hpp&gt;
#include&lt;thread&gt;
#include&lt;future&gt;
using namespace boost::multiprecision;
using namespace std;
int S(set&lt;int&gt; &amp;x) {
    return x.size() ? *x.begin() : 0;
}

void M(vector&lt;array&lt;int1024_t, 2&gt;&gt; * f, vector&lt;int&gt; * nr, vector&lt;array&lt;int1024_t, 2&gt;&gt; * q, int x, int ct, int nt, promise&lt;int1024_t&gt; * pr) {
    int1024_t m = 0;
    for (size_t i = 0; i &lt; f-&gt;size(); i++) {
        if (i % nt == ct) {
            array&lt;int1024_t, 2&gt; h = { 1,1 };
            for (int j = 0; j &lt; 2; j++) {
                int1024_t c = (*f)[i][j];
                // cout &lt;&lt; &quot;c: &quot; &lt;&lt; c &lt;&lt; endl;
                int k = 0;
                while(c &gt; 0) {
                    if (c % 2) {
                        h[j] *= (*nr)[k];
                    }
                    //cout &lt;&lt; k &lt;&lt; &quot; &quot; &lt;&lt; c &lt;&lt; &quot; &quot; &lt;&lt; (*nr)[k] &lt;&lt; &quot; &quot; &lt;&lt; c % 2 &lt;&lt; &quot; &quot; &lt;&lt; h[j] &lt;&lt; endl;
                    c &gt;&gt;= 1;
                    k++;
                }
                //cout &lt;&lt; &quot;h: &quot; &lt;&lt; h[j] &lt;&lt; endl;
                // cout&lt;&lt; &quot;-&quot;;
            }
            // cout&lt;&lt;endl;
            for (auto j = q-&gt;begin(); j != q-&gt;end(); j++) {
                int1024_t g0, g1, f0, f1;
                int64_t f2, f3;
                g0 = h[0] * (*j)[0]; g1 = h[1] * (*j)[1];
                //cout &lt;&lt; g0 &lt;&lt; &quot; &quot; &lt;&lt; g1 &lt;&lt; &quot; &quot; &lt;&lt; h[0] &lt;&lt; &quot; &quot; &lt;&lt; h[1] &lt;&lt; &quot; &quot; &lt;&lt; (*j)[0] &lt;&lt; &quot; &quot; &lt;&lt; (*j)[1] &lt;&lt; endl;
                vector&lt;int1024_t&gt;d;
                vector&lt;int64_t&gt;e;
                if (g0 &gt; g1) { swap(g0, g1); }
                f0 = g0; f1 = g1;
                while (f0 &gt; 1 &amp;&amp; (f0 &gt;= INT32_MAX / 2 || f1 &gt;= INT32_MAX / 2)) {
                    int1024_t n = f0;
                    d.push_back(f1 / f0);
                    f0 = f1 % f0;
                    f1 = n;
                }
                if (f0 &gt; 1) {
                    f2 = (int64_t)f0;
                    f3 = (int64_t)f1;
                    while (f2 &gt; 1) {
                        int64_t n2 = f2;
                        e.push_back(f3 / f2);
                        f2 = f3 % f2;
                        f3 = n2;
                    }
                }
                f2 = 0; f3 = 1;
                for (auto k = e.rbegin(); k != e.rend(); k++) {
                    int64_t n2 = f3;
                    f3 = *k * f3 + f2;
                    f2 = n2;
                }
                f0 = f2; f1 = f3;
                for (auto k = d.rbegin(); k != d.rend(); k++) {
                    //cout&lt;&lt;f[0]&lt;&lt;&quot; &quot;&lt;&lt;f[1]&lt;&lt;&quot; &quot;&lt;&lt;(*j)&lt;&lt;endl;
                    int1024_t n = f1;
                    f1 = *k * f1 + f0;
                    f0 = n;
                }
                int1024_t K = (x * f0 + g0 / 2) / g0;
                int1024_t o = min(abs(f1 * x - g1 * K) * g0, abs(f0 * x - g0 * K) * g1);
                //cout &lt;&lt; x &lt;&lt; &quot; &quot; &lt;&lt; f0 &lt;&lt; &quot; &quot; &lt;&lt; f1 &lt;&lt; &quot; &quot; &lt;&lt; g0 &lt;&lt; &quot; &quot; &lt;&lt; g1 &lt;&lt; &quot; &quot; &lt;&lt; K &lt;&lt; &quot; &quot; &lt;&lt; o &lt;&lt; endl;
                //cout&lt;&lt;o&lt;&lt;&quot; m &quot;&lt;&lt;m&lt;&lt;endl;
                if (!m || o &lt; m) { m = o; }
            }
        }
        //cout&lt;&lt;endl;
    }
    pr-&gt;set_value(m);
}

int main()
{
    int nt = 8;
    double tt = 0;
    for (int x = 36; x &lt; 1000; x++) {
        auto start = chrono::system_clock::now();
        vector&lt;array&lt;set&lt;int&gt;, 2&gt;&gt;v(x - 1), nv;
        vector&lt;pair&lt;array&lt;int1024_t, 2&gt;, int&gt;&gt;r, s;
        vector&lt;array&lt;int1024_t, 2&gt;&gt;f;
        map&lt;int, int&gt;c;

        set&lt;int&gt;y;
        int1024_t t = 1;
        int mp = 0;
        
        for (int i = 2; i &lt; x; i ++) {
            if (!v[i - 1][0].size()) {
                for (int j = 1; j &lt; (x - 1) / i + 1; j++) {
                    v[i * j - 1][0].insert(i);
                    v[x - i * j - 1][1].insert(i);
                }
                if (x % i == 0) {
                    t *= i;
                }
                else if (!mp) {
                    mp = i;
                }
            }
        }
        if (v[0][1].size() == 1) {
            continue;
        }

        for (auto i = v.begin(); i != v.end(); i++) {
            bool e = 0;
            if ((*i)[0].size()) {
                for (auto j = (*i)[0].begin(); j != (*i)[0].end(); j++) {
                    if (t % *j == 0) {
                        e = 1;
                        break;
                    }
                }
            }
            if (e) { continue; }
            if (S((*i)[0]) != mp) {
                nv.push_back(*i);
            }
            for (int j = 0; j &lt; 2; j++) {
                for (auto k = (*i)[j].begin(); k != (*i)[j].end(); k++) {
                    auto ci = c.find(*k);
                    if (ci == c.end()) {
                        c.insert(make_pair(*k, 1));
                    }
                    else {
                        ci-&gt;second++;
                    }
                    //cout &lt;&lt; *k &lt;&lt; &quot; &quot;;
                }
                //cout &lt;&lt; &quot;-&quot;;
            }
                //cout &lt;&lt; endl;
        }
        v = nv;

        map&lt;int, int&gt;ns;
        vector&lt;int&gt;nr;
        vector&lt;array&lt;pair&lt;int1024_t,vector&lt;int1024_t&gt;&gt;,2&gt;&gt;bs;
        int cn = 0;
        for (auto i = v.begin(); i != v.end(); i++) {
            if (((*i)[0].size() == 1 &amp;&amp; (*i)[0].size() == 1 &amp;&amp; c[*((*i)[0].begin())] &lt; 3 &amp;&amp; c[*((*i)[1].begin())] &lt; 3)) {
                int z = *((*i)[0].begin());
                if (z != *((*i)[1].begin())) { z *= *((*i)[1].begin()); };
                if (!y.count(z)) {
                    y.insert(z);
                    //cout&lt;&lt;z&lt;&lt;endl;
                }
            }
            else {
                array&lt;pair&lt;int1024_t,vector&lt;int1024_t&gt;&gt;,2&gt;b;
                for (int j = 0; j &lt; 2; j++) {
                    b[j].first = 0;
                    for (auto k = (*i)[j].begin(); k != (*i)[j].end(); k++) {
                        auto ni = ns.find(*k);
                        int1024_t c;
                        if (ni == ns.end()) {
                            ns.insert(make_pair(*k, cn));
                            nr.push_back(*k);
                            c = ((int1024_t)1) &lt;&lt; cn;
                            cn++;
                        }
                        else {
                            c = ((int1024_t)1) &lt;&lt; ni-&gt;second;
                        }
                        b[j].second.push_back(c);
                        b[j].first |= c;
                    }
                }
                bs.push_back(b);
            }
        }

        sort(bs.begin(), bs.end(), [](array&lt;pair&lt;int1024_t, vector&lt;int1024_t&gt;&gt;, 2&gt;&amp;x, array&lt;pair&lt;int1024_t, vector&lt;int1024_t&gt;&gt;, 2&gt;&amp;y) {
            return min(x[0].first, x[1].first) &lt; min(y[0].first, y[1].first);
        });
        //cout &lt;&lt; &quot;bs size: &quot; &lt;&lt; bs.size() &lt;&lt; endl;

        //for (auto i = bs.begin(); i != bs.end(); i++) {
        //    for (auto j = 0; j &lt; 2; j++) {
        //        int k = 0;
        //        int1024_t c = (*i)[j].first;
        //        while (c &gt; 0) {
        //            if (c % 2) {
        //                cout &lt;&lt; nr[k] &lt;&lt; &quot; &quot;;
        //            }
        //            c &gt;&gt;= 1;
        //            k++;
        //        }
        //        cout &lt;&lt; &quot;-&quot;;
        //    }
        //    cout &lt;&lt; endl;
        //}
        //cout &lt;&lt; endl;

        //for (auto i = v.begin(); i != v.end(); i++) {
        //    for (auto j = 0; j &lt; 2; j++) {
        //        for (auto k = (*i)[j].begin(); k != (*i)[j].end(); k++) {
        //            cout &lt;&lt; *k &lt;&lt; &quot; &quot;;
        //        }
        //        cout &lt;&lt; &quot; - &quot;;
        //    }
        //    cout &lt;&lt; endl;
        //}
        r.push_back(make_pair(array&lt;int1024_t, 2&gt;{((int1024_t)1) &lt;&lt; ns[mp], 0}, 0));
        // cout &lt;&lt; &quot;v size: &quot; &lt;&lt; v.size();
        //int ii = 0;
        bool D = false, D2 = false;
        while (!D &amp;&amp; r.size() &gt; 0 &amp;&amp; r.size() &lt; 40000000) { // memory issues above this
            //cout &lt;&lt; &quot;ii: &quot; &lt;&lt; ii &lt;&lt; endl;
            //for (auto j = 0; j &lt; 2; j++) {
            //    for (auto k = (*i)[j].begin(); k != (*i)[j].end(); k++) {
            //        cout &lt;&lt; *k &lt;&lt; &quot; &quot;;
            //    }
            //    cout &lt;&lt; &quot; - &quot;;
            //}
            //cout &lt;&lt; endl;
            if (D &amp;&amp; !D2) {
                D2 = true;
            }
            s.clear();
            for (auto i = r.begin(); i != r.end(); i++) {
            //    for (auto j = 0; j &lt; 2; j++) {
            //        int k = 0;
            //        int1024_t c = (*i).first[j];
            //        while (c &gt; 0) {
            //            if (c % 2) {
            //                cout &lt;&lt; nr[k] &lt;&lt; &quot; &quot;;
            //            }
            //            c &gt;&gt;= 1;
            //            k++;
            //        }
            //        cout &lt;&lt; &quot;-&quot;;
            //    }
            //    cout &lt;&lt; endl;
                for (; i-&gt;second &lt; bs.size(); i-&gt;second++) {
                    bool e = 0;
                    // Check bitmap for left or right set of primes
                    if (!((i-&gt;first[0] &amp; bs[i-&gt;second][0].first) || (i-&gt;first[1] &amp; bs[i-&gt;second][1].first))) {
                        break;
                    }
                }
                if (i-&gt;second == bs.size()) {
                    // Reached the end for this path
                    D = true;
                    f.push_back(i-&gt;first);
                } else if (!D) {
                    for (int j = 0; j &lt; 2; j++) {
                        for (auto k = bs[i-&gt;second][j].second.begin(); k != bs[i-&gt;second][j].second.end(); k++) {
                            //cout&lt;&lt;k&lt;&lt;&quot; &quot;&lt;&lt;*l&lt;&lt;endl;
                            if (!(i-&gt;first[0] &amp; *k || i-&gt;first[1] &amp; *k)) {
                                array&lt;int1024_t, 2&gt;b{ i-&gt;first[0], i-&gt;first[1] };
                                b[j] |= *k;
                                bool e = true;
                                if (D2) {
                                    for (auto l = f.begin(); l != f.end(); l++) {
                                        if ((*l)[0] &amp; b[0] == (*l)[0] &amp;&amp; (*l)[0] &amp; b[1] == (*l)[0]) {
                                            e = false;
                                            break;
                                        }
                                    }
                                }
                                if (e) {
                                    s.push_back(make_pair(b, i-&gt;second + 1));
                                }
                            }
                        }
                    }
                }
                //cout &lt;&lt; endl;
            }

            //cout&lt;&lt;&quot;s size: &quot;&lt;&lt;s.size()&lt;&lt;endl;

            if (!D) {
                sort(s.begin(), s.end());
                s.erase(unique(s.begin(), s.end()), s.end());
                r = s;
                //cout &lt;&lt; x &lt;&lt; &quot;: &quot; &lt;&lt; &quot;r size: &quot; &lt;&lt; r.size() &lt;&lt; endl;
            }
            //map&lt;size_t, int&gt;rs;
            //for (auto j = r.begin(); j != r.end(); j++) {
            //    size_t js = j-&gt;first[0].size() + j-&gt;first[1].size();
            //    auto k = rs.find(js);
            //    if (k == rs.end()) {
            //        rs.insert(make_pair(js, 1));
            //    }
            //    else {
            //        k-&gt;second++;
            //    }
            //}
            //for (auto k = rs.begin(); k != rs.end(); k++) {
            //    cout &lt;&lt; k-&gt;first &lt;&lt; &quot;: &quot; &lt;&lt; k-&gt;second &lt;&lt; endl;
            //}
        }
        if (!D &amp;&amp; r.size() &lt;= 40000000) {
            continue;
        }

        //size_t ms = 0;
        //for (auto i = r.begin(); i != r.end(); i++) {
        //    size_t cs = i-&gt;first[0].size() + i-&gt;first[1].size();
        //    if (cs &lt; ms || !ms) { ms = cs; }
        //}
        size_t w = y.size();

        cout &lt;&lt; x &lt;&lt; &quot; -&gt; &quot; &lt;&lt; f.size() &lt;&lt; &quot; &quot; &lt;&lt; w &lt;&lt; &quot; &quot; &lt;&lt; (f.size() * ((size_t)1 &lt;&lt; w)) &lt;&lt; endl;

        if (D &amp;&amp; w &lt;= 25 &amp;&amp; (f.size() * ((size_t)1 &lt;&lt; w)) &lt; (1 &lt;&lt; 30)) {
            vector&lt;array&lt;int1024_t, 2&gt;&gt;q(((size_t)1) &lt;&lt; w);


            //for (auto j = t.begin(); j != t.end(); j++) {
            //    cout &lt;&lt; &quot;t:&quot; &lt;&lt; *j &lt;&lt; endl;
            //}

            for (int j = 0; j &lt; (int)(1 &lt;&lt; w); j++) {
                q[j] = { 1,1 };
                auto l = y.begin();
                for (int k = 0; k &lt; w; k++, l++) {
                    q[j][(j &amp; (1 &lt;&lt; k)) / (1 &lt;&lt; k)] *= *l;
                }
                q[j][0] *= t;
                //cout &lt;&lt; j &lt;&lt; &quot;: &quot; &lt;&lt; q[j][0] &lt;&lt; &quot; &quot; &lt;&lt; q[j][1] &lt;&lt; endl;
            }

            vector&lt;thread&gt; ts(min(f.size(), (size_t)nt));
            vector&lt;promise&lt;int1024_t&gt;&gt; ps(ts.size());
            for (size_t i = 0; i &lt; ts.size(); i++) {
                ts[i] = thread(&amp;M, &amp;f, &amp;nr, &amp;q, x, i, nt, &amp;ps[i]);
            }

            int1024_t m = 0;
            for (size_t i = 0; i &lt; ts.size(); i++) {
                ts[i].join();
                int1024_t o = ps[i].get_future().get();
                if (!m || o &lt; m) {
                    m = o;
                }
            }

            double rt = (double)((chrono::duration&lt;double&gt;)(std::chrono::system_clock::now() - start)).count();
            tt += rt;
            cout &lt;&lt; x &lt;&lt; &quot; -&gt; &quot; &lt;&lt; m &lt;&lt; &quot; : &quot; &lt;&lt; rt &lt;&lt; &quot; secs; total &quot; &lt;&lt; tt &lt;&lt; &quot; secs&quot; &lt;&lt; endl;
        }
        else if (D) {
            double rt = (double)((chrono::duration&lt;double&gt;)(std::chrono::system_clock::now() - start)).count();
            tt += rt;
            cout &lt;&lt; x &lt;&lt; &quot; skipping because too many to check : &quot; &lt;&lt; rt &lt;&lt; &quot; secs; total &quot; &lt;&lt; tt &lt;&lt; &quot; secs&quot; &lt;&lt; endl;
        }
        else {
            double rt = (double)((chrono::duration&lt;double&gt;)(std::chrono::system_clock::now() - start)).count();
            tt += rt;
            cout &lt;&lt; x &lt;&lt; &quot; skipping because search got too broad : &quot; &lt;&lt; rt &lt;&lt; &quot; secs; total &quot; &lt;&lt; tt &lt;&lt; &quot; secs&quot; &lt;&lt; endl;
        }
    }
}
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8</a>, <sup><s>263</s> <s>407</s> <s>544</s></sup> 536 bytes</h1>
<p>A port of <a href="https://codegolf.stackexchange.com/a/230542/64121">xash's J answer</a>, if this ends up getting the most terms, the bounty should definitely go to them. Uses functionality added to <code>pow</code> in 3.8 to compute modular inverses. Using the bits of integers to store sets of primes resulted in a quite large improvement, this gets to 204 on TIO.</p>


<pre class="lang-python prettyprint-override"><code>n=int(input())
Q=[]
P=k=r=1
while k&lt;n:Q+=P%k*[k];P*=k*k;k+=1
D=[int(''.join(str(+(a%p&lt;1))for p in Q)[::-1],2)for a in range(n)]
R=[(0,0,-1)]
for i in sorted(range(1,n),key=lambda x:-((P:=D[x]|D[n-x])&amp;-P)):
 N=[];F=D[i];O=D[n-i]
 for p in R:
  A,B,c=p
  if F&amp;A or O&amp;B:N+=p,;continue
  d=F&amp;c;w=1
  while d:
   if d%2:N+=(A^w,B,c^w),
   d&gt;&gt;=1;w*=2
  d=O&amp;c;w=1
  while d:
   if d%2:N+=(A,B^w,c^w),
   d&gt;&gt;=1;w&lt;&lt;=1
 R=N
for v,w,_ in R:
 x=y=1
 for p in Q:
  if v%2:x*=p
  if w%2:y*=p
  v&gt;&gt;=1;w&gt;&gt;=1
 r=min([n*pow(x,-1,y)%y*x-n,r][:r])
print(r)
</code></pre>
<p><a href="https://tio.run/##hVHPa8IwFL73r8hFTdp0WAdjpD5BEY9avYY4OltnVk1DrLaF/e8usbjBLruEvPf94L3v6bY6lOr5VZvbTYFUFZZKXypMiLcGLrwECjAQefVBHnNUjBVbB5D0Cp8XIk58KPwiLgJLmAN36sHg6bOUCp8rgwOc9vQ4ImRfGqSRVGhNOGNhJOjo3ktdz6TqI8eKCG8DHA/pkIaRLRwuHX4uTZVnuKNFVBFa5C0c09N7lqKGhRgnDOa8EV9zrsJGkH6YEMI8tLTzxwsLSRGvwIFSeOhnlo2loCmd0R1o@5N7tOhPkUVX/RlbBqBpvCtVJdUlt3AGi/4uru2iCHVZZE7vZFlv5Ph4uq2d27Ym1CHZZAJRXPswustX/8rpzBr8lY/HTrOB5T2QK63p22P4BlqH/YbLujWu1rDxH0vVtmq76tpZutdDBk72TFz5uqxxYzOnLem1fhMqagRnRhBPG3dRQ2636GX0DQ" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>A bit more readable:</p>

<pre class="lang-python prettyprint-override"><code>def f(n):
    primes = []
    P = k = 1
    while k&lt;n:
        if P%k: primes.append(k)
        P *= k*k
        k += 1
    divs = [
        int(''.join(str(+(a%p==0))for p in primes)[::-1], 2)
        for a in range(n)
    ]
    np = len(primes)
    partitions = [(0, 0, 2**np-1)]
    for i in sorted(
        range(1,n),
        key=lambda x:bin(divs[x]|divs[n-x])[::-1].index('1'),
        reverse=True
    ):
        new_partitions = []
        factors = divs[i]
        other_factors = divs[n-i]
        for p in partitions:
            set_a, set_b, r_primes = p
            if factors &amp; set_a or other_factors &amp; set_b:
                new_partitions += p,
                continue
            for i, v in enumerate(bin(factors &amp; r_primes)[2:][::-1]):
                if v=='1':
                    w = 1 &lt;&lt; i
                    new_partitions += (set_a^w, set_b, r_primes^w),
            for i, v in enumerate(bin(other_factors &amp; r_primes)[2:][::-1]):
                if v=='1':
                    w = 1 &lt;&lt; i
                    new_partitions += (set_a, set_b^w, r_primes^w),
        partitions = new_partitions
    result = float('inf')
    for px, py, _ in partitions:
        x = y = 1
        for p in primes:
            if px % 2:
                x *= p
            if py % 2:
                y *= p
            px //= 2
            py //= 2
        result = min(result, n*pow(x,-1,y)%y*x-n)
    return result
</code></pre>
<p><a href="https://tio.run/##xVVNc6JAEL37K@biCqZNYGZCkIr7G3LYm2UsjOPKqgOFqFDZ/Hb3DRgI4lbtbamMPdMfr/s1zSQpsnWshZ@k5/NSrdjK0nbQY3iSNNqpPZuw6aw8v2C7wXLL02kdbRXbPOvK2TzRir30N8El8D5MEqWX1sauHV7YEBDDTa3YsLtPvGV0LHM1aDqzBoP7X3GkrX2WWndW2E8mE8e2V3HKEtgviexpEIzcGTHeZDIuoXFJQ/1TgVJpqXjoBHm2SluX8IpsmGZRFsW6LMJyiOGPD4c6Gbl2FWcwI4O5j9NMLa06WZXDJW1Tw0wVk224WyxDlgcLUDD8pvnsdyn1KJ9dyr6P9FLl1sAdfIlO1VGlezX5kR5UqbSbLmt1mrernTW0w7csTo2yTBM1ljhbq3R@ZdejLx5NV2vwJql59iqbh1SKBbF0Xs9H0nLDFHym@VbFMCC381eGRRv/BjlMR0Idp7dYZ5G@dOZr@RGxo2Gg9GGn0jBTlul8k/SzZnvKg1nVfrtbAwgcJxO8kK6pHHzzCbDnZxbdNHcZWGUTXk@d1r2ebPpHDtft@59MLjwMoZtMWsPZBulVw70/bDPYVts4xDce6dXArr@wJCeWFMTmfxvFHJFFfQ21J7csJrgexyRnfca7PcjNddQZ3qS47V10vQH88DBhvK0srpQ13x1eZHUgpodJfLJyGrlU2P1imI8ud1SqskOqL0FnddKGqkeck5AkPJIePXrkSfI8enLoCb8@@R75Po05jSWNPXIdBwvS5VhG@uRy6LgkV0ACypWwSSNhf4T0oPegA5Y7xh443JHEXQcLe2BwYHBUwoVZOCOWS8hH6FEVBwYHBvegQ2Xcx9k3EmdUxw3m2CeB@oQDRqhRAF8AXwBboD7BzR4@qFOAr5CQ0rDHHjkEeIsnnEFb@JCgLIArgSlRr3TM3ifpYg9cCUzJjYROOL1efY2jt@YtY2jwn2Y1eI8C8cFG39n7yorsjwFhPg/7dXkH2@c/" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>After letting this run <em>a bit</em> longer than 60 seconds locally, here are some more results:</p>
<p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-html lang-html prettyprint-override"><code> 16 -&gt; 2184
 22 -&gt; 3521210
 34 -&gt; 47563752566
 36 -&gt; 12913165320
 46 -&gt; 21653939146794
 56 -&gt; 172481165966593120
 64 -&gt; 808852298577787631376
 66 -&gt; 91307018384081053554
 70 -&gt; 1172783000213391981960
 76 -&gt; 26214699169906862478864
 78 -&gt; 27070317575988954996883440
 86 -&gt; 92274830076590427944007586984
 88 -&gt; 3061406404565905778785058155412
 92 -&gt; 549490357654372954691289040
 94 -&gt; 38646299993451631575358983576
 96 -&gt; 50130345826827726114787486830
100 -&gt; 35631233179526020414978681410
106 -&gt; 200414275126007376521127533663324
112 -&gt; 1022681262163316216977769066573892020
116 -&gt; 199354011780827861571272685278371171794
118 -&gt; 5084808394825008411597027854612265320
120 -&gt; 33088145229978950006171841905081799893430
124 -&gt; 9132534211053896168120244510786592061314796
130 -&gt; 1010223786859974709684811231603116447862010
134 -&gt; 918536092326116746940802093225005168208856
142 -&gt; 326415290503067481481262636553276300760538971418633970
144 -&gt; 12519236270374172120152530393181563366703899726
146 -&gt; 30102196727419035397352263664971701624550
154 -&gt; 250086121511153463601017992836053431027953173230156
160 -&gt; 16823726350582448550419008635093980344211195490
162 -&gt; 971838598937769539765770921839883750903640741790
186 -&gt; 1794082996332254346315702546582790195234663527026144577149550
190 -&gt; 100043328863825836942691086460363243931180087197722910850
196 -&gt; 17018920629980040075969105511895180448985253900154238700
204 -&gt; 481578279081960788203960306279407682980396228758026204933056959715840
210 -&gt; 29225782603870300544827882241040291898185518589118372486421537923611871170
216 -&gt; 440200183843647241078327939248364204862519711650712622914040841410
218 -&gt; 67518017451793349875086631136663331002689144202850547609381398525979202451060
220 -&gt; 1459104994350090197385240721881419804872579186868731078959002070
222 -&gt; 398425392772309365488991662748906112633693445300311983234641390568
232 -&gt; 907378346149256277304071914319955007121813704909147483268086111540
238 -&gt; 45894107313965996638570818463974089099761314947922544200331971462236682
246 -&gt; 127209574731840814488699664382213489925455290327133090193663688070010069772464
248 -&gt; 87349027419299768189875606566564845285333219860920999198422625577318053831430260
250 -&gt; 1274769952223858733770020211602403840979999894289407226855668118167657960120
256 -&gt; 211337714604794757725712768305031523837613606852887423808080138155983960657486438548840080
260 -&gt; 611379532364397862318258986724238889055579879595343134082300581949384481717350
262 -&gt; 457385261010485284248495193082983704923527433029112880026848488309914263938871758209640697245248
268 -&gt; 3837924875435446453632171348188362753950788432477364059540845274930576542794383781497646020913032
276 -&gt; 690516469573823892560050501225021813072395907134207867385994632898243111919015752071367994
280 -&gt; 47182555594339904819679927877406287035566782878354969819901299764693418800067961552340
286 -&gt; 120610684017694120228701154065517023464640987099534560151170016560718941441263176114
288 -&gt; 138971473108541248222606578801479253148138919955516661540809691054255010511185699956086224052870
292 -&gt; 185675662432708092090998266897578702332183677920758773231493308055529123987258619622978284717475820
296 -&gt; 528072426832989018489058277937146939019285808979376200830352699489792774867918795228285244
298 -&gt; 7925959560314994619176238662647274773767908511981401648794904625493728870549039264807892534696970055800
300 -&gt; 3830358397632282878932144419312617888493673029003334276706856317887318564286779642788172700903966820
302 -&gt; 40657328466375053173917761727511056770288784946750010931930738501228836738754637506437259099070010911712995558</code></pre>
</div>
</div>
</p>
</div>
<div id="pu3" class="pu"><h1>Julia 1.6, 941 bytes</h1>
<p><strong>As it turns out, the numbers provided in the question aren't the &quot;optimal&quot; ones. The code provided below makes no attempt to be golfed (although I may make a pass at golfing it down soon), but rather seeks to find the smallest possible <span class="math-container">\$a\$</span> for any given <span class="math-container">\$k\$</span>, as efficiently as possible.</strong></p>

<p>The code here begins with the approach noted by <a href="https://codegolf.stackexchange.com/a/230542/21439">Xash</a> (obviously, converted to Julia), but makes some tweaks to improve the optimisation.</p>
<pre class="lang-julia prettyprint-override"><code>using Primes
function g(k)
  p=primes(k)
  Q=p[gcd.(p,k).&gt;1]
  q=big(prod(Q))
  p=setdiff(p,Q)
  p2=big.(p)
  l=falses(k-1)
  L=copy(l)
  for i=Q
    l[i:i:end].=true
  end
  r=p.&gt;0
  ~p=prod(p)
  n=(q*~p2)^2
  while any(r)
    L.=l
    for i=1:length(p)
      if r[i]
        L[p[i]:p[i]:end].=true
      else
        L[k%p[i]:p[i]:end].=true
      end
    end
    if all(L)
      L1=copy(l)
      for i=1:length(p)
        if r[i]
          L1[p[i]:p[i]:end].=true
        end
      end
      L2=copy(L1)
      pn=p[.!r];
      r2=pn.&gt;0
      while any(r2)
        L2.=L1
        for i=1:length(pn)
          if r2[i]
            L2[k%pn[i]:pn[i]:end].=true
          end
        end
        if all(L2)
          P0=q*~p2[r]
          P1=~big.(pn[r2])
          m=(k*invmod(-P0,P1)%P1)*P0
          if m&lt;n
            n=m
          end
        end
        r2.chunks.-=1
      end
    end
    r.chunks.-=1
  end
  n==(q*~p2)^2 ? Inf : n
end
</code></pre>
<p><a href="https://tio.run/##jVRNj9owEL3vr3BXWslBJopNyAdd03OlHMI5SiUKCbgJxmug7V7463TGWZak1aJGGs@85/HMs2P5x6lVS/77cqlPenVUe002tPEeCDGyEIxMGJkyEjPCORggjnHKiIBYgJ8APwEuBB8CF0I8xVUwFwEXAY7Bx8DFwCXgE/Ap1gmwaIBVAwdT7INQIJy4li7CiRCHKXJT5CLMw@o8drJwNsHZ1A3IuR5pWrrdmML4zw3GC4g3q7VPDWs8f86Re5Hf1YYau1/Thddt/1Ad16quIWvhCIEpsAhBK@tle6gOtBlzxJlc7c0rbTGu95YouYAI8go1U7NKr0tfHu2pAhIAjFYafx5AcAZl2NWV1ZK@jM5GeN8EoF9b1VZkqV@p9Vy1zJetC7oWfNZWenPcdmvxUzWxhSrfECwoDMCZGwYi8KtgA73M5ulerhN989Bo2bY0uzbOeO8A7in8VyMuvifz1rQfZaJrmPFrZaPht/qfbPn5jbBCGt0dMn690xQ3NZnwZcbf4d@ytdfTicrFUDoWwJPTTr/@YAN94cP4eo6i3ycPpLsFhe23yrk8dxdQF1aU/QU7SZuR0j93cI/GecBy7j2BjfJgqH73rAfatdz9h0Yr/NX2pJuDP5b8g/tghykdreXtOpMv5KuuyYzoB5i84Dk3suARPCL4yoRgEIdgU7AIcAQ@DsAiFicsiViSsFSwNGRpxHgQlMRYpY@tpg17JOM5eWT4cnlY/g8" rel="nofollow noreferrer" title="Julia 1.0 – Try It Online">Try it online!</a> - note that, because the Primes package cannot be loaded on TIO, I have hardcoded the primes up to 200; this does not provide any substantive speed boost, as most of the time is spent in the loops.</p>
<p>Here are the smallest <span class="math-container">\$a\$</span> values for given <span class="math-container">\$k\$</span> values...</p>
<pre class="lang-julia prettyprint-override"><code>16 -&gt; 2184
22 -&gt; 3521210
34 -&gt; 47563752566
36 -&gt; 12913165320
46 -&gt; 21653939146794
56 -&gt; 172481165966593120
64 -&gt; 808852298577787631376
66 -&gt; 91307018384081053554
70 -&gt; 1172783000213391981960
76 -&gt; 26214699169906862478864
78 -&gt; 27070317575988954996883440
86 -&gt; 92274830076590427944007586984
88 -&gt; 3061406404565905778785058155412
92 -&gt; 549490357654372954691289040
94 -&gt; 38646299993451631575358983576
96 -&gt; 50130345826827726114787486830
100 -&gt; 35631233179526020414978681410
</code></pre>
<p>TIO was able to complete this set in 57 seconds - The time required grows rapidly (indeed, exponentially) with <span class="math-container">\$k\$</span>, though, so the next Erdos-Woods number, 106, takes more than 60 seconds on TIO on its own.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 168 bytes</h1>
<pre><code>ṫ-;Ṛ×+ƭ/⁸;
%@’Ð¿/:ƝṖṚçƒØ.ṫ-××%P{
’ÆfQ$€m2Ṛż$©f/ÐḟFḢWḟ&quot;Ṛ¥€FḊ$ÐḟZ;FQɗ&quot;ʋ@ƬƲṪF®ḟ€ƑƇẈ⁼Ø1ƊƇƲF€fƇFQɗⱮ`ÐLQƲ,@$ŒPżṚ$F€€;&quot;€ʋ@/;&quot;Ɱ®f&quot;Ẹ¥ÐḟFQɗḟF}ɗŒPżṚ$Ʋ$€Ẏf&quot;ⱮẸ€ẠɗƇ®P€ḤżUƊ$€ẎNÞç¥€⁸FṂ
</code></pre>
<p><a href="https://tio.run/##PVBPi9NAFL/3U4SSPe3sJpmZTlMD0lNOIu1BRE9ejLCsF28iQncRI12Qugezin8WsRR1LWxPaS0uZOxA/RaTLxLfbxShffn9m/fmzcH9w8PHzaNg3/44eaB/mnE9elPN7Oq8sctve4ldvtXFrvke1Edl0trpk6sn1VVwzby3y9dwZ@ZUn@0jrAtd7AyetJB5ng39@vjiIafIZu1XX7JAT2z5MbXlp9v0bZNeTSlBwth31t0kHW6L9u@TvrkwC7v8mlZzkiljXpncrl7UR2t9Fpmxyc0iJTkzOU7Ul/N7enJjaBas729OB5s19fYRoF/SpkItAwKX82qete2qrKZ/70KH8Xm6Lf4fMwtc265eZshT1rHzbWHyaj4AKT9v1rfM@F/spv6gZ24ReqDULo@bROcJ241@XW2Lauof1KN33t51rx7Rez1r6ZySd5omUoxzJiQTiknFOoopyZRi3ZB1qcYsViyOWY8zryfpr5gXhSEKUMRRHIqpcBicYpEAEkASEekQch0gBVfBiKH1QNGZh@TyKEQBRVOOppzu6HHhCjS04hKoA7cDiqYcTbmC0YUWQ4sdgoYtuBvUIyqwhwg5CmkCcwXmCowU2ENwRxHGRkKASiCsJXANgeFCoXShdRGOgfBeAtMkBknsJkNHKSIjUEyTGCS5QzBE@Ac" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p>A full program taking an integer argument and returning an integer. Works on TIO to solve a for all values of n between 16 and 118 inclusive within 60 seconds. Individually it manages every n up to 130 within 60 seconds.</p>
<p>I’ll post a full explanation later, but crudely it works like this:</p>
<ol>
<li>Partition primes &lt;n such that all <span class="math-container">\$i\$</span> or <span class="math-container">\$n-i\$</span> for <span class="math-container">\$i\$</span> from <span class="math-container">\$1\$</span> to <span class="math-container">\$n-1\$</span> have gcd &gt; 1 for one of the two partitions. This is done initially y working out which primes must go together and then trying all combinations of the rest.</li>
<li>Solve the Diophantine equation of the form <span class="math-container">\$Ax - By = c\$</span> to work out the final end points.</li>
<li>Find the minimal such solution.</li>
</ol>
<p><a href="https://tio.run/##dVTdcqJKEL7nKebs1m4xZtyFGYLEqjlPce4oL1BGxSggghs8Oc@e01@DMbF2U5W2//vrnm7qvt1WpUnq5u1t3VQHUbSuaatqfxLFoa6aVtRNlXer1mPrIWu3Hw2DdlXV/VWbO1dD9nK3Fmv/Rc49Udv05FpfrqtGFKIoRZOVG@e/TEO58MSdViuOEcValFUr9q7067SYhgvWsvfu5h0qTvPzZ/EQDg6CvCc78v@R5blfSE@0Nr1w3AVxl6KmhPM5eahajmV8zaY0WADR8VNAe4UC8/dLGi7IpbHpv6V7aX3Myz@SBbHyP8WNkkNuQ0/82hZ7J3Lgym1ANLMp2Th3j9xHhnyyaU/h04aI6qkAcVyFp4AJnJDd2lBkZT4qQiiCoWW4v1o4sci1hXD7z9HBfXR4jQ44OryLPrl59kDQWH20mSfONBg4Ywi3AR2vKC/3KC9jHcpQoX@ehw/LWf5lK36w8jYSznZmUG4A8T6ocoBKhfrvl4EX/au9DJzj4dLfsnHZ8zg3Ny8J/YXRV3YoCv5sS09suer76o1L7k/SNFA0@sngPgK87rTfyBGpv1PPEoGu7A6uyVpHm8awyvSZhnlOd6jbWV6HMYgrtfMRHrauwEaVRGClWRGPPe9eLZteoZNTOEzL4Xk6uy9Ord/Jj1v0W/QdoReotbzhL@V1qL9poB/vZ0kd8O101IS8e4zitrXXJlCMG1ni@clnUIRQEPwx65/eiHVbeqgUXfjLtFjIia@n/s7aQt5/MrRc3H0ANI5t9fk1t/z9@HGi7xEPv7cFXyAv2nCT/zSdGxctL84Hqoy7UzhDbrm3qcMNPvQenwRJAUn5FTfZcD/XXjaWJ/9xj/nqxQYrONmk9LV5IKr5qjfQvdxcYZiz5WB5CvhqiRWFbqjqBLP8dlAb@plg0N8O@AC5tmtKcShKfyXf3lt352zvF2XdUecynZtgge9vU5S0bOrL9O8vak3Z1XrfnbYWQ5De18G89p@0lG9pGCutlYmUiVUUq8dYxZGKYzUL1IxoopJYJYl60ko8RfQfKxEGAQi4UIMwlxDRMGhyCw04Ay6CS8Qc/B7BxbDGMCTQPUFEZh2QVYcBCEQk1UiqCaPQhgl0SKUjcI@wPkJEUo2kOoZhBl0CXcIcdOhCc6EnEg36MIEGIZ1BXYO6BiUN@jCaRTijI2MgRuDQlgEMg@ImBplBN4NzAg7zMqgWoVCE3qKARXKJQoioFqFQpJmDgR7xfw" rel="nofollow noreferrer">Here’s a minimally golfed Python 3.8 version of this solution</a> that gets from 16 to 144 within 60 seconds.</p>
<p>Thanks to @ovs for pointing out a bug that meant the minimum <span class="math-container">\$a(n)\$</span> was not always obtained.</p>
<p>Following @xash’s insightful observation, now doesn’t assume that the prime partition will always include every prime. For example, the value for <span class="math-container">\$a(46)\$</span> in the question and the linked OEIS sequence is wrong.</p>
<p>I’ve now got a <a href="https://tio.run/##LVBNa9tAEL37VwijnryJpJ31So6gJBcfQ1Poob301BRCoNBbDwUnhxqsi8mhSkvThBZj@pFAc5LS0oC2WbD/xeqPqPO2BevxZt7sezM@eHZ4@Kp7GW26n8Vz89vO2sm7ZuluLjpXf9vIXf3elAN7GbVHVd67t82qmTe30ZY9c/VbqEt7Yk43d838BR6Ysj2qB0/tZb/9cbWz1U5OXT25O3loZ6wcf18Xj143i6Y25bpgxx7s3uzvhSyxV/Pl7le4H5m5q87byQf/O2uuxBhydR656nPyrymEndnrvM@CvWapj9cLrsaumoXe4Ek@3luV/XWxbdn7q1f/e/MMludnML6pPF6EGJ266lOzWBf@zQMWds1Hs1zxVdV4x9XHXW6muRgkf25XZbMID3idYON@wCv1zJTHH3ddooWUgpQgLZQWQy20ElqLNBYpYyYyLbJMjKQIRoo/LYIkjgFgiQR4ljFICJLHEgIjMIUR5RnmhmAaqoaQoTdCCWcZsyqTGIASphKmkncMJHlAD1ZSgQ2hDlHCVMJUaggpehl6mWfo4Qrpg0ZcEu6gWAK4R8gl5BIiCXeQ9CWGcRERSgWGswhrEMJJA1L0UgxnYPi/CGkKQQq3qdiXPKISlEhTCFLSMwgU/wU" rel="nofollow noreferrer">faster, slightly shorter version</a> which doesn’t guarantee a minimum value of <span class="math-container">\$a(n)\$</span> but generates values of <span class="math-container">\$a(n)\$</span> for all <span class="math-container">\$n\$</span> between 16 and 430 in about 50 seconds on TIO. This represents all of the values of <span class="math-container">\$n\$</span> listed in <a href="https://oeis.org/A059756" rel="nofollow noreferrer">A059756</a> at the time of writing.</p>
</div>
<div id="pu5" class="pu"><h1><a href="http://jsoftware.com/" rel="nofollow noreferrer">J</a>, 213 bytes</h1>
<p>Computes the lowest solution for each <span class="math-container">\$n \leq 162\$</span> on TIO. Also found out that the OEIS lowest values is apparently wrong, as you don't need to put every prime in a partition. Big thanks to @Neil for reminding me about modular arithmetic, otherwise I would have sit at <span class="math-container">\$n=36\$</span>. :-)</p>
<pre><code>3 :'N-~&lt;./(0{[*|.(]-[*&lt;.@%~)N*0}.@{_2{[:(]\:~@,:[-]*&lt;.@%&amp;{.)/^:a:,.&amp;(=i.2))&quot;1*/&amp;x:&amp;&gt;&gt;,&amp;.&gt;/@(&lt;@((|.@[(;~&quot;1&amp;&gt;&amp;{.,;&quot;1&amp;&gt;&amp;{:)[,&quot;1 0&amp;.&gt;(-.&amp;.&gt;|.)~)`(,:@[)@.(1 e.[:,e.&amp;&gt;))&quot;1&amp;&gt;~)/(&lt;,:a:,~&lt;2),~&lt;&quot;1\:~(,.|.)&lt;@~.@q:i.&amp;.&lt;:N=:y'
</code></pre>
<p><a href="https://tio.run/##JVDLbtswELz7KxYCKpM2RfEh0RIjCQQK5BT4kCurPmA4idtD0VsCu/p1d0eFwMHsznKGq5/3Qm9faIy0JUWGIp9K0@fnp8e7p7g9Vsuga2GueXfTYq7ybtDp0yKPO/NXp@s3d81RzF/iklTM1byq5VXL@mv8EZUuxXjRTsrC7uryPZbTpEo91UkMSYibTlk8LIUtJ76iHv6TKLMqLBmeE5VmvGm5yO9CxZRl0sLSWeeozrqc4FtOi6zFoBC3DE4yFJbfI5Tmi0NadPoTL@wzxOMYP7Z3uTm9nU@/xmjGHPe6JstfFTkyx1skMau8nyVBueg0cSrtad688i86n95@J6Eyz6we8kVuNq@FMJJsIOfIN@QDNYHaQKGhEOhg6MDYUReo66h31DfUB7LG8AmKrHWAlXUMzgAaBg/mwRqMNCvDXAsWoAYIHXo9yp6ZM6w6awAoYepg6hwPO78CerByDVgLtUUJUwdTFyAc0OvQ61aGXg91Deq59MYAHIB7HrkeuR6RHnt4t5YYxkbeo2zAsJbHM3wb7v8A" rel="nofollow noreferrer" title="J – Try It Online">Try it online!</a></p>
<h3>How it works</h3>
<p><s>Partition the primes <span class="math-container">\$\leq n\$</span> into two sets <span class="math-container">\$p_0, p_1\$</span></s> … this approach doesn't necessarily finds the lowest value, as sometimes not all primes are needed.</p>
<p>Find <span class="math-container">\$p_0, p_1 \subseteq primes_{\leq n}\$</span> with <span class="math-container">\$p_0 \cap p_1 = \emptyset\$</span>, so that every number <span class="math-container">\$i\$</span> in <span class="math-container">\$0 \dots n\$</span> is a multiples of a prime in <span class="math-container">\$p_0\$</span> or <span class="math-container">\$n - i\$</span> is a multiple of a prime in <span class="math-container">\$p_1\$</span> – so the numbers get sieved. I got the idea from <a href="http://www.int-e.eu/oeis/a059756.cc" rel="nofollow noreferrer">Bertram Felgenhauer's implementation</a> to get the Erdös-Woods numbers. For example, for <span class="math-container">\$n = 16\$</span> the sets <span class="math-container">\$2,3,7,13\$</span> and <span class="math-container">\$5,11\$</span> do this. With <span class="math-container">\$P_0 = \prod p_0\$</span> and <span class="math-container">\$P_1 = \prod p_1\$</span> we need some <span class="math-container">\$a, b\$</span> so that <span class="math-container">\$aP_0 + n = bP_1\$</span>.</p>
<p>With some shifting around this is equal to <span class="math-container">\$aP_0 \equiv n \bmod P_1\$</span>, which can be solved with <span class="math-container">\$a = n P_0^{\phi(P_1)} - tP_1\$</span>. Luckely, J has <code>m&amp;|@^</code> already efficiently implemented, thus we can easily get a solution with <span class="math-container">\$t=0\$</span> and then adjust <span class="math-container">\$t\$</span> so <span class="math-container">\$aP_0\$</span> will be the lowest over 0. At the end we just find the lowest overall <span class="math-container">\$aP_0\$</span> of all partitions.</p>
<p>Another method that is slightly faster (but also quite longer) is to solve the equation with the extended Euclidean Algorithm. <span class="math-container">\$aP_0 + n = bP_1\$</span> is <span class="math-container">\$a(-P_0) + bP_1 = n\$</span>, and with the algorithm we get a solution for <span class="math-container">\$a(-P_0) + bP_1 = 1\$</span>. We multiply <span class="math-container">\$a, b\$</span> by <span class="math-container">\$n\$</span> to get a solution for the original formula. To get the smallest positive number, we can increase <span class="math-container">\$a\$</span> by <span class="math-container">\$P_1\$</span> and decrease <span class="math-container">\$b\$</span> by <span class="math-container">\$-P_0\$</span> (though in the end we don't care only about one of them, so we can ignore <span class="math-container">\$b\$</span>).</p>
<p>To get the sets we compute for each <span class="math-container">\$i \in 1\dots n - 1\$</span> the primes that would sieve <span class="math-container">\$i\$</span> on both side. So with <span class="math-container">\$n = 16, i = 3\$</span> would get sieved if <span class="math-container">\$3 \in p_0\$</span> or <span class="math-container">\$13 \in p_1\$</span>. We sort this list so lower numbers that occur more often will already be sieved when construction the sets. Folding these results, starting with the pair <span class="math-container">\$(\{2\}, \{\})\$</span>, either a pair already sieves that number (then we pass it unaltered to the next iteration), or it doesn't – in which case new sets are generated, so that for example <span class="math-container">\$(\{2, 3\},\{\})\$</span> and <span class="math-container">\$(\{2\}, \{13\})\$</span> occur next step. We need to make sure that no prime occurs in both sets, otherwise <span class="math-container">\$gcd(P_0, P_1) \neq 1\$</span>.</p>
<h3>Ungolfed (old)</h3>
<pre><code>f =: 3 : 0
N=:y
NB. needed primes to sieve number
ps=:(,.|.)&lt;@~.@q:i.&amp;.&lt;: N
NB. initial partitioning of 2;''
i=:(&lt;,:(&lt;2),a:),~&lt;&quot;1 ps
NB. fold and expand each partition to all possibilities
NB. to sieve out the next number
ugh=:([:,&amp;.&gt;/&lt;@(([:(#~*/@~:@;&quot;1)({:@[;~&quot;1&amp;&gt;[:{.n),{.@[;&quot;1&amp;&gt;[:{:n=:,&quot;1 0/&amp;.&gt;/@,:)`(,:@[)@.(1 e.[:,e.&amp;&gt;))&quot;1&amp;&gt;~)/ i
NB. helper function for the mod-calculation
t=:4 :'x-@*y(]-[*&gt;.@%~)N*x y&amp;|@^_1+(-~:)&amp;.q:y'
NB. get each partition's solution and pick the lowest of them
&lt;./t/&quot;1 */&amp;x:&amp;&gt;&gt; ugh
)
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="http://julialang.org/" rel="nofollow noreferrer">Julia 1.0</a>, <s>60</s> <s>59</s> 51 bytes</h1>

<pre class="lang-julia prettyprint-override"><code>k-&gt;(a=1;while any(gcd.((a+k)a,a:a+k).&lt;2) a+=1end;a)
</code></pre>
<p><a href="https://tio.run/##yyrNyUw0rPifZvs/W9dOI9HW0Lo8IzMnVSExr1IjPTlFT0MjUTtbM1En0QpE69kYaSokatsapualWCdq/i8oyswrycnTSNMwNNPU5EJwjYw0Nf8DAA" rel="nofollow noreferrer" title="Julia 1.0 – Try It Online">Try it online!</a></p>
<p>Thanks to MarcMush for a saved byte and to Glen O for further -8.</p>
</div>
<div id="pu7" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, <s>106</s> <s>102</s> <s>100</s> 93 bytes</h1>

<pre class="lang-r prettyprint-override"><code>function(k,`^`=function(x,y)ifelse(r&lt;-x%%y,y^r,y)){while({b=0:k+T;sd(T^b*(T+k)^b&lt;2)})T=T+1;T}
</code></pre>
<p><a href="https://tio.run/##K/qfWp5v@z@tNC@5JDM/TyNbJyEuwRbOrdCp1MxMS80pTtUostGtUFWt1KmMKwIKalaXZ2TmpGpUJ9kaWGVrh1gXp2iExCVpaYRoZ2vGJdkYadZqhtiGaBtah9SCrNAwNNP8DwA" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<p>This won't win any fastest-code bounties, but at least runs happily on TIO for the first test-case.</p>
<p>A lot of the code is used-up writing a <code>gcd</code> function (here assigned to the <code>^</code> operator for golfing motives), since 'greatest common divisor' isn't a built-in function in base <a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>.</p>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/barbuz/Husk" rel="nofollow noreferrer">Husk</a>, 17 bytes</h1>
<pre><code>ḟSμΛo←§Y⌋¹⌋³…)+⁰N
</code></pre>
<p><a href="https://tio.run/##yygtzv7//@GO@cHn9pybnf@obcKh5ZGPeroP7QQRmx81LNPUftS4we////@GZgA" rel="nofollow noreferrer" title="Husk – Try It Online">Try it online!</a></p>
<pre><code>ḟ                   # find the first x
                N   # in the infinite list of integers
                    # that satisfies:
 Sμ          )+⁰    # hook: apply lambda function with args x and x+input
   Λ                # are all results truthy
            …       # in range arg1 to arg2 (so from x to x+input):
    o←              #   one less than
      §Y            #   maximum of
        ⌋¹          #   GCD of each element and arg1
          ⌋³        #   and GCD of each element and arg2
</code></pre>
</div>
<div id="pu9" class="pu"><h1><a href="https://github.com/Lyxal/Vyxal" rel="nofollow noreferrer">Vyxal</a>, 17 bytes</h1>
<pre><code>λ?+₌ṡ&quot;Ẋvġ2ẇ‹v∑Π;ṅ
</code></pre>
<p><a href="https://lyxal.pythonanywhere.com?flags=&amp;code=%CE%BB%3F%2B%E2%82%8C%E1%B9%A1%22%E1%BA%8Av%C4%A12%E1%BA%87%E2%80%B9v%E2%88%91%CE%A0%3B%E1%B9%85&amp;inputs=16&amp;header=&amp;footer=" rel="nofollow noreferrer">Try it Online!</a></p>
<p>-3 bytes thanks to lyxal</p>
<p>Using the same approach as my Jelly answer.</p>
<hr />
<p>You can find a more in-depth walk-through and explanation of my solution on my YouTube channel <a href="https://www.youtube.com/watch?v=ipuMUs0IOmg" rel="nofollow noreferrer">here</a>. However, the explanation there is outdated.</p>
<hr />
<pre><code>λ?+₌ṡ&quot;Ẋvġ2ẇ‹v∑Π;ṅ       Full Program; start with `k` on the stack and as the input
λ?+₌ṡ&quot;Ẋvġ2ẇ‹v∑Π;ṅ       Function: given `a`:
 ?                      Push the input, `k`
  +                     Sum with `a`: `a + k`
   ₌ṡ&quot;                  In parallel, apply inclusive range and pair
                        The TOS is now [a, a + k]
                        The second element is [a, a + 1, a + 2, ..., a + k]
      Ẋ                 Cartesian Product
       vġ               GCD of each pair
         2ẇ             Slice into blocks of length 2
           ‹            Decrement
            v∑          Sum of each pair
              Π         Product

                  ṅ     Find the first integer satisfying this
</code></pre>
</div>
<div id="pu10" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="noreferrer">Jelly</a>, 12 bytes</h1>
<pre><code>,gþr’§Ạð+¥1#
</code></pre>
<p><a href="https://tio.run/##ASAA3/9qZWxsef//LGfDvnLigJnCp@G6oMOwK8KlMSP///8xNg" rel="noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p>-3 bytes thanks to caird coinheringaahing</p>
<p>yeah this isn't gonna finish for <code>22</code> on TIO.</p>
<hr />
<p>You can find a more in-depth explanation and step-by-step process for solving and golfing a Jelly solution for this challenge in my <a href="https://www.youtube.com/watch?v=QsYz4DRxJK0" rel="noreferrer">YouTube video here</a>.</p>
<hr />
<pre><code>,gþr’§Ạð+¥1#   Main Link; accept `k`
          1#   nfind; find the first 1 element `a` where all of [a, a + 1, ..., a + k] are not coprime with both [a, a + k]
         ¥     last two links as a dyad:
-------ð       - this link accepts `a` on the left and `a + k` on the right
        +      - this link adds `a` and `k`
               therefore, by the 2,2 chaining rule, this applies the left link to `a` and `a + k`
,gþr             - by the special-case 2,2,2 chaining rule, this applies `gþ` to `(a) , (a+k)` on the left and `(a) r (a+k)` on the right
 gþ                - product table: compute the GCD between all pairs between
,                  - pair; [a, a+k]
   r               - inclusive range; [a, a + 1, a + 2, ..., a + k]
    ’            - decrement each GCD
     §           - vectorized sum: sum each pair
      Ạ          - are all truthy?
</code></pre>
<p>Essentially, for each number, we compute the GCD between all elements of <code>[a, a + k]</code> and <code>[a, a + 1, a + 2, ..., a + k]</code>. Then, we get a list of pairs (though each in reverse order to what was presented in the challenge). Then, we subtract 1 from each. Since GCD gives a minimum of 1, this gives a minimum of 0. Therefore, when we sum each pair, and <code>[1, 1]</code> GCD pairs become <code>0</code> and everything else remains positive. Therefore, we check if all elements are truthy, and find the first <code>a</code> for which it is.</p>
<hr />
<p><a href="https://i.sstatic.net/gn4KN.jpg" rel="noreferrer"><img src="https://i.sstatic.net/gn4KN.jpg" alt="enter image description here" /></a></p>
</div>
<div id="pu11" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, 60 bytes</h1>

<pre class="lang-ruby prettyprint-override"><code>-&gt;k{1.step.find{|x|(x..x+k).all?{|y|y.gcd(k+x)+y.gcd(x)&gt;2}}}
</code></pre>
<p><a href="https://tio.run/##KypNqvyfZvtf1y672lCvuCS1QC8tMy@luqaiRqNCT69CO1tTLzEnx766prKmUi89OUUjW7tCUxvCrNC0M6qtrf1foJAWbWgWywWijYwgtLFJrIKyQmKxQmbafwA" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
</div>
<div id="pu12" class="pu"><h1><a href="https://github.com/Lyxal/Vyxal" rel="nofollow noreferrer">Vyxal</a>, 23 bytes</h1>
<pre><code>λD→a?+:£ṡƛ¥ġn←aġ+2&gt;;A;ṅ
</code></pre>
<p><a href="https://lyxal.pythonanywhere.com?flags=&amp;code=%CE%BBD%E2%86%92a%3F%2B%3A%C2%A3%E1%B9%A1%C6%9B%C2%A5%C4%A1n%E2%86%90a%C4%A1%2B2%3E%3BA%3B%E1%B9%85&amp;inputs=16&amp;header=&amp;footer=" rel="nofollow noreferrer">Try it Online!</a></p>
<p>-1 byte thanks to @cairdcoinheringaahing</p>
</div>
<div id="pu13" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 97 bytes</h1>

<pre class="lang-python prettyprint-override"><code>f=lambda k,a=1:all(gcd(a,x)+gcd(a+k,x)&gt;2for x in range(a,a+k))and a or f(k,a+1)
from math import*
</code></pre>
<p><a href="https://tio.run/##JY7bCoMwEETf/Yp9zFYpTQt9KOi/bE2iwVxkk4J@fbq0AwMHDgOzn3XN6dF83DNXKGfppNdiK9v5w8XnFHz0VembBJsbA8W3IdgGGvWLQlDLbBQNB/Y/6DfB6e4ywwE@AVNarHgRiJQMEIhySva9xs5xjhCprvB/cGk7@1SVU/qJ2L4" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>Might reach the recursion limit, so adjust it with <code>sys.setrecursionlimit</code>. In TIO link it is set to 10000 in Header section.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/230509/">230509</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




