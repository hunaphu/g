<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::165026</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>021</td><td>Uiua</td><td>241018T194531Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/276194#276194">janMakos</a></td></tr>
<tr d-ix="1"><td>268</td><td>Python3</td><td>241018T175858Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/276192#276192">Ajax1234</a></td></tr>
<tr d-ix="2"><td>028</td><td>APL Dyalog Extended</td><td>210120T113426Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/217792#217792">Razetime</a></td></tr>
<tr d-ix="3"><td>nan</td><td>Wolfram Language Mathematica</td><td>180518T094535Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/165033#165033">DELETE_M</a></td></tr>
<tr d-ix="4"><td>011</td><td>Jelly</td><td>180518T102655Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/165037#165037">DELETE_M</a></td></tr>
<tr d-ix="5"><td>158</td><td>Python 2</td><td>180519T015150Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/165080#165080">KSab</a></td></tr>
<tr d-ix="6"><td>134</td><td>JavaScript ES6</td><td>180518T105215Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/165038#165038">Arnauld</a></td></tr>
<tr d-ix="7"><td>155</td><td>Haskell</td><td>180518T142552Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/165049#165049">user2866</a></td></tr>
<tr d-ix="8"><td>210</td><td>Python 2</td><td>180518T093538Z</td><td><a href="https://codegolf.stackexchange.com/questions/165026/where-is-that-snake-going/165032#165032">TFeld</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Uiua, 21 bytes</h1>
<pre class="lang-none prettyprint-override"><code>⧻⊚/↧=1≡/+⌵≡/-◫2⍉⧅≠⊸⧻⊚
</code></pre>
<p><a href="https://uiua.org/pad?src=0_13_0-rc_5__IyBFeHBlcmltZW50YWwhCkYg4oaQIOKnu-KKmi_ihqc9MeKJoS8r4oy14omhLy3il6sy4o2J4qeF4omg4oq44qe74oqaCgpGIMKwanNvbiQgW1sxLDEsMSwxLDFdLAogICAgICAgJCBbMCwwLDAsMCwxXSwKICAgICAgICQgWzAsMCwwLDAsMV1dCgpGIMKwanNvbiQgW1sxLDEsMSwxXSwKICAgICAgICQgWzAsMCwxLDFdLAogICAgICAgJCBbMCwwLDEsMV1dCg==" rel="nofollow noreferrer">Try it online!</a></p>
<h2>Explanation</h2>
<pre class="lang-none prettyprint-override"><code>⧻⊚/↧=1≡/+⌵≡/-◫2⍉⧅≠⊸⧻⊚
                    ⊚ # binary matrix to points
                ⧅≠⊸⧻  # all permutations of points
             ◫2⍉      # pairs of consecutive points
         ⌵≡/-         # absolute differce between pairs
      ≡/+             # sum of x difference and y difference 
                      # (manhattan distance)
  /↧=1                # check if all are equal to one
                      # (points are connected)
⧻⊚                    # count where predicate (above) is true
</code></pre>
</div>
<div id="pu1" class="pu"><h1>Python3, 268 bytes</h1>
<pre class="lang-py prettyprint-override"><code>E=enumerate
def f(b):
 d={(x,y):v for x,r in E(b)for y,v in E(r)}
 q,c=[(*i,[i])for i in d if d[i]],0
 for x,y,p in q:
  if len(p)==sum(d.values()):c+=1;continue
  for X,Y in[(1,0),(-1,0),(0,-1),(0,1)]:
   if d.get(v:=(x+X,y+Y))and v not in p:q+=[(*v,p+[v])]
 return c
</code></pre>
<p><a href="https://tio.run/##dU7NaoQwEL7nKeaYqbOL0kux5LjvsEvIwWpsA7sxZmNQSp/dGl0otJY5DN98f@Om8NHZ5xfn5/kktB1u2ldBs0a30PI3LBk04pOPNGEZoe08jOTBWDgtZIITxQ16/GLQUy0kfzIkjVppk8gGTAvNclKUs0fIRC5R/VKQ2Ku23KEQ9@HGm2OsroO@c8SyzkTxWnc2GDvoRZrMZ7osVskLypH4YVs5HYp1FahS5lp5fNeBx1LwMTvTlF0QK9tABNuFVO7KPkvvRnKZjAoVA6/D4C3Us/PGBt5yuWTJgh6jKMGcttmBCpHtWX@UO@CP6R/db9P8DQ" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/abrudz/dyalog-apl-extended" rel="nofollow noreferrer">APL (Dyalog Extended)</a>, 28 bytes</h1>

<pre class="lang-apl prettyprint-override"><code>+/×/1=2(1⊥∘|-)/x[⌂pmat≢x←⍸⎕]
</code></pre>
<p><a href="https://tio.run/##SyzI0U2pTMzJT9dNrShJzUtJTfn/qKM97b@2/uHp@oa2RhqGj7qWPuqYUaOrqV8R/ainqSA3seRR56KKR20THvXueNQ3NRak4X8a16O2iUCeV7C/n4J6dLShDhTG6kQb6EAgKjtWnQuHJqgyVFasOgA" rel="nofollow noreferrer" title="APL (Dyalog Extended) – Try It Online">Try it online!</a></p>
<p>A full program that accepts a matrix.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 16+83=99 bytes</h1>

<p>Library import statement (16 bytes):</p>

<pre><code>&lt;&lt;Combinatorica`
</code></pre>

<p>Actual function body (83 bytes):</p>

<pre><code>Length@HamiltonianCycle[MakeGraph[#~Position~1~Join~{1&gt;0},##||Norm[#-#2]==1&amp;],All]&amp;
</code></pre>

<p><a href="https://tio.run/##bcixCsIwEIDhvU9RCHSKYJxbqXRQRKV7KXiW1B4mF4m3SNu8erTgKP/0/RZ40BYYO4gxzytnb0jAzn/HNemLk6Y7D@UBLBp2hEDVuzO6OcND7z08h0aE2r2Q0VFQ4eiQwqi261kKMU0X520jVmLTFoXKWrkzps1i7ZG47MsxSdNRyV@zXLiWS3@YzPED" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>

<hr>

<p>Note that the question just ask for the number of Hamiltonian path in the graph.</p>

<p>However, (for some reason) the <code>HamiltonianPath</code> function doesn't really work with directed graph (<a href="https://tio.run/##fY6xCsIwFEX3/kbBKUWaro1UHOqgUqVOIeCzfaTBJC0xLYj47THg7nrOgXsN@AENeNVBCOdZoedluRvNXVnwo4v4JhKZs9qpvnYwDZySQiQLa@dJ45NfwEpcV@9IPzGk7AgP/IULOY3O8DRLqWAsX0Vd/NGkfU2Yba62Vw47j71IGqes5we00g/VHozSfrQKbBNP85RstRaruC1zIimR8UAIXw" rel="nofollow noreferrer">example</a>). So, I used the workaround described in <a href="https://mathematica.stackexchange.com/questions/105196">this Mathematica.SE</a> question:</p>

<ul>
<li>Add an vertex (called <code>True</code>) that is connected to all other vertices.</li>
<li>Count the number of Hamiltonian cycle on the resulting graph.</li>
</ul>

<p>The graph is constructed using <code>MakeGraph</code> (annoyingly there are no directly equivalent built-in), using the boolean function <code>##||Norm[#-#2]==1&amp;</code>, which returns <code>True</code> if and only if one of the arguments is <code>True</code> or the distance between the two vertices are <code>1</code>.</p>

<hr>

<p><code>Tr[1^x]</code> cannot be used instead of <code>Length@x</code>, and <code>&lt;2</code> cannot be used instead of <code>==1</code>.</p>

<hr>

<p><code>HamiltonianPath</code> can be used if the graph is undirected, with the function body takes <strong>84</strong> bytes (exactly 1 byte more than the current submission):</p>

<pre><code>Length@HamiltonianPath[MakeGraph[#~Position~1,Norm[#-#2]==1&amp;,Type-&gt;Undirected],All]&amp;
</code></pre>

<p><a href="https://tio.run/##hY3BSsNAEIbv@xQDgaJlC8ZzIxEP9qASQU8x4NhMm6HZ2bA7QaSkrx6j9SIW5L/M9898jENtyKHyGsfHnknL5fLGuzcWVB@m9rWCszl8r4Aj9JFqUA@x77pAMcKkwzsGYdnC/NxsspfxjmSrTb5Cx616YZRi@lLe445uA3ZNmRwKH1nZyyG1Dz64Mlkkl1WWpTP79NHR4upZag60Vqore9221WwsAovmm3xvAPap/clgv/DCHvMHzWDM/@IJPCUeb34NZhg/AQ" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>12</s> 11 bytes</h1>

<pre><code>ŒṪŒ!ạƝ€§ÐṂL
</code></pre>

<p><a href="https://tio.run/##y0rNyan8///opIc7Vx2dpPhw18Jjcx81rTm0/PCEhzubfP4fbgfy/v@P5ormUlCINtSBwlgdENdABwKxcIEIWQdCARZOLFcsAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<hr>

<h2>Explanation.</h2>

<pre><code>ŒṪ               Positions of snake blocks.
  Œ!             All permutations.
                 For each permutation:
    ạƝ€             Calculate the absolute difference for each neighbor pair
       §            Vectorized sum.
                 Now we have a list of Manhattan distance between snake
                    blocks. Each one is at least 1.
        ÐṂL      Count the number of minimum values.
                    Because it's guaranteed that there exists a valid snake,
                    the minimum value is [1,1,1,...,1].
</code></pre>
</div>
<div id="pu5" class="pu"><h1>Python 2, 158 bytes</h1>

<pre class="lang-py prettyprint-override"><code>E=enumerate
g=lambda P,x,y:sum(g(P-{o},*o)for o in P if x&lt;0 or abs(x-o[0])+abs(y-o[1])&lt;2)+0**len(P)
lambda L:g({(x,y)for y,r in E(L)for x,e in E(r)if e},-1,0)
</code></pre>

<p><a href="https://tio.run/##bYw9C4MwEIb3/Iob7/SE2KGD2LFbB3dxsDRaQRNJLUTE325jSqGUcje8z3084zzdjT5s2/mk9HNQtp6UaE99PVxvNRTseM4ezwFbLJLFrBwZaowFA52GAroGXC7BD@rrA11iSllRvOfZ57Si/ECxjKJeaSxINB/vJWtxQe8OspntrjvjJaBj9UZL3q9WTlKWtI220xM2WAqAMuVQFe8gWf6DihiOJH7@YO/3qU/yG8ImvKVH2l4" rel="noreferrer">Try it online!</a> </p>
</div>
<div id="pu6" class="pu"><h1>JavaScript (ES6), <s>154</s> 134 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;m.map((r,Y)=&gt;r.map(g=(_,x,y,r=m[y=1/y?y:Y])=&gt;r&amp;&amp;r[x]&amp;&amp;[-1,0,1,2].map(d=&gt;r[r[x]=0,/1/.test(m)?g(_,x+d%2,y+~-d%2):++n,x]=1)),n=0)|n/4
</code></pre>
<p><a href="https://tio.run/##jY3LCoMwEEX3foWbSoKjJtKVEP0OCaGIL1pMlCjFQOmvp8ZdaQWZxXC498w8qmc11/o@LZEam9Z2zEqWy1hWE0IaSsxyvUPP0A1WMKCZ5IbRxBQmK4XLg0DzVQQBjygQoJCK3Wi2iLuEEUhoEi/tvCCJi94dCptLCiZ8R9vGWRgq2HoUY1CM4JdKrrYe1TwObTyMPeoQ93yfU9hHgAMCbn5AYOydUf/AgXrQPqN@fT2ATbUf" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h2>How?</h2>
<h3>Method</h3>
<p>Starting from each possible cell, we flood-fill the matrix, clearing all cells on our way. Whenever the matrix contains no more <strong>1</strong>'s, we increment the number <strong>n</strong> of possible paths.</p>
<p>Each valid path is counted 4 times because of the direction chosen on the last cell, which actually doesn't matter. Therefore, the final result is <strong>n / 4</strong>.</p>
<h3>Recursive function</h3>
<p>Instead of calling the recursive function <strong>g()</strong> from the callback of the second <strong>map()</strong> like this...</p>
<pre class="lang-javascript prettyprint-override"><code>m=&gt;m.map((r,y)=&gt;r.map((_,x)=&gt;(g=(x,y,r=m[y])=&gt;...g(x+dx,y+dy)...)(x,y)))
</code></pre>
<p>...we define the recursive function <strong>g()</strong> <em>directly as the callback</em> of <strong>map()</strong>:</p>
<pre class="lang-javascript prettyprint-override"><code>m=&gt;m.map((r,Y)=&gt;r.map(g=(_,x,y,r=m[y=1/y?y:Y])=&gt;...g(_,x+dx,y+dy)...))
</code></pre>
<p>Despite the rather long formula <code>y=1/y?y:Y</code> which is needed to set the initial value of <strong>y</strong>, this saves 2 bytes overall.</p>
<h3>Commented code</h3>
<pre class="lang-javascript prettyprint-override"><code>m =&gt;                           // given the input matrix m[][]
  m.map((r, Y) =&gt;              // for each row r[] at position Y in m[][]:
    r.map(g = (                //   for each entry in r[], use g() taking:
      _,                       //     - the value of the cell (ignored)
      x,                       //     - the x coord. of this cell
      y,                       //     - either the y coord. or an array (1st iteration),
                               //       in which case we'll set y to Y instead
      r = m[y = 1 / y ? y : Y] //     - r = the row we're currently located in
    ) =&gt;                       //       (and update y if necessary)
      r &amp;&amp; r[x] &amp;&amp;             //     do nothing if this cell doesn't exist or is 0
      [-1, 0, 1, 2].map(d =&gt;   //     otherwise, for each direction d,
        r[                     //     with -1 = West, 0 = North, 1 = East, 2 = South:
          r[x] = 0,            //       clear the current cell
          /1/.test(m) ?        //       if the matrix still contains at least one '1':
            g(                 //         do a recursive call to g() with:
              _,               //           a dummy first parameter (ignored)
              x + d % 2,       //           the new value of x
              y + ~-d % 2      //           the new value of y
            )                  //         end of recursive call
          :                    //       else (we've found a valid path):
            ++n,               //         increment n
          x                    //       \_ either way,
        ] = 1                  //       /  do r[x] = 1 to restore the current cell to 1
      )                        //     end of map() over directions
    ),                         //   end of map() over the cells of the current row
    n = 0                      //   start with n = 0
  ) | n / 4                    // end of map() over the rows; return n / 4
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, <strike>187</strike> 155 bytes</h1>



<pre class="lang-hs prettyprint-override"><code>r=filter
l=length
(a,b)?(x,y)=abs(a-x)+abs(b-y)==1
l#x=sum[p!r(/=p)l|p&lt;-x]
p![]=1
p!l=l#r(p?)l
f x|l&lt;-[(i,j)|i&lt;-[0..l x-1],j&lt;-[0..l(x!!0)-1],x!!i!!j&gt;0]=l#l
</code></pre>

<p><a href="https://tio.run/##dY/BbsMgEETvfAUoPYAKrp1cQ/whiANW7AZn4yLsSETyvzubOFIjlbKXmbc7I3Fy47kFWJaoOw9TGwloaIfv6US4k42oeZI3oV0zcqeS@HyIRiHRFYFN0uP1YgKL/EsHAXPYq2RJYMbiOjCs2kQeagGko2mGvTLcy17MHlVZFECTqqzsX44nxkrxICg8Y/2htNgAS@dbOFZUU0MoPlPJ11i5glKukwHoLSHPhu2fhvfzjH3L7n6z/xxnsxfnB0wef57LEP0w0Q/a0fVHObjNwd1yBw" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>
</div>
<div id="pu8" class="pu"><h1><a href="https://docs.python.org/2/" rel="noreferrer">Python 2</a>, <s>257</s> <s>246</s> <s>241</s> <s>234</s> <s>233</s> <s>227</s> <s>214</s> 210 bytes</h1>



<pre class="lang-python prettyprint-override"><code>lambda b:sum(g(b,i,j)for j,l in e(b)for i,_ in e(l))
e=enumerate
def g(b,x,y):d=len(b[0])&gt;x&gt;-1&lt;y&lt;len(b);c=eval(`b`);c[d*y][d*x]=0;return d and b[y][x]and('1'not in`c`or sum(g(c,x+a,y)+g(c,x,y+a)for a in(1,-1)))
</code></pre>

<p><a href="https://tio.run/##dY7BbsMgEETvfMXeAvVGMj0mIT9CUQ0Gt44wjiiuzNe7xK5UqXW1Epq3zGjnntP7GJ6XTrwsXg/GajCnj2mgb9RgjzfWjRFu6KEP4KhZscfXDT1jxAkXpsFFnRyxroNHbsbMTlZ4F6iRtWLX@Xrkl3xZF@zcCvepPW1MU7S0T1mVZ1aiPkeXphjAgg4WjCwfsyqSHvghjKkcbdqmFNj6tThXulyqVom50ms7XWyU45EzxpZ77EOCjkoCIDl@j8IH1rjNDipGyF70x7kDf0L/@H6Fli8" rel="noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>

<hr>

<p>Saved</p>

<ul>
<li>-8 bytes, thanks to Kevin Cruijssen</li>
<li>-14 bytes, thanks to user202729</li>
</ul>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/165026/">165026</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




