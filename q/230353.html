<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::230353</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>302</td><td>C++ clang</td><td>210628T140409Z</td><td><a href="https://codegolf.stackexchange.com/questions/230353/continuous-knapsack-but-fast/230639#230639">Noodle9</a></td></tr>
<tr d-ix="1"><td>421</td><td>Common Lisp</td><td>210703T013329Z</td><td><a href="https://codegolf.stackexchange.com/questions/230353/continuous-knapsack-but-fast/230921#230921">Thun_A</a></td></tr>
<tr d-ix="2"><td>378</td><td>Python 3</td><td>210624T171508Z</td><td><a href="https://codegolf.stackexchange.com/questions/230353/continuous-knapsack-but-fast/230459#230459">ngn</a></td></tr>
<tr d-ix="3"><td>252</td><td>Python 3</td><td>210623T113853Z</td><td><a href="https://codegolf.stackexchange.com/questions/230353/continuous-knapsack-but-fast/230363#230363">Noodle9</a></td></tr>
<tr d-ix="4"><td>178</td><td>R</td><td>210624T080839Z</td><td><a href="https://codegolf.stackexchange.com/questions/230353/continuous-knapsack-but-fast/230419#230419">Nick Ken</a></td></tr>
<tr d-ix="5"><td>271</td><td>Python3</td><td>210623T202741Z</td><td><a href="https://codegolf.stackexchange.com/questions/230353/continuous-knapsack-but-fast/230391#230391">user1502</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="http://clang.llvm.org/" rel="nofollow noreferrer">C++ (clang)</a>, <sup><s>410</s> <span class="math-container">\$\cdots\$</span> <s>310</s></sup> 302 bytes</h1>

<pre class="lang-cpp prettyprint-override"><code>#import&lt;regex&gt;
using V=std::deque&lt;std::pair&lt;float,int&gt;&gt;;float f(int W,V&amp;l){int N=0,X=0,A=0,i=0;auto[a,b]=l[rand()%l.size()];V L,S,M;for(auto[p,w]:l)(p/w&gt;a/b?N+=p,A=X+=w,L:p/w==a/b?++i,M:S).push_back({p,w});for(;i--&amp;X&lt;W;X+=b)std::tie(a,b)=M[i],N+=a;return A&gt;W?f(W,L):X&lt;W?S&gt;V()?f(W-X,S)+N:N:(W-X)*a/b+N;}
</code></pre>
<p><a href="https://tio.run/##hVZbT@tGEH7nV6xSlWOfOBx7r944CTqq@ga8oBIkQEcmOGCdkKS2Q1Cj/PXSuTgQWlAjJRnPzuWbb2Z3PVkue5NZPr9/efmlfFwuqmZQFffF8@hgVZfze3ExrJu7fv@u@HNVDEhc5mU1mM4WeROV82Y0ykgW0wCexDi6OJyFGxTPhnF0Cd/v8C2HcZavmsVVHt3eDGdXVT6/C8JfZ0d1@VcRhDfZhTiJzqPTbLqoAjJcRuub/iwMlt/Wo/zb7fFZd7iEUJfd4To66YN2OER1t1tGp/3z8Gi5qh9@3OaTn8EGXLchRcrKXu/wcjDOwO02JPRNWQQAIhyeXpU3EUTNs6poVtVcfB@Nj6fBODoJ@@ByfD66CEJU9C6j87B71j/roxx@hbTds2wLdM0ns9VdIQaTx7x5GB28KcpF3VRF/riveyomzaIaHSA1j3k5D8LNgYBPTVw05WMRnP1xchKGGakni3ndiMlDXn2F32Lys6iubsRQbDrXz7/L62f/G3xNJxL7z6qzZW8qlTMOLkaiKeqm/vEE3rSKn83GR8JuI7FJTCQMCSoSnoQkEm67jfaNQZVqXHQSJIWSjyOhSdIWJBQMxNIkpW10BZpUkiNIniQLwaTZ5eZgzgEK8tAQNknJDgCZdOebUFwJsPWrzsUUBXw9@TpIq@QuiiU7rSnv@3I0RiEIJrbow6kTkCWH9x4K1TIhINqjDQWWCrI5T77auB0FKZWiWY18eMOylFgsM4AsemYFAvqYg1sIknBw46EAzzxDFkVIDFZgHGmVAtklFNpZSJMyuR4rUtYRFI@N5G5ZBbL03FaVIFrumMQGtY2JgSvXdgbSppwK/gAXQ3ASTNK2P4nHZjAETOuZjMQDHCM9w8Ga2rREqnM8MlgfiUZ5rMQzAoe8MwUWw8etzRs1HtFzv51Efrm5KVjYmNU4mpaBGRxm2fKBrHN9XoM6ZbwGoMiE2FAxqF07VpZmo82PiSQPqNTIJE8Z7h1mSTuQjeY51ADAmLZROKgMwGok3r6S5BIy10ieMYqHAPmieUgxEWSjYUO@nOLycFv6lECm2DJPapVg5xmATAmM5w2QYEhuGU2KpbItg@cwOB2GSZUS96cie6kJAlGW4uxbk3ArFfaDOcPCtSK9wh1tYt60eJzw1tIppm0LRNlyiyXKns@CFOE4Pg2I4ZQR04GTsAnJxu/OHGspYoJ9ZTokcpA4vzsMEm6fpoHgEdMJttsmrxOc6vZ8IuZ5@lP5aqPwWDDtmRNTJrZPsT7uiDd4FjLdBjsieesm2FjH0@9whBV3VmGBqvXF40XyEEvqOLTz/Rn1f@cz2X5w4OOt3B75Y7wxaO9it2Cj0maJP3CiS3wkiuclPBd36KfcUYof2o/KHnlpcfdK54@s1obOYQ4Ed62g678EvziDv4HQmYDLOdy7ci7EEyy3dxHcvtnrCr05vK6N363x20U@r9dFBSZ4Qz@F/14uYGUH/QPvu3I6Rd/8tg4K0Wuj7UW5XSxmYpnXNViR8UAkRU@@GRBVk8WqEYOB6LScLatyUkRiXZT3D8DdUHQ@cfiy@ZJRirrJqwYLrVbFHkikjy98fPc5FPT2I/riaZ@@/0QNONqx6HTAFl8FQkK36eDfkmRQ4v@aHrZ7@Dgao5nms3oPzvaTIrZfPuMDOCibB2ohpRuTVvRG/Ng2j3Sk2L3QIOM3pL@et9i2B9uXvyfTWX5fv/TW/wA" rel="nofollow noreferrer" title="C++ (clang) – Try It Online">Try it online!</a></p>
<p><em>Saved a whopping <s>24 25 31 33 40 44</s> 52 bytes thanks to <a href="https://codegolf.stackexchange.com/users/52904/ceilingcat">ceilingcat</a>!!!</em></p>
<p>Port of my <a href="https://codegolf.stackexchange.com/a/230363/9481">Python answer</a>.</p>
</div>
<div id="pu1" class="pu"><h1><a href="http://www.clisp.org/" rel="nofollow noreferrer">Common Lisp</a>, 421 bytes</h1>

<pre class="lang-lisp prettyprint-override"><code>(defun F(F c)(loop for(p w)across(C F)sum p into R sum w into U until(&gt; U c)finally(return(decf R(* p(min(/(- U c)w)1))))))(defun K(f)(floor(apply'/ f).01))(defun C(F)(reverse(let((C(make-array(1+(reduce'max(mapcar'K F))):initial-element 0))(O(make-array(length F))))(mapc(lambda(f)(incf(elt C(K f))))F)(dotimes(i(1-(length C)))(incf(elt C(1+ i))(elt C i)))(mapc(lambda(f)(setf(elt O(decf(elt C(K f))))f))(reverse F))O)))
</code></pre>
<p><a href="https://tio.run/##dVZNb9w2ED3bv2KQwjblVLZIiqIYA70YMFA4qIEgPRU9yFquLURfkLhZ@@K/7r6hdu1Nmy7gSBzOvHnzZkSmbpt5fH0VK7/e9HQjbqhORDsMI62HSYy0Tap6GuZZXNNNMm86Gqnpw0BfiBfbZfEnbfrQtOI3vNXJuumrtn0Wkw@bqQdyvaYv4pxG0TW9uBRp9NomMom/XepbsU7EGpknUY1j@3x2SevkIpNvDtfiJgHmdz/NXrQ@CHEtuuqbT6tpqp6F/IjN1ab2Z131hI2xrqazW5BOkk9N34SmalPf@s73gTKA3h0Gt75/CI/ROYmxoq26@1XFnJq@XgvfBhC4BSX8wGM1hKbzs2iETPfR1xx84C0/UgNLXPDbf5BnHxbfuyjSj0nwz75a5nUH0@vVFd0MU1cFGtZUUfBzSOsKDs1Moq7Gqm7CM33rh22fTn7eAO8Uz0D9prsHUnLMWo7VVHU@@InO3xDm82OiMyFURtpelI4cFSQlGZIa79KQTeBBJEqLZaaLC4cNSWVOVlGJ94xyTXlBORlDeU4lELShUpE15BQVkpRhJDhbSwaeGUl4aTIl@8iclKM8vltsWXIF2ZK0Ys@iZFCndjScY1DrLgo8c0QZMhkSKsDKghRgHJLmSlKRO9gVKW3JIiw3lqmWTCVnqgU5pswuBmxRFQIMNMgQXFiS2DGu5DxA0CUZMDE2J61hYW2KgkoU6uChEVCyNlCm0BolQS8tkRHqKJTLgmQZq1agxBIw/CcBa6F@ybpIhICZBRzXKaGDgTTOgQvDcYGQ0GXgBCW1Awv8ZRZ1g2rBHWL7Qt0hu@WEqBMilpYKzs8EkMSgwYo5o2qYHCuDnGiJwo7O0CxuSZHHSKMBomBTsVkWk1KAfY6hMNxOTm9YGDQSoEUueSS4ACsxII6HQ0NUmDA7Kl@AUIfVoISBc2VJJehhnDQGQgNUlQwOQLSDkXJWG20vYnK4Q1mDAhXGy2nuPcNiKBFTGMSgDgnOGiRzaKExiQYpC64SfS8Bx6TwLMBf4cmjUwLeApIJwpQzYQkzP@NwoAwAQ7eStUIL@cuA5JApj91FOsy3QjruaJnz98CVqzgEbNcYWcNznzEK9nmMoYQzC30DJRREkzx66LxFSzUIaMUaZ5GnQlMVK@lwrCXHx7vj8sH3fqqCT99PCdHzxyNw4gf@3ElMVb8aOnyTWZZQ37R0RW@nCI6Uqufj3T/gpGh6@iuLjn/T6XLCYHve8tZMf/z@OeLFe2Pyo8cJhQO/J5VQPbStr7HGcbhP6JyLRz/y@ap@pHFqan@59c3DY/hJYrQwQ@K30g4qwiXV0ekwhmbApUMC5@X9gA0Uk5CYw@SrjkKy1O3DOQkxcv3HR3u6QKB4AtLQ4xBdrSY2dQndP9MvZ7xmX/zeCuF4ZG4mPGIkZ/L10K92S27DEWevppDyPUHiwYeUS5rAMp02fTQvbjsZcfOOh8iRxOLBvmnAbQWCl4T783/g6D0j4o6O3jwiwAaX4JyOfkoXsgv2ObTvQzrisg7P51G33Qm7fUS@nZ7RQovc6O1O1w9f0Yimf4hlf6KX@eXkc7wK8b56Obk9mBJYflXrl5ProRs3wa/@Zf7KIsUKYVnPL@rkw071vSgyjbXvrtqlQyp5V36x7LR8F2xfzPeq3aDF/B8M8F/ckv3y0D1@QXxPo/m7q5rEE1zfh@6JB@qHuxP36uHoS1oNhwHiJ98iT3TCQK//AA" rel="nofollow noreferrer" title="Common Lisp – Try It Online">Try it online!</a></p>
<p>Uses counting sort, should be <span class="math-container">\$O(n)\$</span> as far as I can tell.</p>
<p><code>F</code> Main function &amp; the list of input items of type <code>f</code></p>
<p><code>f</code> Individual items of format <code>(profit weight)</code></p>
<p><code>c</code> Capacity</p>
<p><code>p</code> Profit of item</p>
<p><code>w</code> Weight of item</p>
<p><code>U</code> Total weight</p>
<p><code>R</code> Total profit</p>
<p><code>K</code> Helper function for calculating <span class="math-container">\$\left\lfloor 100\times p_i/w_i\right\rfloor\$</span> to use as index in <code>C</code></p>
<p><code>C</code> The counting sort &amp; the array <code>count[k+1]</code></p>
<p><code>O</code> The output array in <code>C</code></p>
<p><code>i</code> Generic index</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <s>394</s> 378 bytes</h1>
<p>thanks @Anush for finding issues</p>
<p>thanks @pxeger for -16 bytes</p>

<pre class="lang-python prettyprint-override"><code>def f(x,c):
 A,B=zip(*x);r=len(x);l=o=0
 if c&gt;=sum(B):return sum(A)
 while 1:
  a,b=x[__import__('random').randint(l,r-1)];t=a/b;W=P=0;i=k=l;j=r
  while k&lt;j:
   p,w=x[k];u=v=k
   if p/w&gt;t:v=i;i+=1;W+=w;P+=p
   elif p/w&lt;t:j-=1;v=j;k-=1
   k+=1;x[u],x[v]=x[v],x[u]
  if W&gt;c:r=i;continue
  while W&lt;c and i&lt;j:p,w=x[i];i+=1;W+=w;P+=p
  if W&gt;=c:return(c-W+w)*p/w+P-p+o
  l=j;c-=W;o+=P
</code></pre>
<p><a href="https://tio.run/##fVTLbuJKEN3zFS3dRexQMO53N05HmvmC7FgghIhjJg4EW8YEcn8@95SJZnOlkRJou6tPnUc13efw2h7119dLvRO77EpVvpiIn/Qr/dt02f01L/t0qI8ZFofUpmIimp2oHtPp/J79yhd9PZz7o@Cnn/lEXF6bQy0kEMSWntN1tdk0713bD5tNdtdvjy/t@10@50VzHLID9TOZr8shbX88l8v0lIqySft0KN9SD4gb2v7hjfFERxcA7tflOX2kPb8Bk@7H5XFYfKSmbKZJlstpupRP09Txdn24FTwMi7cZNj/SW7nHgvf2XH1dndd0XX2sE38QP05G1OVjteiBWbXHoTme6z9clg@VAHnRgNONT7P@f@cRIVXf5mTVbDm95PdgMn2addMWFQdQqWZpWbbT9PRVp8P2/fllK670udg@n7Lr7DN/mBdyMtm1vdiI5ijg2e86k0WBeCaiS6tIUpLUJO26vKSVI0uR/LqskirEP13f7prhRJe6@f2K72rbbatm@JyI7elU90NWZ7tsdc8ZQ0e@Ruyk/TzEPP@Gl@QVxYIMkC0F0pa8JYeeWHgyBTnNb1TkT@nJB35pDDwEn2AoaDL4wytyFACmSFl@ax3JQDaQxGYgX1B0pBW5gBocr1Lw8W9MZaHdPOo/XA3ZwpGRjiKaOBNJaVC0ngLYGkgwSpGHJm0jOefJRvQlC2paG/KOT4Jx1FAFT7XECWYGlZAWPGoUxEmIRR1PkIx8xiMFfBeQo7FXANNFrD1FzQ6ic4A1sNIiqyApwhIo1wXMc@CtHaqAHiIZj0yNAiNwNDAaHQy6OXbv1lShkUfuAcQ03FN8rABZ1DisA8grmKwgLBgeEY1YI2nk5uBE4DKHY4BEOVANTAn4R9IS9BRAIdiAsEFG3JNFa8sHQQ02K/TTAdNmIQo8JCh6CNZAY/uV@h4BgyINBxQyNgqHxgwsD0UwfB48gRHRG2KxOQLBSXYbuQVuiKwiZklFCIU4JgFuHIhEaeBRYizAWkziLRgIw4QiGy9Zo8K8@LEBT1ogx6nikGJsBsNhBaM880RaUWmeaoceFhNtLVxCKabIS37EfIy3g9ky4M0mGKi5ml1HcAF2O89iUDKGjMG0rJNvhYRzfAMgEnAOFNk5z8lxNBKkxkGFU7glPBfg5VgNggxgIlE@DgSeLTILOGbBhkNX7CNM0DzveKd41mMxXiwY9beLFZWPc2f5YnU9/0Tftfu7/Os/" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>non-competing. qselect with in-place 3-way partitioning.</p>
<p><code>x</code> list of price-weight pairs</p>
<p><code>c</code> capacity</p>
<p><code>l</code> <code>r</code> left and right index in <code>x</code> (everywhere it's left inclusive, right exclusive)</p>
<p><code>t</code> pivot</p>
<p><code>i</code> <code>j</code> 3-way partitioning:</p>
<ul>
<li><code>x[l:i]</code> are larger than <code>t</code></li>
<li><code>x[i:j]</code> are equal to <code>t</code></li>
<li><code>x[j:r]</code> are smaller than <code>t</code></li>
</ul>
<p><code>k</code> current index</p>
<p><code>p</code> price</p>
<p><code>w</code> weight</p>
<p><code>P</code> partial sum of prices</p>
<p><code>W</code> partial sum of weights</p>
<p><code>o</code> accumulator for the result</p>
<p><code>u</code> <code>v</code> temporary</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <sup><s>332</s> <span class="math-container">\$\cdots\$</span> <s>242</s></sup> 252 bytes</h1>

<pre class="lang-python prettyprint-override"><code>from random import*
def f(l,W):
 a,b=choice(l);L=*M,=*S,=[]
 for p,w in l:[[M,S][p/w&lt;a/b],L][p/w&gt;a/b]+=(p,w),
 N,X=map(sum,zip(*L+[(0,0)]));A=X
 while X&lt;W and M:*M,(p,w)=M;X+=w;N+=p
 return A&gt;W and f(L,W)or X&lt;W and N+(S&gt;[]and f(S,W-X))or(W-X+w)*p/w+N-p
</code></pre>
<p><a href="https://tio.run/##XVVNb@JIEL37V/QNG5qM@7s7iSPNPcklB5BYNCLEDNbyYYEjZjbKb8/WK8MmO0jYbVfVq1evqt3t726935mPj9VhvxWHxe6Fbs223R@6YfZSr8Qq38hJcZ2JhXyulut9s6zzTXFzXw0fZDV8ktVsnonV/iBaeRLNTmyuZ7MH@TSftd9Ot4tvz3N5z@s7rEdVTm6FzMSjnFbbRZsfX7fyn6bNh/ejWV7KspgXxc33apqJ07rZ1GJ6OxFESjxcUz4Orh5upqPqdPM4qtpMHOru9bAT3@96t1V@T2yJzSXucZQ/3c3mve1JTsbTgsw53UenYki8Ro/j9qOrj92P9rBfNd1RVCLPBP3yJIVy9Df0VyDNL5UUQUuRSimsl8KRR5TC0C3Q36s@KAQyk4s3/Xud@rui9yH2Nmv/A7UEVBKaVXRJifC9pQhtAOPoEgFqkdBqsgbQMI5cvCerSwSJuyUgY@gSPAPRKiYDGijCKITDtQQ1cIkBzhpsFCgiQiWODSgbq5IinIG1RA6f8EirZFgLcIooC7I4qBXpfbK0cFCmhAQeFRoPfySMhGEDBLYajFGIVefUFiTAP8JXI31QZIxgbRTecXyJcuDn8RhRotbQGipE6KfAxiCPQWM8NIwc4AGCFAhFGgtFIy7orEIJGqkgkkVlVsWzSMYxBIijZxo8TCTs5KAAWCqUECCSATh3VOvPfv8xWUXGE3iqm5/rrxPopZNJhktYRF0UA2lBGTJBJUoAfNdbwQ5cIT4qsNxw8vFgA@bwv2BaEDdoooaj1SimHzHXZ4qWS4OwqC9BIbQKTn2ZSMZzhKIiC4OpTOCrE1qF3rBiUJJnTiEqMlfGRzaHXaIQoLF/MIFBcX8oSmH4OCkXQ9GepxjRmtMxNnA0hA1cDgYzadNvQI/EDlvPOQiDKGypoPgVutFvb66Ks8R@HgwH8UhBxohJ8oHrhls/2NDWsTLcI4VZ4D5AFaB71MGzEHhOeQAVWPc7GWKjabwxwNxz9RjdCJ6K24xHh8ZGxDvw5GHX3AyoZ/jrAIPmD0MqL93@HKgiWy7axbLpmpoHDp@AiMTcCZK2LLL6V1svu/oFdhOusFVUafwVvihJh3TVbyiCWtfLv@sD/AZ/vepglwMpeKXMgHDaY7PZ78is6rHO@LQ40EFylOeJlxNZ4/DASfD1WyzF130hxSdlKS7kcDbRb0PoMz4gvp5GAPx/qmLO7qi5P9r48ed@jyoXz8f8OK6L2zNjtlH8rstXg7ce6F2KtzPWuzg13VpsF78uzH6Lt8m7GN@JNzK@nWWZAX3@Pig@/gU" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>Runs in <span class="math-container">\$O(n)\$</span> time and space complexity.</p>
<p>Inputs a list of price and weight tuples along with the maximum capacity.<br />
Returns the optimal profit.</p>
<p>Saved 3 bytes thanks to <a href="https://codegolf.stackexchange.com/users/103772/jakque">Jakque</a>!!!<br />
Saved 6 bytes thanks to <a href="https://codegolf.stackexchange.com/users/97857/pxeger">pxeger</a>!!!<br />
Saved 8 bytes thanks to <a href="https://codegolf.stackexchange.com/users/64121/ovs">ovs</a>!!!<br />
Added 10 bytes to fix a bug kindly pointed out by  <a href="https://codegolf.stackexchange.com/users/98590/anush">Anush</a>.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, <s>172</s> 178 bytes</h1>

<pre class="lang-r prettyprint-override"><code>f=function(x,m,y=x$p/x$w,s=sample(c(y,y),1),S=sum,i=`if`)i((v=S((z&lt;-x[y&gt;s,])$w))&gt;m,f(z,m),i((t=v+S((u=x[y==s,])$w))&gt;=m,S(z$p)+(m-v)*s,S(c(z$p,u$p))+i(any(y&lt;s),f(x[y&lt;s,],m-t),0)))
</code></pre>
<p><a href="https://tio.run/##ZVTNbhs9DLzzKQgjBylRUv1REoFsXyLHomj9uevCQHbjep3ETtFnT0cp2uJDD4YgLjmcGVI@vL5uh@3jvDnuHmZzcpM7D6eL/bvTxbNbhmU97e9HszFnd7YuWHc3LI@T2w2fd9vPdmfM03BnzMvt9enD@f3iPtqLZ2vfT25rXtxkHRKOw9MVUh4HZAzDn5Rhcnfm5WJvr8x0/WQvF1w3PeAeEbRXO7Oez@Z8u1hgofQWlW66PlrnrbWvp9vrw7j@cnNc/wd6x2GlmXMTEl84xUI5FI65kWrkHAOVrIhHiqlyVaEslXOiFoRbxjUXVsEZI0eJVDWwUhJl9SgulQOKRRtrJiCkRpIzS82UUuYahGop3FpEx8ypVGqaWFumkhJHVQopoGNCi8YFedV7rpFKqNwAgx8HwNbouUkXoBzArAJOQThoYYkKeHDpcF1graQenCpJUrBQoFboBtWCct/jv6grulcPdOhslFvl4nGtkQuaSADHzhmqwUlz4oae0jiGRMknrvCylu5xxwRITADLUEa1KRcoyFVZsqeQI4t0Y5QzQEuG8PImoAZPGYJEEkyFjkANIACiCB01gVIAh9aowR71lALcBGhsHVwp@4Ay2NPdLkLlrTnS4bJAYIzCmgrF3GEjNcy9SIBdCT5AC0jmFCiVwOIbFWHB2uQGuE4KZ4F9ESdWhxrgaxTqShu6Yi1aQLifgmF4LiVRgG@gHME1VIwGlsOm3M3FSHKAjSW8TbTBiCRdOSbf4ls8YWUldAc6Cr43cIITKhH5ipX2sDnDQEjC5CtGmuBcAqnU87DiEUON3Un1K7d5uL@Z19O48MAbs9qvHK@eV9YSHpLry2Tp698XP9vvxIw3/@Ew7s0yfvt0PyJ6eHg2J2vdbN3Hq8P8cJjMfPk7ioLlvBzH6ea4m0azxb8DYC9nfPlBgLnfbdbH0Yj7amRMiP4/Fsb8Tyz22OtP" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<p>A function that takes a data frame <code>x</code> with columns <code>w</code> and <code>p</code> and a capacity <code>m</code> and returns a double indicating the profit. As far as I can tell, this should be <span class="math-container">\$O(n)\$</span> complexity. Thanks to @digEmAll for saving 9 bytes! Thanks to @Anush for pointing out that the original version failed where everything can fit in the knapsack.</p>
</div>
<div id="pu5" class="pu"><h1>Python3, 271 bytes</h1>
<p>Runs in expected linear time. Essentially quickselect.</p>
<pre><code>from random import *
def k(c,p,V=0):
    while p[1:]!=[]:
        i=randrange(len(p))
        m,l,r=(p[i][0]/p[i][1],i),[],[]
        for j,t in enumerate(p):
            [r,l][(t[0]/t[1],j)&gt;=m]+=[t]
        v,w=map(sum,zip(*l))
        c,V,p=[(c,V,l),(c-w,V+v,r)][w&lt;=c]
    v,w=(p+[(0,1)])[0]
    return V+v*min(c/w,1)
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/230353/">230353</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




