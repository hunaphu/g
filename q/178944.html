<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::178944</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>461</td><td>Python3</td><td>250517T155610Z</td><td><a href="https://codegolf.stackexchange.com/questions/178944/connect-4-spot-the-fake/279770#279770">Ajax1234</a></td></tr>
<tr d-ix="1"><td>285</td><td>Python 2</td><td>190122T054120Z</td><td><a href="https://codegolf.stackexchange.com/questions/178944/connect-4-spot-the-fake/178982#178982">Chas Bro</a></td></tr>
<tr d-ix="2"><td>183</td><td>JavaScript ES6</td><td>190120T203915Z</td><td><a href="https://codegolf.stackexchange.com/questions/178944/connect-4-spot-the-fake/178949#178949">Arnauld</a></td></tr>
<tr d-ix="3"><td>057</td><td>Jelly</td><td>190121T000728Z</td><td><a href="https://codegolf.stackexchange.com/questions/178944/connect-4-spot-the-fake/178951#178951">Jonathan</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 461 bytes</h1>
<pre class="lang-py prettyprint-override"><code>E=enumerate
def V(P,j):
 B=P[j][-1]
 q=[(5,j,B,-1,-1),(5,j,B,-1,1)]
 for x,y,B,X,Y in q:
  if 0&lt;=(J:=x+X)&lt;6 and 0&lt;=(K:=y+Y)&lt;7:q+=[(J,K,B+[*zip(*P)][J][K],X,Y)]
  else:yield B
def f(b):
 q=[(['']*7,0)]
 for B,T in q:
  P=[' '*(6-len(j))+j for j in B]
  if b==P:return 1
  if not any('0'*4 in''.join(i)or'1'*4 in''.join(i)for i in B+[*zip(*P)]+[k for j,_ in E(P)for k in V(P,j)]):
   for i,a in E(B):q+=[(B[:i]+[str(T)+a]+B[i+1:],(T+1)%2)]*b[i].endswith(str(T)+a)
</code></pre>
<p><a href="https://tio.run/##vVRda9swFH2ef4UIDEm2EuJ8Y@IXQ18SGMaEUaOJkhB5lZvJie2wZut@eybJSZO0prRjJAqYe3R8zr0XfNa78j6T3dE63@9vfC63P3g@L7m15An4ikKSYs8CgR/SlNGmyyyw8Snqk5QEpOmqPyanysXqPsly8Eh2CrklMRASbJQAEAloj3008fxH5xaPB2AulwaZev7OifF46G0cpTwhUxI41P4l1sgOMaMTRqdMS2ltwFcF93aCr5YgMC0maKEb1E1RCJk9JO1jEwGZPduHPoUA2mjQXHGJUoyd1HBSzQhY1eDC90Mv5@U2l8CtIJmVqtMdgm1o9xQXwlaaCYkEznLovsS0ojCKZxM49KGyInf66gaFhvegi2rBTE8ADEmQeUUKcLWPgHpCSRRljmbYmTMnoMJxPUbQzHHx5w5m9oIK1uJyWfwU5T06MvG@cIEPGo2G9QQuzvvq6EUdn9XRZa09is5bZvEHxF/fx@e1Metec7LeNSfr/9tkQP/qSPHhHOvocE6Og/c6xnWO0QVsGe344qVzpHIcXs0xOjiO/utWq32ethq93qrJpjK7W2TzfIkK9YF/OgQLPcbFbxhDT2UIgZF6tuGf1ndeoi1ROWUCYquDIMWnmDKBQqmdiFXJc/Qlk5wA0SrWK1Ei@AQxZs8BdMEpjpxvUpNUPlrrXMgSJejUoosxroE79XC3Hu7Vw/16eFAPD@vhkYL3fwE" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, <s>295</s> 285 bytes</h1>



<pre class="lang-python prettyprint-override"><code>def f(a):
 if 1-any(a):return[]
 p=sum(map(len,a))%2
 for i in R(7):
&#9;if a[i][-1:]==`p`:
&#9; b=a[:];b[i]=b[i][:-1];L=f(b)
&#9; if L&gt;1&gt;(`1-p`*4in','.join([J((u[j]+' '*14)[n-j]for j in R(7))for n in R(12)for u in[b,b[::-1]]]+b+map(J,zip(*[r+' '*7for r in b])))):return L+[i]
R=range;J=''.join
</code></pre>

<p><a href="https://tio.run/##vVRda9swFH2ef8WlZUhKnFCHQiHB@QGle/GbUQWRY7lRSGQhyd1a@t@zK8fJlj6Mja2TwPY5V1fnfliyL2HTmtnhUKsGGirZPAHdQDaR5iUip0LnDBcJ2Nx3e7qXlu6USSVjn2cJNK0DDdpAQe/Q9RO6Sq4Fn2Rzkecru0IOqlzyuVhUaMjjg88nmVg85A2tGJrR52GZLekqm9jV6FYbkpLpttWG8ntKO74VYwJklN0ybiZbESW3J0kWkTmibNajDhGv0orPo4wQ42ocg75PX7WlI@76ze7iShf9KsFwDHnCwxjjS4rcSfOkFvc5OUZyuIaw0R6azqyDbg04hRvsZfDIKwjKB1hLrzzuGFrYv0CtvHaqhuOyeXINWV@sYgE3/Ue5ACXXG1i3u26PGXiQ4NqvMSR0Rx@nvy1AmjqyaHQKWrOLllpBZ6FtgNwQ368gGX5Q04KVda3NE3gr18qzpG/qPnyRgfrYHp/7qVN2h1ZKCqxzRtgPokTihmBLhmLwIXvsQV9LNvUYlaUMTnWGoaY8i/aptzsdKHkj7FxefyIfDWGCiSTBUuVACHmDi5n8NS7wWeKM7@INFVCr@XCt4qQVfjev8pKJI25YvhP4mUkGqRNzFGz@l@CQYfdLvfIdLv7IXp5xL/X8z/pWnucpy@Kyb8nrB/0jl7jXisdCxmPBfUh9k4aQhibt0uf0VeDxtA6vD5ApXD2afHmV4oU8nF68bgdzcvgO" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>

<p>-10 thx to <a href="https://codegolf.stackexchange.com/users/76162/jo-king">Jo King</a>.</p>

<p>Input is a list of strings representing the columns; with '1' for Red and '0' for Yellow. The strings are not ' '-padded. So the (falsey) case:</p>

<pre class="lang-python prettyprint-override"><code>| | | | | | | |
| | | | | | | |
|Y| | | | | | |
|R|Y| | | | | |
|R|R|Y| | | | |
|Y|R|R|Y| | |R|
</code></pre>

<p>is input as:</p>

<pre class="lang-python prettyprint-override"><code>[
  '0110',
  '110',
  '10',
  '0',
  '',
  '',
  '1'
]
</code></pre>

<p>Output is a list of column indexes, 0-indexed, that could make the board; or <code>None</code> if it's not valid.</p>

<p>Accepts the empty board as valid (returns the empty list <code>[]</code> instead of <code>None</code>).</p>

<p>This approach is recursive from the last move to the first move: based on the parity of the total number of moves taken, we remove either the last Red move or the last Yellow move (or fail if that is not possible); check the resulting board to see if the opponent has 4-in-a-row (in which case fail, because the game should have stopped already); otherwise, recurse until the board is empty (which is valid).</p>

<p>The 4-in-a-row code is the most bloaty part. All the diagonal strings for the matrix <code>b</code> are generated by:</p>

<pre class="lang-python prettyprint-override"><code>[
    ''.join(
        (u[j]+' '*14)[n-j] for j in range(7)
    )
    for u in[b,b[::-1]]for n in range(12) 
]
</code></pre>

<p>which first lists out the 'down-sloping' diagonals, and then 'up-sloping' ones.</p>
</div>
<div id="pu2" class="pu"><h1>JavaScript (ES6), <s> 202 194 187 </s> 183 bytes</h1>
<p>Takes input as a matrix with <span class="math-container">\$2\$</span> for red, <span class="math-container">\$4\$</span> for yellow and <span class="math-container">\$0\$</span> for empty. Returns a string of 0-indexed moves (or an empty string if there's no solution). Reds start the game.</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;(p=[...'5555555'],g=(c,s=o='')=&gt;/2|4/.test(m)?['',0,2,4].some(n=&gt;m.join``.match(`(1|3)(.{1${n}}\\1){3}`))?o:p.map((y,x)=&gt;m[m[y][x]--^c||p[g(c^6,s+x,p[x]--),x]++,y][x]++)&amp;&amp;o:o=s)(2)
</code></pre>
<p><a href="https://tio.run/##zZOxbsIwEIZ3noKhImflMGDcDkiGvUM7dDRGQWlIg3Ac4agKIjx7ioBWJtClBVqf7OHTyfp0vz2fvk9tuEyyvJ2a16iaiUqLIWRCUkq9@/3yFMYCQrTCCM8jYthhJe/QPLI5aDKSnoddZMgVtUZHkIqhpnOTpEFA9TQP3yCAXtknQNe9u3W62YzHPbLubwJCRmaQbXsygBUW24u11HKlZKHa7UlYlpmMIZw8oPULzHaUYKF8H3c9vk9aLTMwwhJgpApNas0iogsTw@PL8xO1@TJJ42S2ghnIRrMpu@iUwkuj7QTwa6uGIoQ0rizFThGvS7nol1L8JwZnu7iDbjKp7qnBvhzEDnV5KX7@tZwgVh8eRwf@Ryn2J/HtgzuKj10xvguhm0jxzx/oPvTDWZ8Uu1V8NSnuSLFvpaoP" rel="noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>How?</h3>
<p>The recursive function <span class="math-container">\$g\$</span> attempts to replace all <span class="math-container">\$2\$</span>'s and <span class="math-container">\$4\$</span>'s in the input matrix with <span class="math-container">\$1\$</span>'s and <span class="math-container">\$3\$</span>'s respectively.</p>
<p>While doing so, it makes sure that we don't have any run of four consecutive odd values until all even values have disappeared (i.e. if a side wins, it must be the last move).</p>
<p>The row <span class="math-container">\$y\$</span> of the next available slot for each column <span class="math-container">\$x\$</span> is stored in <span class="math-container">\$p[x]\$</span>.</p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>m =&gt; (                            // m[] = input matrix
  p = [...'5555555'],             // p[] = next row for each column
  g = (c,                         // g = recursive function taking c = color,
          s = o = '') =&gt;          //     s = current solution, o = final output
    /2|4/.test(m) ?               // if the matrix still contains at least a 2 or a 4:
      ['', 0, 2, 4]               //   see if we have four consecutive 1's or 3's
      .some(n =&gt;                  //   by testing the four possible directions
        m.join``                  //   on the joined matrix, using
        .match(                   //   a regular expression where the number of characters
          `(1|3)(.{1${n}}\\1){3}` //   between each occurrence is either 1, 10, 12 or 14
        )                         //   (horizontal, diagonal, vertical, anti-diagonal)
      ) ?                         //   if we have a match:
        o                         //     abort and just return the current value of o
      :                           //   else:
        p.map((y, x) =&gt;           //     for each cell at (x, y = p[x]):
          m[                      // 
            m[y][x]--             //       decrement the value of the cell
            ^ c ||                //       compare the original value with c
            p[                    //       if they're equal:
              g(                  //         do a recursive call with:
                c ^ 6,            //           the other color
                s + x,            //           the updated solution
                p[x]--            //           the updated row for this column
              ),                  //         end of recursive call
              x                   //         then:
            ]++,                  //         restore p[x]
            y                     //         and restore m[y][x]
          ][x]++                  //         to their initial values
        ) &amp;&amp; o                    //     end of map(); yield o
    :                             // else:
      o = s                       //   we've found a solution: copy s to o
)(2)                              // initial call to g() with c = 2
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 57 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>

<pre><code>ŒṪŒ!µ0ịŒṬ¬a³ZU,Ɗ;ŒD$€Ẏṡ€4Ḅo1%15;Ḋ€ṢṚ$Ƒƙ$Ȧȧœị³$2R¤ṁ$ƑµƇṪṪ€
</code></pre>

<p>Takes a matrix where <code>0</code> is unfilled, <code>1</code> played first, and <code>2</code> played second. Yields a list of 1-indexed columns, empty if a fake was identified.</p>

<p><strong><a href="https://tio.run/##y0rNyan8///opIc7Vx2dpHhoq8HD3d0g3ppDaxIPbY4K1TnWZX10kovKo6Y1D3f1Pdy5EMgwebijJd9Q1dDU@uGOLpDEzkUPd85SOTbx2EyVE8tOLD86GWjIoc0qRkGHljzc2QiUOLT1WDvQBiACKv///390tIEOEozl0iFSwBBdwAhZwBAsAFUTGwsA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> (too inefficient for more than 7 pieces to run in under a minute) </p>

<p>Note:</p>

<ol>
<li>Assumes that no "floating" pieces are present (fix this by prepending <code>ZṠṢ€Ƒȧ</code> for +6 bytes)</li>
<li>Assumes that the empty board is a fake</li>
</ol>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/178944/">178944</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




